"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[9451],{49199:(e,t,a)=>{a.r(t),a.d(t,{AboutAdsModal:()=>Zl,AboutMonetizationModal:()=>ec,ArchivedChats:()=>nA,AttachBotInstallModal:()=>qi,AttachBotRecipientPicker:()=>Ls,AttachmentModal:()=>ch,BoostModal:()=>Ll,BotCommandMenu:()=>Oh,BotTrustModal:()=>$i,CalendarModal:()=>Ys,ChatCommandTooltip:()=>Uh,ChatFolderModal:()=>sA,ChatInviteModal:()=>Hl,ChatLanguageModal:()=>_c,ChatlistModal:()=>jl,CollectibleInfoModal:()=>Kc,ContactList:()=>zu,ContextMenuContainer:()=>oA.A,CountryPickerModal:()=>co,CreateTopic:()=>vp,CustomEmojiSetsModal:()=>mA,CustomEmojiTooltip:()=>jh,CustomSendMenu:()=>zh,DeleteFolderDialog:()=>Wi,DeleteMessageModal:()=>kc,Dialogs:()=>Fs,DraftRecipientPicker:()=>Bs,DropArea:()=>Hh.A,EditTopic:()=>Ep,EmojiInteractionAnimation:()=>Dc,EmojiStatusAccessModal:()=>ic,EmojiTooltip:()=>Zh,ForwardRecipientPicker:()=>Ts,GifSearch:()=>dy,GiftCodeModal:()=>Vl,GiveawayModal:()=>Vo,HeaderMenuContainer:()=>yA,HistoryCalendar:()=>Qs,InlineBotTooltip:()=>iy,InviteViaLinkModal:()=>Dv,LeftSearch:()=>Md,LocationAccessModal:()=>rc,Management:()=>ev,MapModal:()=>Ks,MediaViewer:()=>Pt,MentionTooltip:()=>nh,MessageSelectToolbar:()=>Pc,MessageStatistics:()=>Yy,MiddleSearch:()=>wA,MinimizedWebAppModal:()=>mi,MuteChatModal:()=>rA,NewChat:()=>Wu,NewContactModal:()=>Xs,Notifications:()=>Ds,OneTimeMediaModal:()=>Uv,PaymentModal:()=>Bv,PinMessageModal:()=>wc,PollModal:()=>dh,PollResults:()=>ip,PremiumLimitReachedModal:()=>Ko,PremiumMainModal:()=>no,PreparedMessageModal:()=>hc,PrivacySettingsNoticeModal:()=>Fc,ReactionPicker:()=>RA,ReactorListModal:()=>Vc,ReceiptModal:()=>xv,ReportAdModal:()=>lc,ReportModal:()=>mc,SafeLinkModal:()=>Os,SeenByModal:()=>Mc,SendAsMenu:()=>ry,Settings:()=>Gu,SharePreparedMessageModal:()=>yc,SponsoredMessageContextMenuContainer:()=>ql.A,Statistics:()=>Jy,StatusPickerMenu:()=>kl,StickerSearch:()=>cy,StickerSetModal:()=>cA,StickerTooltip:()=>Jh,StoryStatistics:()=>ap,StoryViewer:()=>ps,SuggestedStatusModal:()=>Il,SymbolMenu:()=>Vh,TextFormatter:()=>Yh,UnpinAllMessagesModal:()=>Nc,UrlAuthModal:()=>Gs,VerificationMonetizationModal:()=>nc,WebAppModal:()=>Hi,WebAppsCloseConfirmationModal:()=>Ov});var n=a(84051),s=a(13439),i=a(89925),r=a(31481),o=a(66644),l=a(90709),c=a(29807),d=a(53827),m=a(11778),u=a(14680),A=a(76023),h=a(49086);function y(e){if(!e)return;if("standalone"===e.type)return{media:e.media[e.mediaIndex],isSingle:1===e.media.length};if("avatar"===e.type){const t=e.profilePhotos?.photos[e.mediaIndex];return t?{media:t}:void 0}const{action:t,document:a,photo:n,video:s,webPage:i,paidMedia:r}=(0,l.r_3)(e.message);if("chatEditPhoto"===t?.type||"suggestProfilePhoto"===t?.type)return{media:t.photo,isSingle:!0};if(a&&((0,l.Ml8)(a)||(0,l.hrn)(a)))return{media:a};if(i){const{photo:e,video:t,document:a}=i,n=a&&((0,l.Ml8)(a)||(0,l.hrn)(a)),s=t||(n?a:void 0)||e;if(s)return{media:s,isSingle:!0}}if(r){const t=r.extendedMedia[e.mediaIndex||0];if(!("mediaType"in t)){const{photo:e,video:a}=t;return{media:e||a}}}const o=s||n;return o?{media:o,isSingle:s?.isGif}:void 0}var p=a(19822),v=a(83868),g=a(16460),E=a(41512),b=a(82393),C=a(43503);function f(e,t){const a=document.createElement("div");a.classList.add("ghost");const n=new Image;if(n.draggable=!1,n.oncontextmenu=v.A,"string"==typeof e?n.src=e:e instanceof HTMLVideoElement?n.src=e.poster:n.src=e.src,a.appendChild(n),t===i.TQ.ProfileAvatar||t===i.TQ.SettingsAvatar){a.classList.add("ProfileInfo"),t===i.TQ.SettingsAvatar&&a.classList.add("self");const e=document.querySelector(t===i.TQ.ProfileAvatar?"#RightColumn .ProfileInfo .info":"#Settings .ProfileInfo .info");e&&a.appendChild(e.cloneNode(!0))}return a}function S(e,t,a){let n,s;switch(e){case i.TQ.Album:case i.TQ.ScheduledAlbum:n=`.Transition_slide-active > .MessageList #album-media-${(0,l.GZP)(t.id,a)}`,s=".full-media";break;case i.TQ.PreviewMedia:n=`#preview-media${a}`,s="img";break;case i.TQ.SharedMedia:n=`#shared-media${(0,l.GZP)(t.id,a)}`,s="img";break;case i.TQ.SearchResult:n=`#search-media${(0,l.GZP)(t.id,a)}`,s="img";break;case i.TQ.MiddleHeaderAvatar:n=".MiddleHeader .Transition_slide-active .ChatInfo .Avatar",s=".avatar-media";break;case i.TQ.SettingsAvatar:n="#Settings .ProfileInfo .Transition_slide-active .ProfilePhoto",s=".avatar-media";break;case i.TQ.ProfileAvatar:n="#RightColumn .ProfileInfo .Transition_slide-active .ProfilePhoto",s=".avatar-media";break;case i.TQ.ChannelAvatar:case i.TQ.SuggestedAvatar:n=`.Transition_slide-active > .MessageList #${(0,l.GZP)(t.id,a)}`,s=".Avatar img";break;case i.TQ.StarsTransaction:n=".transaction-media-preview",s=0===a?`.stars-transaction-media-${a} :is(img, video)`:void 0;break;case i.TQ.SponsoredMessage:n=".Transition_slide-active > .MessageList .sponsored-media-preview",s=`${r.KFG} .full-media,${r.KFG} .thumbnail:not(.blurred-bg)`;break;case i.TQ.ScheduledInline:case i.TQ.Inline:default:n=`.Transition_slide-active > .MessageList #${(0,l.GZP)(t.id,a)}`,s=`${r.KFG} .full-media,${r.KFG} .thumbnail:not(.blurred-bg)`}const o=document.querySelector(n),c=s?o?.querySelectorAll(s):void 0;return{container:o,mediaEl:c?.[0]}}function k(e,t){switch(t){case i.TQ.Album:case i.TQ.ScheduledAlbum:case i.TQ.Inline:case i.TQ.ScheduledInline:case i.TQ.StarsTransaction:case i.TQ.PreviewMedia:case i.TQ.ChannelAvatar:e.classList.add("rounded-corners");break;case i.TQ.SharedMedia:case i.TQ.SettingsAvatar:case i.TQ.ProfileAvatar:case i.TQ.SearchResult:e.firstChild.style.objectFit="cover";break;case i.TQ.MiddleHeaderAvatar:case i.TQ.SuggestedAvatar:e.classList.add("circle"),t===i.TQ.SuggestedAvatar&&e.classList.add("transition-circle")}}var w=a(43874),N=a(77523),I=a(37661),P=a(30857),M=a(17712),T=a(59030),B=a(41733),L=a(22237);const R=(0,L.n5)(!1),x=R[1];function F(e){if(e.webkitSupportsPresentationMode&&"function"==typeof e.webkitSetPresentationMode)return e.webkitSetPresentationMode.bind(e)}function V(){if(document.pictureInPictureElement)try{document.exitPictureInPicture()}catch(e){r.Oig&&console.log("[MV] PictureInPicture Error",e)}}var D=a(73767),_=a(34780),U=a(23174),O=a(32610),J=a(87679);const K=new Map;var j=a(35297);var G=a(62587),z=a(69419);const H=A.cf,$=e=>{let{media:t,isAvatar:a,origin:s,delay:r}=e;const o=a&&"photo"===t?.mediaType&&!t.isVideo,c=a&&"photo"===t?.mediaType&&t.isVideo,d="document"===t?.mediaType,m="video"===t?.mediaType&&!t.isRound||d&&(0,l.hrn)(t),u="photo"===t?.mediaType||d&&(0,l.Ml8)(t),h="video"===t?.mediaType&&t.isGif,y=s===i.TQ.SharedMedia,p=s===i.TQ.SearchResult,v=(0,n.Kr)((()=>e=>{if(t)return!o&&!c||e?c&&e?(0,l.Pgy)(t):(0,l.VOI)(t,e?"full":"preview"):(0,l.mU)(t)}),[c,o,t]),g=(0,G.A)(t&&(y||p||d)&&(0,l.VOI)(t,"pictogram"),void 0,U.qZ.BlobUrl,r),E=v(),b=(0,G.A)(E,void 0,U.qZ.BlobUrl,r),{mediaData:C,loadProgress:f}=(0,z.A)(v(!0),void 0,t&&(0,l.Czs)(t,"full"),r),S=t&&"blobUrl"in t?t.blobUrl:void 0;let k=!m&&(S||C)||b||g;const w=function(e){const t=(0,n.li)();let a=!1;(0,j.A)((()=>{if(a=!0,t.current=void 0,!e)return;const n=new Image;if(n.src=e,!n.width)return;const s=(0,J.PR)(n);(0,O.A)(s.getContext("2d"),0,0,s.width,s.height,2,2),t.current=s.toDataURL()}),[e]);const s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;const s=(0,n.li)(e?K.get(e):void 0),i=(0,n.li)(),r=(0,P.A)();return i.current&&t&&(clearTimeout(i.current),i.current=void 0),(0,n.vJ)((()=>{if(!e||s.current||t)return;const n=new Image;n.onload=()=>{const t=(0,J.PR)(n);(0,O.A)(t.getContext("2d"),0,0,t.width,t.height,2,2);const a=t.toDataURL();s.current=a,r(),K.size>=1e3&&K.clear(),K.set(e,a)},a?i.current=window.setTimeout((()=>{n.src=e}),a):n.src=e}),[e,a,r,t]),s.current}(e||void 0,Boolean(t.current));return t.current||!a&&s||e||void 0}(!k&&t&&(0,l.VDY)(t));k||s===i.TQ.SearchResult||(k=w),c&&b&&(k=b);const N=S||C||(c||m?void 0:b||g||k),I=t&&(0,l.siT)(t),M=Boolean(S),T=(0,n.Kr)((()=>a?c?A._e:A.cf:d?t.mediaSize:u?(0,l.XnE)(t):m?(0,l.NZp)(t):H),[a,d,u,m,c,t]);return{getMediaHash:v,media:t,isVideo:m,isPhoto:u,isGif:h,isDocument:d,bestImageData:k,bestData:N,dimensions:T,isFromSharedMedia:y,isVideoAvatar:c,isLocal:M,loadProgress:f,mediaSize:I}};var q=a(18276),W=a(64493),Y=a(40664),Q=a(8410),Z=a(1087);const X=(0,n.ph)((e=>{let{isOpen:t,peerId:a,photo:i,onClose:r,onCloseAnimationEnd:o}=e;const{reportProfilePhoto:l}=(0,s.ko)(),[c,d]=(0,n.J0)("spam"),[m,u]=(0,n.J0)(""),A=(0,M.A)((()=>{l({chatId:a,photo:i,reason:c,description:m}),r()})),h=(0,M.A)((e=>{d(e)})),y=(0,M.A)((e=>{u(e.target.value)})),p=(0,T.A)(),v=(0,n.Kr)((()=>[{value:"spam",label:p("lng_report_reason_spam")},{value:"violence",label:p("lng_report_reason_violence")},{value:"pornography",label:p("lng_report_reason_pornography")},{value:"childAbuse",label:p("lng_report_reason_child_abuse")},{value:"copyright",label:p("ReportPeer.ReasonCopyright")},{value:"illegalDrugs",label:"Illegal Drugs"},{value:"personalDetails",label:"Personal Details"},{value:"other",label:p("lng_report_reason_other")}]),[p]);if(!a||!i)return;const g=p("ReportPeer.Report");return n.Ay.createElement(Q.A,{isOpen:t,onClose:r,onEnter:t?A:void 0,onCloseAnimationEnd:o,className:"narrow",title:g},n.Ay.createElement(Z.A,{className:"dialog-checkbox-group",name:"report-message",options:v,onChange:h,selected:c}),n.Ay.createElement(Y.A,{label:p("lng_report_reason_description"),value:m,onChange:y}),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(W.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:A},p("lng_report_button")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:r},p("Cancel"))))}));var ee=a(26607),te=a(41036);const[ae,ne]=(0,L.n5)(1);function se(){return(0,n._W)((()=>{ne(1)})),[ae,ne]}const ie=(0,n.ph)((e=>{let{isOpen:t,photo:a,profileId:i,onClose:r,onConfirm:o}=e;const{deleteProfilePhoto:c,deleteChatPhoto:d}=(0,s.ko)(),m=(0,n.hb)((()=>{o?.(),(0,l.L8L)(i)?c({photo:a}):d({photo:a,chatId:i}),r()}),[o,i,r,c,a,d]),u=(0,T.A)();return n.Ay.createElement(Q.A,{isOpen:t,onClose:r,onEnter:m,className:"delete dialog-buttons-column",title:u("AreYouSure")},n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(W.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:m},u("Preview.DeletePhoto")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:r},u("Cancel"))))}));var re=a(22699),oe=a(24433),le=a(35913);const ce=(0,n.ph)((0,s.EK)(((e,t)=>{let{item:a,canUpdateMedia:n}=t;const s=(0,c.nTw)(e),{origin:i}=s.mediaViewer,r="message"===a?.type?a.message:void 0,o="avatar"===a?.type?a.avatarOwner:void 0,l="avatar"===a?.type&&a.profilePhotos.photos[a.mediaIndex],d=(0,c.meB)(e),m=(0,c.Xf0)(e),{threadId:u}=(0,c.Xf0)(e)||{},A=(0,c.ynf)(e,r),h=(0,c.yuw)(e),y=r&&(0,c.ryq)(e,r?.chatId),{canDelete:p}=u&&r&&(0,c.WAX)(e,r,u)||{},v=l&&l.id===o?.avatarPhotoId,g=n&&Boolean(l),E=p||g,b=n&&Boolean(l)&&!v,C=m?.type;return{activeDownloads:h,isProtected:A,chat:d,isChatProtected:y,canDelete:E,canUpdate:b,messageListType:C,origin:i}}))((e=>{let{item:t,mediaData:a,isVideo:i,chat:r,isChatProtected:o,isProtected:c,canReportAvatar:d,canDelete:m,canUpdate:u,messageListType:A,activeDownloads:h,origin:p,onReportAvatar:v,onCloseMediaViewer:g,onBeforeDelete:E,onForward:b}=e;const[C,f,S]=(0,I.A)(!1),[k,N]=se(),{isMobile:P}=(0,w.Ay)(),{downloadMedia:B,cancelMediaDownload:L,updateProfilePhoto:R,updateChatPhoto:x,openMediaViewer:F,openDeleteMessageModal:V}=(0,s.ko)(),D="message"===t?.type,{media:_}=y(t)||{},U=_&&(0,l.sdt)(_),O=_&&(0,l.$r_)(h,_),{loadProgress:J}=(0,z.A)(_&&(0,l.VOI)(_,"download"),!O,_&&(0,l.Czs)(_,"download")),K=(0,M.A)((()=>{if(_)if(O)L({media:_});else{const e="message"===t?.type?t.message:void 0;B({media:_,originMessage:e})}})),j=(0,M.A)((()=>{const e=k();N((e<0?e:0)-1)})),G=(0,M.A)((()=>{const e=k();N((e>0?e:0)+1)})),H=(0,M.A)((()=>{if("avatar"!==t?.type)return;const{avatarOwner:e,profilePhotos:a,mediaIndex:n}=t,s=a?.photos[n];(0,l.L8L)(e.id)?R({photo:s}):x({chatId:e.id,photo:s}),F({origin:p,chatId:e.id,mediaIndex:0,isAvatarView:!0},{forceOnHeavyAnimation:!0})})),$=(0,T.A)(),Y=(0,n.Kr)((()=>e=>{let{onTrigger:t,isOpen:a}=e;return n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",className:a?"active":void 0,onClick:t,ariaLabel:"More actions"},n.Ay.createElement(q.A,{name:"more"}))}),[]);function Q(){return"avatar"===t?.type?n.Ay.createElement(ie,{isOpen:C,onClose:S,onConfirm:E,profileId:t.avatarOwner.id,photo:t.profilePhotos.photos[t.mediaIndex]}):void 0}const Z=(0,M.A)((()=>{"message"===t?.type&&r?V({chatId:r?.id,messageIds:[t.message.id],isSchedule:"scheduled"===A,onConfirm:E}):f()}));if(P){const e=[];if(D&&t.message.isForwardingAllowed&&!t.message.content.action&&!o&&e.push({icon:"forward",onClick:b,children:$("Forward")}),c||(i?e.push({icon:O?"close":"download",onClick:K,children:O?`${Math.round(100*J)}% Downloading...`:"Download"}):e.push({icon:"download",href:a,download:U,children:$("AccActionDownload")})),d&&e.push({icon:"flag",onClick:v,children:$("ReportPeer.Report")}),u&&e.push({icon:"copy-media",onClick:H,children:$("ProfilePhoto.SetMainPhoto")}),m&&e.push({icon:"delete",onClick:Z,children:$("Delete"),destructive:!0}),0===e.length)return;return n.Ay.createElement("div",{className:"MediaViewerActions-mobile"},n.Ay.createElement(re.A,{trigger:Y,positionX:"right"},e.map((e=>{let{icon:t,onClick:a,href:s,download:i,children:r,destructive:o}=e;return n.Ay.createElement(oe.A,{key:t,icon:t,href:s,download:i,onClick:a,destructive:o},r)}))),O&&n.Ay.createElement(le.A,{progress:J,size:"s",noCross:!0}),m&&Q())}return n.Ay.createElement("div",{className:"MediaViewerActions"},D&&t.message.isForwardingAllowed&&!o&&n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:$("Forward"),onClick:b},n.Ay.createElement(q.A,{name:"forward"})),function(){if(!c&&"standalone"!==t?.type)return"sponsoredMessage"!==t?.type&&(i?n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:$("AccActionDownload"),onClick:K},O?n.Ay.createElement(le.A,{progress:J,size:"s",onClick:K}):n.Ay.createElement(q.A,{name:"download"})):n.Ay.createElement(W.A,{href:a,download:U,round:!0,size:"smaller",color:"translucent-white",ariaLabel:$("AccActionDownload")},n.Ay.createElement(q.A,{name:"download"})))}(),n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:$("MediaZoomOut"),onClick:j},n.Ay.createElement(q.A,{name:"zoom-out"})),n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:$("MediaZoomIn"),onClick:G},n.Ay.createElement(q.A,{name:"zoom-in"})),d&&n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:$(i?"PeerInfo.ReportProfileVideo":"PeerInfo.ReportProfilePhoto"),onClick:v},n.Ay.createElement(q.A,{name:"flag"})),u&&n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:$("ProfilePhoto.SetMainPhoto"),onClick:H},n.Ay.createElement(q.A,{name:"copy-media"})),m&&n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:$("Delete"),onClick:Z},n.Ay.createElement(q.A,{name:"delete"})),n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:$("Close"),onClick:g},n.Ay.createElement(q.A,{name:"close"})),m&&Q())})));var de=a(87357),me=a(50442),ue=a(43336),Ae=a(37836),he=a(14737),ye=a(16581),pe=a(19129),ve=a(26072),ge=a(15283);function Ee(e){const t=(0,n.li)(e());return(0,ge.A)((()=>e.subscribe((()=>{t.current=e()})))),t}var be=a(90423),Ce=a(39751),fe=a(83414);const[Se,ke]=(0,L.n5)(!1),[we,Ne]=(0,L.n5)(!1);function Ie(){return[(0,fe.A)((()=>Se()&&!we()),[Se,we]),ke,Ne]}const[Pe,Me]=(0,L.n5)(0);function Te(){return(0,n._W)((()=>{Me(0)})),[Pe,Me]}var Be=a(5718),Le=a(672),Re=a(57474);const xe=e=>{let{text:t="",buttonText:a,isForVideo:s,onClick:i,handleSponsoredClick:r,isProtected:o,isForceMobileVersion:l}=e;const[c,d]=(0,n.J0)(!1),{isMobile:m}=(0,w.Ay)(),[u]=Ie(),h=(0,pe.A)((()=>!!b.TF&&!u()),[u]);(0,n.vJ)((()=>{const e=document.querySelector(".MediaViewerFooter .media-text"),t=()=>{const t=e?e.clientHeight:0;d(t>2*A.$)};t();const a=(0,Ae.nF)(t,500,!0);return window.addEventListener("resize",a,!1),()=>{window.removeEventListener("resize",a,!1)}}),[]);const y=(0,M.A)((()=>{r()})),p=(0,de.A)("MediaViewerFooter",s&&"is-for-video",h&&"is-hidden",o&&"is-protected",l&&"mobile");return n.Ay.createElement("div",{className:p,onClick:function(e){t&&e.stopPropagation()}},Boolean(t)&&n.Ay.createElement("div",{className:"media-viewer-footer-content",onClick:m?void 0:i},n.Ay.createElement("p",{className:"media-text custom-scroll allow-selection "+(c?"multiline":""),dir:"auto"},t)),Boolean(a)&&n.Ay.createElement(W.A,{className:(0,de.A)("media-viewer-footer-content","media-viewer-button"),size:"default",color:"primary",isRectangular:!0,onClick:y},a))};var Fe=a(84313),Ve=a(71533),De=a(50680),_e=a(73622);const[Ue,Oe]=(0,L.n5)(!1);function Je(){return(0,n._W)((()=>{Oe(!1)})),[Ue,Oe]}var Ke=a(17663),je=a(14242),Ge=a(71429),ze=a(82497),He=a(41074),$e=a(4875);function qe(e,t,a){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?n:n+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const We=b.Ni||b.pz,Ye=b.Ni||b.pz?.3:.25,Qe=We?40:80,Ze=200,Xe=(0,He.Ay)();let et;class tt{constructor(e,t){qe(this,"frames",new Map),qe(this,"currentTime",0),qe(this,"canvas",void 0),this.canvas=t,Xe.forEach(((t,a)=>{let{connector:n}=t;n.request({name:"video-preview:init",args:[e,Qe,a,He.bP,this.onFrame.bind(this)]})}))}onFrame(e,t){this.frames.set(e,t),e===this.currentTime&&this.render(e)}clearCache(){this.frames.forEach((e=>{e.close()})),this.frames.clear()}render(e){this.currentTime=e;const t=this.frames.get(e);return!!t&&((0,o.RK)((()=>{this.canvas.width=t.width,this.canvas.height=t.height,this.canvas.getContext("2d").drawImage(t,0,0,this.canvas.width,this.canvas.height)})),!0)}destroy(){this.clearCache(),Xe.forEach((e=>{let{connector:t}=e;t.request({name:"video-preview:destroy",args:[]})}))}}Xe.forEach((e=>{let{worker:t}=e;t.addEventListener("message",(async e=>{const{type:a,messageId:n,params:s}=e.data;if("requestPart"!==a)return;const i=await(0,$e.px)("downloadMedia",{mediaFormat:U.qZ.Progressive,...s});if(!i)return;const{arrayBuffer:r}=i;t.postMessage({type:"partResponse",messageId:n,result:r},[r])}))}));var at=a(63988);const nt="Od9ZSc1U";let st;const it=(0,n.ph)((e=>{let{duration:t,bufferedRanges:a,isReady:s,posterSize:i,playbackRate:r,url:o,isActive:l,isPlaying:c,isPreviewDisabled:d,onSeek:m,onSeekStart:u}=e;const A=(0,n.li)(null),[h]=Te(),[y]=Je(),v=(0,at.aG)(h,250),[g,E]=(0,n.Ul)(v()),[C,f]=(0,n.Ul)(0),[S,k]=(0,n.Ul)(0),w=(0,n.li)(!1),[N,I]=(0,n.J0)(!1),[P,T]=(0,n.J0)(!1),B=(0,n.li)(null),L=(0,n.li)(null),R=(0,n.li)(null),x=(0,n.li)(null),F=(0,n.Kr)((()=>function(e,t){const a=(e=Math.round(e*Ye))/(t=Math.round(t*Ye));return e>Ze&&(e=Ze,t=Math.round(e/a)),t>Ze&&(t=Ze,e=Math.round(t*a)),{width:e,height:t}}(i?.width||0,i?.height||0)),[i]),V=(0,M.A)((e=>{e=Math.floor(e),k(e),function(e){et&&et.render(e)}(e)}));return(0,n.vJ)((()=>{if(!d&&o&&s)return function(e,t){return et&&et.destroy(),et=new tt(e,t),()=>{et?.destroy(),et=void 0}}(o,B.current)}),[o,s,d]),(0,n.vJ)((()=>{I(!1)}),[l]),(0,n.vJ)((()=>{if(st&&st(),st=void 0,!w.current&&!P){const e=v(),a=t-e;st=(0,p.Hd)({from:e,to:t,duration:1e3*a/r,onUpdate:E})}}),[v,P,E,r,t]),(0,n.vJ)((()=>{c&&!y()||(st&&st(),st=void 0)}),[c,g,y]),(0,n.vJ)((()=>{if(c){st&&st(),st=void 0;const e=v(),a=t-e;st=(0,p.Hd)({from:e,to:t,duration:1e3*a/r,onUpdate:E})}}),[c,r,t]),(0,n.Nf)((()=>{if(!R.current)return;const e=(0,ue.LI)(g()/t*100,2);R.current.style.width=`${e}%`}),[g,t]),(0,n.Nf)((()=>{L.current&&(L.current.style.left=`${C()}px`)}),[C]),(0,n.Nf)((()=>{x.current&&(x.current.innerText=(0,Ke.QO)(S()))}),[S]),(0,n.vJ)((()=>{if(!A.current||!l)return;const e=A.current;let a=e.getBoundingClientRect(),n=0,s=0;const i=n=>{const s=n instanceof MouseEvent?n.pageX:n.touches[0].pageX,i=(0,ue.qE)(t*((s-a.left)/a.width),0,t);if(d)return[i,0];a.width||(a=e.getBoundingClientRect());const r=L.current;return[i,(0,ue.qE)(s-a.left-r.clientWidth/2,-4,a.width-r.clientWidth+4)]},r=()=>{st&&st(),st=void 0},o=()=>{r(),w.current=!0,I(!1),T(!1),E(n),m(n),setTimeout((()=>{w.current=!1}),250)},c=(0,me.wJ)(e,{onCapture:()=>{r(),I(!0),T(!0),u()},onRelease:o,onClick:o,onDrag:e=>{r(),I(!0),[n,s]=i(e),V(n),f(s),E(n)}});if(b.TF||d)return c;const h=e=>{I(!0),[n,s]=i(e),f(s),V(n)},y=()=>{I(!1)};return e.addEventListener("mousemove",h),e.addEventListener("mouseenter",h),e.addEventListener("mouseleave",y),()=>{c(),e.removeEventListener("mousemove",h),e.removeEventListener("mouseenter",h),e.removeEventListener("mouseleave",y)}}),[t,V,l,m,u,f,E,T,d,r]),n.Ay.createElement("div",{className:"ingarEvU",ref:A},!d&&n.Ay.createElement(ee.A,{isOpen:!0,isHidden:!N,className:"TqpEWfl3",style:`width: ${F.width}px; height: ${F.height}px`,ref:L},n.Ay.createElement("canvas",{className:"fKVz2lln",ref:B}),n.Ay.createElement("div",{className:"bGiNvx5D"},n.Ay.createElement("span",{className:"mnkqvOMR",ref:x}))),n.Ay.createElement("div",{className:nt},a.map((e=>{let{start:t,end:a}=e;return n.Ay.createElement("div",{key:`${t}-${a}`,className:"ANe2DKfp",style:`left: ${100*t}%; right: ${100-100*a}%`})}))),n.Ay.createElement("div",{className:nt},n.Ay.createElement("div",{ref:R,className:(0,de.A)("igaGLblf",P&&"beUP6SqY")})))})),rt=e=>{e.stopPropagation()},ot=[.5,1,1.5,2],lt=(0,n.ph)((e=>{let{url:t,bufferedRanges:a,bufferedProgress:s,duration:i,isReady:r,fileSize:o,isForceMobileVersion:l,isPlaying:c,isFullscreenSupported:d,isFullscreen:m,isBuffered:u,isPreviewDisabled:A,volume:h,isMuted:y,playbackRate:p,posterSize:v,onChangeFullscreen:g,onVolumeClick:E,onVolumeChange:C,onPlaybackRateChange:f,isPictureInPictureSupported:S,onPictureInPictureChange:k,onPlayPause:N,onSeek:P}=e;const[B,L,R]=(0,I.A)(),[x]=Te(),F=(0,pe.A)((()=>Math.trunc(x())),[x]),[V,D]=(0,n.Ul)(!1),{isMobile:_}=(0,w.Ay)(),[U,O]=Ie(),J=(0,pe.A)(U);(0,n.vJ)((()=>{if(!b.TF&&!l)return;let e;if(J&&c&&!B&&!V())return e=window.setTimeout((()=>{O(!1)}),3e3),()=>{e&&window.clearTimeout(e)};e&&window.clearTimeout(e)}),[c,J,O,B,V,l]),(0,n.Nf)((()=>(J?document.body.classList.add("video-controls-visible"):document.body.classList.remove("video-controls-visible"),()=>{document.body.classList.remove("video-controls-visible")})),[J]),(0,n.vJ)((()=>{J||R()}),[R,J]);const K=(0,T.A)(),j=(0,M.A)((e=>{D(!1),P(e)})),G=(0,M.A)((()=>{D(!0)})),z=(0,n.Kr)((()=>0===h||y?"muted":h<.3?"volume-1":h<.6?"volume-2":"volume-3"),[h,y]);return n.Ay.createElement("div",{className:(0,de.A)("VideoPlayerControls",l&&"mobile",J&&"active"),onClick:rt},n.Ay.createElement(it,{url:t,duration:i,isReady:r,isPlaying:c,isPreviewDisabled:A,posterSize:v,bufferedRanges:a,playbackRate:p,onSeek:j,onSeekStart:G,isActive:J}),n.Ay.createElement("div",{className:"buttons"},n.Ay.createElement(W.A,{ariaLabel:K("AccActionPlay"),size:"tiny",ripple:!_,color:"translucent-white",className:"play",round:!0,onClick:N},n.Ay.createElement(q.A,{name:c?"pause":"play"})),n.Ay.createElement(W.A,{ariaLabel:"Volume",size:"tiny",color:"translucent-white",className:"volume",round:!0,onClick:E},n.Ay.createElement(q.A,{name:z})),!b.pz&&n.Ay.createElement(ze.A,{bold:!0,className:"volume-slider",value:y?0:100*h,onChange:C}),function(e,t){return n.Ay.createElement("div",{className:"player-time"},`${(0,Ke.QO)(e)} / ${(0,Ke.QO)(t)}`)}(F,i),!u&&n.Ay.createElement("div",{className:"player-file-size"},`${(0,je.v7)(K,o*s)} / ${(0,je.v7)(K,o)}`),n.Ay.createElement("div",{className:"spacer"}),n.Ay.createElement(W.A,{ariaLabel:"Playback rate",size:"tiny",color:"translucent-white",className:"playback-rate",round:!0,onClick:L},`${p}x`),S&&n.Ay.createElement(W.A,{ariaLabel:"Picture in picture",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:k},n.Ay.createElement(q.A,{name:"pip"})),d&&n.Ay.createElement(W.A,{ariaLabel:"Fullscreen",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:g},n.Ay.createElement(q.A,{name:m?"smallscreen":"fullscreen"}))),n.Ay.createElement(Ge.A,{isOpen:B,className:(0,de.A)("playback-rate-menu",!d&&"no-fullscreen",!S&&"no-pip"),positionX:"right",positionY:"bottom",autoClose:!0,onClose:R},ot.map((e=>n.Ay.createElement(oe.A,{disabled:p===e,onClick:()=>f(e)},`${e}x`)))))}));function ct(){return ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},ct.apply(this,arguments)}const dt=(0,n.ph)((e=>{let{url:t,isGif:a,posterData:i,posterSize:o,loadProgress:l,fileSize:c,isMediaViewerOpen:d,noPlay:m,volume:u,isMuted:A,playbackRate:h,isForceMobileVersion:y,shouldCloseOnClick:p,isProtected:g,isClickDisabled:E,isPreviewDisabled:C,isSponsoredMessage:f,timestamp:S,handleSponsoredClick:k,onClose:N}=e;const{setMediaViewerVolume:I,setMediaViewerMuted:P,setMediaViewerPlaybackRate:T,setMediaViewerHidden:L}=(0,s.ko)(),R=(0,n.li)(null),[D,_]=(0,n.J0)(!b.TF||!b.pz),[U,O,J]=(0,be.Ay)(R,_),{isMobile:K}=(0,w.Ay)(),j=R.current?.duration||0,G=a||j<=30,z=(0,M.A)((()=>{b.Nd||L({isHidden:!0})})),H=(0,M.A)((()=>{b.Nd||L({isHidden:!1})})),[$,Y,Q]=function(e,t,a){const[s,i]=(0,n.J0)(!1),[o,l]=(0,n.J0)(!1);(0,n.Nf)((()=>{if(b.pz&&b._7||!e.current)return;const n=e.current,s=F(n);if((!document.pictureInPictureEnabled||e.current?.disablePictureInPicture)&&void 0===s)return;n.autoPictureInPicture=!0,i(!0);const r=()=>{t(),l(!0),x(!0)},o=()=>{x(!1),l(!1),a()};return n.addEventListener("enterpictureinpicture",r),n.addEventListener("leavepictureinpicture",o),()=>{n.removeEventListener("enterpictureinpicture",r),n.removeEventListener("leavepictureinpicture",o)}}),[e,t,a]);const c=(0,n.hb)((()=>{if(!e.current)return;const t=F(e.current);t?t("inline"):V()}),[e]),d=(0,n.hb)((()=>{if(!e.current)return;c();const t=e.current,a=(0,B.e)(t),n=F(t);n?n("picture-in-picture"):function(e){if(e.requestPictureInPicture)try{e.requestPictureInPicture()}catch(e){r.Oig&&console.log("[MV] PictureInPicture Error",e)}}(t),a&&(0,B.A)(t)}),[e,c]);return s?[s,d,o]:[!1]}(R,z,H),[,Z,X]=Ie(),ee=(0,M.A)((()=>{Z(!0)})),te=(0,M.A)((e=>{const t=R.current?.getBoundingClientRect();t&&(e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom)&&Z(!1)})),{isReady:ae,isBuffered:ne,bufferedRanges:se,bufferingHandlers:ie,bufferedProgress:re}=(0,Ve.A)(),oe=(0,Fe.A)(R,void 0,!t),{shouldRender:ce,transitionClassNames:de}=(0,De.A)(!ne&&!oe,void 0,void 0,"slow"),{shouldRender:me,transitionClassNames:Ae}=(0,De.A)(b.pz&&!D&&!ce&&!oe,void 0,void 0,"slow"),[,he]=Te(),[,ye]=Je();(0,n.vJ)((()=>{X(ce)}),[X,ce]),(0,n.vJ)((()=>{m||!d||oe?R.current.pause():t&&!b.TF&&(0,B.A)(R.current)}),[m,d,t,P,oe]),(0,n.vJ)((()=>{R.current.volume=u}),[u]),(0,n.vJ)((()=>{R.current.playbackRate=h}),[h]),(0,n.vJ)((()=>{S&&(R.current.currentTime=S,he(S))}),[he,S]);const pe=(0,M.A)((e=>{e.stopPropagation(),D?(R.current.pause(),_(!1)):((0,B.A)(R.current),_(!0))})),ve=(0,M.A)((e=>{f&&(k?.(!0),N(e)),E||(p?N(e):pe(e))}));(0,_e.A)(R,ie);const ge=(0,M.A)((e=>{const t=e.currentTarget;t.readyState>=4&&(ye(!1),he(t.currentTime)),G||t.currentTime!==t.duration||(he(0),_(!1))})),Ee=(0,M.A)((()=>{G||(he(0),_(!1),Z(!0))})),Ce=(0,M.A)((()=>{U&&J?J():!U&&O&&O()})),fe=(0,M.A)((e=>{R.current.currentTime=e})),Se=(0,M.A)((e=>{I({volume:e/100})})),ke=(0,M.A)((()=>{R.current.muted=!R.current.muted,P({isMuted:!A})})),we=(0,M.A)((e=>{T({playbackRate:e})}));(0,n.vJ)((()=>{if(!d)return;const e=e=>{if(!U)return;const t=R.current,a=(0,ue.qE)(t.currentTime+5*e,0,t.duration);Number.isFinite(a)&&(t.currentTime=a)},t=t=>{if(!Q)switch(t.key){case" ":case"Enter":t.preventDefault(),pe(t);break;case"Left":case"ArrowLeft":t.preventDefault(),e(-1);break;case"Right":case"ArrowRight":t.preventDefault(),e(1)}};return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)}}),[pe,d,U,Q]);const Ne=o&&`width: ${o.width}px; height: ${o.height}px`,Pe=`background-image: url(${i})`,Me=!b.TF&&!y;return n.Ay.createElement("div",{className:"VideoPlayer",onMouseMove:Me?ee:void 0,onMouseOut:Me?te:void 0},n.Ay.createElement("div",{style:Ne},g&&n.Ay.createElement("div",{onContextMenu:v.A,onDoubleClick:b.TF?void 0:Ce,onClick:K?void 0:pe,className:"protector"}),n.Ay.createElement("video",ct({ref:R,autoPlay:b.TF,controlsList:"nodownload",playsInline:!0,loop:G,muted:a||A,id:"media-viewer-video",style:Pe,onWaiting:()=>ye(!0),onPlay:()=>_(!0),onEnded:Ee,onClick:K||U?void 0:ve,onDoubleClick:b.TF?void 0:Ce},ie,{onPause:e=>{_(!1),ie.onPause(e)},onTimeUpdate:ge,src:t}))),me&&n.Ay.createElement(W.A,{round:!0,className:`play-button ${Ae}`,onClick:pe},n.Ay.createElement(q.A,{name:"play"})),ce&&n.Ay.createElement("div",{className:["spinner-container",de].join(" ")},!ne&&n.Ay.createElement("div",{className:"buffering"},"Buffering..."),n.Ay.createElement(le.A,{size:"xl",progress:ne?1:l,onClick:N})),!a&&!f&&!oe&&n.Ay.createElement(lt,{url:t,isPlaying:D,bufferedRanges:se,bufferedProgress:re,isBuffered:ne,isFullscreenSupported:Boolean(O),isPictureInPictureSupported:$,isFullscreen:U,isPreviewDisabled:C,fileSize:c,duration:j,isReady:ae,posterSize:o,isForceMobileVersion:y,onSeek:fe,onChangeFullscreen:Ce,onPictureInPictureChange:Y,onPlayPause:pe,volume:u,playbackRate:h,isMuted:A,onVolumeClick:ke,onVolumeChange:Se,onPlaybackRateChange:we}))})),mt=(0,n.ph)((0,s.EK)(((e,t)=>{let{item:a}=t;const{volume:n,isMuted:s,playbackRate:i,isHidden:r,origin:o,timestamp:l,threadId:d}=(0,c.nTw)(e).mediaViewer,m="message"===a.type?a.message:void 0,u="sponsoredMessage"===a.type?a.message:void 0,A=m||u,h=m&&(0,c.meW)(e,m,!0);return{origin:o,textMessage:A,isProtected:m&&(0,c.ynf)(e,m),volume:n,isMuted:s,isHidden:r,playbackRate:i,threadId:d,timestamp:l,maxTimestamp:h}}))((e=>{let{item:t,isActive:a,textMessage:i,origin:o,withAnimation:l,isProtected:c,volume:d,playbackRate:m,isMuted:u,isHidden:p,isMoving:g,threadId:E,timestamp:C,maxTimestamp:f,onClose:S,onFooterClick:k,handleSponsoredClick:N}=e;const{updateLastPlaybackTimestamp:I}=(0,s.ko)(),P=(0,T.A)(),B="avatar"===t.type,L="sponsoredMessage"===t.type,{media:R}=y(t)||{},{isVideo:x,isPhoto:F,bestImageData:V,bestData:D,dimensions:_,isGif:U,isLocal:O,isVideoAvatar:J,mediaSize:K,loadProgress:j}=$({media:R,isAvatar:B,origin:o,delay:!!l&&350}),[,G]=Ie(),[z]=Te(),H=Boolean(R),{isMobile:q}=(0,w.Ay)(),W=(0,M.A)((()=>{G(!0)})),Y=(0,Le.A)((()=>{if(!a||!i||"video"!==R?.mediaType)return;if(R.duration<r.u4b)return;const e="id"in i?i:void 0,t=z();if(!t||!e||e.isInAlbum)return;const n=R.duration-t>1?t:void 0;I({chatId:e.chatId,messageId:e.id,timestamp:n})}),[z,a,R,i],1e3);if((0,Be.R)(Y,[z]),!R)return;if("avatar"===t.type)return J?n.Ay.createElement("div",{key:R.id,className:"MediaViewerContent"},n.Ay.createElement(dt,{key:R.id,url:D,isGif:!0,posterData:V,posterSize:(0,A.sk)(_,!1,!0),loadProgress:j,fileSize:K,isMediaViewerOpen:H&&a,isProtected:c,isPreviewDisabled:!b.G9||O,noPlay:!a,onClose:S,isMuted:!0,shouldCloseOnClick:!0,volume:0,isClickDisabled:g,playbackRate:1,isSponsoredMessage:L,handleSponsoredClick:N})):n.Ay.createElement("div",{key:R.id,className:"MediaViewerContent"},ut(D,(0,A.sk)(_,!1),!q&&!c,c));const Q=i&&("suggestProfilePhoto"===i.content.action?.type?P("Conversation.SuggestedPhotoTitle"):(0,h.V)({message:i,maxTimestamp:f,threadId:E,forcePlayback:!0,isForMediaViewer:!0})),Z=i&&"buttonText"in i?i.buttonText:void 0,X=Boolean(Q),ee=(0,A.sk)(_,X,x),te=q||function(e){return!!e&&e.width<350}(ee);return n.Ay.createElement("div",{className:(0,de.A)("MediaViewerContent",X&&"has-footer"),onMouseMove:te&&!b.TF?W:void 0},F&&ut(D,ee,!q&&!c,c),x&&(a?n.Ay.createElement(dt,{key:R.id,url:D,isGif:U,posterData:V,posterSize:ee,loadProgress:j,fileSize:K,isMediaViewerOpen:H&&a,noPlay:!a,isPreviewDisabled:!b.G9||O,onClose:S,isMuted:u,isHidden:p,isForceMobileVersion:te,isProtected:c,volume:d,isClickDisabled:g,playbackRate:m,isSponsoredMessage:L,handleSponsoredClick:N,timestamp:C}):function(e,t,a,s){const i=t&&`width: ${t.width}px; height: ${t.height}px`,r=`background-image: url(${e})`;return e?n.Ay.createElement("div",{className:"VideoPlayer"},s&&n.Ay.createElement("div",{onContextMenu:v.A,className:"protector"}),n.Ay.createElement("div",{style:i},n.Ay.createElement("video",{style:r,className:(0,de.A)(s&&"is-protected"),draggable:Boolean(a)}))):n.Ay.createElement("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:""},n.Ay.createElement(Re.A,{color:"white"}))}(V,ee,!q&&!c,c)),Q&&n.Ay.createElement(xe,{text:Q,buttonText:Z,onClick:k,isProtected:c,isForceMobileVersion:te,isForVideo:x&&!U,handleSponsoredClick:N}))})));function ut(e,t,a,s){return e?n.Ay.createElement("div",{style:"position: relative;"},s&&n.Ay.createElement("div",{onContextMenu:v.A,className:"protector"}),n.Ay.createElement("img",{src:e,alt:"",className:(0,de.A)(s&&"is-protected"),style:t?`width: ${t.width}px`:"",draggable:Boolean(a)})):n.Ay.createElement("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:""},n.Ay.createElement(Re.A,{color:"white"}))}const{easeOutCubic:At,easeOutQuart:ht}=p.qM,yt=b.TF?40:0,pt=350;let vt,gt;var Et=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(Et||{});const bt=(0,n.ph)((e=>{let{item:t,isVideo:a,isGif:s,isOpen:i,withAnimation:r,isHidden:o,isLoadingMoreMedia:l,isSynced:c,loadMoreItemsIfNeeded:d,getNextItem:m,selectItem:u,onClose:A,onFooterClick:h,handleSponsoredClick:y}=e;const v=(0,n.li)(null),g=(0,n.li)(null),E=(0,n.li)(null),C=(0,n.li)(null),f=(0,n.li)({x:0,y:0,scale:1}),S=(0,n.li)(void 0),k=(0,n.li)(void 0),w=(0,n.li)(!1),[N,I]=(0,n.J0)(!0),[P]=se(),B=(0,n.li)(P()),L=(0,be.zk)(),[R,x]=(0,n.J0)(!1),[F,V]=(0,n.Ul)({x:0,y:0,scale:1}),D=Ee(F),[_,U]=(0,n.Ul)(t),O=Ee(_),J=(0,pe.A)((()=>1!==F().scale),[F]),K=(0,pe.A)(_),{height:j,width:G,isResizing:z}=(0,Ce.A)(),[H,$,q]=Ie(),W=(0,T.A)();(0,ve.A)({isActive:i,onBack:A,shouldBeReplaced:!0});const Y=(0,ye.A)(u,[u],350,!0),Q=(0,ye.A)((()=>{S.current=void 0}),[],500,!0),Z=(0,ye.A)((e=>I(e)),[],800,!0),X=Boolean(s&&!b.pz),ee=b.TF?40:G/10,te=(0,M.A)((e=>{if(!b.TF)return;const t=j-e.pageY<80;!t&&e.pageX<ee||!t&&e.pageX>G-ee||$(!H())}));(0,he.A)((()=>$(!0)),pt),(0,n.vJ)((()=>{const{scale:e,x:a,y:n}=D.current;0===a&&0===n&&1===e&&U(t)}),[t,U,D]),(0,n.vJ)((()=>{c&&K&&!l&&d(K)}),[K,d,c,l]),(0,n.Nf)((()=>{const{x:e,y:t,scale:a}=F();q(1!==a),E.current&&(E.current.style.transform=Ct(-G+e-yt)),g.current&&(g.current.style.transform=Ct(e,t,a)),C.current&&(C.current.style.transform=Ct(G+e+yt))}),[F,q,G]),(0,n.vJ)((()=>{if(!v.current||void 0===O.current||o||L)return;let e=f.current;const t={x:0,y:0},a={x:0,y:0},n={x:0,y:0};let s,i=Date.now();const l=(0,Ae.sg)((()=>{i=Date.now()}),500,!1,!0),c=t=>{const a=O.current;if(void 0===a)return!1;const n=m(a,t);if(void 0!==n){const a=(G+yt)*t,s=D.current.x+a;return I(!1),U(n),Y(n),Z(!0),e={x:0,y:0,scale:1},r?(vt=(0,p.Hd)({from:s,to:0,duration:pt,timing:At,onUpdate:e=>V({y:0,x:e,scale:1})}),!0):(V(e),!0)}return!1},d=e=>{const{scale:t}=D.current;if(1!==t)return[!1,!1];if(e.target.closest("div.VideoPlayerControls"))return[!1,!1];let a=0;return j-e.pageY<80?[!1,!1]:(e.pageX<ee?a=-1:e.pageX>G-ee&&(a=1),[0!==a,c(a)])},u=e=>{const{scale:t}=D.current;if(1===t)switch(e.key){case"Left":case"ArrowLeft":c(-1);break;case"Right":case"ArrowRight":c(1)}},h=function(e){let{x:t,y:a,scale:n}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=k.current;if(!i)return[{x:t,y:a,scale:n},!0,!0];let r=!0,o=!0;const l=(G-G*n)/2,c=(j-j*n)/2,d=Math.max(-i.left*n,l),m=G-i.right*n;r=(0,ue.Bt)(t,m,d),t=(0,ue.qE)(t,m,d);const u=Math.max(-i.top*n+s,c),A=j-i.bottom*n;return o=(0,ue.Bt)(a,A,u),a=(0,ue.qE)(a,A,u),[{x:t,y:a,scale:n},r,o]},y=s=>{if(w.current)return void(w.current=!1);"mouseup"===s.type&&x(!1);const r=D.current,{y:o,scale:l}=r;let c=r.x;const d=Math.abs(c),u=Math.abs(o);if(Q(),Z(!0),l<1)return e={x:0,y:0,scale:1},void(vt=(0,p.Hd)({from:[c,o,l],to:[0,0,1],duration:pt,timing:At,onUpdate:e=>V({x:e[0],y:e[1],scale:e[2]})}));if(l>1){const r=Math.min(l,4),d=r/l;let m=c*d+(a.x-d*a.x),u=o*d+(a.y-d*a.y);const A=.15;if("wheel"!==s.type&&e.scale===l){const e=Math.abs(t.x)/(Date.now()-i),a=Math.abs(t.y)/(Date.now()-i);m-=Math.abs(t.x)*e*A*n.x,u-=Math.abs(t.y)*a*A*n.y}return[e]=h({x:m,y:u,scale:r},60),void(vt=(0,p.Hd)({from:[c,o,l],to:[e.x,e.y,e.scale],duration:pt,timing:At,onUpdate:e=>V({x:e[0],y:e[1],scale:e[2]})}))}if(e={x:c,y:o,scale:l},u>=50)return void A();if(u>0)return void(vt=(0,p.Hd)({from:o,to:0,duration:pt,timing:At,onUpdate:e=>V({x:0,y:e,scale:l})}));const y=c<0?1:-1,v=O.current,g=v&&m(v,c<0?1:-1),E=n.x<0?-1:1;void 0!==g&&d>=50&&y===E&&(c+=(G+yt)*y,U(g),Y(g)),vt=(0,p.Hd)({from:c,to:0,duration:pt,timing:At,onUpdate:e=>V({y:0,x:e,scale:l??1})})},E=(0,me.wJ)(v.current,{isNotPassive:!0,withNativeDrag:!0,excludedClosestSelector:".MediaViewerFooter, .ZoomControls, .VideoPlayerControls",minZoom:1,maxZoom:4,doubleTapZoom:3,withWheelDrag:!0,onCapture:e=>{if(St(e))return;const{x:t,y:a,scale:n}=D.current;if("mousedown"!==e.type||(x(!0),1===n)){if(i=Date.now(),0===t&&0===a&&1===n){if(!g.current)return;if(s=g.current.querySelector("img, video"),!s)return;k.current=s.getBoundingClientRect()}}else e.preventDefault()},onDrag:(a,s,i,r)=>{let{dragOffsetX:o,dragOffsetY:c}=i;if(w.current||St(a))return;if(b.pz&&"touchstart"===s.type){const{pageX:e}=s.touches[0];if(e<=me.h6||e>=G-me.h6)return}vt&&(vt(),vt=void 0),n.x=t.x-o,n.y=t.y-c,t.x=o,t.y=c;const d=Math.abs(o),m=Math.abs(c),{x:u,y:A,scale:p}=D.current;if(l(),1===p){if("mousemove"!==a.type){if(S.current!==Et.Vertical&&(S.current===Et.Horizontal||Math.abs(u)>me.no||d/m>me.fG)){S.current=Et.Horizontal,I(!1);const e=G+yt,t=(0,ue.qE)(o,-e,e);return V({x:t,y:0,scale:p}),void("wheel"===a.type&&Math.abs(t)>100&&(y(a),w.current=!0))}if(S.current===Et.Vertical||Math.abs(A)>me.no||m/d>me.fG){S.current=Et.Vertical;const e=j,t=(0,ue.qE)(c,-e,e);V({x:0,y:t,scale:p}),"wheel"===a.type&&Math.abs(t)>100&&(y(a),w.current=!0)}}}else{const t=e.x+o,n=e.y+c;if(["wheel","mousemove"].includes(a.type)){const[e,a,s]=h({x:t,y:n,scale:p},60);return r&&r(!a,!s),void V(e)}"touches"in a&&1===a.touches.length&&V({x:t,y:n,scale:p})}},onZoom:(t,n)=>{let{zoom:s,zoomFactor:i,initialCenterX:r,initialCenterY:o,dragOffsetX:l,dragOffsetY:c,currentCenterX:d,currentCenterY:m}=n;vt&&vt(),r=r||G/2,o=o||j/2,d=d||G/2,m=m||j/2;const u=s??(0,ue.qE)(e.scale*i,.5,12),A=u/e.scale,y=Math.abs(Math.min(e.x,0)),p=Math.abs(Math.min(e.y,0));a.x=d,a.y=m;const v=y+r,g=p+o,E=v-A*v,b=g-A*g,[C]=h({x:e.x+E+l,y:e.y+b+c,scale:u});V(C)},onClick(t){x(!1);const[a,n]=d(t);if(a){if(t.preventDefault(),t.stopPropagation(),b.TF)return;n||A()}else 1!==e.scale||b.TF||!X&&ft(t.target,".VideoPlayer")||A()},onDoubleClick(t,a){let{centerX:n,centerY:s}=a;const[i]=d(t);if(i)return t.preventDefault(),void t.stopPropagation();if(!b.TF&&"wheel"!==t.type)return;const{x:r,y:o,scale:l}=D.current;if(1===l){if(0!==r||0!==o)return;e=h({x:n-3*n,y:s-3*s,scale:3})[0]}else e={x:0,y:0,scale:1};vt=(0,p.Hd)({from:[r,o,l],to:[e.x,e.y,e.scale],duration:pt,timing:At,onUpdate:e=>{const t={x:e[0],y:e[1],scale:e[2]};V(t)}})},onRelease:y});return document.addEventListener("keydown",u,!1),()=>{E(),document.removeEventListener("keydown",u,!1)}}),[O,Q,ee,m,L,o,A,Y,U,Z,V,X,D,j,G,r]),(0,n.vJ)((()=>{const e=P(),t=void 0!==B.current&&B.current!==e;if(!v.current||!t||o||L)return;B.current=e;const{scale:a}=D.current,n=e>0?-1:1;let s=100,i=0;a<=.6&&n>0||a>=12&&n<0||(1===a&&n>0&&(s=20),gt&&gt(),gt=(0,p.Hd)({from:n,to:n*s,duration:pt,timing:ht,onUpdate:e=>{if(!v.current)return;const t=(0,ue.LI)(e-i,2);i=e;const a=new WheelEvent("wheel",{deltaY:t,ctrlKey:!0});v.current.dispatchEvent(a)}}))}),[P,o,L,D]);const[ae,ne]=(0,n.Kr)((()=>void 0===K?[void 0,void 0]:[m(K,-1),m(K,1)]),[K,m]);if(void 0===K)return;const ie=void 0!==ae,re=void 0!==ne,oe=R&&J;return n.Ay.createElement("div",{className:"MediaViewerSlides",ref:v},n.Ay.createElement("div",{className:"MediaViewerSlide",ref:E},ie&&!J&&!z&&n.Ay.createElement(mt,{withAnimation:r,isMoving:oe,item:ae,onClose:A,onFooterClick:h,handleSponsoredClick:y})),n.Ay.createElement("div",{className:(0,de.A)("MediaViewerSlide","MediaViewerSlide--active",oe&&"MediaViewerSlide--moving"),onClick:te,ref:g},n.Ay.createElement(mt,{item:K,withAnimation:r,isActive:N,isMoving:oe,onClose:A,onFooterClick:h,handleSponsoredClick:y})),n.Ay.createElement("div",{className:"MediaViewerSlide",ref:C},re&&!J&&!z&&n.Ay.createElement(mt,{withAnimation:r,isMoving:oe,item:ne,onClose:A,onFooterClick:h,handleSponsoredClick:y})),ie&&!J&&!b.TF&&n.Ay.createElement("button",{type:"button",className:`navigation prev ${a&&!s&&"inline"}`,"aria-label":W("AccDescrPrevious"),dir:W.isRtl?"rtl":void 0}),re&&!J&&!b.TF&&n.Ay.createElement("button",{type:"button",className:`navigation next ${a&&!s&&"inline"}`,"aria-label":W("Next"),dir:W.isRtl?"rtl":void 0}))}));function Ct(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return`translate3d(${(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0).toFixed(3)}px, ${e.toFixed(3)}px, 0px) scale(${t.toFixed(3)})`}function ft(e,t){return!!e&&(!!e.matches(t)||Boolean(e.closest(t)))}function St(e){const t=e.target;return!!ft(t,".VideoPlayerControls")&&(ft(t,".play, .fullscreen, .volume, .volume-slider, .playback-rate, .playback-rate-menu, .SeekLine")||e.preventDefault(),!0)}var kt=a(4961),wt=a(21849);const Nt=(0,s.EK)(((e,t)=>{let{item:a}=t;const n="message"===a?.type?a.message:void 0,s=n&&(0,c.Y7C)(e,n);return{owner:"avatar"===a?.type?a.avatarOwner:s}}))((e=>{let{owner:t,item:a}=e;const{closeMediaViewer:i,focusMessage:r,toggleChatInfo:o}=(0,s.ko)(),{isMobile:c}=(0,w.Ay)(),d=(0,M.A)((()=>{if(i(),"message"!==a?.type)return;const e=a.message;c?setTimeout((()=>{o({force:!1},{forceSyncOnIOs:!0}),r({chatId:e.chatId,messageId:e.id})}),350):r({chatId:e.chatId,messageId:e.id})})),m=(0,T.A)(),u=(0,n.Kr)((()=>{if(!a||"standalone"===a.type)return;const e="avatar"===a.type?a.avatarOwner:void 0,t="avatar"===a.type?a.profilePhotos:void 0,n=t?.photos[a.mediaIndex],s=n?.id===t?.fallbackPhoto?.id,i=n?.id===t?.personalPhoto?.id,r="message"===a.type?a.message.date:n?.date;if(!r)return;const o=(0,Ke.fS)(m,1e3*r,!0),c=t?.count&&t.count+(t?.fallbackPhoto?1:0),d=a.mediaIndex+1+(t?.personalPhoto?-1:0),u=c&&m("Of",[d,c]),A=[];if(n){const t=(0,l.L8L)(e.id)?void 0:e,a=t&&(0,l.WXB)(t),n=t&&(0,l.YEQ)(t);A.push(m(i?"lng_mediaview_profile_photo_by_you":s?"lng_mediaview_profile_public_photo":a?"lng_mediaview_channel_photo":n?"lng_mediaview_group_photo":"lng_mediaview_profile_photo"))}return!u||i||s||A.push(u),A.push(o),A.join(" • ")}),[a,m]);if(!t)return;const A=(0,l.F9N)(m,t);return n.Ay.createElement("div",{className:"SenderInfo",onClick:d},n.Ay.createElement(wt.A,{key:t.id,size:"medium",peer:t}),n.Ay.createElement("div",{className:"meta"},n.Ay.createElement("div",{className:"title",dir:"auto"},A&&(0,kt.A)(A)),n.Ay.createElement("div",{className:"date",dir:"auto"},u)))})),It=250,Pt=(0,n.ph)((0,s.EK)((e=>{const{mediaViewer:t,shouldSkipHistoryAnimations:a}=(0,c.nTw)(e),{chatId:n,threadId:s,messageId:r,origin:o,isHidden:d,withDynamicLoading:m,standaloneMedia:u,mediaIndex:A,isAvatarView:h,isSponsoredMessage:y}=t,p=(0,c.xYJ)(e,"mediaViewerAnimations"),{currentUserId:v,isSynced:g}=e,E=Boolean(n)&&(0,c.nZ4)(e,n);if(h){const t=(0,c.PVB)(e,n);let s=!1;t&&(s=(0,l.L8L)(t.id)?t.id===v:(0,l.SJk)(t));const i=(0,c.IVq)(e,n);return{profilePhotos:i,avatar:i?.photos[A],avatarOwner:t,isLoadingMoreMedia:i?.isLoading,isChatWithSelf:E,canUpdateMedia:s,withAnimation:p,origin:o,shouldSkipHistoryAnimations:a,isHidden:d,standaloneMedia:u,mediaIndex:A,isSynced:g}}let b,C,f;n&&r&&(b=o&&[i.TQ.ScheduledAlbum,i.TQ.ScheduledInline].includes(o)?(0,c.Jl6)(e,n,r):(0,c.O5q)(e,n,r)),y&&n&&o===i.TQ.SponsoredMessage&&(C=(0,c.v8U)(e,n)),n&&(f=o&&[i.TQ.ScheduledAlbum,i.TQ.ScheduledInline].includes(o)?(0,c.yFI)(e,n):(0,c.zeq)(e,n));let S=!1;const k=o===i.TQ.Inline,w=o===i.TQ.Album;let N;if(n&&s&&r)if(m&&(k||w)){const t=(0,c.CuV)(e);S=Boolean(t?.isLoading);const{foundIds:a}=t?.currentSegment||{};N=a}else if(o===i.TQ.SharedMedia){const t=(0,c.BU_)(e),{foundIds:a}=t&&t.resultsByType&&t.resultsByType.media||{};N=a}else(k||w)&&(N=(0,c.Lzh)(e,n,s,r)||(0,c.gCU)(e,n,s));return{chatId:n,threadId:s,messageId:r,isChatWithSelf:E,origin:o,message:b,chatMessages:f,sponsoredMessage:C,collectedMessageIds:N,withAnimation:p,isHidden:d,shouldSkipHistoryAnimations:a,withDynamicLoading:m,standaloneMedia:u,mediaIndex:A,isLoadingMoreMedia:S,isSynced:g}}))((e=>{let{chatId:t,threadId:a,messageId:c,message:v,collectedMessageIds:B,isChatWithSelf:L,canUpdateMedia:x,origin:F,avatar:U,avatarOwner:O,profilePhotos:J,chatMessages:K,sponsoredMessage:j,standaloneMedia:G,mediaIndex:z,withAnimation:H,isHidden:Y,shouldSkipHistoryAnimations:Q,withDynamicLoading:Z,isLoadingMoreMedia:ae,isSynced:ne}=e;const{openMediaViewer:se,closeMediaViewer:ie,openForwardMenu:re,focusMessage:oe,toggleChatInfo:le,searchChatMediaMessages:de,loadMoreProfilePhotos:me,clickSponsoredMessage:ue,openUrl:Ae}=(0,s.ko)(),he=Boolean(O||v||G||j),{isMobile:ye}=(0,w.Ay)(),pe=(0,n.li)(),ve=v?.senderId||O?.id||v?.chatId,ge=(0,D.A)(ve),Ee=H?"slideFade":"none",be=Boolean(H&&!Q),[Ce,fe,Se]=(0,I.A)(),ke=function(e){let{message:t,avatarOwner:a,profilePhotos:n,standaloneMedia:s,mediaIndex:i,sponsoredMessage:r}=e;return a&&n?{type:"avatar",avatarOwner:a,profilePhotos:n,mediaIndex:i}:s?{type:"standalone",media:s,mediaIndex:i}:t?{type:"message",message:t,mediaIndex:i}:r?{type:"sponsoredMessage",message:r,mediaIndex:i}:void 0}({message:v,avatarOwner:O,standaloneMedia:G,profilePhotos:J,mediaIndex:z,sponsoredMessage:j}),{media:we,isSingle:Ne}=y(ke)||{},{isVideo:Ie,isPhoto:Pe,bestImageData:Me,bestData:Te,dimensions:Be,isGif:Le,isFromSharedMedia:Re}=$({media:we,isAvatar:Boolean(O),origin:F,delay:be&&It}),xe=(()=>{if(L)return!1;if("avatar"!==ke?.type||!O)return!1;const e=ke.profilePhotos;return we!==e.personalPhoto})(),Fe=!Y&&he,Ve=(0,n.Kr)((()=>Z?B:(0,l.Wm9)(K||{},B||[],Re)),[K,B,Re,Z]);!he||ge&&ge===ve&&void 0!==pe.current||(pe.current=Ne?0:c||z);const[De]=R;(0,n.vJ)((()=>{if(!he||De())return;(0,u.FD)();const e=(0,_.w4)();return()=>{e(),(0,u.wb)()}}),[he,De]),(0,n.vJ)((()=>{Fe&&V()}),[Fe]),(0,n.vJ)((()=>{ye&&(0,o.RK)((()=>{document.body.classList.toggle("is-media-viewer-open",he)}))}),[ye,he]);const _e=(0,n.li)(null);(0,N.A)(_e);const Ue=(0,P.A)();(0,n.vJ)((()=>{const e=window.matchMedia(A.wy);return e.addEventListener("change",Ue),()=>{e.removeEventListener("change",Ue)}}),[Ue]);const Oe=(0,D.A)(v),Je=(0,D.A)(Y),Ke=(0,D.A)(F),je=(0,D.A)(ke),Ge=(0,D.A)(Me),ze=v?(0,h.V)({message:v,forcePlayback:!0,isForMediaViewer:!0}):void 0,He=Boolean(ze),$e=Je&&je!==ke;(0,n.vJ)((()=>{be&&he&&($e||!je)&&((0,n.VK)(It+r.xB5),function(e,t,a,n,s,l,c){const{mediaEl:d}=S(t,l,c);if(!d)return;const{width:m}=C.A.get(),{width:u,height:h}=(0,A.$w)(e,s),{width:y,height:v}=(0,A.ky)(u,h,n.width,n.height),g=(m-y)/2,E=function(e){const t=window.matchMedia(A.wy);let a=4.125;return e&&!b.TF&&(a+=t.matches?.875:2.125),a*A.$}(e)+(h-v)/2;let{top:w,left:N,width:I,height:P}=d.getBoundingClientRect();if([i.TQ.SharedMedia,i.TQ.Album,i.TQ.ScheduledAlbum,i.TQ.SearchResult].includes(t)){const e=function(e,t,a,n,s,i){if(e===t){const r=Math.max(s,i)*(e/t);n-=(r-s)/2,a-=(r-i)/2,s=r,i=r}else if(e>t){const a=s;n-=((s=i*(e/t))-a)/2}else if(t>e){const n=i;a-=((i=s*(t/e))-n)/2}return{top:a,left:n,width:s,height:i}}(y,v,w,N,I,P);w=e.top,N=e.left,I=e.width,P=e.height}const M=N+I/2-(g+y/2),T=w+P/2-(E+v/2),B=I/y,L=P/v;(0,o.RK)((()=>{const e=f(a||d);(0,p.ZM)(e,{top:`${E}px`,left:`${g}px`,width:`${y}px`,height:`${v}px`,transform:`translate3d(${M}px, ${T}px, 0) scale(${B}, ${L})`}),k(e,t),document.body.appendChild(e),document.body.classList.add("ghost-animating"),(0,o.RK)((()=>{e.style.transform="",function(e){e.firstChild.style.objectFit="default",e.classList.remove("rounded-corners","circle")}(e),setTimeout((()=>{(0,o.RK)((()=>{document.body.contains(e)&&document.body.removeChild(e),document.body.classList.remove("ghost-animating")}))}),200+r.xB5)}))}))}(He,F,Me,Be,Ie,v,z)),be&&!he&&je&&((0,n.VK)(It+r.xB5),function(e,t,a,n){const{container:s,mediaEl:l}=S(e,a,n);if(!l)return;const c=document.getElementById("MediaViewer").querySelector(".MediaViewerSlide--active img, .MediaViewerSlide--active video");if(!c)return;const{top:d,left:m,width:u,height:A}=c.getBoundingClientRect(),{top:h,left:y,width:v,height:b}=l.getBoundingClientRect();let w=h;if(!(0,E.Y)(s)){const{height:e}=C.A.get();w=h<d?-b:e}const N=m+u/2-(y+v/2),I=d+A/2-(w+b/2);let P=u/v,M=A/b;const T=[i.TQ.Inline,i.TQ.ScheduledInline,i.TQ.Album,i.TQ.ScheduledAlbum].includes(e)&&!function(e){const t=document.querySelector(".Transition_slide-active > .MessageList"),{top:a}=(0,g.A)(e,t);return a>t.scrollTop&&a+e.offsetHeight<t.scrollTop+t.offsetHeight}(l);[i.TQ.SharedMedia,i.TQ.Album,i.TQ.ScheduledAlbum,i.TQ.SearchResult].includes(e)&&(P>M?P=M:M>P&&(M=P));const B=document.getElementsByClassName("ghost")[0],L=B||f(t||l,e);let R;if(B){const{top:e,left:t,width:a,height:n}=B.getBoundingClientRect();R={transition:"none",top:`${w}px`,left:`${y}px`,transformOrigin:"top left",transform:`translate3d(${t-y}px, ${e-w}px, 0) scale(${a/v}, ${n/b})`,width:`${v}px`,height:`${b}px`}}else R={top:`${w}px`,left:`${y}px`,width:`${v}px`,height:`${b}px`,transform:`translate3d(${N}px, ${I}px, 0) scale(${P}, ${M})`};(0,o.RK)((()=>{(0,p.ZM)(L,R),B||document.body.appendChild(L),document.body.classList.add("ghost-animating"),(0,o.RK)((()=>{B&&(B.style.transition=""),L.style.transform="",T&&(L.style.opacity="0"),k(L,e),setTimeout((()=>{(0,o.RK)((()=>{document.body.contains(L)&&document.body.removeChild(L),document.body.classList.remove("ghost-animating")}))}),200+r.xB5)}))}))}(Ke,Ge,Oe,je?.mediaIndex))}),[Me,Be,He,be,he,Ie,v,F,Ge,je,Oe,Ke,$e,z]);const qe=(0,M.A)((()=>ie())),We=(0,M.A)((e=>{e.target instanceof HTMLElement&&e.target.closest("a")||(qe(),t&&c&&(ye?setTimeout((()=>{le({force:!1},{forceSyncOnIOs:!0}),oe({chatId:t,threadId:a,messageId:c})}),It):oe({chatId:t,threadId:a,messageId:c})))})),Ye=(0,M.A)((e=>{j&&t&&(ue({isMedia:e,isFullscreen:!0,peerId:t}),Ae({url:j.url}),ie())})),Qe=(0,M.A)((()=>{re({fromChatId:t,messageIds:[c]})}));(0,n.vJ)((()=>he?(0,m.A)((()=>{qe()})):void 0),[qe,he]),(0,n.vJ)((()=>{Ie&&!Le&&(0,d._K)()}),[Le,Ie]);const Ze=(0,M.A)((e=>{if(e&&!ae){if("avatar"===e.type){if(!(e.mediaIndex>=e.profilePhotos.photos.length-4))return;me({peerId:e.avatarOwner.id})}"message"===e.type&&Z&&de({chatId:t,threadId:a,currentMediaMessageId:e.message.id})}})),Xe=(0,M.A)(((e,t)=>{if(0===t||Ne)return;if("standalone"===e.type){const{media:a,mediaIndex:n}=e,s=n+t;return s>=0&&s<a.length?{type:"standalone",media:a,mediaIndex:s}:void 0}if("avatar"===e.type){const{avatarOwner:a,profilePhotos:n,mediaIndex:s}=e,i=s+t;return i>=0&&n&&i<n.photos.length?{type:"avatar",avatarOwner:a,profilePhotos:n,mediaIndex:i}:void 0}if("sponsoredMessage"===e.type){const{message:a,mediaIndex:n}=e,s=n+t;return s>=0&&a?{type:"sponsoredMessage",message:a,mediaIndex:s}:void 0}const{message:a,mediaIndex:n}=e,s=(0,l.qGu)(a);if(s){const e=n+t;if(e>=0&&e<s.extendedMedia.length)return{type:"message",message:a,mediaIndex:e}}const i=Ve?.indexOf(a.id);if(void 0===i)return;const r=Ve[i+t],o=K?.[r];return o?{type:"message",message:o}:void 0})),et=(0,M.A)((e=>{if(!e)return void qe();const t="avatar"===e.type?e.avatarOwner.id:"message"===e.type?e.message.chatId:void 0,a="message"===e.type?e.message.id:void 0,n="standalone"===e.type?e.media:void 0;se({origin:F,chatId:t,messageId:a,standaloneMedia:n,mediaIndex:e.mediaIndex,isAvatarView:"avatar"===e.type,withDynamicLoading:Z},{forceOnHeavyAnimation:!0})})),tt=(0,M.A)((()=>{if((J?.photos.length||G?.length||Ve?.length||0)<=1||!ke)return void qe();const e=Xe(ke,-1);e?et(e):"avatar"===ke.type&&(0,l.L8L)(ke.avatarOwner.id)||"standalone"===ke.type||qe()})),at=(0,T.A)();return n.Ay.createElement(ee.A,{id:"MediaViewer",isOpen:he,isHidden:Y,shouldAnimateFirstRender:!0,noCloseTransition:Q},n.Ay.createElement("div",{className:"media-viewer-head",dir:at.isRtl?"rtl":void 0,ref:_e},ye&&n.Ay.createElement(W.A,{className:"media-viewer-close",round:!0,size:"smaller",color:"translucent-white",ariaLabel:at("Close"),onClick:qe},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement(te.Ay,{activeKey:pe.current,name:Ee},n.Ay.createElement(Nt,{key:we?.id,item:ke})),n.Ay.createElement(ce,{mediaData:Te,isVideo:Ie,item:ke,canUpdateMedia:x,canReportAvatar:xe,onBeforeDelete:tt,onReportAvatar:fe,onCloseMediaViewer:qe,onForward:Qe}),n.Ay.createElement(X,{isOpen:Ce,onClose:Se,photo:U,peerId:O?.id})),n.Ay.createElement(bt,{item:ke,loadMoreItemsIfNeeded:Ze,isLoadingMoreMedia:ae,isSynced:ne,getNextItem:Xe,chatId:t,isPhoto:Pe,isGif:Le,threadId:a,avatarOwnerId:O?.id,origin:F,isOpen:he,hasFooter:He,isVideo:Ie,withAnimation:H,onClose:qe,selectItem:et,isHidden:Y,onFooterClick:We,handleSponsoredClick:Ye}))})));var Mt=a(2429);const Tt="bu_hGbaa",Bt="W9A8SEMl",Lt="OFh6u50Q",Rt="Jd1DYS6Y",xt="xe67dhtF",Ft="Mye8Dwxa",Vt="gLHHo5k8",Dt="GJVwqV9e",_t="_Yn4SWUB",Ut="hGCH03qc",Ot="ZecqXqKy",Jt="e7HHuS1g",Kt="FXineBYO",jt="RKedwa0I",Gt="sHNAfxzf",zt="PVZ8TOWS",Ht="lQfkulvp",$t="Wi0DXPH2",qt="Ka1CGfzq",Wt="urTtSsk9",Yt="AjXOHOgE",Qt="Sef28wEh",Zt="uAlXNXJN",Xt="g8ypsnnC",ea="YiuvOPgT",ta="jGDd2sza",aa="eMYhXF_X",na="PXnfXZur",sa="WpyVfrsc",ia="jmKI_lhC",ra="H1uod43o",oa="zimpR8Hz",la="hGTnZuar",ca="WlLsjJ2Z",da="GrsJNw3y",ma="prxptFFf",ua="_MVsZpgB",Aa="TkphaPyQ",ha="K0_xAdzf",ya="D_5mWNmi",pa="ilyTRZtw",va="hmFA5qb1",ga="e1gyTmKe",Ea="HIMnUViv",ba="CvnxnCxN",Ca="Vq8pl_kQ",fa="bM5rlQtM",Sa="nZ30pf4g",ka="SXpRZiax",wa="twOBFwUE",Na="MnNC7VHS",Ia="fME2l_yv",Pa="TYicp2_K",Ma="HjoURJRK",Ta="JJFtefb9",Ba="BsqMBS2I",La="G8OgmMDJ",Ra="_M8CgT7s",xa="nJr8QgYX",Fa=3.5*A.$,Va=.5*A.$;function Da(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=document.createElement("div");n.classList.add(a?Pa:Ia);const s=new Image;if(s.draggable=!1,s.oncontextmenu=v.A,s.classList.add(Ma),t){const t=document.createElement("canvas");t.classList.add(Na),s.onload=()=>{const e=t.getContext("2d",{alpha:!1}),{width:a,height:n}=s;(0,o.RK)((()=>{t.width=a,t.height=n,b.QH&&(e.filter="blur(2px)"),e.drawImage(s,-4,-4,a+8,n+8),b.QH||(0,O.A)(e,0,0,a,n,2,2)}))},s.src=e,n.appendChild(t)}else s.src=e,n.appendChild(s);return n}function _a(e,t){let a;const n=`#${(0,l.kRw)(t)}`;switch(e){case i.G9.StoryRibbon:a=`#LeftColumn .${Mt.A.root}`;break;case i.G9.MiddleHeaderAvatar:a=".MiddleHeader .Transition_slide-active .ChatInfo";break;case i.G9.ChatList:a="#LeftColumn .chat-list";break;case i.G9.SearchResult:a="#LeftColumn .LeftSearch--container"}const s=document.querySelector(a),r=s&&s.querySelectorAll(`${n} img`);return{container:s,mediaEl:r?.[0]}}const Ua=1200,Oa=800,Ja=405,Ka=720,ja=135,Ga=240;function za(e){let{scale:t,slideAmount:a,isActiveSlideSize:n,isMoveThroughActiveSlide:s,isBackward:i}=e;const r=40+(n?Ja:ja),o=(Math.abs(a)-1)*((s?Ja:ja)+40),l=(0,ue.Ki)((r+o)*t);return i?-l:l}function Ha(){const{width:e,height:t}=(0,Ce.A)();return(0,n.Kr)((()=>function(e,t){const a=function(e,t,a,n){const s=a/e,i=n/t;return Math.min(s,i)}(Ua,Oa,e,t),n=(0,ue.Ki)(Ja*a),s=(0,ue.Ki)(ja*a);return{activeSlide:{width:n,height:(0,ue.Ki)(Ka*a)},slide:{width:s,height:(0,ue.Ki)(Ga*a)},scale:a,toActiveScale:n/s,fromActiveScale:s/n}}(e,t)),[e,t])}function $a(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e&&"content"in e,s=e&&"isDeleted"in e,i=!!n&&(0,l.XR0)(e),r=n&&Boolean(e.forwardInfo);let o;n&&(e.content.photo?.thumbnail&&(o=e.content.photo.thumbnail.dataUri),e.content.video?.thumbnail?.dataUri&&(o=e.content.video.thumbnail.dataUri));const c=n?(0,l.EN7)(e):void 0,d=(0,G.A)(c),m=Boolean(n&&e.content.video),u=n&&e.content.video?.noSound,A=n?(0,l.EN7)(e,"full"):void 0,h=(0,G.A)(A,!e,m?U.qZ.Progressive:U.qZ.BlobUrl),y=m&&n?(0,l.EN7)(e,"full",!0):void 0,p=(0,G.A)(y,!e,U.qZ.Progressive),v=Boolean(h||p),g=m?d:h||d,E=!d&&!v,b=t&&n&&!e.noForwards,C=n?(0,l.EN7)(e,"download"):void 0;return{isLoadedStory:n,isDeletedStory:s,hasText:i,hasForwardInfo:r,thumbnail:o,previewHash:c,previewBlobUrl:d,isVideo:m,noSound:u,fullMediaHash:A,fullMediaData:h,altMediaHash:y,altMediaData:p,hasFullData:v,bestImageData:g,hasThumb:E,canDownload:b,downloadMediaData:(0,G.A)(C,!b&&!a)}}var qa=a(80140),Wa=a(22720),Ya=a(61361);const Qa="RGD70uBt",Za="HCYfPccW",Xa="L8oRQyKb",en=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.nTw)(e);return{isOpen:t.storyViewer?.isStealthModalOpen,stealthMode:e.stories.stealthMode,isCurrentUserPremium:(0,c.g29)(e)}}))((e=>{let{isOpen:t,stealthMode:a,isCurrentUserPremium:i}=e;const{toggleStealthModal:r,activateStealthMode:o,showNotification:l,openPremiumModal:c}=(0,s.ko)(),[d,m]=(0,n.J0)(!1);(0,n.vJ)((()=>{if(!a)return;const e=(0,qa.Fm)();a.cooldownUntil&&a.cooldownUntil>e&&m(!0)}),[a,t]);const u=(0,T.A)(),A=(0,M.A)((()=>{m(!1)})),h=(0,M.A)((()=>{r({isOpen:!1})})),y=(0,M.A)((()=>{i?(o(),l({title:u("StealthModeOn"),message:u("StealthModeOnHint")}),r({isOpen:!1})):c({initialSection:"stories"})}));return n.Ay.createElement(Q.A,{className:"component-theme-dark",contentClassName:"GrE47IXS",isOpen:t,isSlim:!0,onClose:h},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",className:"NlWSF1pA",ariaLabel:u("Close"),onClick:h},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("div",{className:"qKi5jsGM"},n.Ay.createElement(q.A,{name:"eye-closed-outline"})),n.Ay.createElement("div",{className:"BFctFGoT"},u("StealthMode")),n.Ay.createElement("div",{className:"fZIJH4IG"},u(i?"StealthModeHint":"StealthModePremiumHint")),n.Ay.createElement(Wa.A,{className:(0,de.A)(Qa,"smaller-icon"),multiline:!0,inactive:!0,leftElement:n.Ay.createElement(q.A,{name:"stealth-past",className:Za})},n.Ay.createElement("span",{className:"title"},u("HideRecentViews")),n.Ay.createElement("span",{className:(0,de.A)("subtitle",Xa)},u("HideRecentViewsDescription"))),n.Ay.createElement(Wa.A,{className:(0,de.A)(Qa,"smaller-icon"),multiline:!0,inactive:!0,leftElement:n.Ay.createElement(q.A,{name:"stealth-future",className:Za,"aria-hidden":!0})},n.Ay.createElement("span",{className:"title"},u("HideNextViews")),n.Ay.createElement("span",{className:(0,de.A)("subtitle",Xa)},u("HideNextViewsDescription"))),n.Ay.createElement(W.A,{className:"AM_sxoXP",size:"smaller",disabled:d,isShiny:!i,withPremiumGradient:!i,onClick:y},i?d?n.Ay.createElement(Ya.A,{langKey:"AvailableIn",endsAt:a.cooldownUntil,onEnd:A}):u("EnableStealthMode"):u("UnlockStealthMode")))})));var tn=a(94189);const an=(0,n.ph)((function(e){let{isOpen:t,story:a,onClose:i}=e;const{deleteStory:r,openNextStory:o}=(0,s.ko)(),l=(0,T.A)(),c=(0,n.hb)((()=>{a&&(o(),r({peerId:a.peerId,storyId:a.id}),i())}),[i,a]);return n.Ay.createElement(tn.A,{isOpen:t,onClose:i,title:l("DeleteStoryTitle"),text:l("DeleteStorySubtitle"),confirmLabel:l("Delete"),confirmHandler:c,confirmIsDestructive:!0,className:"component-theme-dark"})}));var nn=a(21309),sn=a(63152),rn=a(70636),on=a(87894),ln=a(79824),cn=a(54960);const dn=(0,n.ph)((function(e){let{id:t,contactListIds:a,currentUserId:s,selectedIds:i,lockedIds:r,onSelect:o}=e;const l=(0,T.A)(),[c,d]=(0,n.J0)(""),m=(0,n.Kr)((()=>{const e=(a||[]).filter((e=>e!==s));return(0,on.Am)((0,rn.PU)({ids:[...i||[],...e],query:c,type:"user"}))}),[a,s,c,i]);return n.Ay.createElement(cn.A,{key:t,itemIds:m,selectedIds:i??ln.p,lockedSelectedIds:r,filterValue:c,filterPlaceholder:l("Search"),searchInputId:`${t}-picker-search`,isSearchable:!0,withDefaultPadding:!0,forceShowSelf:!0,onSelectedIdsChange:o,onFilterChange:d,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})}));var mn=a(82117),un=a(12933);const An=(0,n.ph)((function(e){let{isActive:t,contactListIds:a,usersById:i,currentUserId:r,onClose:o}=e;const{saveCloseFriends:l}=(0,s.ko)(),c=(0,T.A)(),[d,m]=(0,n.J0)(""),[u,A]=(0,n.J0)(!1),[h,y]=(0,n.J0)([]),p=(0,n.Kr)((()=>(a||[]).filter((e=>i[e]?.isCloseFriend))),[a,i]),v=(0,n.Kr)((()=>{const e=(a||[]).filter((e=>e!==r));return(0,on.Am)((0,rn.PU)({ids:[...p,...e],query:d,type:"user"}))}),[p,a,r,d]);(0,mn.A)((e=>{let[a]=e;!a&&t&&(A(!1),y(p))}),[t,p]);const g=(0,n.hb)((e=>{y(e),A(!0)}),[]),E=(0,M.A)((()=>{l({userIds:h}),o()}));return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(cn.A,{itemIds:v||[],selectedIds:h,filterValue:d,filterPlaceholder:c("Search"),searchInputId:"close-friends-picker-search",isSearchable:!0,withDefaultPadding:!0,onSelectedIdsChange:g,onFilterChange:m,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),n.Ay.createElement("div",{className:(0,de.A)("BDK_pgpt",u&&"N8ujSwlC")},n.Ay.createElement(un.A,{isShown:u,onClick:E,ariaLabel:c("Save")},n.Ay.createElement(q.A,{name:"check"}))))})),hn={modal:"hz7SomkK",header:"NV6Rt2g9",closeButton:"SN1GFS6L",headerTitle:"gi0Y6Ns6",content:"sTaVDkiD",section:"eUiuPoEC",title:"iPPiw9DI",list:"OUP1Ss0W",option:"JL33Sa3b",checked:"qVPo_cVL",input:"zsDaUk0i",icon:"AfYCVlys",action:"njMeBBwY",optionContent:"TUAAnG2w",footer:"r24Qz2bf",info:"ljeRVBOm",submit:"RwNLN_rH"},yn=[{name:"StoryPrivacyOptionEveryone",value:"everybody",color:["#50ABFF","#007AFF"],icon:"channel-filled",actions:"blockUserIds"},{name:"StoryPrivacyOptionContacts",value:"contacts",color:["#C36EFF","#8B60FA"],icon:"user-filled",actions:"blockContactUserIds"},{name:"StoryPrivacyOptionCloseFriends",value:"closeFriends",color:["#88D93A","#30B73B"],icon:"favorite-filled",actions:"closeFriends"},{name:"StoryPrivacyOptionSelectedContacts",value:"nobody",color:["#FFB743","#F69A36"],icon:"group-filled",actions:"allowUserIds"}];var pn=function(e){return e[e.privacy=0]="privacy",e[e.allowList=1]="allowList",e[e.closeFriends=2]="closeFriends",e[e.denyList=3]="denyList",e}(pn||{});const vn=(0,n.ph)((0,s.EK)((e=>{const{storyViewer:{storyId:t,peerId:a}}=(0,c.nTw)(e),n=a&&t?(0,c.Msb)(e,a,t):void 0;return{story:n&&"content"in n?n:void 0,visibility:n&&"visibility"in n?n.visibility:void 0,contactListIds:e.contactList?.userIds,usersById:e.users.byId,currentUserId:e.currentUserId}}))((function(e){let{isOpen:t,story:a,visibility:i,contactListIds:r,usersById:o,currentUserId:c,onClose:d}=e;const{editStoryPrivacy:m,toggleStoryInProfile:u}=(0,s.ko)(),A=(0,T.A)(),[h,y,p]=(0,I.A)(!1),[g,E]=(0,n.J0)(i),[b,C]=(0,n.J0)(a?.isInProfile),[f,S]=(0,n.J0)(pn.privacy),[k,w]=(0,n.J0)("everybody"),N=f!==pn.privacy,P=(0,n.Kr)((()=>(r||[]).filter((e=>o[e]?.isCloseFriend))),[r,o]),B=(0,n.Kr)((()=>{if(f===pn.allowList&&(!g?.allowUserIds?.length||g.allowUserIds[0]===c))return[c]}),[f,c,g?.allowUserIds]),L=(0,n.Kr)((()=>k!==g?.visibility?[]:g?.blockUserIds||[]),[k,g?.blockUserIds,g?.visibility]),R=(0,M.A)((e=>{E({...g,allowUserIds:e?.length?e?.filter((e=>e!==c)):[c]})})),x=(0,M.A)((e=>{E({...g,blockUserIds:e,visibility:k})}));(0,n.vJ)((()=>{t&&(S(pn.privacy),y())}),[t]),(0,n.vJ)((()=>{E(i)}),[i]);const F=(0,M.A)((()=>{f!==pn.privacy?S(pn.privacy):p()})),V=(0,M.A)((()=>{C(!b)})),D=(0,M.A)((()=>{m({peerId:a.peerId,storyId:a.id,privacy:g}),a.isInProfile!==b&&u({peerId:a.peerId,storyId:a.id,isInProfile:b}),p()}));function _(e){switch(f){case pn.privacy:return function(){const e=a?(0,nn.qZ)(a.expireDate-a.date):0;return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:hn.section},n.Ay.createElement("h3",{className:hn.title},A("StoryPrivacyAlertSubtitleProfile")),n.Ay.createElement("div",{className:hn.list},yn.map((e=>{return n.Ay.createElement("label",{key:e.value,className:(0,de.A)(hn.option,e.value===g?.visibility&&hn.checked)},n.Ay.createElement("input",{type:"radio",name:"story_privacy",className:hn.input,value:e.value,checked:e.value===g?.visibility,onChange:()=>{return t=e.value,void E({...g,visibility:t});var t},teactExperimentControlled:!0}),n.Ay.createElement("span",{className:hn.icon,style:`--color-from: ${e.color[0]}; --color-to: ${e.color[1]}`},n.Ay.createElement(q.A,{name:e.icon})),n.Ay.createElement("div",{className:hn.optionContent},n.Ay.createElement("span",{className:(0,de.A)(hn.option_name)},A(e.name)),e.actions&&n.Ay.createElement("div",{tabIndex:0,role:"button",className:hn.action,"aria-label":A("Edit"),onClick:t=>{!function(e,t){switch((0,v.A)(e),t){case"closeFriends":S(pn.closeFriends);break;case"allowUserIds":S(pn.allowList);break;case"blockUserIds":S(pn.denyList),w("everybody");break;case"blockContactUserIds":S(pn.denyList),w("contacts")}}(t,e.actions)}},n.Ay.createElement("span",{className:hn.actionInner},"closeFriends"===(t=e.actions)?0===P.length?A("StoryPrivacyOptionCloseFriendsDetail"):1===P.length?(0,l.F9N)(A,o[P[0]]):A("StoryPrivacyOptionPeople",P.length,"i"):"blockUserIds"===t&&"everybody"===g?.visibility||"blockContactUserIds"===t&&"contacts"===g?.visibility?g?.blockUserIds?.length?1===g.blockUserIds.length?A("StoryPrivacyOptionExcludePerson",(0,l.YgS)(o[g.blockUserIds[0]])):A("StoryPrivacyOptionExcludePeople",g.blockUserIds.length,"i"):A("StoryPrivacyOptionContactsDetail"):g?.allowUserIds&&0!==g.allowUserIds.length?1===g.allowUserIds.length?(0,l.YgS)(o[g.allowUserIds[0]]):A("StoryPrivacyOptionPeople",g.allowUserIds.length,"i"):A("StoryPrivacyOptionSelectedContactsDetail")),n.Ay.createElement(q.A,{name:"next"}))));var t})))),n.Ay.createElement("div",{className:hn.section},n.Ay.createElement(Wa.A,{ripple:!0,onClick:V},n.Ay.createElement("span",null,A("StoryKeep")),n.Ay.createElement(sn.A,{id:"group-notifications",label:A("StoryKeep"),checked:b,inactive:!0}))),n.Ay.createElement("div",{className:hn.footer},n.Ay.createElement("div",{className:hn.info},A("StoryKeepInfo",e)),n.Ay.createElement("div",{className:hn.submit},n.Ay.createElement(W.A,{onClick:D},A("StoryPrivacyButtonSave")))))}();case pn.closeFriends:return n.Ay.createElement(An,{key:"close-friends",isActive:e,contactListIds:r,currentUserId:c,usersById:o,onClose:F});case pn.denyList:return n.Ay.createElement(dn,{key:"deny-list",id:"deny-list",contactListIds:r,currentUserId:c,selectedIds:L,onSelect:x});case pn.allowList:return n.Ay.createElement(dn,{key:"allow-list",id:"allow-list",contactListIds:r,lockedIds:B,currentUserId:c,selectedIds:g?.allowUserIds,onSelect:R})}}return n.Ay.createElement(Q.A,{isOpen:h,className:(0,de.A)(hn.modal,"component-theme-dark"),onClose:p,noBackdrop:!0,onCloseAnimationEnd:d},n.Ay.createElement("div",{className:hn.header},n.Ay.createElement(W.A,{className:(0,de.A)(hn.closeButton,"close-button"),round:!0,color:"translucent",size:"smaller",onClick:F,ariaLabel:A(N?"Common.Back":"Common.Close")},n.Ay.createElement("div",{className:(0,de.A)("animated-close-icon",N&&"state-back")})),n.Ay.createElement(te.Ay,{name:"slideFade",activeKey:f},function(){switch(f){case pn.privacy:return n.Ay.createElement("h3",{className:hn.headerTitle},A("StoryPrivacyAlertEditTitle"));case pn.allowList:return n.Ay.createElement("h3",{className:hn.headerTitle},A("StoryPrivacyAlertSelectContactsTitle"));case pn.closeFriends:return n.Ay.createElement("h3",{className:hn.headerTitle},A("CloseFriends"));case pn.denyList:return n.Ay.createElement("h3",{className:hn.headerTitle},A("StoryPrivacyAlertExcludedContactsTitle"))}}())),n.Ay.createElement(te.Ay,{activeKey:f,name:"slideFade",slideClassName:"ChatOrUserPicker_slide",className:hn.content},_))})));var gn=a(95807),En=a(36353),bn=a(73104),Cn=a(14),fn=a(52674),Sn=a(95362),kn=a(46051),wn=a(45470),Nn=a(38218),In=a(83057),Pn=a(66991),Mn=a(61157),Tn=a(92111),Bn=a(58674),Ln=a(65843),Rn=a(55158),xn=a(59816),Fn=a(61433),Vn=a(91800),Dn=a(23565),_n=a(35049),Un=a(18501),On=a(11217),Jn=a(86070),Kn=a(39877);const jn=(0,n.ph)((0,s.EK)(((e,t)=>{let{forwardInfo:a}=t;return{sender:a.fromPeerId?(0,c.PVB)(e,a.fromPeerId):void 0,story:a.storyId&&a.fromPeerId?(0,c.Msb)(e,a.fromPeerId,a.storyId):void 0}}))((e=>{let{className:t,forwardInfo:a,sender:i,story:r}=e;const{openStoryViewer:o,loadPeerStoriesByIds:c,openChat:d}=(0,s.ko)(),m=(0,n.li)(null),u=(0,T.A)();(0,n.vJ)((()=>{!r&&a.fromPeerId&&a.storyId&&c({peerId:a.fromPeerId,storyIds:[a.storyId]})}),[a,r]);const A=i?(0,l.F9N)(u,i):a.fromName,h=(0,M.A)((()=>{const{fromPeerId:e,storyId:t}=a;e&&(!r||"isDeleted"in r&&r.isDeleted?d({id:e}):o({peerId:e,storyId:t,isSingleStory:!0}))})),{handleClick:y,handleMouseDown:p}=(0,On.Q)(h);return n.Ay.createElement(Jn.A,{ref:m,className:(0,de.A)("EmbeddedMessage",t,(0,_n.y)(i,!0,!0)),dir:u.isRtl?"rtl":void 0,onClick:y,onMouseDown:p},i?.color?.backgroundEmojiId&&n.Ay.createElement(Kn.A,{emojiDocumentId:i.color.backgroundEmojiId,className:"EmbeddedMessage--background-icons"}),n.Ay.createElement("div",{className:"message-text"},function(){if(r&&"content"in r&&r.content.text)return n.Ay.createElement("p",{className:"embedded-text-wrapper"},(0,Un.f)(r.content.text))}(),n.Ay.createElement("div",{className:"message-title"},function(){if(!i||!A)return;const e=(0,l.L8L)(i.id)?"user-filled":"channel-filled";return n.Ay.createElement(n.Ay.Fragment,null,e&&n.Ay.createElement(q.A,{name:e,className:"embedded-chat-icon"}),A&&(0,kt.A)(A))}())))})));var Gn=a(74936);const zn=(0,n.ph)((function(e){let{story:t,isExpanded:a,className:s,onExpand:i,onFold:r}=e;const l=(0,T.A)(),c=(0,n.li)(null),d=(0,n.li)(null),m=(0,n.li)(null),u=(0,n.li)(null),A=(0,Cn.A)(t,!0),h=A?.content.text,[y,p]=(0,n.J0)(!1),v=(0,Dn.A)(a||void 0,400),g=a||v;(0,n.vJ)((()=>{(0,o.RK)((()=>{d.current&&(a?(0,Fn.YM)(d.current,ba):(0,Fn.HW)(d.current,ba))}))}),[a]);const E=y&&!g,{shouldRender:b,transitionClassNames:C}=(0,De.A)(E,void 0,!0,"slow",!0);(0,n.Nf)((()=>{(0,o.YS)((()=>{if(!u.current)return;const e=u.current,{offsetWidth:t}=e;(0,o.RK)((()=>{e.style.setProperty("--expand-button-width",`${t}px`)}))}))}),[]),(0,n.Nf)((()=>{(0,o.gm)((()=>{if(!d.current||!m.current)return;const e=d.current,t=m.current,a=t.offsetTop,{lineHeight:n,totalLines:s}=(0,Vn.A)(t),i=s>3,r=a+3*n;return()=>{i&&((0,Fn.YM)(e,ga),p(!0)),e.style.setProperty("--_overflow-shift",`${r}px`)}}))}),[h]),(0,n.vJ)((()=>{a||c.current?.scrollTo({top:0})}),[a]);const f=(0,de.A)(pa,g&&Ea,b&&Ca);return n.Ay.createElement("div",{className:(0,de.A)(jt,s)},n.Ay.createElement("div",{ref:d,className:f,role:E?"button":void 0,onClick:E?i:r},n.Ay.createElement("div",{ref:c,className:(0,de.A)(ya,"allow-selection","custom-scroll")},A?.forwardInfo&&n.Ay.createElement(jn,{forwardInfo:A.forwardInfo,className:Ra}),A&&n.Ay.createElement("div",{ref:m,className:va},n.Ay.createElement(Gn.A,{messageOrStory:A,withTranslucentThumbs:!0,forcePlayback:!0})))),b&&n.Ay.createElement("div",{ref:u,className:(0,de.A)(fa,C),onClick:i},l("Story.CaptionShowMore")))}));var Hn=a(26875),$n=a(11241);const qn="YVD19vOP",Wn="vJRk_UUk",Yn="nIv3YAnZ",Qn=(0,n.ph)((e=>{let{story:t,className:a}=e;const{openStoryViewModal:i,openForwardMenu:o,sendStoryReaction:c}=(0,s.ko)(),d=(0,T.A)(),{views:m,isOut:u,peerId:A,id:h,sentReaction:y}=t,{viewsCount:p,forwardsCount:v,reactionsCount:g}=m||{},E=!(0,l.L8L)(A),b=y&&(0,l.a0K)(y,r.tNZ),C=Boolean((u||E)&&t.isPublic&&!t.noForwards),f=(0,l.$_j)(A,h),S=(0,n.Kr)((()=>{const{users:{byId:e}}=(0,s.mS)(),t=m&&"recentViewerIds"in m?m.recentViewerIds:void 0;if(t)return t.map((t=>e[t])).filter(Boolean)}),[m]),k=(0,M.A)((()=>{i({storyId:h})})),w=(0,M.A)((()=>{o({fromChatId:A,storyId:h})})),N=(0,M.A)((()=>{const e=y?void 0:r.tNZ;c({peerId:A,storyId:h,containerId:f,reaction:e})}));return p?n.Ay.createElement("div",{className:(0,de.A)(qn,a)},n.Ay.createElement("div",{className:(0,de.A)("cknL5COh",!E&&"pJAyeGkG"),onClick:E?void 0:k},Boolean(S?.length)&&n.Ay.createElement(Hn.A,{size:"small",peers:S,className:"Vz_VtJ16"}),E?n.Ay.createElement("span",{className:Yn},n.Ay.createElement(q.A,{name:"channelviews",className:"WyBiNM6e"}),p):n.Ay.createElement("span",{className:Yn},d("Views",p,"i")),Boolean(g)&&!E&&n.Ay.createElement("span",{className:"sf3u_6Vh"},n.Ay.createElement(q.A,{name:"heart",className:"Er2XKRqi"}),g)),n.Ay.createElement("div",{className:"kKoeDk3Z"}),C&&n.Ay.createElement(W.A,{color:"translucent",size:"smaller",round:!0,onClick:w,ariaLabel:d("Forward"),className:Wn},n.Ay.createElement(q.A,{name:"forward"})),E&&n.Ay.createElement(n.Ay.Fragment,null,Boolean(v)&&n.Ay.createElement("div",{className:Wn},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",nonInteractive:!0,ariaLabel:d("PublicShares")},n.Ay.createElement(q.A,{name:"loop"})),n.Ay.createElement("span",null,v)),n.Ay.createElement("div",{className:Wn},n.Ay.createElement(W.A,{round:!0,className:"lpDXVIuf",color:"translucent",size:"smaller",onClick:N,ariaLabel:d("AccDescrLike")},y&&n.Ay.createElement($n.A,{key:(0,l.Jjj)(y),containerId:f,reaction:y,withEffectOnly:b}),(!y||b)&&n.Ay.createElement(q.A,{name:b?"heart":"heart-outline",className:(0,de.A)(b&&"twgMDT1y")})),Boolean(g)&&n.Ay.createElement("span",null,g)))):n.Ay.createElement("div",{className:(0,de.A)(qn,a)},d("NobodyViewed"))})),Zn=6,Xn=(0,n.ph)((function(e){let{isActive:t,isViewed:a,isVideo:s,duration:i=Zn,isPaused:r,onImageComplete:o}=e;const l=(0,M.A)((e=>{s||"XY98E7VM"!==e.animationName||o()})),c=(0,de.A)("c1fbGgcx",a&&"xwOKghO2",t&&"ZuByYcIx",r&&"n9V6B7hP");return n.Ay.createElement("span",{className:c,"aria-hidden":!0},t&&n.Ay.createElement("i",{style:`--progress-duration: ${i}s`,className:"qyBCpJct",onAnimationEnd:l}))})),es=b.Yw?4:3,ts=(0,n.ph)((0,s.EK)(((e,t)=>{let{peerId:a,storyId:n,isDeleteModalOpen:s}=t;const{appConfig:i}=e,r=(0,c.mBe)(e,a),o=(0,c.hds)(e,a),l=(0,c.nTw)(e),{storyViewer:{isMuted:d,viewModal:m,isPrivacyModalOpen:u,isStealthModalOpen:A,storyList:h},forwardMessages:{storyId:y},premiumModal:p,safeLinkModalUrl:v,mapModal:g,reportModal:E,giftInfoModal:b}=l,{isOpen:C}=p||{},f=(0,c.Msb)(e,a,n),S=f&&"content"in f,k=Boolean(m||y||l.reactionPicker?.storyId||E||u||C||s||v||A||g||b),w=S?f.forwardInfo:void 0,N=S?f.mediaAreas:void 0,I=w?.fromPeerId||N?.find((e=>"channelPost"===e.type))?.channelId,P=I?(0,c.PVB)(e,I):void 0,M=(0,c.xYJ)(e,"mediaViewerAnimations");return{peer:r||o,forwardSender:P,fromPeer:S&&f.fromId?(0,c.PVB)(e,f.fromId):void 0,story:f,orderedIds:h?.storyIdsByPeerId[a],isMuted:d,isCurrentUserPremium:(0,c.g29)(e),shouldForcePause:k,storyChangelogUserId:i.storyChangelogUserId,viewersExpirePeriod:i.storyExpirePeriod+i.storyViewersExpirePeriod,isChatExist:Boolean(o),areChatSettingsLoaded:Boolean(o?.settings),stealthMode:e.stories.stealthMode,withHeaderAnimation:M}}))((function(e){let{peerId:t,storyId:a,peer:i,forwardSender:o,fromPeer:c,isMuted:d,isArchivedStories:m,isPrivateStories:u,story:A,orderedIds:h,isSingleStory:y,dimensions:p,shouldForcePause:v,storyChangelogUserId:g,viewersExpirePeriod:E,isChatExist:b,areChatSettingsLoaded:C,getIsAnimating:f,isCurrentUserPremium:S,stealthMode:k,withHeaderAnimation:N,onDelete:P,onClose:B,onReport:L}=e;const{viewStory:R,setStoryViewerMuted:x,openPreviousStory:F,openNextStory:V,loadPeerSkippedStories:D,openForwardMenu:_,copyStoryLink:O,toggleStoryInProfile:J,openChat:K,showNotification:j,openStoryPrivacyEditor:G,loadChatSettings:z,fetchChat:H,loadStoryViews:$,toggleStealthModal:Y}=(0,s.ko)(),Q=(0,qa.Fm)(),Z=(0,T.A)(),{isMobile:X}=(0,w.Ay)(),[ee,ae,ne]=(0,I.A)(!1),[se,ie,le]=(0,I.A)(!1),[ce,me,Ae]=(0,I.A)(!1),[he,ye,pe]=(0,I.A)(!0),[ve,ge,Ee]=(0,I.A)(!1),[be,Ce]=(0,n.J0)(!1),[fe,Se,ke]=(0,I.A)(!1),[we,Ne,Ie]=(0,I.A)(!1),Pe=(0,n.li)(null),{isDeletedStory:Me,hasText:Te,hasForwardInfo:Be,thumbnail:Le,previewBlobUrl:Re,isVideo:xe,noSound:Ve,fullMediaData:_e,altMediaHash:Ue,altMediaData:Oe,hasFullData:Je,hasThumb:je,canDownload:Ge,downloadMediaData:ze}=$a(A,S,we),He=A&&"content"in A,$e=t===g,qe=(0,l.L8L)(t),We=!qe,Ye=We&&(0,l.WXB)(i),Qe=He&&A.isOut,Ze=(0,Cn.A)(Qe?!A.isInProfile:void 0,!0),Xe=(0,Cn.A)(Qe?A.isInProfile:void 0,!0),et=Boolean(Qe&&A.date+E<(0,qa.Fm)()),tt=o?(0,l.F9N)(Z,o):He&&A.forwardInfo?.fromName,at=Boolean(He&&A.isPublic&&!$e&&i?.usernames?.length),nt=Boolean(He&&A.isPublic&&!A.noForwards&&!$e&&!ve),st=Boolean(Je&&!v&&he&&!ee&&!ve&&!be&&!fe),it=He&&A.content.video?.duration?A.content.video.duration:void 0,rt=!(Qe&&qe||$e||Ye),ot=He&&!rt&&(Qe||Ye),lt=X&&N?"slideFade":"none",{shouldRender:ct,transitionClassNames:dt}=(0,De.A)(!Je),{transitionClassNames:mt}=(0,De.A)(Boolean(_e)),ut=(0,wn.A)(Le,!je),At=(0,In.A)(Re),{shouldRender:ht,transitionClassNames:yt}=(0,De.A)(rt),{shouldRender:pt,transitionClassNames:vt}=(0,De.A)(Te&&ve),{transitionClassNames:gt}=(0,De.A)(!0),{shouldRender:Et,transitionClassNames:bt}=(0,De.A)(Te||Be),Ct=(0,Pn.Y)(Pe,_e,kn.G);(0,Tn.A)(t,a),(0,n.vJ)((()=>{a&&R({peerId:t,storyId:a})}),[a,t]),(0,n.vJ)((()=>{D({peerId:t})}),[t]),(0,n.vJ)((()=>{const e=(0,l.L8L)(t);!b&&e&&H({chatId:t})}),[b,t]),(0,n.vJ)((()=>{b&&!C&&z({chatId:t})}),[C,b,t]);const ft=(0,M.A)((()=>{xe&&Pe.current?.pause(),Ae(),le()})),St=(0,M.A)((()=>{st&&(ie(),xe||me())})),Nt=(0,M.A)((()=>{Se()})),It=(0,M.A)((()=>{ke()})),Pt=(0,M.A)((()=>{Ne(),ft()})),Mt=(0,M.A)((()=>{Ie(),St()})),{onMouseDown:Tt,onMouseUp:Lt,onMouseLeave:xt,onTouchStart:Ft,onTouchEnd:Vt}=(0,Nn.A)({onStart:Nt,onEnd:It}),Dt=(0,Fe.A)(Pe,void 0,!xe||!_e||Ct),_t=_e&&(!Ue||Oe);(0,n.vJ)((()=>{_t&&!Dt&&St()}),[_t,Dt]),(0,Mn.A)(pe,ye),(0,n.vJ)((()=>{_t&&Pe.current?.load()}),[_t]),(0,n.vJ)((()=>{!He||Me||et||(Qe||Ye)&&$({peerId:t,storyId:a})}),[Me,et,He,t,a,Qe,Ye]),(0,n.vJ)((()=>{v||!he||ee||ve||be||fe?ft():St()}),[St,he,ve,ee,v,be,fe]),(0,n.vJ)((()=>{if(!(ee||v||ve))return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){32===e.keyCode&&(e.preventDefault(),Ce(!be))}}),[ve,ee,be,v]),(0,mn.A)((e=>{let[t,a,n,s,i]=e;!be||ve||ee||v||!he||fe||a===ve&&t===ee&&n===v&&s===he&&i===fe||Ce(!1)}),[ee,ve,v,he,fe,be]);const Ot=(0,M.A)((()=>{B(),K({id:t})})),jt=(0,M.A)((()=>{B(),K({id:o.id})})),Wt=(0,M.A)((()=>{B(),K({id:c.id})})),Yt=(0,M.A)((()=>{F()})),Qt=(0,M.A)((()=>{V()})),Zt=(0,M.A)((e=>{const t=e.currentTarget;t.readyState>=es?me():Ae(),it&&(0,ue.LI)(t.currentTime,2)>=(0,ue.LI)(it,2)&&Qt()}));(0,n.vJ)((()=>f()||ee?void 0:(0,fn.A)({onRight:Qt,onLeft:Yt})),[f,ee]);const ya=(0,M.A)((()=>{O({peerId:t,storyId:a})})),pa=(0,M.A)((()=>{J({peerId:t,storyId:a,isInProfile:!0})})),va=(0,M.A)((()=>{J({peerId:t,storyId:a,isInProfile:!1})})),ga=(0,M.A)((()=>{P(A)})),Ea=(0,M.A)((()=>{L()})),ba=(0,M.A)((()=>{_({fromChatId:t,storyId:a})})),Ca=(0,M.A)((()=>{G()})),fa=(0,M.A)((()=>{const e=!He||A.isPublic?void 0:A.isForContacts?"contacts":A.isForCloseFriends?"closeFriends":"nobody";let t;const a=(0,l.F9N)(Z,i);switch(e){case"nobody":t=Z("StorySelectedContactsHint",a);break;case"contacts":t=Z("StoryContactsHint",a);break;case"closeFriends":t=Z("StoryCloseFriendsHint",a);break;default:return}j({message:t})})),Ia=(0,M.A)((()=>{Ve?j({message:Z("Story.TooltipVideoHasNoSound")}):(Pe.current.muted=!Pe.current.muted,x({isMuted:!d}))})),Pa=(0,M.A)((()=>{if(k.activeUntil&&(0,qa.Fm)()<k.activeUntil){const e=k.activeUntil-(0,qa.Fm)();j({title:Z("StealthModeOn"),message:Z("Story.ToastStealthModeActiveText",(0,Ke.QO)(e)),duration:4e3})}else Y({isOpen:!0})})),Ma=(0,M.A)((()=>{ze&&(0,Sn.A)(ze,`story-${t}-${a}.${xe?"mp4":"jpg"}`)}));(0,n.vJ)((()=>{Me&&j({message:Z("StoryNotFound")})}),[Z,Me]);const Ra=(0,n.Kr)((()=>e=>{let{onTrigger:t,isOpen:a}=e;return n.Ay.createElement(W.A,{round:!0,ripple:!X,size:"tiny",color:"translucent-white",onClick:t,className:(0,de.A)(Aa,a&&"active"),ariaLabel:Z("AccDescrOpenMenu2")},n.Ay.createElement(q.A,{name:"more"}))}),[X,Z]);return n.Ay.createElement("div",{className:(0,de.A)(Xt,"component-theme-dark"),onMouseDown:Tt,onMouseUp:Lt,onMouseLeave:xt,onTouchStart:Ft,onTouchEnd:Vt},n.Ay.createElement("div",{className:(0,de.A)(Jt,gt)},n.Ay.createElement("div",{className:ta},(y?[a]:h??[]).map((e=>n.Ay.createElement(Xn,{key:`progress-${e}`,isActive:e===A?.id,isVideo:xe,isViewed:Boolean(A?.id&&(u||m?e>A?.id:e<A?.id)),isPaused:!ce,duration:it,onImageComplete:Qt})))),n.Ay.createElement("div",{className:aa},n.Ay.createElement(te.Ay,{activeKey:Number(t),name:lt,className:na},n.Ay.createElement("div",{className:sa},n.Ay.createElement(wt.A,{peer:i,size:"tiny",onClick:Ot}),n.Ay.createElement("div",{className:ia},n.Ay.createElement("span",{onClick:Ot,className:ra},(0,kt.A)((0,l.F9N)(Z,i)||"")),n.Ay.createElement("div",{className:oa},tt&&n.Ay.createElement("span",{className:(0,de.A)(la,Ta,o&&Ba),onClick:o?jt:void 0},n.Ay.createElement(q.A,{name:"loop"}),n.Ay.createElement("span",{className:La},(0,kt.A)(tt))),c&&n.Ay.createElement("span",{className:(0,de.A)(la,xa),onClick:Wt},n.Ay.createElement(wt.A,{peer:c,size:"micro"}),n.Ay.createElement("span",{className:La},(0,kt.A)((0,l.F9N)(Z,c)||""))),A&&"date"in A&&n.Ay.createElement("span",{className:la},(0,Ke.fw)(Z,Q,A.date)),He&&A.isEdited&&n.Ay.createElement("span",{className:la},Z("Story.HeaderEdited")))))),n.Ay.createElement("div",{className:da},function(){if(!qe)return;let e="channel-filled";const t={"channel-filled":["#50ABFF","#007AFF"],"user-filled":["#C36EFF","#8B60FA"],"favorite-filled":["#88D93A","#30B73B"],"group-filled":["#FFB743","#F69A36"]};if(Qe){const{visibility:t}=A&&"visibility"in A&&A.visibility||{};switch(t){case"everybody":e="channel-filled";break;case"contacts":e="user-filled";break;case"closeFriends":e="favorite-filled";break;case"nobody":e="group-filled"}}else{if(!A||!("content"in A)||A.isPublic)return;e=A.isForCloseFriends?"favorite-filled":A.isForContacts?"user-filled":"group-filled"}return n.Ay.createElement("div",{className:(0,de.A)(ma,Qe&&ua),onClick:Qe?Ca:fa,style:`--color-from: ${t[e][0]}; --color-to: ${t[e][1]}`},n.Ay.createElement(q.A,{name:e}),Qe&&n.Ay.createElement(q.A,{name:"next"}))}(),xe&&n.Ay.createElement(W.A,{className:Aa,round:!0,ripple:!X,size:"tiny",color:"translucent-white",disabled:!Je,onClick:Ia,ariaLabel:Z("Volume")},n.Ay.createElement(q.A,{name:d||Ve?"speaker-muted-story":"speaker-story"})),n.Ay.createElement(re.A,{className:ha,trigger:Ra,positionX:"right",onOpen:Pt,onClose:Mt},at&&n.Ay.createElement(oe.A,{icon:"copy",onClick:ya},Z("CopyLink")),Ze&&n.Ay.createElement(oe.A,{icon:"save-story",onClick:pa},Z(qe?"StorySave":"SaveToPosts")),Xe&&n.Ay.createElement(oe.A,{icon:"delete",onClick:va},Z(qe?"ArchiveStory":"RemoveFromPosts")),Ge&&n.Ay.createElement(oe.A,{icon:"download",disabled:!ze,onClick:Ma},Z("lng_media_download")),!Qe&&qe&&n.Ay.createElement(oe.A,{icon:"eye-closed-outline",onClick:Pa},Z("StealthMode")),!Qe&&n.Ay.createElement(oe.A,{icon:"flag",onClick:Ea},Z("lng_report_story")),Qe&&n.Ay.createElement(oe.A,{icon:"delete",destructive:!0,onClick:ga},Z("Delete"))),n.Ay.createElement(W.A,{className:(0,de.A)(Aa,ca),round:!0,size:"tiny",color:"translucent-white",ariaLabel:Z("Close"),onClick:B},n.Ay.createElement(q.A,{name:"close"}))))),n.Ay.createElement("div",{className:ea,style:`width: ${p.width}px; height: ${p.height}px`},n.Ay.createElement("canvas",{ref:ut,className:Na}),Re&&n.Ay.createElement("img",{key:`preview-${a}`,src:Re,draggable:!1,alt:"",className:(0,de.A)(zt,Ht,At)}),ct&&n.Ay.createElement(Rn.A,{className:(0,de.A)(dt,Bt)}),!xe&&_e&&n.Ay.createElement("img",{src:_e,alt:"",className:(0,de.A)(zt,mt),draggable:!1}),xe&&_e&&n.Ay.createElement(Ln.A,{ref:Pe,key:`video-${a}`,className:(0,de.A)(zt,mt),canPlay:se,muted:d,width:720,height:1280,draggable:!1,playsInline:!0,disablePictureInPicture:!0,isPriority:!0,onPause:Ae,onWaiting:Ae,disableRemotePlayback:!0,onTimeUpdate:Zt},n.Ay.createElement("source",{src:_e,type:kn.G,width:"720"}),Oe&&n.Ay.createElement("source",{src:Oe,type:kn.w,width:"480"})),!fe&&!ee&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("button",{type:"button",className:(0,de.A)(Sa,ka),onClick:Yt,"aria-label":Z("Previous")}),n.Ay.createElement("button",{type:"button",className:(0,de.A)(Sa,wa),onClick:Qt,"aria-label":Z("Next")})),He&&_e&&n.Ay.createElement(xn.A,{key:`area-overlay-${a}-${t}`,story:A,isActive:!0,isStoryPlaying:we}),!X&&n.Ay.createElement("div",{className:Ut},n.Ay.createElement("div",{className:$t},n.Ay.createElement(wt.A,{peer:i,withStory:!0,storyViewerMode:"disabled"}),n.Ay.createElement("div",{className:qt},(0,kt.A)((0,l.F9N)(Z,i)||""))))),ot&&n.Ay.createElement(Qn,{story:A,className:gt}),pt&&n.Ay.createElement("div",{tabIndex:0,role:"button",className:(0,de.A)(Rt,vt),onClick:()=>Ee(),"aria-label":Z("Close")}),Te&&n.Ay.createElement("div",{className:(0,de.A)(Gt,bt)}),Et&&n.Ay.createElement(zn,{key:`caption-${a}-${t}`,story:A,isExpanded:ve,onExpand:ge,onFold:Ee,className:bt}),ht&&n.Ay.createElement(Bn.A,{type:"story",chatId:t,threadId:U.l3,storyId:a,isReady:!Qe,messageListType:"thread",isMobile:(0,w.Ny)(),editableInputCssSelector:r.iKt,editableInputId:r.YVZ,inputId:"story-input-text",className:(0,de.A)(Kt,yt),inputPlaceholder:Z(We?"ReplyToGroupStory":"ReplyPrivately"),onForward:nt?ba:void 0,onFocus:ae,onBlur:ne}))}))),as=(0,n.ph)((0,s.EK)(((e,t)=>{let{peer:a}=t;const{storyViewer:{lastViewedByPeerIds:n,origin:s,storyList:i}}=(0,c.nTw)(e);return{lastViewedId:a?.id?n?.[a.id]:void 0,origin:s,storyIdsForViewer:a?.id?i?.storyIdsByPeerId[a.id]:void 0}}))((function(e){let{peer:t,peerStories:a,lastViewedId:i,storyIdsForViewer:r,origin:o}=e;const{openStoryViewer:c,loadPeerSkippedStories:d}=(0,s.ko)(),m=(0,T.A)(),u=(0,n.Kr)((()=>{if(!a)return;const{orderedIds:e,lastReadId:t,byId:n}=a,s=e[e.length-1]!==t,o=i&&r?.includes(i)?i??(s?t??-1:-1):-1;return n[n[o]?.id||r?.[0]||e[0]]}),[i,a,r]),A=u&&"content"in u;(0,n.vJ)((()=>{u&&!A&&d({peerId:u.peerId})}),[u,A]);const h=A?u.content.video:void 0,y=A?(0,l.EN7)(u):void 0,p=(0,G.A)(y)||h?.thumbnail?.dataUri;if(t&&u&&!("isDeleted"in u))return n.Ay.createElement("div",{className:Xt,onClick:()=>{c({peerId:u.peerId,storyId:u.id,origin:o})}},p&&n.Ay.createElement("img",{src:p,alt:"",className:zt,draggable:!1}),A&&n.Ay.createElement(xn.A,{story:u}),n.Ay.createElement("div",{className:Ut},n.Ay.createElement("div",{className:$t},n.Ay.createElement(wt.A,{peer:t,withStory:!0,storyViewerMode:"disabled"}),n.Ay.createElement("div",{className:qt},(0,kt.A)((0,l.F9N)(m,t)||"")))))})));var ns=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(ns||{});const ss=(0,n.ph)((0,s.EK)((e=>{const{storyViewer:{peerId:t,storyId:a,isSinglePeer:n,isSingleStory:s,isPrivate:i,isArchive:r,storyList:o}}=(0,c.nTw)(e),{byPeerId:l,orderedPeerIds:{active:d}}=e.stories;return{byPeerId:l,peerIds:o?.peerIds??d,currentPeerId:t,currentStoryId:a,isSinglePeer:n,isSingleStory:s,isPrivate:i,isArchive:r}}),(e=>(0,c.gd2)(e)))((function(e){let{peerIds:t,currentPeerId:a,currentStoryId:i,isOpen:d,isSinglePeer:m,isSingleStory:u,isPrivate:A,isArchive:h,byPeerId:y,isDeleteModalOpen:p,onDelete:v,onClose:g,onReport:E}=e;const{stopActiveReaction:C}=(0,s.ko)(),f=(0,n.li)(null),[S,k]=(0,n.J0)(a),[N,I]=(0,n.J0)(i),P=(0,D.A)(a),T=(0,Cn.A)(h,!0),B=(0,Cn.A)(A,!0),L=(0,Cn.A)(m,!0),R=(0,Cn.A)(u,!0),x=Ha(),{height:F,width:V}=(0,Ce.A)(),_=(0,n.li)(void 0),U=(0,n.li)(!1),{isMobile:O}=(0,w.Ay)(),J=(0,n.li)({}),[K,j]=(0,n.Ul)(!1);function G(e,t){e&&(J.current[t]?J.current[t].current=e:J.current[t]={current:e})}(0,ve.A)({isActive:d,onBack:g,shouldBeReplaced:!0});const z=(0,n.Kr)((()=>{if(S&&(L||R))return[S];const e=S?t.indexOf(S):-1;if(!S||-1===e)return[];const a=Math.max(e-4,0),n=Math.min(e+5,t.length);return t.slice(a,n)}),[R,L,S,t]),H=(0,n.Kr)((()=>z.length&&S?z.indexOf(S):-1),[S,z]),$=(0,n.Kr)((()=>z.length&&a?z.indexOf(a):-1),[a,z]);(0,n.vJ)((()=>{O&&k(a)}),[a,O]),(0,n.vJ)((()=>{S===a&&i!==N&&I(i)}),[a,i,S,N]),(0,n.vJ)((()=>{if(!O)return P&&P!==a&&j(!0),()=>{j(!1)}}),[P,a,j,O]),(0,n.vJ)((()=>()=>{i&&a&&C({containerId:(0,l.$_j)(a,i)})}),[i,a]);const q=$-H,W=H>$,Y=(0,M.A)((()=>t.reduce(((e,n,s)=>{if(n===S)e[n]=za({scale:x.scale,slideAmount:q,isBackward:W,isActiveSlideSize:W});else{let i=!1;!W&&s>0&&t[s-1]===S&&(i=!0),W&&s<t.length-1&&t[s+1]===S&&(i=!0),e[n]=za({scale:x.scale,slideAmount:q,isBackward:W,isActiveSlideSize:a===n&&!W,isMoveThroughActiveSlide:i})}return e}),{})));(0,n.vJ)((()=>{if(!f.current||!d)return;let e=0;const t=()=>S?J.current[S]?.current:void 0,a=a=>{if(U.current)return void(U.current=!1);const n=t();if(n)if(e<-50){const e=document.getElementById(r.YVZ);e&&(0,o.RK)((()=>{(0,En.A)(e)}))}else e>50?(g(),"wheel"===a.type&&((0,bn.M6)(),setTimeout(bn.v5,1500))):(0,o.RK)((()=>{n.style.setProperty("--slide-translate-y","0px")}))};return(0,me.wJ)(f.current,{isNotPassive:!0,withNativeDrag:!0,withWheelDrag:!0,excludedClosestSelector:".Composer",onDrag:(n,s,i)=>{let{dragOffsetX:r,dragOffsetY:l}=i;if(U.current)return;if(b.pz&&"touchstart"===s.type){const{pageX:e}=s.touches[0];if(e<=me.h6||e>=V-me.h6)return}if("mousemove"===n.type)return;const c=Math.abs(r),d=Math.abs(l),m=t();if(m&&(_.current===ns.Vertical||Math.abs(d)>me.no||d/c>me.fG)){_.current=ns.Vertical;const t=F;e=(0,ue.qE)(l,-t,t),e>0&&(0,o.RK)((()=>{m.style.setProperty("--slide-translate-y",e*(O?1:-1)+"px")})),"wheel"===n.type&&Math.abs(e)>100&&(a(n),U.current=!0)}},onRelease:a})}),[d,g,V,F,O,S]),(0,n.Nf)((()=>{if(O)return;const e=Y();Object.entries(J.current).forEach((t=>{let[n,{current:s}]=t;if(!s)return;if(!K())return s.classList.remove(Dt,_t,Ot),s.style.setProperty("--slide-translate-x","0px"),s.style.setProperty("--slide-translate-y","0px"),s.style.setProperty("--slide-translate-scale","1"),void s.style.setProperty("--slide-content-scale",String(x.toActiveScale));let i=0;n===S&&(i=-1.75*x.fromActiveScale,s.classList.add(Ot)),n===a&&(i=1.75,s.classList.add(_t)),s.classList.add(Dt),s.style.setProperty("--slide-translate-x",`${e[n]||0}px`),s.style.setProperty("--slide-translate-y",`${i}rem`),s.style.setProperty("--slide-translate-scale",a===n?String(x.toActiveScale):n===S?String(x.fromActiveScale):"1")}))}),[a,K,S,x,O]);const Q=(0,M.A)((e=>{const t=e.target;t&&t.classList.contains(Zt)&&(S!==a?(k(a),I(i)):i!==N&&I(i),j(!1))}));return O?n.Ay.createElement("div",{className:Vt,ref:f},n.Ay.createElement("div",{className:Yt,ref:e=>G(e,S)},n.Ay.createElement(ts,{peerId:S,storyId:N,onDelete:v,dimensions:x.activeSlide,isPrivateStories:B,isArchivedStories:T,isDeleteModalOpen:p,isSingleStory:u,getIsAnimating:K,onClose:g,onReport:E}))):n.Ay.createElement("div",{className:Vt,ref:f,style:`--story-viewer-scale: ${x.scale}`,onTransitionEnd:Q},n.Ay.createElement("div",{className:Bt,onClick:g}),z.length>1&&n.Ay.createElement("div",{className:xt,style:`height: ${x.slide.height}px`}),z.map(((e,t)=>e===S?function(e){const t=O?void 0:(0,gn.A)(`width: ${x.activeSlide.width}px`,`--slide-media-height: ${x.activeSlide.height}px`);return n.Ay.createElement("div",{key:e,ref:t=>G(t,e),className:(0,de.A)(Wt,Zt),style:t},n.Ay.createElement(ts,{peerId:e,storyId:N,onDelete:v,dimensions:x.activeSlide,isPrivateStories:B,isArchivedStories:T,isDeleteModalOpen:p,isSingleStory:u,getIsAnimating:K,onClose:g,onReport:E}))}(S):function(e,t,a){const i=(0,gn.A)(`width: ${x.slide.width}px`,`height: ${x.slide.height}px`),r=(0,de.A)(Wt,Qt,`slide-${a}`);return n.Ay.createElement("div",{key:e,ref:t=>G(t,e),className:r,style:i},n.Ay.createElement(as,{peer:(0,c.PVB)((0,s.mS)(),e),peerStories:y?.[e]}))}(e,0,t-H))))})));function is(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const[t,a]=(0,n.J0)(!0),[s,i]=(0,n.J0)(!0);return{isAtBeginning:t,isAtEnd:s,handleScroll:(0,M.A)((t=>{const{scrollHeight:n,scrollTop:s,clientHeight:r}=t.target;a(s<e),i(n-s-r<e)}))}}var rs=a(46222),os=a(283),ls=a(36393),cs=a(51083),ds=a(17751),ms=a(17794);const us={"views-list":"gpDY8bos",viewsList:"gpDY8bos","views-list-loading":"vuRAfQ5v",viewsListLoading:"vuRAfQ5v",info:"AOSUIChK",centeredInfo:"oGLhkkS7","view-reaction":"MLaabS6n",viewReaction:"MLaabS6n",header:"d3N2bktu",content:"QmRA3HZK","top-button":"Dkv8GAxf",topButton:"Dkv8GAxf","contact-filter":"YpB_9VxE",contactFilter:"YpB_9VxE",selected:"DoUlpdZJ",sort:"axDpgq9G","sort-button":"Bm5VA66f",sortButton:"Bm5VA66f","icon-sort":"YVQiH93R",iconSort:"YVQiH93R","icon-down":"NXP9aMD0",iconDown:"NXP9aMD0",search:"QQQqBLK6","bottom-info":"_CSv6suH",bottomInfo:"_CSv6suH",scrolled:"RYQ0liYe",footer:"dUK7rP37",closeButton:"abPzLiCH","opacity-fade-in":"cX8oY3zb",opacityFadeIn:"cX8oY3zb",fadeIn:"Sx_aeh1o",blocked:"L82sciL8",check:"UqGBKwjg",menuBubble:"dRqemuTA","with-colored-status":"GQ96fta9",withColoredStatus:"GQ96fta9"},As=1.5*A.$,hs=(0,n.ph)((0,s.EK)(((e,t)=>{let{storyView:a}=t;return{peer:(0,c.PVB)(e,a.peerId),availableReactions:e.reactions.availableReactions}}))((e=>{let{storyView:t,peer:a,availableReactions:i}=e;const{openChat:r,closeStoryViewer:o,unblockUser:c,blockUser:d,deleteContact:m,updateStoryView:u,focusMessage:A,openStoryViewer:h,closeStoryViewModal:y}=(0,s.ko)(),p=(0,T.A)(),v=(0,M.A)((()=>{const{type:e}=t;if("repost"===e)return y(),void h({peerId:t.peerId,storyId:t.storyId});o(),setTimeout((()=>{"user"===e?r({id:t.peerId}):"forward"===e&&A({chatId:t.peerId,messageId:t.messageId})}),100)})),g=(0,n.Kr)((()=>{if(!(0,l.L8L)(t.peerId))return;const{peerId:e,areStoriesBlocked:n,isUserBlocked:s}=t,i=a,{isContact:r}=i||{},o=(0,l.YgS)(i),A=[];return s||(n?A.push({handler:()=>{c({userId:e,isOnlyStories:!0}),u({userId:e,areStoriesBlocked:!1})},title:p("StoryShowBackTo",o),icon:"play-story"}):A.push({handler:()=>{d({userId:e,isOnlyStories:!0}),u({userId:e,areStoriesBlocked:!0})},title:p("StoryHideFrom",o),icon:"hand-stop"})),r?A.push({handler:()=>{m({userId:e})},title:p("DeleteContact"),icon:"delete-user",destructive:!0}):A.push({handler:()=>{s?(c({userId:e}),u({userId:e,isUserBlocked:!1})):(d({userId:e}),u({userId:e,isUserBlocked:!0}))},title:p(s?"Unblock":"BlockUser"),icon:s?"user":"delete-user",destructive:!s}),A}),[p,t,a]),E="user"===t.type?"message-read":"forward"===t.type?"forward":"loop",b="forward"===t.type||"repost"===t.type,C=(0,n.Kr)((()=>{const e="repost"===t.type&&t.story.forwardInfo?.isModified,a=[(0,Ke.U)(p,1e3*t.date)];return e&&a.push(p("lng_edited")),a.join(" • ")}),[p,t]);return n.Ay.createElement(Wa.A,{key:t.peerId,className:(0,de.A)("chat-item-clickable small-icon",us.opacityFadeIn,(t.isUserBlocked||t.areStoriesBlocked)&&us.blocked),onClick:v,rightElement:"user"===t.type&&t.reaction?n.Ay.createElement(ms.A,{reaction:t.reaction,className:us.viewReaction,size:As,availableReactions:i,withIconHeart:!0}):void 0,contextActions:g,withPortalForMenu:!0,menuBubbleClassName:us.menuBubble},(0,l.L8L)(t.peerId)?n.Ay.createElement(ds.A,{className:(0,de.A)(b&&us.withColoredStatus),userId:t.peerId,noStatusOrTyping:!0,status:C,statusIcon:E,withStory:!0,forceShowSelf:!0}):n.Ay.createElement(cs.A,{className:(0,de.A)(b&&us.withColoredStatus),chatId:t.peerId,status:C,statusIcon:E,withStory:!0}))}))),ys=(0,n.ph)((0,s.EK)((e=>{const{appConfig:t}=e,{storyViewer:{viewModal:a}}=(0,c.nTw)(e),{storyId:n,views:s,nextOffset:i,isLoading:r}=a||{},o=n?(0,c.Msb)(e,e.currentUserId,n):void 0;return{storyId:n,views:s,viewersExpirePeriod:t.storyExpirePeriod+t.storyViewersExpirePeriod,story:o&&"content"in o?o:void 0,nextOffset:i,isLoading:r,availableReactions:e.reactions.availableReactions,isCurrentUserPremium:(0,c.g29)(e)}}))((function(e){let{story:t,viewersExpirePeriod:a,views:i,nextOffset:o,isLoading:l,isCurrentUserPremium:c}=e;const{loadStoryViewList:d,closeStoryViewModal:m,clearStoryViews:u}=(0,s.ko)(),[A,h,y]=(0,I.A)(!1),[p,v,g]=(0,I.A)(!0),[E,b]=(0,n.J0)(""),C=(0,T.A)(),f=Boolean(t),S=Boolean(t?.date)&&t.date+a<(0,qa.Fm)(),{viewsCount:k=0,reactionsCount:w=0}=t?.views||{},N=t?.isPublic&&k>r.XQO,P=w>r.$4F,B=k>r.frj,L=N||P||B;(0,n.vJ)((()=>{f||(b(""),y(),v())}),[f]);const R=(0,ye.A)((()=>{u({isLoading:!0})}),[],250,!0);(0,n.vJ)((()=>{R()}),[A,p,E,R]);const x=(0,n.Kr)((()=>i?.sort(function(e){return(t,a)=>{if(e){const e="user"===t.type&&t.reaction,n="user"===a.type&&a.reaction;if(e&&!n)return-1;if(!e&&n)return 1}return a.date-t.date}}(p))),[p,i]),F=x?.length?1:Math.min(k,8),V=Boolean(x?.length)&&x.length<k&&S,D=(0,M.A)((()=>{t?.id&&void 0!==o&&d({peerId:t.peerId,storyId:t.id,offset:o,areReactionsFirst:p||void 0,areJustContacts:A||void 0,query:E})})),{handleScroll:_,isAtBeginning:U}=is(),O=(0,M.A)((()=>{m()})),J=(0,n.Kr)((()=>e=>{let{onTrigger:t,isOpen:a}=e;return n.Ay.createElement(W.A,{fluid:!0,size:"tiny",color:"translucent",className:(0,de.A)(!a&&"active",us.sortButton,us.topButton),faded:a,onClick:t,ariaLabel:C("SortBy")},n.Ay.createElement(q.A,{name:p?"heart-outline":"recent",className:us.iconSort}),n.Ay.createElement(q.A,{name:"down",className:us.iconDown}))}),[p,C]);return n.Ay.createElement(Q.A,{isOpen:f,onClose:O,className:"component-theme-dark",contentClassName:us.viewsList,isSlim:!0},L&&n.Ay.createElement("div",{className:us.header},N&&n.Ay.createElement("div",{className:us.contactFilter},n.Ay.createElement(W.A,{className:(0,de.A)(!A&&us.selected,us.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:y},C("AllViewers")),n.Ay.createElement(W.A,{className:(0,de.A)(A&&us.selected,us.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:h},C("Contacts"))),P&&n.Ay.createElement(re.A,{className:us.sort,trigger:J,positionX:"right"},n.Ay.createElement(oe.A,{icon:"heart-outline",onClick:v},C("SortByReactions"),p&&n.Ay.createElement(q.A,{name:"check",className:us.check})),n.Ay.createElement(oe.A,{icon:"recent",onClick:g},C("SortByTime"),!p&&n.Ay.createElement(q.A,{name:"check",className:us.check}))),B&&n.Ay.createElement(ls.A,{className:us.search,value:E,onChange:b})),n.Ay.createElement("div",{className:(0,de.A)(us.content,!U&&us.topScrolled,"custom-scroll"),onScroll:_},S&&!l&&!E&&Boolean(!x?.length)&&n.Ay.createElement("div",{className:(0,de.A)(us.info,us.centeredInfo)},(0,kt.A)(C(c?"ServerErrorViewers":"ExpiredViewsStub"),["simple_markdown","emoji"])),!l&&Boolean(E.length)&&!x?.length&&n.Ay.createElement("div",{className:us.info},C("Story.ViewList.EmptyTextSearch")),n.Ay.createElement(rs.A,{items:x,onLoadMore:D},x?.map((e=>{const t="forward"===e.type?e.messageId:"repost"===e.type?e.storyId:"user";return n.Ay.createElement(hs,{key:`${e.peerId}-${e.date}-${t}`,storyView:e})})),l&&Array.from({length:F}).map(((e,t)=>n.Ay.createElement(Wa.A,{key:`placeholder-${t}`,className:"chat-item-clickable contact-list-item scroll-item small-icon",disabled:!0},n.Ay.createElement(os.A,null)))),V&&n.Ay.createElement("div",{key:"not-all-available",className:(0,de.A)(us.info,us.bottomInfo)},C("Story.ViewList.NotFullyRecorded")))),n.Ay.createElement("div",{className:(0,de.A)(us.footer,"dialog-buttons")},n.Ay.createElement(W.A,{className:(0,de.A)("confirm-dialog-button",us.close),isText:!0,onClick:O},C("Close"))))}))),ps=(0,n.ph)((0,s.EK)((e=>{const{shouldSkipHistoryAnimations:t,storyViewer:{storyId:a,peerId:n,isPrivacyModalOpen:s,origin:i}}=(0,c.nTw)(e),r=n&&a?(0,c.Msb)(e,n,a):void 0,o=(0,c.xYJ)(e,"mediaViewerAnimations");return{isOpen:(0,c.gd2)(e),shouldSkipHistoryAnimations:t,peerId:n,storyId:a,story:r,origin:i,withAnimation:o,isPrivacyModalOpen:s}}))((function(e){let{isOpen:t,peerId:a,storyId:i,story:l,origin:c,shouldSkipHistoryAnimations:d,withAnimation:A,isPrivacyModalOpen:h}=e;const{closeStoryViewer:y,closeStoryPrivacyEditor:v,reportStory:g}=(0,s.ko)(),E=(0,T.A)(),[b,f]=(0,n.J0)(void 0),[S,k,w]=(0,I.A)(!1),{bestImageData:N,thumbnail:P}=$a(l),B=Ha(),L=(0,D.A)(t),R=(0,D.A)(N),x=(0,D.A)(a),F=(0,D.A)(c),V=Boolean(A&&!d);(0,n.vJ)((()=>{t||(f(void 0),w())}),[t]),(0,n.vJ)((()=>{if(!t)return;(0,u.FD)();const e=(0,_.w4)();return()=>{(0,u.wb)(),e()}}),[t]);const U=(0,n.hb)((()=>{y()}),[y]),O=(0,M.A)((e=>{f(e),k()})),J=(0,M.A)((()=>{w(),f(void 0)})),K=(0,M.A)((()=>{i&&g({storyId:i,peerId:a})}));return(0,n.vJ)((()=>t?(0,m.A)((()=>{U()})):void 0),[U,t]),(0,n.vJ)((()=>{V&&!L&&t&&a&&P&&void 0!==c&&((0,n.VK)(250+r.xB5),function(e,t,a,n,s){const{mediaEl:i}=_a(t,e);if(!i)return;const{width:l,height:c}=C.A.get();let{width:d,height:m}=s;const u=l<=600;if(u){d=l-2*Va,m=c-Fa-2*Va;const e=getComputedStyle(document.documentElement).getPropertyValue("--safe-area-bottom");e&&(m-=parseFloat(e))}const A=u?Va:(l-d)/2,h=u?Va:(c-(m+Fa))/2,{top:y,left:v,width:g,height:E}=i.getBoundingClientRect(),b=v+g/2-(A+d/2),f=y+E/2-(h+m/2),S=g/d,k=E/m;(0,o.RK)((()=>{const e=Da(n||a,!n);(0,p.ZM)(e,{top:`${h}px`,left:`${A}px`,width:`${d}px`,height:`${m}px`,transform:`translate3d(${b}px, ${f}px, 0) scale(${S}, ${k})`});const t=document.getElementById("StoryViewer");t.appendChild(e),document.body.classList.add("ghost-animating"),(0,o.RK)((()=>{(0,p.ZM)(e,{transform:""}),setTimeout((()=>{(0,o.RK)((()=>{t.contains(e)&&t.removeChild(e),document.body.classList.remove("ghost-animating")}))}),200+r.xB5)}))}))}(a,c,P,N,B.activeSlide)),V&&L&&!t&&x&&R&&void 0!==F&&((0,n.VK)(250+r.xB5),function(e,t,a){const{mediaEl:n}=_a(t,e),s=document.getElementById("StoryViewer").querySelector(`.${Yt} .${zt}, .${Zt} .${zt}`);if(!s||!n)return;const{top:i,left:l,width:c,height:d}=s.getBoundingClientRect(),{top:m,left:u,width:A,height:h}=n.getBoundingClientRect(),y=u+A/2-(l+c/2),v=m+h/2-(i+d/2),g=A/c,E=h/d;(0,o.RK)((()=>{const e=Da(a);(0,p.ZM)(e,{top:`${i}px`,left:`${l}px`,width:`${c}px`,height:`${d}px`});const t=Da(n.src,void 0,!0),s=i+d/2-c/2;(0,p.ZM)(t,{top:`${s}px`,left:`${l}px`,width:`${c}px`,height:`${c}px`});const m=document.getElementById("StoryViewer");m.appendChild(e),document.body.appendChild(t),document.body.classList.add("ghost-animating"),(0,o.RK)((()=>{(0,p.ZM)(e,{transform:`translate3d(${y}px, ${v}px, 0) scale(${g}, ${E})`}),(0,p.ZM)(t,{transform:`translate3d(${y}px, ${v}px, 0) scale(${g})`,opacity:"1"}),setTimeout((()=>{(0,o.RK)((()=>{m.contains(e)&&m.removeChild(e),document.body.contains(t)&&document.body.removeChild(t),document.body.classList.remove("ghost-animating")}))}),200+r.xB5)}))}))}(x,F,R))}),[V,N,R,t,L,B.activeSlide,P,a,x,c,F]),n.Ay.createElement(ee.A,{id:"StoryViewer",className:Tt,isOpen:t,shouldAnimateFirstRender:!0,noCloseTransition:d},n.Ay.createElement("div",{className:Lt,onClick:U}),n.Ay.createElement(W.A,{className:Ft,round:!0,size:"smaller",color:"translucent-white",ariaLabel:E("Close"),onClick:U},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement(ss,{isOpen:t,isDeleteModalOpen:S,onReport:K,onClose:U,onDelete:O}),n.Ay.createElement(an,{isOpen:S,story:b,onClose:J}),n.Ay.createElement(ys,null),n.Ay.createElement(en,null),n.Ay.createElement(vn,{isOpen:h,onClose:v}))})));var vs=a(79582),gs=a(63527),Es=a(96374),bs=a(79174),Cs=a(10328),fs=a(52745),Ss=a(34431),ks=a(38102),ws=a(45780);const Ns=2.75*A.$,Is="ChatOrUserPicker-item",Ps=(0,n.ph)((e=>{let{isOpen:t,currentUserId:a,chatOrUserIds:i,search:o,searchPlaceholder:d,className:m,loadMore:u,onSearchChange:A,onSelectChatOrUser:h,onClose:y,onCloseAnimationEnd:p}=e;const{loadTopics:v}=(0,s.ko)(),g=(0,T.A)(),E=(0,n.li)(null),b=(0,n.li)(null),C=(0,n.li)(null),f=(0,n.li)(null),[S,k]=(0,Es.A)(u,i,Boolean(o)),[w,N]=(0,n.J0)(void 0),[I,P]=(0,n.J0)(""),B=w?1:0,L=i.indexOf(S[0]),R=(0,M.A)((()=>{A("")}));(0,bs.A)(C,t&&0===B,R),(0,bs.A)(f,t&&1===B);const x=(0,M.A)((e=>{if(w)return(0,c.pSx)(e,w)})),F=(0,gs.A)(x),[V,D]=(0,n.Kr)((()=>{const e=(0,s.mS)(),t=e.chats.byId,a=e.chats.fullInfoById,n=t[w];if(!n||!F)return[void 0,void 0];const i=I.toLowerCase(),r=F?Object.values(F).reduce(((e,t)=>(!(0,l.__m)(n,t,void 0,a[w])||i&&!t.title.toLowerCase().includes(i)||(e[t.id]=t),e)),{}):F;return[Object.keys(r).map(Number),r]}),[w,I,F]),_=(0,M.A)((()=>{N(void 0),P("")})),U=(0,M.A)((e=>{A(e.currentTarget.value)})),O=(0,M.A)((e=>{P(e.currentTarget.value)})),J=(0,Cs.A)(E,t,(e=>{if(S&&S.length>0){const t=(0,s.mS)().chats.byId,a=S[-1===e?0:e],n=t[a];n?.isForum?(F||v({chatId:a}),N(a)):h(a)}}),`.${Is}`,!0),K=(0,Cs.A)(b,t,(e=>{V?.length&&h(w,V[-1===e?0:e])}),`.${Is}`,!0),j=(0,M.A)((e=>{const t=(0,s.mS)().chats.byId,a=t?.[e];a?.isForum?(F||v({chatId:e}),N(e),R()):h(e)})),G=(0,n.hb)(((e,t)=>{const i=(0,s.mS)(),o=(0,c.PVB)(i,e);if(!o)return;const d=o&&!(0,rn.vj)(o)?o.isSelf:void 0,[m,u]=function(){if(!o)return;if(o.id===a)return[g("SavedMessagesInfo")];if((0,rn.vj)(o))return[(0,l.sTh)(g,o)];const e=(0,c.K0y)(i,o.id);return[(0,l.CDb)(g,o,e),(0,de.A)((0,l.PFE)(o,e,!0)&&"online")]}()||[];return n.Ay.createElement(ws.A,{key:e,className:Is,title:n.Ay.createElement(Ss.A,{peer:o,isSavedMessages:d}),avatarElement:n.Ay.createElement(wt.A,{peer:o,isSavedMessages:d,size:"medium"}),subtitle:m,subtitleClassName:u,ripple:!0,style:`top: ${(L+t)*r.xw7}px;`,onClick:()=>j(e)})}),[a,g,L]);return n.Ay.createElement(Q.A,{isOpen:t,className:(0,de.A)("ChatOrUserPicker",m),onClose:y,onCloseAnimationEnd:p},n.Ay.createElement(te.Ay,{activeKey:B,name:"slideFade",slideClassName:"ChatOrUserPicker_slide"},(()=>1===B?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"modal-header",dir:g.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:g("Back"),onClick:_},n.Ay.createElement(q.A,{name:"arrow-left"})),n.Ay.createElement(Y.A,{ref:f,value:I,onChange:O,onKeyDown:K,placeholder:d})),n.Ay.createElement(rs.A,{ref:b,className:"picker-list custom-scroll",items:V,withAbsolutePositioning:!0,maxHeight:56*(V?.length||0),onKeyDown:K},!V&&n.Ay.createElement(fs.A,null),V?.map(((e,t)=>n.Ay.createElement(ws.A,{key:`${w}_${e}`,className:Is,onClick:()=>h(w,e),style:`top: ${56*(L+t)}px;`,avatarElement:n.Ay.createElement(ks.A,{size:Ns,topic:D[e],className:"topic-icon",letterClassName:"topic-icon-letter"}),title:(0,kt.A)(D[e].title)}))))):n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"modal-header",dir:g.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:g("Close"),onClick:y},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement(Y.A,{ref:C,value:o,onChange:U,onKeyDown:J,placeholder:d})),S?.length?n.Ay.createElement(rs.A,{ref:E,className:"picker-list custom-scroll",items:S,itemSelector:`.${Is}`,onLoadMore:k,withAbsolutePositioning:!0,maxHeight:i.length*r.xw7,onKeyDown:J},S.map(G)):S&&!S.length?n.Ay.createElement("p",{className:"no-results"},g("lng_blocked_list_not_found")):n.Ay.createElement(fs.A,null)))))})),Ms=(0,n.ph)((0,s.EK)((e=>{const{chats:{listIds:t,orderedPinnedIds:a},currentUserId:n}=e;return{activeListIds:t.active,archivedListIds:t.archived,pinnedIds:a.active,contactIds:e.contactList?.userIds,currentUserId:n}}))((e=>{let{isOpen:t,currentUserId:a,activeListIds:i,archivedListIds:o,pinnedIds:d,contactIds:m,filter:u=r.K_A,className:A,searchPlaceholder:h,loadMore:y,onSelectRecipient:p,onClose:v,onCloseAnimationEnd:g}=e;const[E,b]=(0,n.J0)(""),C=(0,n.Kr)((()=>{if(!t)return;let e=d||[];a&&(e=(0,on.Am)([a,...e]));const n=(0,s.mS)(),r=[...i||[],...E&&o||[]].filter((e=>{const t=(0,c.hds)(n,e),a=(0,c.mBe)(n,e);if(a&&!(0,l.PL2)(a))return!0;const s=(0,c.AWZ)(n,e);return t&&(!s||(0,l.__m)(t,void 0,void 0,s))})),A=(0,vs.A)((0,rn.PU)({ids:(0,on.Am)([...a?[a]:[],...r,...m||[]]),query:E}),void 0,e,a);return(0,c.yMZ)(n,A,u)}),[d,a,i,E,o,m,u,t]),f=(0,Cn.A)(C,!0);return n.Ay.createElement(Ps,{isOpen:t,className:A,chatOrUserIds:f,currentUserId:a,searchPlaceholder:h,search:E,onSearchChange:b,loadMore:y,onSelectChatOrUser:p,onClose:v,onCloseAnimationEnd:g})}))),Ts=(0,n.ph)((0,s.EK)((e=>{const{messageIds:t,storyId:a}=(0,c.nTw)(e).forwardMessages,n=t&&t.length>0;return{currentUserId:e.currentUserId,isManyMessages:(t?.length||0)>1,isStory:Boolean(a),isForwarding:n}}))((e=>{let{isOpen:t,currentUserId:a,isManyMessages:i,isStory:r,isForwarding:o}=e;const{openChatOrTopicWithReplyInDraft:d,setForwardChatOrTopic:m,exitForwardMode:u,forwardToSavedMessages:A,forwardStory:h,showNotification:y}=(0,s.ko)(),p=(0,T.A)(),v=(0,D.A)(r,!0),[g,E,b]=(0,I.A)();(0,n.vJ)((()=>{t&&E()}),[t,E]);const C=(0,n.hb)(((e,t)=>{const n=e===a;if(r){h({toChatId:e});const t=(0,s.mS)();if((0,l.L8L)(e))y({message:n?p("Conversation.StoryForwardTooltip.SavedMessages.One"):p("StorySharedTo",(0,l.u0l)((0,c.mBe)(t,e)))});else{const a=(0,c.hds)(t,e);if(!a)return;y({message:p("StorySharedTo",(0,l.JsG)(p,a))})}}else if(n){const e=p(i?"Conversation.ForwardTooltip.SavedMessages.Many":"Conversation.ForwardTooltip.SavedMessages.One");A(),y({message:e})}else{const a=e,n=t?Number(t):void 0;o?m({chatId:a,topicId:n}):d({chatId:a,topicId:n})}}),[a,i,r,p,o]),f=(0,n.hb)((()=>{u()}),[u]);if(t||g)return n.Ay.createElement(Ms,{isOpen:t,className:v?"component-theme-dark":void 0,searchPlaceholder:p(o?"ForwardTo":"ReplyToDialog"),onSelectRecipient:C,onClose:f,onCloseAnimationEnd:b})}))),Bs=(0,n.ph)((e=>{let{requestedDraft:t}=e;const a=Boolean(t&&!t.chatId),{openChatWithDraft:i,resetOpenChatWithDraft:r}=(0,s.ko)(),o=(0,T.A)(),[l,c,d]=(0,I.A)();(0,n.vJ)((()=>{a&&c()}),[a,c]);const m=(0,n.hb)(((e,a)=>{i({chatId:e,threadId:a,text:t.text,files:t.files})}),[i,t]),u=(0,n.hb)((()=>{r()}),[r]);if(a||l)return n.Ay.createElement(Ms,{isOpen:a,searchPlaceholder:o("ForwardTo"),filter:t?.filter,onSelectRecipient:m,onClose:u,onCloseAnimationEnd:d})})),Ls=(0,n.ph)((e=>{let{requestedAttachBotInChat:t}=e;const{cancelAttachBotInChat:a,callAttachBot:i}=(0,s.ko)(),r=(0,T.A)(),o=Boolean(t),[l,c,d]=(0,I.A)();(0,n.vJ)((()=>{o&&c()}),[o,c]);const{bot:m,filter:u,startParam:A}=t||{},h=(0,n.hb)((e=>{i({bot:m,chatId:e,startParam:A}),a()}),[m,i,a,A]);if(o||l)return n.Ay.createElement(Ms,{isOpen:o,searchPlaceholder:r("Search"),filter:u,onSelectRecipient:h,onClose:a,onCloseAnimationEnd:d})}));var Rs=a(99375);function xs(e){return e.isSlowMode?"Slowmode enabled":e.hasErrorKey?"Something went wrong":"Telegram"}const Fs=(0,n.ph)((0,s.EK)((e=>({dialogs:(0,c.nTw)(e).dialogs,currentMessageList:(0,c.Xf0)(e)})))((e=>{let{dialogs:t,currentMessageList:a}=e;const{dismissDialog:i,sendMessage:r}=(0,s.ko)(),[o,l,c]=(0,I.A)(),d=(0,T.A)();var m,u,A;if((0,n.vJ)((()=>{t.length>0&&l()}),[t,l]),t.length)return Boolean(t.length)&&("phoneNumber"in(m=t[t.length-1])?(u=m,n.Ay.createElement(Q.A,{isOpen:o,onClose:c,className:"confirm",title:d("ShareYouPhoneNumberTitle"),onCloseAnimationEnd:i},d("AreYouSureShareMyContactInfoBot"),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:()=>{a&&(r({contact:(0,on.Up)(u,["firstName","lastName","phoneNumber"]),messageList:a}),c())}},d("OK")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:c},d("Cancel"))))):(A=m,n.Ay.createElement(Q.A,{isOpen:o,onClose:c,onCloseAnimationEnd:i,className:"error",title:xs(A)},A.hasErrorKey?(0,Rs.Ay)(A):(0,kt.A)(A.message,["simple_markdown","emoji","br"]),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(W.A,{isText:!0,onClick:c},d("OK"))))))})));var Vs=a(17208);const Ds=(0,n.ph)((0,s.EK)((e=>(0,on.Up)((0,c.nTw)(e),["notifications"])))((e=>{let{notifications:t}=e;if(t.length)return n.Ay.createElement("div",{id:"Notifications"},t.map((e=>n.Ay.createElement(Vs.A,{notification:e}))))})));var _s=a(93578),Us=a(39351);const Os=(0,n.ph)((e=>{let{url:t}=e;const{toggleSafeLinkModal:a}=(0,s.ko)(),i=(0,Us.A)(),r=(0,n.hb)((()=>{t&&(window.open((0,_s.Tc)(t),"_blank","noopener noreferrer"),a({url:void 0}))}),[a,t]),o=(0,n.hb)((()=>{a({url:void 0})}),[a]),l=(0,Cn.A)(t);return n.Ay.createElement(tn.A,{isOpen:Boolean(t),onClose:o,title:i("OpenUrlTitle"),textParts:(0,kt.A)(i("OpenUrlText",{url:l},{withNodes:!0,withMarkdown:!0})),confirmLabel:i("OpenUrlConfirm"),confirmHandler:r})}));var Js=a(47526);const Ks=(0,n.ph)((e=>{let{modal:t}=e;const{closeMapModal:a}=(0,s.ko)(),{point:i,zoom:r}=t||{},o=(0,T.A)(),l=Boolean(i),c=(0,M.A)((()=>{a()})),[d,m,u,A]=(0,n.Kr)((()=>{if(!i)return[];const e=(0,Js.zS)("google",i,r),t=(0,Js.zS)("bing",i,r),a=(0,Js.zS)("osm",i,r);return[e,t,(0,Js.zS)("apple",i,r),a]}),[i,r]),h=(0,M.A)((e=>{a(),window.open(e,"_blank","noopener")})),y=(0,M.A)((()=>{h(d)})),p=(0,M.A)((()=>{h(m)})),v=(0,M.A)((()=>{h(u)})),g=(0,M.A)((()=>{h(A)}));return n.Ay.createElement(Q.A,{contentClassName:"VJDwJpsF",title:o("OpenMapWith"),isOpen:l,onClose:c,isSlim:!0},n.Ay.createElement("div",{className:"aYO2C2Hx"},(b.pz||b.MP)&&n.Ay.createElement(W.A,{fluid:!0,size:"smaller",onClick:v},"Apple Maps"),n.Ay.createElement(W.A,{fluid:!0,size:"smaller",onClick:y},"Google Maps"),n.Ay.createElement(W.A,{fluid:!0,size:"smaller",onClick:p},"Bing Maps"),n.Ay.createElement(W.A,{fluid:!0,size:"smaller",onClick:g},"OpenStreetMap")),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:c},o("Cancel"))))}));var js=a(19806);const Gs=(0,n.ph)((0,s.EK)((e=>({currentUser:(0,c.mBe)(e,e.currentUserId)})))((e=>{let{modal:t,currentUser:a}=e;const{closeUrlAuthModal:i,acceptBotUrlAuth:r,acceptLinkUrlAuth:o}=(0,s.ko)(),[c,d]=(0,n.J0)(!0),[m,u]=(0,n.J0)(!0),A=(0,Cn.A)(t,!1),{domain:h,botId:y,shouldRequestWriteAccess:p}=A?.request||{},v=y?(0,s.mS)().users.byId[y]:void 0,g=(0,T.A)(),E=(0,n.hb)((()=>{t?.url&&c?(t.button?r:o)({isWriteAllowed:m}):A?.url&&window.open((0,_s.Tc)(A.url),"_blank","noopener"),i()}),[t,c,i,r,o,m,A]),b=(0,n.hb)((()=>{i()}),[i]),C=(0,n.hb)((e=>{d(e),u(e)}),[d]);return(0,n.vJ)((()=>{h&&(d(!0),u(Boolean(p)))}),[p,h]),n.Ay.createElement(tn.A,{isOpen:Boolean(t?.url),onClose:b,title:g("OpenUrlTitle"),confirmLabel:g("OpenUrlTitle"),confirmHandler:E},(0,kt.A)(g("OpenUrlAlert2",A?.url),["links"]),h&&n.Ay.createElement(js.A,{className:"dialog-checkbox",checked:c,label:n.Ay.createElement(n.Ay.Fragment,null,(0,kt.A)(g("Conversation.OpenBotLinkLogin",[h,(0,l.YgS)(a)]),["simple_markdown"])),onCheck:C}),p&&n.Ay.createElement(js.A,{className:"dialog-checkbox",checked:m,label:n.Ay.createElement(n.Ay.Fragment,null,(0,kt.A)(g("Conversation.OpenBotLinkAllowMessages",(0,l.YgS)(v)),["simple_markdown"])),onCheck:u,disabled:!c}))}))),zs=1e3*r.fRl,Hs=["lng_weekday1","lng_weekday2","lng_weekday3","lng_weekday4","lng_weekday5","lng_weekday6","lng_weekday7"];function $s(e,t,a,n,s){const i=new Date(e,t,a),r=n&&(0,Ke.pU)(n),o=s&&(0,Ke.pU)(s);return!!(o&&i>o)||!!(r&&i<r)}function qs(e){return String(e).padStart(2,"0")}function Ws(e,t,a){return`${e}-${t+1}-${a}`}const Ys=(0,n.ph)((e=>{let{selectedAt:t,minAt:a,maxAt:s,isFutureMode:i,isPastMode:r,isOpen:o,withTimePicker:l,submitButtonLabel:c,secondButtonLabel:d,onClose:m,onSubmit:u,onSecondButtonClick:A}=e;const h=(0,T.A)(),y=new Date,p=(0,n.Kr)((()=>i&&!a?new Date:new Date(Math.max(a||0,0))),[i,a]),v=(0,n.Kr)((()=>r&&!s?new Date:new Date(Math.min(s||zs,zs))),[r,s]),g=(0,n.Kr)((()=>t?new Date(t):new Date),[t]),E=(0,D.A)(o),[b,C]=(0,I.A)(!1),[f,S]=(0,n.J0)(g),[k,w]=(0,n.J0)(new Date(f.getFullYear(),f.getMonth(),1)),[N,P]=(0,n.J0)(qs(g.getHours())),[M,B]=(0,n.J0)(qs(g.getMinutes())),L=Ws(f.getFullYear(),f.getMonth(),f.getDate()),R=k.getFullYear(),x=k.getMonth(),F=i&&f.getTime()<p.getTime()||r&&f.getTime()>v.getTime();(0,n.vJ)((()=>{!E&&o&&(S(g),w(new Date(g.getFullYear(),g.getMonth(),1)),l&&(P(qs(g.getHours())),B(qs(g.getMinutes()))))}),[g,o,E,l]),(0,n.vJ)((()=>{i&&!b&&f.getTime()<p.getTime()&&(S(p),P(qs(p.getHours())),B(qs(p.getMinutes())))}),[i,b,p,f]),(0,n.vJ)((()=>{r&&!b&&f.getTime()>v.getTime()&&(S(v),P(qs(v.getHours())),B(qs(v.getMinutes())))}),[i,r,b,v,p,f]),(0,n.vJ)((()=>{if(t){const e=new Date(t);S(e),P(qs(e.getHours())),B(qs(e.getMinutes()))}}),[t]);const V=r&&R>=y.getFullYear()&&x>=y.getMonth()||v&&R>=v.getFullYear()&&x>=v.getMonth(),_=i&&R<=y.getFullYear()&&x<=y.getMonth(),{prevMonthGrid:U,currentMonthGrid:O,nextMonthGrid:J}=(0,n.Kr)((()=>function(e,t){const a=[],n=[],s=[],i=new Date;i.setDate(1),i.setMonth(t),i.setFullYear(e);const r=i.getDay()||7,o=new Date(e,t,0).getDate();for(let e=1;e<r;e++)a.push(o-r+e+1);for(;i.getMonth()===t;){const e=i.getDate();n.push(e),i.setDate(e+1)}const l=(n.length+a.length)%7;if(l>0)for(let e=1;e<=7-l;e++)s.push(e);return{prevMonthGrid:a,currentMonthGrid:n,nextMonthGrid:s}}(R,x)),[x,R]),K=(0,n.Kr)((()=>c||function(e,t){const a=(0,Ke.A)(t,e.code);return a===(0,Ke.A)(new Date,e.code)?e("Conversation.ScheduleMessage.SendToday",(0,Ke.fU)(e,t)):e("Conversation.ScheduleMessage.SendOn",[a,(0,Ke.fU)(e,t)])}(h,f)),[h,f,c]),j=(0,n.hb)((()=>{u(i&&f<p?p:r&&f>v?v:f)}),[i,r,p,v,u,f]),G=(0,n.hb)((e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return P(""),void(e.target.value="");const a=Math.max(0,Math.min(Number(t),23)),n=new Date(f.getTime());n.setHours(a),S(n);const s=qs(a);P(s),e.target.value=s}),[f]),z=(0,n.hb)((e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return B(""),void(e.target.value="");const a=Math.max(0,Math.min(Number(t),59)),n=new Date(f.getTime());n.setMinutes(a),S(n);const s=qs(a);B(s),e.target.value=s}),[f]);return n.Ay.createElement(Q.A,{isOpen:o,onClose:m,className:"CalendarModal",onEnter:j},n.Ay.createElement("div",{className:"container"},n.Ay.createElement("div",{className:"month-selector"},n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",onClick:m},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("h4",null,h(`lng_month${x+1}`)," ",R),n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",disabled:_,onClick:_?void 0:function(){w((e=>{const t=new Date(e);return t.setMonth(t.getMonth()-1),t}))}},n.Ay.createElement(q.A,{name:"previous"})),n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",disabled:V,onClick:V?void 0:function(){w((e=>{const t=new Date(e);return t.setMonth(t.getMonth()+1),t}))}},n.Ay.createElement(q.A,{name:"next"})))),n.Ay.createElement("div",{className:"calendar-wrapper"},n.Ay.createElement("div",{className:"calendar-grid"},Hs.map((e=>n.Ay.createElement("div",{className:"day-button faded weekday"},n.Ay.createElement("span",null,h(e))))),U.map((e=>n.Ay.createElement("div",{className:"day-button disabled"},n.Ay.createElement("span",null,e)))),O.map((e=>n.Ay.createElement("div",{role:"button",tabIndex:0,onClick:()=>{return t=e,void S((e=>{const a=new Date(e);return a.setDate(t),a.setMonth(x),a.setFullYear(R),a}));var t},className:(0,de.A)("day-button","div-button",$s(R,x,e,p,v)?"disabled":e?"clickable":"",L===Ws(R,x,e)&&"selected")},Boolean(e)&&n.Ay.createElement("span",null,e)))),J.map((e=>n.Ay.createElement("div",{className:"day-button disabled"},n.Ay.createElement("span",null,e)))))),l&&n.Ay.createElement("div",{className:"timepicker"},n.Ay.createElement("input",{type:"text",className:"form-control",inputMode:"decimal",value:N,onChange:G,onFocus:C}),":",n.Ay.createElement("input",{type:"text",className:"form-control",inputMode:"decimal",value:M,onChange:z,onFocus:C})),n.Ay.createElement("div",{className:"footer"},n.Ay.createElement("div",{className:"footer"},n.Ay.createElement(W.A,{onClick:j,disabled:F},K),d&&n.Ay.createElement(W.A,{onClick:A,isText:!0},d))))})),Qs=(0,n.ph)((0,s.EK)((e=>({selectedAt:(0,c.nTw)(e).historyCalendarSelectedAt})))((e=>{let{isOpen:t,selectedAt:a}=e;const{searchMessagesByDate:i,closeHistoryCalendar:r}=(0,s.ko)(),o=(0,n.hb)((e=>{i({timestamp:e.getTime()/1e3}),r()}),[r,i]),l=(0,T.A)();return n.Ay.createElement(Ys,{isOpen:t,selectedAt:a,isPastMode:!0,submitButtonLabel:l("JumpToDate"),onClose:r,onSubmit:o})})));var Zs=a(64713);const Xs=(0,n.ph)((0,s.EK)(((e,t)=>{let{userId:a}=t;return{user:a?(0,c.mBe)(e,a):void 0,userStatus:a?(0,c.K0y)(e,a):void 0,phoneCodeList:e.countryList.phoneCodes}}))((e=>{let{isOpen:t,userId:a,isByPhoneNumber:i,user:r,userStatus:o,phoneCodeList:c}=e;const{updateContact:d,importContact:m,closeNewContactDialog:u}=(0,s.ko)(),A=(0,T.A)(),h=(0,Cn.A)(r),y=(0,Cn.A)(i),p=(0,n.li)(null),[v,g,E]=(0,I.A)(),[C,f]=(0,n.J0)(h?.firstName??""),[S,k]=(0,n.J0)(h?.lastName??""),[w,N]=(0,n.J0)(h?.phoneNumber??""),[P,M]=(0,n.J0)(!0),B=Boolean(C&&(!i||w));(0,n.vJ)((()=>{t&&(g(),f(h?.firstName??""),k(h?.lastName??""),N(h?.phoneNumber??""),M(!0))}),[t,g,h?.firstName,h?.lastName,h?.phoneNumber]),(0,n.vJ)((()=>{!b.TF&&v&&setTimeout((()=>{p.current?.focus()}),200)}),[v]);const L=(0,n.hb)((e=>{f(e.target.value)}),[]),R=(0,n.hb)((e=>{N((0,Zs.Ox)(c,e.target.value))}),[c]),x=(0,n.hb)((e=>{k(e.target.value)}),[]),F=(0,n.hb)((()=>{u(),f(""),k(""),N("")}),[u]),V=(0,n.hb)((()=>{i||!a?m({firstName:C,lastName:S,phoneNumber:w}):d({userId:a,firstName:C,lastName:S,shouldSharePhoneNumber:P})}),[C,m,i,S,w,P,d,a]);if(t||v)return n.Ay.createElement(Q.A,{className:"NewContactModal",title:A("NewContact"),isOpen:t,onClose:F,onCloseAnimationEnd:E},h&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"NewContactModal__profile",dir:A.isRtl?"rtl":void 0},n.Ay.createElement(wt.A,{size:"jumbo",peer:h,text:`${C} ${S}`}),n.Ay.createElement("div",{className:"NewContactModal__profile-info"},n.Ay.createElement("p",{className:"NewContactModal__phone-number"},h?.phoneNumber?(0,Zs.Ox)(c,h.phoneNumber):A("MobileHidden")),n.Ay.createElement("span",{className:"NewContactModal__user-status",dir:"auto"},(0,l.CDb)(A,h,o)))),n.Ay.createElement(Y.A,{ref:p,value:C,label:A("FirstName"),tabIndex:0,onChange:L}),n.Ay.createElement(Y.A,{value:S,label:A("LastName"),tabIndex:0,onChange:x}),n.Ay.createElement("p",{className:"NewContactModal__help-text"},(0,kt.A)(A("NewContact.Phone.Hidden.Text",h?.firstName||""),["emoji","simple_markdown"])),n.Ay.createElement(js.A,{className:"dialog-checkbox",checked:P,tabIndex:0,onCheck:M,label:A("lng_new_contact_share")}),n.Ay.createElement("p",{className:"NewContactModal__help-text NewContactModal__help-text__negative"},(0,kt.A)(A("AddContact.SharedContactExceptionInfo",h?.firstName)))),y&&n.Ay.createElement("div",{className:"NewContactModal__new-contact",dir:A.isRtl?"rtl":void 0},n.Ay.createElement(wt.A,{size:"jumbo",text:`${C} ${S}`}),n.Ay.createElement("div",{className:"NewContactModal__new-contact-fieldset"},n.Ay.createElement(Y.A,{ref:p,value:w,inputMode:"tel",label:A("lng_contact_phone"),tabIndex:0,onChange:R}),n.Ay.createElement(Y.A,{value:C,label:A("FirstName"),tabIndex:0,onChange:L}),n.Ay.createElement(Y.A,{value:S,label:A("LastName"),tabIndex:0,onChange:x}))),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(W.A,{isText:!0,className:"confirm-dialog-button",disabled:!B,onClick:V},A("Done")),n.Ay.createElement(W.A,{isText:!0,className:"confirm-dialog-button",onClick:F},A("Cancel"))))})));var ei=a(20179),ti=a(48894),ai=a(71322),ni=a(32625),si=a(10722);let ii=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.TopLeft=4]="TopLeft",e[e.TopRight=5]="TopRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomRight=7]="BottomRight",e}({});const ri={top:ii.Top,bottom:ii.Bottom,left:ii.Left,right:ii.Right,topLeft:ii.TopLeft,topRight:ii.TopRight,bottomLeft:ii.BottomLeft,bottomRight:ii.BottomRight},oi=Object.keys(ri);let li;const ci={x:0,y:0};var di=a(36838);const mi=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.nTw)(e).webApps,{botId:a}=(0,c.ES7)(e)||{},{modalState:n,openedWebApps:s}=t||{},i="minimized"===n;return{activeTabBot:a?(0,c.mBe)(e,a):void 0,isMinimizedState:i,openedWebApps:s}}))((e=>{let{activeTabBot:t,isMinimizedState:a,openedWebApps:i}=e;const{changeWebAppModalState:r,closeWebAppModal:o}=(0,s.ko)(),l=(0,T.A)(),d=(0,Us.A)(),m=(0,n.li)(null),u=(0,n.Kr)((()=>i&&Object.values(i)),[i]),A=u?.length,h=(0,n.Kr)((()=>{if(!A)return[];const e=(0,s.mS)(),a=t?.id;return(0,on.Am)([a,...u.map((e=>e.botId))]).map((t=>t&&(0,c.mBe)(e,t))).filter(Boolean).slice(0,3)}),[A,t,u]),y=(0,M.A)((()=>{o()})),p=(0,M.A)((()=>{r({state:"maximized"})}));if(a)return n.Ay.createElement("div",{ref:m,className:(0,de.A)("kUZmBlnN")},n.Ay.createElement(W.A,{className:"SMRJmUuE",round:!0,color:"translucent",size:"tiny",ariaLabel:l("Close"),onClick:y},n.Ay.createElement(q.A,{className:"P0P4gW6a",name:"close"})),n.Ay.createElement(Hn.A,{className:"GP17QhNN",size:"mini",peers:h}),function(){const e=h.length>0&&h[0]?.firstName,t=A&&e&&A>1?`${d("MiniAppsMoreTabs",{botName:e,count:A-1},{pluralValue:A-1})}`:e;return n.Ay.createElement("div",{className:"TZFjRaG4"},t)}(),n.Ay.createElement(W.A,{className:(0,de.A)("Rax9j_TK","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:p},n.Ay.createElement(q.A,{className:"sdbTXCxq",name:"expand-modal"})))})));var ui=a(59852),Ai=a(84991);const hi={container:"RFg0Ey2I","user-count-badge":"UZtJ6ZXb",userCountBadge:"UZtJ6ZXb","user-badge-icon":"pTiZFhsG",userBadgeIcon:"pTiZFhsG",name:"TzA5nqCC"},yi=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;return{user:(0,c.mBe)(e,a)}}))((function(e){let{user:t,isPopularApp:a}=e;const{requestMainWebView:i}=(0,s.ko)(),r=(0,M.A)((()=>{if(!t)return;const e=t?.id;if(!e)return;const a=(0,ui.A)();i({botId:e,peerId:e,theme:a})}));if(!t)return;const o=t?.firstName,l=t?.botActiveUsers,c=l&&a?(0,je.Vw)(l):void 0;return n.Ay.createElement("div",{className:hi.container,onClick:r},n.Ay.createElement(Ai.A,{className:(0,de.A)(hi.avatarContainer,a&&"PopularAppGridItem"),textClassName:hi.name,badgeClassName:hi.userCountBadge,badgeIconClassName:hi.userBadgeIcon,peer:t,text:o,badgeText:c,badgeIcon:"user-filled"}))}))),pi={root:"BJV09FsC",search:"bdi8G7GR","section-title":"ex3kxgWX",sectionTitle:"ex3kxgWX","section-content":"uIZzLhEh",sectionContent:"uIZzLhEh",showMoreLink:"h_Zs9ypA"},vi=(0,Ae.nF)((e=>e()),500,!0),gi=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.nTw)(e).globalSearch,a=t.popularBotApps?.peerIds;return{isLoading:!a&&t.fetchingStatus?.botApps,foundIds:a,recentBotIds:e.topBotApps.userIds}}))((e=>{let{foundIds:t,recentBotIds:a}=e;const r=(0,T.A)(),o=(0,Us.A)(),[l,c]=(0,n.J0)(!1),{searchPopularBotApps:d}=(0,s.ko)(),m=(0,M.A)((()=>{c((e=>!e))})),[u,A]=(0,n.J0)(""),h=(0,n.Kr)((()=>t?(0,rn.PU)({ids:t,query:u,type:"user"}):[]),[t,u]),y=(0,n.hb)((e=>{let{direction:t}=e;t===i.TN.Backwards&&vi((()=>{d()}))}),[]),p=(0,n.hb)((()=>{A("")}),[]);return n.Ay.createElement(rs.A,{className:(0,de.A)(pi.root,"custom-scroll"),items:h,onLoadMore:y,itemSelector:".PopularAppGridItem",noFastList:!0,preloadBackwards:30},n.Ay.createElement(ls.A,{className:pi.search,value:u,onChange:A,onReset:p,placeholder:o("SearchApps")}),a&&!u&&n.Ay.createElement("div",{className:pi.section},n.Ay.createElement("div",{className:pi.sectionTitle},n.Ay.createElement("span",null,r("SearchAppsMine")),n.Ay.createElement("span",{className:pi.showMoreLink,onClick:m},r(l?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore"))),n.Ay.createElement("div",{className:pi.sectionContent},a.map(((e,t)=>{if(l||!(t>=5))return n.Ay.createElement(yi,{chatId:e})})))),n.Ay.createElement("div",{className:pi.section},n.Ay.createElement("div",{className:pi.sectionTitle},o(u?"Apps":"PopularApps")),n.Ay.createElement("div",{className:pi.sectionContent},h&&h.map((e=>n.Ay.createElement(yi,{chatId:e,isPopularApp:!u}))))))}))),Ei=3.675*A.$,bi="jEAibDyh",Ci="ablUg8HU",fi="Wrl63uWL",Si="vOFiAq3l",ki="KwI4XdkC",wi="oq6HKJur",Ni="a0AI_he5",Ii="MvCwTbk_",Pi=250,Mi=["allow-scripts","allow-same-origin","allow-popups","allow-forms","allow-modals","allow-storage-access-by-user-activation"].join(" "),Ti={ok:"OK",cancel:"Cancel",close:"Close"},Bi=(0,n.ph)((0,s.EK)(((e,t)=>{let{modal:a}=t;const n=a?.activeWebAppKey?(0,c.wtp)(e,a.activeWebAppKey):void 0,{botId:s}=n||{},i=a?.modalState,r=s?e.attachMenu.bots[s]:void 0,o=s?(0,c.mBe)(e,s):void 0,l=s?(0,c.vGo)(e,s):void 0,d=l?.botInfo?.appSettings,m=e.currentUserId?(0,c.mBe)(e,e.currentUserId):void 0,u=(0,c.SJA)(e),{isPaymentModalOpen:A,status:h}=(0,c.nTw)(e).payment,{status:y,inputInvoice:p}=(0,c.nTw)(e).starsPayment,v=o?(0,c.XOs)(e,o.id):void 0,g=y||h;return{attachBot:r,bot:o,currentUser:m,theme:u,isPaymentModalOpen:A||Boolean(p),paymentStatus:g,modalState:i,botAppPermissions:v,botAppSettings:d}}))((e=>{let{modal:t,webApp:a,bot:i,theme:o,isPaymentModalOpen:c,paymentStatus:d,registerSendEventCallback:m,registerReloadFrameCallback:u,isTransforming:A,modalState:h,isMultiTabSupported:y,onContextMenuButtonClick:p,botAppPermissions:v,botAppSettings:g,modalHeight:E}=e;const{closeActiveWebApp:C,sendWebViewData:f,toggleAttachBot:S,openTelegramLink:k,setWebAppPaymentSlug:N,switchBotInline:P,sharePhoneWithBot:B,updateWebApp:L,resetPaymentStatus:R,openChatWithInfo:x,showNotification:F,openEmojiStatusAccessModal:V,openLocationAccessModal:D,changeWebAppModalState:_,closeWebAppModal:U,openPreparedInlineMessageModal:O}=(0,s.ko)(),[J,K]=(0,n.J0)(),[G,z]=(0,n.J0)(),[H,$,Y]=(0,I.A)(!1),[Z,X]=(0,n.J0)(),[ee,ae]=(0,n.J0)(!1),[ne,se]=(0,n.J0)(!1),[ie,re]=(0,n.J0)(),[oe,le]=(0,n.J0)(),{unlockPopupsAt:ce,handlePopupOpened:me,handlePopupClosed:ue}=function(e,t){const[a,s]=(0,n.J0)(0),i=(0,n.li)(0),r=(0,n.li)(0),o=(0,M.A)((()=>{const e=Date.now();e-r.current>2e3&&(i.current=0),i.current+=1,i.current>=3&&s(e+2e3)})),l=(0,M.A)((()=>{a<Date.now()&&(r.current=Date.now())}));return{unlockPopupsAt:a,handlePopupOpened:o,handlePopupClosed:l}}(),Ae=(0,n.li)(null),he=(0,n.li)(null),ye=(0,n.li)(null),pe="fullScreen"===h,ve="minimized"===h,ge=(0,M.A)((()=>{setTimeout((()=>{_({state:"maximized"})}),350)})),Ee=(0,n.li)(null);(0,n.vJ)((()=>{Ee.current=document.querySelector("#portals")}),[]);const[,fe,Se]=(0,be.Ay)(Ee,ge),ke=t?.activeWebAppKey?t.openedWebApps[t.activeWebAppKey]:void 0,we=ke?.appName,{url:Ne,buttonText:Ie,isBackButtonVisible:Pe}=a||{},{placeholderPath:Me}=g||{},Te=Boolean(a?.isCloseModalOpen),Be=Boolean(a?.isRemoveModalOpen),Le=a&&(0,ei.rp)(a),xe=ke&&(0,ei.rp)(ke),Fe=ke&&a&&xe===Le,Ve=b.H$,De=void 0!==v?.geolocation,_e=Boolean(v?.geolocation),Ue=(0,M.A)((e=>{Le&&L({key:Le,update:e})})),Oe=(0,n.Kr)((()=>(0,ui.A)()),[o]);(0,n.vJ)((()=>{le(Oe.secondary_bg_color)}),[Oe]);const Je=Oe.bg_color,[Ke,je]=(0,n.J0)(),Ge="light"===o?g?.backgroundColor:g?.backgroundDarkColor;(0,n.vJ)((()=>{Ue({backgroundColor:Ke||Ge||Je})}),[Je,Ke,Ge]);const ze=Oe.bg_color,[He,qe]=(0,n.J0)(),We="light"===o?g?.headerColor:g?.headerDarkColor;(0,n.vJ)((()=>{Ue({headerColor:He||We||ze})}),[ze,He,We]);const Ye=(0,n.li)(null),Qe=(0,T.A)(),Ze=(0,Us.A)(),Xe=t?.isModalOpen||!1,et=Boolean(Ie),{reloadFrame:tt,sendEvent:at,sendFullScreenChanged:nt,sendViewport:st,sendSafeArea:it,sendTheme:rt}=((e,t,a,i,r,o,c)=>{const{showNotification:d,setWebAppPaymentSlug:m,openInvoice:u,closeWebApp:A,openSuggestedStatusModal:h,updateWebApp:y}=(0,s.ko)(),p=(0,n.li)(!1),v=(0,n.li)(),g=(0,n.li)(!1),E=(0,n.li)(),b=(0,Ce.A)();(0,n.vJ)((()=>{if(!e.current||!t)return;const a=()=>{c?.()},n=e.current;return n.addEventListener("load",a),()=>{n.removeEventListener("load",a)}}),[c,e,t]);const C=(0,n.hb)((t=>{e.current?.contentWindow&&e.current.contentWindow.postMessage(JSON.stringify(t),"*")}),[e]),f=(0,n.hb)((e=>{C({eventType:"fullscreen_changed",eventData:{is_fullscreen:e}})}),[C]),S=(0,M.A)((t=>{if(!e.current)return;const a=e.current;a.src="about:blank",a.addEventListener("load",(()=>{a.src=t}),{once:!0})})),k=(0,n.hb)((e=>{if(p.current)return C({eventType:"reload_iframe"}),void(v.current=setTimeout((()=>{S(e)}),500));S(e)}),[C]),w=(0,n.hb)((t=>{if(!e.current)return;const{width:a,height:n}=e.current.getBoundingClientRect();C({eventType:"viewport_changed",eventData:{width:a,height:n,is_expanded:!0,is_state_stable:!t}})}),[C,e]),N=(0,n.hb)((()=>{e.current&&(C({eventType:"safe_area_changed",eventData:{left:0,right:0,top:0,bottom:0}}),C({eventType:"content_safe_area_changed",eventData:{left:0,right:0,top:a?Ei:0,bottom:0}}))}),[C,a,e]),I=(0,n.hb)((()=>{C({eventType:"theme_changed",eventData:{theme_params:(0,ui.A)()}})}),[C]),P=(0,n.hb)((e=>{C({eventType:"set_custom_style",eventData:e})}),[C]),T=(0,n.hb)((t=>{if(g.current)return;const a=e.current?.contentWindow;if(a===t.source)try{const e=JSON.parse(t.data),{eventType:a,eventData:n}=e;if("web_app_ready"===a&&c?.(),"web_app_close"===a&&o){const e=(0,l.rpZ)(o);A({key:e,skipClosingConfirmation:!0})}if("web_app_request_viewport"===a&&w(b.isResizing),"web_app_request_safe_area"===a&&N(),"web_app_request_content_safe_area"===a&&N(),"web_app_request_theme"===a&&I(),"iframe_ready"===a){const e=getComputedStyle(document.body).getPropertyValue("--color-scrollbar");P("* {\n  scrollbar-width: thin;\n  scrollbar-color: %SCROLLBAR_COLOR% transparent;\n}\n\n*::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n  background-color: transparent;\n}\n\n*::-webkit-scrollbar-thumb {\n  border-radius: 6px;\n  background-color: %SCROLLBAR_COLOR%;\n}\n\n*::-webkit-scrollbar-corner {\n  background-color: transparent;\n}".replace(/%SCROLLBAR_COLOR%/g,e)),p.current=Boolean(n.reload_supported)}if("iframe_will_reload"===a&&clearTimeout(v.current),"web_app_data_send"===a){if(!i)return;g.current=!0}if("web_app_read_text_from_clipboard"===a&&C({eventType:"clipboard_text_received",eventData:{req_id:n.req_id,data:null}}),"web_app_open_scan_qr_popup"===a&&d({message:"Scanning QR code is not supported in this client yet"}),"web_app_open_invoice"===a&&(m({slug:n.slug}),u({type:"slug",slug:n.slug})),"web_app_open_link"===a){const e=n.url;window.open(e,"_blank","noreferrer")}if("web_app_biometry_get_info"===a&&C({eventType:"biometry_info_received",eventData:{available:!1}}),"web_app_set_emoji_status"===a){const{custom_emoji_id:e,duration:t}=n;if(!e||"string"!=typeof e)return void C({eventType:"emoji_status_failed",eventData:{error:"SUGGESTED_EMOJI_INVALID"}});if(t)try{BigInt(t)}catch(e){return void C({eventType:"emoji_status_failed",eventData:{error:"DURATION_INVALID"}})}if(!o)return void C({eventType:"emoji_status_failed",eventData:{error:"UNKNOWN_ERROR"}});h({webAppKey:(0,l.rpZ)(o),customEmojiId:e,duration:Number(t),botId:o.botId})}r(e)}catch(e){}}),[i,C,r,P,o,I,w,N,c,b.isResizing,e]);return(0,n.vJ)((()=>{const{width:e,height:t,isResizing:a}=b;E.current&&E.current.width===e&&E.current.height===t&&!E.current.isResizing||(E.current={width:e,height:t,isResizing:a},w(a))}),[w,N,b]),(0,n.vJ)((()=>{o?.plannedEvents?.length&&(o.plannedEvents.forEach((e=>{C(e)})),y({key:(0,l.rpZ)(o),update:{plannedEvents:[]}}))}),[C,o]),(0,n.vJ)((()=>(window.addEventListener("message",T),()=>window.removeEventListener("message",T))),[T,e]),(0,n.vJ)((()=>{t&&e.current?.contentWindow?(w(),N(),g.current=!1):E.current=void 0}),[t,a,w,N,e]),{sendEvent:C,sendFullScreenChanged:f,reloadFrame:k,sendViewport:w,sendSafeArea:N,sendTheme:I}})(Ye,Xe,pe,et,(function(e){const{eventType:t,eventData:a}=e;if("web_app_request_fullscreen"===t&&((0,w.cB)()?_({state:"fullScreen"}):at({eventType:"fullscreen_failed",eventData:{error:"UNSUPPORTED"}})),"web_app_exit_fullscreen"===t&&gt(),"web_app_open_tg_link"===t){const e=r.jsp+a.path_full;k({url:e,shouldIgnoreCache:a.force_request}),C()}if("web_app_setup_back_button"===t&&Ue({isBackButtonVisible:a.is_visible}),"web_app_setup_settings_button"===t&&Ue({isSettingsButtonVisible:a.is_visible}),"web_app_set_background_color"===t&&je((0,ui.To)(a.color)?a.color:void 0),"web_app_set_header_color"===t){const e=a.color_key;qe(a.color||(e?Oe[e]:void 0))}if("web_app_set_bottom_bar_color"===t&&le(a.color),"web_app_data_send"===t&&(C(),f({bot:i,buttonText:Ie,data:a.data})),"web_app_setup_main_button"===t){const e=a.color,t=a.text_color;K({isVisible:a.is_visible&&Boolean(a.text?.trim().length),isActive:a.is_active,text:a.text,color:e,textColor:t,isProgressVisible:a.is_progress_visible})}if("web_app_setup_secondary_button"===t){const e=a.color,t=a.text_color;z({isVisible:a.is_visible&&Boolean(a.text?.trim().length),isActive:a.is_active,text:a.text,color:e,textColor:t,isProgressVisible:a.is_progress_visible,position:a.position})}if("web_app_setup_closing_behavior"===t&&Ue({shouldConfirmClosing:!0}),"web_app_open_popup"===t){if(Z||!a.message.trim().length||!a.buttons?.length||a.buttons.length>3||ee||ne||ce>Date.now())return void ht(void 0);X(a),me()}if("web_app_switch_inline_query"===t){const e=a.chat_types?.map(l.XjE).filter(Boolean),t=!e?.length;P({botId:i.id,query:a.query,filter:e,isSamePeer:t}),C()}if("web_app_request_phone"===t){if(Z||ne||ce>Date.now())return void ft();ae(!0),me()}if("web_app_request_write_access"===t){if(Z||ee||ce>Date.now())return void Nt();!async function(){if(!i)return;const e=await(0,$e.px)("fetchBotCanSendMessage",{bot:i});e&&at({eventType:"write_access_requested",eventData:{status:"allowed"}}),se(!e)}(),me()}if("web_app_invoke_custom_method"===t){const{method:e,params:t,req_id:n}=a;!async function(e,t,a){const n=await(0,$e.px)("invokeWebViewCustomMethod",{bot:i,customMethod:t,parameters:a});at({eventType:"custom_method_invoked",eventData:{req_id:e,...n}})}(n,e,JSON.stringify(t))}if("web_app_request_file_download"===t){if(ie||ce>Date.now())return void wt();!async function(e,t){await(0,$e.px)("checkBotDownloadFileParams",{bot:i,url:e,fileName:t})?(re({url:e,fileName:t}),me()):at({eventType:"file_download_requested",eventData:{status:"cancelled"}})}(a.url,a.file_name)}if("web_app_send_prepared_message"===t){if(!i||!Le)return;const{id:e}=a;O({botId:i.id,messageId:e,webAppKey:Le})}if("web_app_request_emoji_status_access"===t){if(!i)return;V({bot:i,webAppKey:Le})}"web_app_check_location"===t&&at({eventType:"location_checked",eventData:{available:Ve,access_requested:De,access_granted:_e}}),"web_app_request_location"===t&&(async()=>{const e=await(0,b.Bu)(),{accessRequested:t,accessGranted:a,geolocation:n}=e;if(!a||!t)return at({eventType:"location_requested",eventData:{available:!1}}),F({message:Qe("PermissionNoLocationPosition")}),void ht(void 0);Ve?De?at({eventType:"location_requested",eventData:{available:v?.geolocation,latitude:n?.latitude,longitude:n?.longitude,altitude:n?.altitude,course:n?.heading,speed:n?.speed,horizontal_accuracy:n?.accuracy,vertical_accuracy:n?.accuracy}}):D({bot:i,webAppKey:Le}):(F({message:Qe("PermissionNoLocationPosition")}),ht(void 0))})(),"web_app_open_location_settings"===t&&Mt()}),a,$);(0,n.vJ)((()=>{Fe&&m(at)}),[at,m,Fe]),(0,n.vJ)((()=>{Fe&&u(tt)}),[tt,u,Fe]);const ot=H&&J?.isVisible&&J.text.trim().length>0,lt=H&&G?.isVisible&&G.text.trim().length>0,ct=(0,M.A)((()=>{Ue({isCloseModalOpen:!1})})),dt=(0,M.A)((()=>{Ue({shouldConfirmClosing:!1,isCloseModalOpen:!1}),setTimeout((()=>{C()}),400)})),mt=(0,M.A)((()=>{Ue({isRemoveModalOpen:!1})})),ut=(0,M.A)((()=>{at({eventType:"main_button_pressed"})})),At=(0,M.A)((()=>{at({eventType:"secondary_button_pressed"})})),ht=(0,M.A)((e=>{X(void 0),ue(),at({eventType:"popup_closed",eventData:{button_id:e}})})),yt=(0,M.A)((()=>{ht()})),pt=(0,M.A)((()=>{rt()}));(0,j.A)((()=>{setTimeout((()=>{pt()}),400)}),[o]);const vt=(0,M.A)((()=>{!(0,be.j9)()&&Fe&&fe?.()})),gt=(0,M.A)((()=>{(0,be.j9)()&&Fe&&Se?.()})),Et=(0,M.A)((e=>{Fe&&nt(e)}));(0,n.vJ)((()=>{pe?(vt(),Et(!0)):(gt(),Et(!1))}),[pe]);const bt=(0,M.A)((e=>{at({eventType:"visibility_changed",eventData:{is_visible:e}})}));(0,n.vJ)((()=>{H&&bt(Boolean(Fe))}),[Fe,H]),(0,mn.A)((e=>{let[t]=e;"minimized"===h&&bt(!1),h&&"minimized"===t&&bt(!0)}),[h]),(0,j.A)((e=>{let[t]=e;c!==t&&a?.slug&&!c&&d&&(at({eventType:"invoice_closed",eventData:{slug:a.slug,status:d}}),N({slug:void 0}),R())}),[c,d,at,a?.slug]);const Ct=(0,M.A)((()=>{S({botId:i.id,isEnabled:!1}),C()})),ft=(0,M.A)((()=>{ae(!1),ue(),at({eventType:"phone_requested",eventData:{status:"cancelled"}})})),St=(0,M.A)((()=>{B({botId:i.id}),ae(!1),ue(),at({eventType:"phone_requested",eventData:{status:"sent"}})})),wt=(0,M.A)((e=>{e&&(re(void 0),ue()),at({eventType:"file_download_requested",eventData:{status:"cancelled"}})})),Nt=(0,M.A)((()=>{at({eventType:"write_access_requested",eventData:{status:"cancelled"}}),se(!1),ue()})),It=(0,M.A)((async()=>{i&&(await(0,$e.px)("allowBotSendMessages",{bot:i})?(at({eventType:"write_access_requested",eventData:{status:"allowed"}}),se(!1),ue()):Nt())})),Pt=(0,M.A)((()=>{ie&&(re(void 0),ue(),(0,Sn.A)(ie.url,ie.fileName),at({eventType:"file_download_requested",eventData:{status:"downloading"}}))}));(0,n.vJ)((()=>{Xe||(X(void 0),ae(!1),se(!1),K(void 0),z(void 0),Ue({isSettingsButtonVisible:!1,shouldConfirmClosing:!1,isBackButtonVisible:!1,isCloseModalOpen:!1,isRemoveModalOpen:!1}),Y())}),[Xe]);const Mt=(0,M.A)((()=>{x({id:i.id})})),Tt=(0,Cn.A)(J?.color,!0),Bt=(0,Cn.A)(J?.textColor,!0),Lt=(0,Cn.A)(J&&Boolean(J.isActive),!0),Rt=(0,Cn.A)(J?.text,!0),xt=(0,Cn.A)(G?.position,!0),Ft=(0,Cn.A)(G?.color,!0),Vt=(0,Cn.A)(G?.textColor,!0),Dt=(0,Cn.A)(G&&Boolean(G.isActive),!0),_t=(0,Cn.A)(G?.text,!0),[Ut,Ot]=(0,n.J0)(!1),[Jt,Kt]=(0,n.J0)(!0),[jt,Gt]=(0,n.J0)(!0),[zt,Ht]=(0,n.J0)(!1),[$t,qt]=(0,n.J0)(!1),[Wt,Yt]=(0,n.J0)(!1),[Qt,Zt]=(0,n.J0)(0);(0,j.A)((()=>{setTimeout((()=>{st(),it()}),A?0:400)}),[$t,jt,zt,zt,G?.position,st,A,E,it]);const Xt="top"===xt||"bottom"===xt,ea=Xt&&zt&&$t?2:zt||$t?1:0,ta=Xt||Jt||jt?"vertical":"horizontal",aa=(0,n.li)(),na=(0,n.li)(),sa=(0,n.li)(),ia=(0,n.li)(),ra=(0,n.li)();(0,n.vJ)((()=>(pe&&Xe&&Boolean(we)?(Yt(!0),ra.current&&clearTimeout(ra.current),ra.current=setTimeout((()=>{Yt(!1),ra.current=void 0}),3800)):(Yt(!1),ra.current&&(clearTimeout(ra.current),ra.current=void 0)),()=>{ra.current&&clearTimeout(ra.current)})),[pe,Xe,we]),(0,n.vJ)((()=>{aa.current&&clearTimeout(aa.current),na.current&&clearTimeout(na.current),ot&&(na.current=setTimeout((()=>{Ht(!0)}),35),Kt(!1),aa.current=setTimeout((()=>{Ot(!0)}),Pi)),ot||(Ht(!1),aa.current=setTimeout((()=>{Kt(!0)}),Pi))}),[ot]),(0,n.vJ)((()=>{sa.current&&clearTimeout(sa.current),ia.current&&clearTimeout(ia.current),lt&&(ia.current=setTimeout((()=>{qt(!0)}),35),Gt(!1),sa.current=setTimeout((()=>{Ot(!0)}),Pi)),lt||(qt(!1),sa.current=setTimeout((()=>{Gt(!0)}),Pi))}),[lt]),(0,n.vJ)((()=>{$t||zt||Ot(!1)}),[Ot,$t,zt]);const oa=A?"pointer-events: none;":"",la=(0,M.A)((()=>{Pe?at({eventType:"back_button_pressed"}):(gt(),nt(!1),_({state:"maximized"}),U())})),ca=(0,M.A)((()=>{gt()})),da=(0,M.A)((e=>{p(e)})),ma=(0,de.A)("BvNtfigU",Pe&&"rC2wkMIk"),ua=Wt?we:Qe(Pe?"Back":"Close"),Aa=ye?.current;return(0,n.vJ)((()=>{Zt(ye?.current?.clientWidth||0)}),[ua,Aa]),n.Ay.createElement("div",{ref:Ae,className:(0,de.A)("LeeJZdwH",!Fe&&Si,y&&"ESsGT5OD")},pe&&(0,w.cB)()&&n.Ay.createElement("div",{className:"eYrhewMy"},n.Ay.createElement("div",{ref:he,className:Ii,onClick:la},n.Ay.createElement("div",{className:"JXsuZ01s"},n.Ay.createElement("div",{className:ma})),n.Ay.createElement("span",{className:"dpZR3YT7",style:`width: ${Qt}px;`},n.Ay.createElement(te.Ay,{activeKey:Wt?0:Pe?1:2,name:"slideFade"},n.Ay.createElement("div",{ref:ye,className:"dWDprnWa"},ua)))),n.Ay.createElement("div",{className:"Tl4_05AQ"},n.Ay.createElement("div",{className:(0,de.A)(Ii,"emOpAMBm"),tabIndex:0,role:"button","aria-label":Ze("WebAppCollapse"),onClick:ca},n.Ay.createElement(q.A,{name:"down",className:Ni})),n.Ay.createElement("div",{className:(0,de.A)(Ii,"z4C5VD5o"),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":Ze("AriaMoreButton"),onClick:da},n.Ay.createElement(q.A,{name:"more",className:(0,de.A)(Ni,"T58ozRyW")})))),!ve&&(Me?n.Ay.createElement("svg",{className:(0,de.A)(bi,H&&fi),viewBox:"0 0 512 512"},n.Ay.createElement("path",{className:"Gx1BIECZ",d:Me})):function(){const e=(0,de.A)(bi,"Ig_t1R7i",H&&fi);return n.Ay.createElement("div",{className:e},n.Ay.createElement("div",{className:Ci}),n.Ay.createElement("div",{className:Ci}),n.Ay.createElement("div",{className:Ci}),n.Ay.createElement("div",{className:Ci}))}()),n.Ay.createElement("iframe",{className:(0,de.A)("OmY14FFl",Ut&&"liDRl1xT",!H&&fi),style:oa,src:Ne,title:`${i?.firstName} Web App`,sandbox:Mi,allow:"camera; microphone; geolocation;",allowFullScreen:!0,ref:Ye}),!ve&&n.Ay.createElement("div",{style:`background-color: ${oe};`,className:(0,de.A)("mR_hsBdT","left"===xt&&"ntESqwQ_","right"===xt&&"q6IUFEL0","top"===xt&&"gb4iHJ9H","bottom"===xt&&"R_bh3GF8","horizontal"===ta&&"oYaRA7u4",1===ea&&"YfQO314y",2===ea&&"gUldkEoy")},n.Ay.createElement(W.A,{className:(0,de.A)("ypxiUCFQ",$t&&!jt&&ki,jt&&Si),fluid:!0,style:`background-color: ${Ft}; color: ${Vt}`,disabled:!Dt&&!G?.isProgressVisible,nonInteractive:G?.isProgressVisible,onClick:At,size:"smaller"},!G?.isProgressVisible&&_t,G?.isProgressVisible&&n.Ay.createElement(Re.A,{className:wi,color:"blue"})),n.Ay.createElement(W.A,{className:(0,de.A)("U_ggDKn1",zt&&!Jt&&ki,Jt&&Si),fluid:!0,style:`background-color: ${Tt}; color: ${Bt}`,disabled:!Lt&&!J?.isProgressVisible,nonInteractive:J?.isProgressVisible,onClick:ut,size:"smaller"},!J?.isProgressVisible&&Rt,J?.isProgressVisible&&n.Ay.createElement(Re.A,{className:wi,color:"white"}))),Z&&n.Ay.createElement(Q.A,{isOpen:Boolean(Z),title:Z.title||" ",onClose:yt,hasCloseButton:!0,className:(0,de.A)("YEOURXza",!Z.title?.trim().length&&"gvljUzY9")},Z.message,n.Ay.createElement("div",{className:"dialog-buttons mt-2"},Z.buttons.map((e=>n.Ay.createElement(W.A,{key:e.id||e.type,className:"confirm-dialog-button",color:"destructive"===e.type?"danger":"primary",isText:!0,size:"smaller",onClick:()=>ht(e.id)},e.text||Qe(Ti[e.type])))))),n.Ay.createElement(tn.A,{isOpen:ee,onClose:ft,title:Qe("ShareYouPhoneNumberTitle"),text:Qe("AreYouSureShareMyContactInfoBot"),confirmHandler:St,confirmLabel:Qe("ContactShare")}),n.Ay.createElement(tn.A,{isOpen:ne,onClose:Nt,title:Qe("lng_bot_allow_write_title"),text:Qe("lng_bot_allow_write"),confirmHandler:It,confirmLabel:Qe("lng_bot_allow_write_confirm")}),n.Ay.createElement(tn.A,{isOpen:Boolean(ie),title:Qe("BotDownloadFileTitle"),textParts:Ze("BotDownloadFileDescription",{bot:i?.firstName,filename:ie?.fileName},{withNodes:!0,withMarkdown:!0}),confirmLabel:Qe("BotDownloadFileButton"),onClose:wt,confirmHandler:Pt}),n.Ay.createElement(tn.A,{isOpen:Te,onClose:ct,title:Qe("lng_bot_close_warning_title"),text:Qe("lng_bot_close_warning"),confirmHandler:dt,confirmIsDestructive:!0,confirmLabel:Qe("lng_bot_close_warning_sure")}),n.Ay.createElement(tn.A,{isOpen:Be,onClose:mt,title:Qe("BotRemoveFromMenuTitle"),textParts:(0,kt.A)(Qe("BotRemoveFromMenu",i?.firstName),["simple_markdown"]),confirmHandler:Ct,confirmIsDestructive:!0}))}))),Li="oHX2d8Or",Ri="O4NxErFX",xi="dgdyQDsZ",Fi="xGefqS93",Vi="f7EicoVH",Di="s6pBIYMI",_i="txS0KiU0",Ui="XpHR_yo0",Oi="DoeOewUR",Ji="YRMGpqUS",Ki="b13oE9uA",ji={width:300,height:40},Gi={width:420,height:730},zi={width:300,height:300},Hi=(0,n.ph)((0,s.EK)(((e,t)=>{let{modal:a}=t;const n=a?.activeWebAppKey?(0,c.wtp)(e,a.activeWebAppKey):void 0,{botId:s}=n||{};return{attachBot:s?e.attachMenu.bots[s]:void 0,bot:s?(0,c.mBe)(e,s):void 0,chat:(0,c.meB)(e),theme:(0,c.SJA)(e),cachedPosition:e.settings.miniAppsCachedPosition,cachedSize:e.settings.miniAppsCachedSize}}))((e=>{let{modal:t,chat:a,bot:i,attachBot:o,theme:l,cachedSize:c,cachedPosition:d}=e;const{closeActiveWebApp:m,closeWebAppModal:u,prolongWebView:A,toggleAttachBot:h,openChat:y,changeWebAppModalState:p,openWebAppTab:v,updateWebApp:g,openMoreAppsTab:E,closeMoreAppsTab:b,updateMiniAppCachedPosition:f,updateMiniAppCachedSize:S}=(0,s.ko)(),[k,N]=(0,n.Ul)(c||Gi);function P(){return"fullScreen"===t?.modalState?C.A.get():"maximized"===t?.modalState?k():ji}const{openedWebApps:B,activeWebAppKey:L,openedOrderedKeys:R,sessionKeys:x,isMoreAppsTabActive:F}=t||{},V=L?B?.[L]:void 0,{isBackButtonVisible:D,headerColor:_,backgroundColor:U,isSettingsButtonVisible:O}=V||{},J=(0,n.Kr)((()=>R?.map((e=>{const t=B[e];return{bot:(0,s.mS)().users.byId[t.botId],webApp:t,isOpen:Boolean(V&&e===(0,ei.rp)(V))}}))),[R,B,V]),{isMobile:K}=(0,w.Ay)(),j=t?.isModalOpen||!1,G="maximized"===t?.modalState,z="minimized"===t?.modalState,H="fullScreen"===t?.modalState,$=!K,Y=(0,n.li)(null),Z=(0,n.li)(null),X=(0,n.li)(null),ee=(0,M.A)((()=>Y.current)),te=(0,M.A)((()=>Y.current)),ae=(0,M.A)((()=>X.current)),{isContextMenuOpen:ne,contextMenuAnchor:se,handleContextMenu:ie,handleContextMenuClose:le,handleContextMenuHide:ce}=(0,si.A)(Y),[ue,Ae]=(0,n.J0)(!1),he=Z.current,ye=Y.current;(0,n.vJ)((()=>{Ae(Boolean($&&he&&ye&&!H))}),[$,he,ye,H]),(0,n.vJ)((()=>{p({state:"maximized"})}),[$]);const{isDragging:pe,isResizing:ve,style:ge,size:Ee,position:be}=function(e,t){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{width:0,height:0},l=arguments.length>6?arguments[6]:void 0;const[c,d]=(0,n.J0)(l),[m,u]=(0,n.J0)(void 0),[A,h]=(0,n.Ul)({x:0,y:0}),[y,p]=(0,n.Ul)({width:0,height:0}),[v,g]=(0,n.Ul)({x:0,y:0}),E=A(),b=v(),C=e.current,f=t.current,[S,k]=(0,I.A)(!1),[w,N]=(0,I.A)(!1),[P,T,B]=(0,I.A)(!1),[L,R,x]=(0,I.A)(!1),[F,V,D]=(0,I.A)(!1),[_,U]=(0,n.J0)(void 0);function O(){return{width:window.innerWidth,height:window.innerHeight}}const J=(0,M.A)((e=>{i||d({x:e.x,y:e.y})})),K=(0,M.A)((()=>i?ci:c)),j=(0,M.A)((()=>{if(!m)return;const{width:e,height:t}=m,a=O();return{x:(a.width-e)/2,y:(a.height-t)/2}}));(0,n.vJ)((()=>{C&&N()}),[C]),(0,n.vJ)((()=>{if(!S&&m){const e=j();if(!e)return;J(e),k()}}),[m,S,C]);const G=(0,M.A)((e=>{if(e instanceof MouseEvent&&0!==e.button)return;if(e.target.closest(".no-drag")||!C)return;const{pageX:t,pageY:a}="touches"in e?e.touches[0]:e,{left:n,top:s}=C.getBoundingClientRect();h({x:n,y:s}),g({x:t,y:a}),T()})),z=(0,M.A)((e=>{if(e instanceof MouseEvent&&0!==e.button)return;const t=e.target;if(!C||!t)return;const a=function(e){const t=t=>e.closest(t);if(t(r.cnh))for(const e of oi)if(t(`.${e}`))return ri[e]}(t);if(void 0===a)return;U(a);const{pageX:n,pageY:s}="touches"in e?e.touches[0]:e,{left:i,right:o,top:l,bottom:c}=C.getBoundingClientRect();h({x:i,y:l}),p({width:o-i,height:c-l}),g({x:n,y:s}),R()})),H=(0,M.A)((()=>{B()})),$=(0,M.A)((()=>{x()}));(0,n.vJ)((()=>{a||B()}),[a]);const q=(e,t)=>{const a=O(),n=a.width,s=a.height,i=m.width,r=m.height;let o=e,l=t;return o<0&&(o=0),l<0&&(l=0),o+i>n&&(o=n-i),l+r>s&&(l=s-r),{x:o,y:l}},W=(0,M.A)((()=>{if(i)return;const e=w||l?c:j();if(!m||!e)return;const t=q(e.x,e.y);J(t)})),Y=(0,M.A)((e=>{const t=e,a=O(),n=s.width,i=s.height;return t.width=Math.min(a.width,Math.max(n,t.width)),t.height=Math.min(a.height,Math.max(i,t.height)),t}));(0,n.vJ)((()=>{if(L)return;const e=Y({width:s.width,height:s.height});e&&u(e)}),[s,L]);const Q=(0,M.A)((()=>{if(!m||L)return;const e=Y(m);e&&u(e)}));(0,n.vJ)((()=>{L||W()}),[m,L]),(0,n.vJ)((()=>{const e=()=>{V(),Q(),W(),li&&(clearTimeout(li),li=void 0),li=window.setTimeout((()=>{li=void 0,D()}),250)};return window.addEventListener("resize",e),()=>{clearTimeout(li),li=void 0,window.removeEventListener("resize",e)}}),[W]);const Z=(0,M.A)((e=>{if(!P||!C)return;const{pageX:t,pageY:a}="touches"in e?e.touches[0]:e,n=t-b.x,s=a-b.y,i=E.x+n,r=E.y+s;m&&d(q(i,r))})),X=(0,M.A)((e=>{if(!L||!C||void 0===_)return;const{pageX:t,pageY:a}="touches"in e?e.touches[0]:e,n=y(),s=Math.min(Math.max(0,t),O().width),i=Math.min(Math.max(0,a),O().height),r=s-b.x,l=i-b.y,c=E.x+n.width-o.width,m=E.y+n.height-o.height,A={x:E.x,y:E.y,width:n.width,height:n.height};_!==ii.Left&&_!==ii.TopLeft&&_!==ii.BottomLeft||(A.width=Math.max(n.width-r,o.width),A.x=Math.min(A.x+r,c)),_!==ii.Right&&_!==ii.TopRight&&_!==ii.BottomRight||(A.width=Math.max(n.width+r,o.width)),_!==ii.Top&&_!==ii.TopLeft&&_!==ii.TopRight||(A.height=Math.max(n.height-l,o.height),A.y=Math.min(A.y+l,m)),_!==ii.Bottom&&_!==ii.BottomLeft&&_!==ii.BottomRight||(A.height=Math.max(n.height+l,o.height)),u({width:A.width,height:A.height}),d({x:A.x,y:A.y})}));(0,n.vJ)((()=>{let e;return f&&a&&(e=(0,me.wJ)(f,{onCapture:G,onDrag:Z,onRelease:H,onClick:H,onDoubleClick:H})),e}),[a,f]),(0,n.vJ)((()=>{const e=[];if(C&&a)for(const t of oi){const a=C.querySelector(`.resizeHandle.${t}`);if(a){const t=(0,me.wJ)(a,{onCapture:z,onDrag:X,onRelease:$,onClick:$,onDoubleClick:$});t&&e.push(t)}}return()=>{e.forEach((e=>e()))}}),[a,C]);const ee=P?"cursor: grabbing !important; ":"",te=K();if(!S||!m||!te)return{isDragging:!1,style:ee};const ae=(0,gn.A)(`left: ${te.x}px;`,`top: ${te.y}px;`,!i&&`max-width: ${m.width}px;`,!i&&`max-height: ${m.height}px;`,"position: fixed;",(P||L||F)&&"transition: none !important;",ee);return{position:c,size:m,isDragging:P,isResizing:L,style:ae}}(Y,Z,ue,P(),H,function(){if("maximized"===t?.modalState)return zi}(),d),Ce=be?.x,fe=be?.y;(0,n.vJ)((()=>{pe||void 0===Ce||void 0===fe||f({position:{x:Ce,y:fe}})}),[pe,Ce,fe]),(0,n.vJ)((()=>{!pe&&Ee&&G&&S({size:Ee})}),[pe,G,Ee]);const Se=Ee||P(),ke=Se.width,we=Se.height;(0,n.vJ)((()=>{ve&&N({width:ke,height:we})}),[we,ke,ve,N]);const Ne=(0,T.A)(),Ie=(0,Us.A)(),{queryId:Pe}=V||{},Me=B?Object.values(B).length:0;(0,ni.A)((()=>{B&&Object.keys(B).forEach((e=>{const t=B[e];t.queryId&&A({botId:t.botId,queryId:t.queryId,peerId:t.peerId||a.id,replyInfo:t.replyInfo})}))}),Pe?45e3:void 0,!0);const Te=(0,n.li)(null),Be=(0,n.li)(null),Le=(0,M.A)((e=>{Te.current=e})),Re=(0,M.A)((e=>{Te.current&&Te.current(e)})),xe=(0,M.A)((e=>{Be.current=e})),Fe=(0,M.A)((e=>{Be.current&&Be.current(e)})),Ve=(0,M.A)((()=>{Re({eventType:"settings_button_pressed"})})),De=(0,M.A)((()=>{Fe(V.url)})),_e=(0,M.A)((()=>{u()})),Ue=(0,M.A)((()=>{b()})),Oe=(0,M.A)((()=>{Me>1?m():u()})),Je=(0,M.A)((()=>{if(o){const e=(0,ei.rp)(V);g({key:e,update:{isRemoveModalOpen:!0}})}else h({botId:i.id,isEnabled:!0})})),Ke=(0,M.A)((()=>{D?Re({eventType:"back_button_pressed"}):_e()})),je=(0,M.A)((()=>{p({state:"minimized"})})),ze=(0,M.A)((()=>{p({state:"fullScreen"})})),He=(0,M.A)((()=>{E()})),$e=(0,M.A)((e=>{v({webApp:e.webApp})})),qe=(0,M.A)((()=>{y({id:i.id})})),We=(0,n.Kr)((()=>e=>{let{onTrigger:t,isOpen:a}=e;return n.Ay.createElement(W.A,{className:(0,de.A)($?"gkji2_RB":"kKPD09tc",a&&"active"),round:!0,ripple:!K,size:$?"tiny":"smaller",color:"translucent",onClick:t,ariaLabel:"More actions"},n.Ay.createElement(q.A,{name:"more"}))}),[K,$]);function Ye(){return n.Ay.createElement(n.Ay.Fragment,null,a&&i&&a.id!==i.id&&n.Ay.createElement(oe.A,{icon:"bots",onClick:qe},Ne("BotWebViewOpenBot")),n.Ay.createElement(oe.A,{icon:"reload",onClick:De},Ne("WebApp.ReloadPage")),O&&n.Ay.createElement(oe.A,{icon:"settings",onClick:Ve},Ne("Settings")),i?.isAttachBot&&n.Ay.createElement(oe.A,{icon:o?"stop":"install",onClick:Je,destructive:Boolean(o)},Ne(o?"WebApp.RemoveBot":"WebApp.AddToAttachmentAdd")))}function Qe(){return n.Ay.createElement(Ge.A,{isOpen:ne,anchor:se,ref:X,className:(0,de.A)($?_i:"web-app-more-menu","with-menu-transitions"),getTriggerElement:ee,getMenuElement:ae,getRootElement:te,autoClose:!0,onClose:le,onCloseAnimationEnd:ce},Ye())}const Ze=(0,de.A)("RuJ3d9N6",D&&"IWA50OWU"),Xe=(0,n.Kr)((()=>{if(F)return"color-text";if(!_)return;const{r:e,g:t,b:a}=(0,ai.E2)(_),n=(0,ti.LS)([e,t,a]);return("dark"===l?255-n:n)>128?"color-text":"color-background"}),[_,l,F]);function et(e){return n.Ay.createElement("svg",{className:e,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},n.Ay.createElement("path",{className:"bOuMHiVw","fill-rule":"evenodd","clip-rule":"evenodd",d:"M16 16V0C16 12 12 16 0 16H16Z"}))}const tt=(0,n.li)(null);function at(e){return(0,de.A)(r.jQ1,e)}return(0,di.A)(tt,!j||z||!tt.current),n.Ay.createElement(Q.A,{dialogRef:Y,className:(0,de.A)("XWfkIDLY",$&&"gBVR7Hec",z&&"dJ1Ld_PX",H&&"ciSTWz16"),dialogStyle:$?ge:void 0,dialogContent:ue?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:at("top")}),n.Ay.createElement("div",{className:at("bottom")}),n.Ay.createElement("div",{className:at("left")}),n.Ay.createElement("div",{className:at("right")}),n.Ay.createElement("div",{className:at("topLeft")}),n.Ay.createElement("div",{className:at("topRight")}),n.Ay.createElement("div",{className:at("bottomLeft")}),n.Ay.createElement("div",{className:at("bottomRight")})):void 0,isOpen:j,isLowStackPriority:!0,onClose:_e,header:n.Ay.createElement("div",{ref:Z},$?G?n.Ay.createElement("div",{className:(0,de.A)("modal-header","multiTab"),style:(0,gn.A)(Xe&&`--color-header-text: var(--${Xe})`)},n.Ay.createElement(W.A,{className:"GE5AkJOU",round:!0,color:"translucent",size:"tiny",ariaLabel:Ne(D?"Back":"Close"),onClick:Ke},n.Ay.createElement("div",{className:Ze})),n.Ay.createElement("div",{className:"X18WbDa5",ref:tt},J?.map((e=>e.isOpen?function(){const e=(0,gn.A)(Xe&&`--color-header-text: var(--${Xe})`,_&&`--active-tab-background: ${_}`);return n.Ay.createElement("div",{className:Li,style:e},et(Vi),n.Ay.createElement("div",{className:Ri},n.Ay.createElement("div",{className:"z39ojrWc"},n.Ay.createElement(wt.A,{size:"mini",peer:i}),n.Ay.createElement(We,{onTrigger:ie,isOpen:ne})),o?.shortName??i?.firstName,n.Ay.createElement("div",{className:xi}),n.Ay.createElement(W.A,{className:Fi,round:!0,color:"translucent",size:"tiny",ariaLabel:Ne("Close"),onClick:Oe},n.Ay.createElement(q.A,{className:Oi,name:"close"}))),et(Di))}():n.Ay.createElement(wt.A,{className:"tI6TE6HP",size:"mini",peer:e.bot,onClick:()=>$e(e)}))),F&&n.Ay.createElement("div",{className:Li},et(Vi),n.Ay.createElement("div",{className:Ri},n.Ay.createElement("div",{className:"Obu3ui67"},n.Ay.createElement(q.A,{className:Ki,name:"add"})),Ie("OpenApp"),n.Ay.createElement("div",{className:xi}),n.Ay.createElement(W.A,{className:Fi,round:!0,color:"translucent",size:"tiny",ariaLabel:Ne("Close"),onClick:Ue},n.Ay.createElement(q.A,{className:Oi,name:"close"}))),et(Di))),Qe(),n.Ay.createElement("div",{className:"qK4q0Sat"},!F&&n.Ay.createElement(W.A,{className:(0,de.A)("cEuW1_hJ","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:He},n.Ay.createElement(q.A,{className:Ki,name:"add"})),!F&&n.Ay.createElement(W.A,{className:(0,de.A)(Ui,"otlJULGy","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:ze},n.Ay.createElement(q.A,{className:Ji,name:"expand-modal"})),n.Ay.createElement(W.A,{className:(0,de.A)(Ui,"no-drag"),round:!0,color:"translucent",size:"tiny",onClick:je},n.Ay.createElement(q.A,{className:Ji,name:"collapse-modal"})))):n.Ay.createElement(mi,null):n.Ay.createElement("div",{className:"modal-header",style:(0,gn.A)(_&&`background-color: ${_}`,Xe&&`--color-header-text: var(--${Xe})`)},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ne(D?"Back":"Close"),onClick:Ke},n.Ay.createElement("div",{className:Ze})),n.Ay.createElement("div",{className:"modal-title"},o?.shortName??i?.firstName),!F&&n.Ay.createElement(re.A,{className:(0,de.A)($?_i:"web-app-more-menu","with-menu-transitions"),trigger:We,positionX:$?"left":"right"},Ye()))),style:`background-color: ${U||"var(--color-background)"}`,noBackdrop:!0,noBackdropClose:!0},H&&Qe(),B&&x?.map((e=>n.Ay.createElement(Bi,{key:e,modal:t,registerSendEventCallback:Le,registerReloadFrameCallback:xe,webApp:B[e],isTransforming:pe||ve,onContextMenuButtonClick:ie,isMultiTabSupported:$,modalHeight:we}))),F&&n.Ay.createElement(gi,null))}))),$i=(0,n.ph)((e=>{let{bot:t,type:a,shouldRequestWriteAccess:i}=e;const{cancelBotTrustRequest:r,markBotTrusted:o}=(0,s.ko)(),[c,d]=(0,n.J0)(i||!1),m=(0,T.A)(),u=(0,n.hb)((()=>{o({botId:t.id,isWriteAllowed:c})}),[o,c,t]),A=(0,n.hb)((()=>{r()}),[]),h=m("game"===a?"AppName":"BotOpenPageTitle"),y=(0,n.Kr)((()=>{switch(a){case"game":return m("BotPermissionGameAlert",(0,l.YgS)(t));case"webApp":return m("BotOpenPageMessage",(0,l.YgS)(t));default:return m("BotWebViewStartPermission")}}),[t,a,m]);return n.Ay.createElement(tn.A,{isOpen:Boolean(t),onClose:A,title:h,confirmHandler:u},(0,kt.A)(y,["simple_markdown"]),i&&n.Ay.createElement(js.A,{className:"dialog-checkbox",checked:c,label:(0,kt.A)(m("WebApp.AddToAttachmentAllowMessages",t?.firstName),["simple_markdown"]),onCheck:d}))})),qi=(0,n.ph)((e=>{let{modal:t}=e;const{confirmAttachBotInstall:a,cancelAttachBotInstall:i}=(0,s.ko)(),o=t?.bot,[l,c]=(0,n.J0)(!1),d=(0,T.A)(),m=(0,n.hb)((()=>{a({isWriteAllowed:Boolean(o?.shouldRequestWriteAccess)})}),[a,o]);(0,n.vJ)((()=>{o&&c(!1)}),[o]);const u=(0,n.Kr)((()=>{const e=d("lng_mini_apps_disclaimer_button").split("{link}"),t=d("lng_mini_apps_disclaimer_link");return[e[0],n.Ay.createElement("a",{href:r.Pje,target:"_blank",rel:"noopener noreferrer"},t),e[1]]}),[d]);return n.Ay.createElement(tn.A,{isOpen:Boolean(o),onClose:i,title:d("lng_mini_apps_disclaimer_title"),confirmHandler:m,isConfirmDisabled:!l},(0,kt.A)(d("lng_mini_apps_disclaimer_text",o?.shortName),["simple_markdown"]),n.Ay.createElement(js.A,{className:"dialog-checkbox",checked:l,label:u,onCheck:c}),(0,kt.A)(d("WebBot.Account.Desclaimer.Desc",o?.shortName),["simple_markdown"]))})),Wi=(0,n.ph)((e=>{let{folder:t}=e;const{closeDeleteChatFolderModal:a,deleteChatFolder:i,openDeleteChatFolderModal:r}=(0,s.ko)(),o=(0,T.A)(),l=Boolean(t),c=(0,D.A)(t)||t,d=c?.hasMyInvites,m=(0,n.hb)((()=>{a(),d?r({folderId:c.id,isConfirmedForChatlist:!0}):i({id:c.id})}),[d,c]);return n.Ay.createElement(tn.A,{isOpen:l,onClose:a,text:o(d?"FilterDeleteAlertLinks":"FilterDeleteAlert"),confirmLabel:o("Delete"),confirmHandler:m,confirmIsDestructive:!0})}));var Yi=a(64520),Qi=a(17142),Zi=a(87412);const Xi={root:"Wn7D2H1e",text:"IQ1U2TrZ",header:"F6qqXRvD",description:"ILLaH6qQ",icon:"DzGwbpu5","font-icon":"Pa9h5mh3",fontIcon:"Pa9h5mh3"},er=["#F2862D","#EB7B4D","#E46D72","#DD6091","#CC5FBA","#B464E7","#9873FF","#768DFF","#55A5FC","#52B0C9","#4FBC93","#4CC663"].map(ai.E2),tr=(0,n.ph)((e=>{let{icon:t,isFontIcon:a,title:s,text:i,index:r,count:o,section:l,onClick:c}=e;const d=r/o*er.length,m=er[Math.floor(d)],u=er[Math.ceil(d)]??m,{r:A,g:h,b:y}=(0,ai.dD)(m,u,.5),p=(0,M.A)((()=>{c?.(l)}));return n.Ay.createElement(Wa.A,{buttonClassName:Xi.root,onClick:p,inactive:!c},a?n.Ay.createElement(q.A,{name:t,className:Xi.fontIcon,style:`--item-color: rgb(${A},${h},${y})`}):n.Ay.createElement("img",{src:t,className:Xi.icon,alt:"",style:`--item-color: rgb(${A},${h},${y})`,draggable:!1}),n.Ay.createElement("div",{className:Xi.text},n.Ay.createElement("div",{className:Xi.title},(0,kt.A)(s,["br"])),n.Ay.createElement("div",{className:Xi.description},i)))}));var ar=a(57446);const nr="cqNhvdib",sr="wDzTWXzO",ir=(0,n.ph)((e=>{let{length:t,active:a,onSelectSlide:s}=e;const i=Math.max(0,Math.min(t-8,a-4)),r=i===t-8-1,o=i===t-8,l=0===i,c=1===i,d=Math.min(t,8),m=(0,n.hb)((()=>{s(a+1)}),[a,s]),u=(0,n.hb)((()=>{s(a-1)}),[a,s]),A=Math.min(8,t);return n.Ay.createElement("div",null,!b.TF&&n.Ay.createElement(W.A,{className:(0,de.A)(nr,0===a&&sr),color:"translucent",disabled:0===a,round:!0,onClick:u},n.Ay.createElement(q.A,{name:"previous"})),n.Ay.createElement("div",{className:"HmY1pYD9",style:`--start-from: ${i}; --length: ${t}; --count: ${A};`},Array(t).fill(void 0).map(((e,t)=>{const m=t,u=t===i+d-1&&!o&&!r,A=t===i+d-2&&!r&&!o||t===i+d-1&&r,h=t===i&&!l&&!c,y=t===i+1&&!l&&!c||t===i&&c,p=t<i||t>=i+d;return n.Ay.createElement("div",{onClick:()=>s(t),className:(0,de.A)("Ac0pMX9w",m===a&&"NYDxCNdz",(A||y)&&"yDo_8Y7X",(u||h||p)&&"bhODNwmU",p&&"O9pyrgj0")})}))),!b.TF&&n.Ay.createElement(W.A,{className:(0,de.A)(nr,a===t-1&&sr,"hIgQCprt"),color:"translucent",round:!0,disabled:a===t-1,onClick:m},n.Ay.createElement(q.A,{name:"next"})))})),rr="Hy5kWx0p",or=(0,n.ph)((e=>{let{leftValue:t,rightValue:a,className:s,floatingBadgeIcon:i,rightStyle:r}=e;const o=(0,T.A)();return n.Ay.createElement("div",{className:(0,de.A)("u84X0r2z",s)},i&&n.Ay.createElement("div",{className:"hPi4fICJ"},n.Ay.createElement(q.A,{name:i,className:"XkiOXdMP"}),n.Ay.createElement("div",{className:"iC3LJrvy",dir:o.isRtl?"rtl":void 0},t),n.Ay.createElement("div",{className:"jufjjcX9"},n.Ay.createElement("svg",{width:"26",height:"9",viewBox:"0 0 26 9",fill:"none"},n.Ay.createElement("path",{d:"M0 0H26H24.4853C22.894 0 21.3679 0.632141 20.2426 1.75736L14.4142 7.58579C13.6332 8.36684 12.3668 8.36683 11.5858 7.58579L5.75736 1.75736C4.63214 0.632139 3.10602 0 1.51472 0H0Z",fill:"#7E85FF"})))),n.Ay.createElement("div",{className:(0,de.A)(rr,"scGr4JS9")},n.Ay.createElement("div",{className:"OejVAPj6 YaiSoFKE YaiSoFKE",dir:o.isRtl?"rtl":void 0},o("LimitFree")),!i&&n.Ay.createElement("div",{className:"RJosx238 YaiSoFKE"},t)),n.Ay.createElement("div",{className:(0,de.A)(rr,"nPaUalQf"),style:r},n.Ay.createElement("div",{className:"COQdFBQk YaiSoFKE YaiSoFKE",dir:o.isRtl?"rtl":void 0},o("LimitPremium")),n.Ay.createElement("div",{className:"BEq3jFlz YaiSoFKE YaiSoFKE"},a)))})),lr=[91,160,255],cr=[197,100,243],dr=(0,n.ph)((e=>{let{title:t,description:a,leftValue:s,rightValue:i,colorStepProgress:r}=e;const o=(0,n.Kr)((()=>lr.map(((e,t)=>(0,ue.Cc)(e,cr[t],r)))),[r]);return n.Ay.createElement("div",{className:"ZXp65Wgy"},n.Ay.createElement("div",{className:"W1xG3pjS"},t),n.Ay.createElement("div",{className:"b_CBXIkT"},a),n.Ay.createElement(or,{leftValue:s,rightValue:i,rightStyle:`background: rgb(${o.join(",")})`}))}));var mr=a(67054),ur=a(18104);const Ar=e=>{let{size:t,realIndex:a,canPlay:s,sticker:i,index:r,maxLength:o,onClick:l,onEnded:c}=e;const d=(0,G.A)(`sticker${i.id}`),m=(0,G.A)(`sticker${i.id}?size=f`),u=0===r,[A,h,y]=(0,I.A)(u),p=t-.6*t,v=3*p,g=3.2*p,E=r/o*(2*Math.PI),b=u?1:.66,C=Math.cos(E)*v-2.8*p,f=Math.sin(E)*g,S=(0,M.A)((()=>{l(a)})),k=(0,M.A)((()=>{y(),c(a)}));return(0,n.vJ)((()=>{u&&h()}),[u,h]),n.Ay.createElement(n.Ay.Fragment,null,u&&n.Ay.createElement(ur.A,{className:"Stdz4UIW ogaoEAcn",tgsUrl:m,play:s,isLowPriority:!0,noLoop:!0,size:.8*t,style:`--x: calc(${C}px - 10%); --y: ${f}px;`}),n.Ay.createElement(ur.A,{className:"ogaoEAcn",tgsUrl:d,play:s&&A,noLoop:!0,size:.6*t,style:`--x: ${C}px; --y: ${f}px; --opacity: ${b}`,onClick:S,onEnded:k}))},hr=(0,n.ph)((0,s.EK)((e=>({stickers:e.stickers.premium.stickers})))((e=>{let{stickers:t,isActive:a}=e;const s=(0,n.li)(null),[i,r]=(0,n.J0)(0),[o,l]=(0,n.J0)(0),c=t?.slice(0,15),d=(0,M.A)((e=>{r(-e)})),m=(0,M.A)((e=>{0===(0,mr.A)(c.length,e+i)&&setTimeout((()=>{r((e=>(0,mr.A)(c.length,e+1)))}),150)}));return(0,n.vJ)((()=>{const e=s.current;e&&l(e.closest(".modal-dialog").clientWidth)}),[]),n.Ay.createElement("div",{className:"O1fqNCy0",ref:s},Boolean(o)&&c?.map(((e,t)=>n.Ay.createElement(Ar,{size:o,sticker:e,realIndex:t,index:(t+i+c.length)%c.length,maxLength:c.length,onClick:d,onEnded:m,canPlay:a}))))})));var yr=a(38691),pr=a(88554);const vr={stories_order:"PremiumStoriesPriority",stories_stealth:"PremiumStoriesStealth",stories_views:"PremiumStoriesViews",stories_timer:"lng_premium_stories_subtitle_expiration",stories_save:"PremiumStoriesSaveToGallery",stories_caption:"lng_premium_stories_subtitle_caption",stories_link:"lng_premium_stories_subtitle_links"},gr={stories_order:"PremiumStoriesPriorityDescription",stories_stealth:"PremiumStoriesStealthDescription",stories_views:"PremiumStoriesViewsDescription",stories_timer:"PremiumStoriesExpirationDescription",stories_save:"PremiumStoriesSaveToGalleryDescription",stories_caption:"PremiumStoriesCaptionDescription",stories_link:"PremiumStoriesFormattingDescription"},Er={stories_order:"story-priority",stories_stealth:"eye-closed-outline",stories_views:"eye-outline",stories_timer:"timer",stories_save:"arrow-down-circle",stories_caption:"story-caption",stories_link:"link-badge"},br=Object.keys(vr),Cr=wt.R.giant+.25*A.$,fr=(0,n.ph)((0,s.EK)((e=>({currentUser:(0,c.mBe)(e,e.currentUserId)})))((e=>{let{currentUser:t}=e;const a=(0,n.li)(null),s=(0,T.A)(),i=(0,yr.A)();(0,n.Nf)((()=>{a.current&&(0,pr.$)({canvas:a.current,size:Cr*i,segmentsCount:8,color:"purple",readSegmentsCount:0,readSegmentColor:"transparent",dpr:i})}),[i]);const{handleScroll:r,isAtBeginning:o}=is(),l=Cr;return n.Ay.createElement("div",{className:"mFElmm7a"},n.Ay.createElement("div",{className:"Jjbochk6"},n.Ay.createElement(wt.A,{forPremiumPromo:!0,peer:t,size:"giant"}),n.Ay.createElement("canvas",{className:"ChteQ9C3",ref:a,style:`max-width: ${l}px; max-height: ${l}px`})),n.Ay.createElement("div",{className:"d2ayix6L"},s("UpgradedStories")),n.Ay.createElement("div",{className:(0,de.A)("ensyCeMe",!o&&"iN1T0a2Y","custom-scroll"),onScroll:r},br.map(((e,t)=>n.Ay.createElement(tr,{key:e,title:s(vr[e]),text:s(gr[e]),icon:Er[e],isFontIcon:!0,index:t,count:br.length,section:e}))),n.Ay.createElement("div",{className:"DFbZJafh"},s("lng_premium_stories_about_mobile"))))}))),Sr={root:"Ot0dA1yZ",wrapper:"yxSAGAc1",down:"Jcy6cDoc",frame:"Vn81yTTJ",video:"rrVJClLL"},kr=a.p+"telegram-a.DeviceFrame.79271ee0fa60a7b6a1aa.svg",wr=(0,n.ph)((e=>{let{videoId:t,isReverseAnimation:a,isDown:s,videoThumbnail:i,index:r,isActive:o}=e;const l=(0,G.A)(`document${t}`),c=(0,wn.A)(i.dataUri),d=(0,In.A)(l);return n.Ay.createElement("div",{className:Sr.root},n.Ay.createElement("div",{className:(0,de.A)(Sr.wrapper,a&&Sr.reverse,s&&Sr.down),id:`premium_feature_preview_video_${r}`},n.Ay.createElement("img",{src:kr,alt:"",className:Sr.frame,draggable:!1}),n.Ay.createElement("canvas",{ref:c,className:Sr.video}),n.Ay.createElement(Ln.A,{canPlay:o,className:(0,de.A)(Sr.video,d),src:l,disablePictureInPicture:!0,playsInline:!0,muted:!0,loop:!0})))})),Nr="a7IoUtQG",Ir="gubS9KP1",Pr="iZLwcL8v",Mr="A7YHY8qF",Tr={double_limits:"PremiumPreviewLimits",infinite_reactions:"PremiumPreviewReactions2",premium_stickers:"PremiumPreviewStickers",animated_emoji:"PremiumPreviewEmoji",no_ads:"PremiumPreviewNoAds",voice_to_text:"PremiumPreviewVoiceToText",profile_badge:"PremiumPreviewProfileBadge",faster_download:"PremiumPreviewDownloadSpeed",more_upload:"PremiumPreviewUploads",advanced_chat_management:"PremiumPreviewAdvancedChatManagement",animated_userpics:"PremiumPreviewAnimatedProfiles",emoji_status:"PremiumPreviewEmojiStatus",translations:"PremiumPreviewTranslations",stories:"PremiumPreviewStories",saved_tags:"PremiumPreviewTags2",last_seen:"PremiumPreviewLastSeen",message_privacy:"PremiumPreviewMessagePrivacy",effects:"Premium.MessageEffects"},Br={double_limits:"PremiumPreviewLimitsDescription",infinite_reactions:"PremiumPreviewReactions2Description",premium_stickers:"PremiumPreviewStickersDescription",no_ads:"PremiumPreviewNoAdsDescription",animated_emoji:"PremiumPreviewEmojiDescription",voice_to_text:"PremiumPreviewVoiceToTextDescription",profile_badge:"PremiumPreviewProfileBadgeDescription",faster_download:"PremiumPreviewDownloadSpeedDescription",more_upload:"PremiumPreviewUploadsDescription",advanced_chat_management:"PremiumPreviewAdvancedChatManagementDescription",animated_userpics:"PremiumPreviewAnimatedProfilesDescription",emoji_status:"PremiumPreviewEmojiStatusDescription",translations:"PremiumPreviewTranslationsDescription",stories:"PremiumPreviewStoriesDescription",saved_tags:"PremiumPreviewTagsDescription2",last_seen:"PremiumPreviewLastSeenDescription",message_privacy:"PremiumPreviewMessagePrivacyDescription",effects:"Premium.MessageEffectsInfo"},Lr={channels:"GroupsAndChannelsLimitTitle",dialogFolderPinned:"PinChatsLimitTitle",channelsPublic:"PublicLinksLimitTitle",savedGifs:"SavedGifsLimitTitle",stickersFaved:"FavoriteStickersLimitTitle",aboutLength:"BioLimitTitle",captionLength:"CaptionsLimitTitle",dialogFilters:"FoldersLimitTitle",dialogFiltersChats:"ChatPerFolderLimitTitle",recommendedChannels:"SimilarChannelsLimitTitle"},Rr={channels:"GroupsAndChannelsLimitSubtitle",dialogFolderPinned:"PinChatsLimitSubtitle",channelsPublic:"PublicLinksLimitSubtitle",savedGifs:"SavedGifsLimitSubtitle",stickersFaved:"FavoriteStickersLimitSubtitle",aboutLength:"BioLimitSubtitle",captionLength:"CaptionsLimitSubtitle",dialogFilters:"FoldersLimitSubtitle",dialogFiltersChats:"ChatPerFolderLimitSubtitle",recommendedChannels:"SimilarChannelsLimitSubtitle"},xr=(0,n.ph)((e=>{let{promo:t,initialSection:a,isPremium:s,limits:i,premiumPromoOrder:l,subscriptionOption:c,onBack:d,onClickSubscribe:m}=e;const u=(0,T.A)(),A=(0,Us.A)(),h=(0,n.li)(null),[y,p]=(0,n.J0)(r.O2i.indexOf(a)),[v,g]=(0,n.J0)(0),[E,b,C]=(0,I.A)(),[f,S]=(0,n.J0)(!0),[k,w]=(0,n.J0)(!1),N=(0,D.A)(a),P=(0,n.Kr)((()=>l?l.filter((e=>r.O2i.includes(e))):r.O2i),[l]),B=(0,n.Kr)((()=>{if(!c)return;const{amount:e,months:t,currency:a}=c,n=Math.floor(e/t);return s?A("OK"):A("SubscribeToPremium",{price:(0,Qi.v)(A,n,a)},{withNodes:!0})}),[s,A,c]),L=(0,M.A)((()=>{m(a)}));function R(e){const{scrollTop:t,clientHeight:a,scrollHeight:n}=e.currentTarget;S(t<=20),w(t>=n-a-20)}(0,n.vJ)((()=>{const e=h.current;if(!e||N===a)return;const t=P.indexOf(a);p(t),b(),(0,ar.A)(e,e.clientWidth*t,0).then(C)}),[y,P,a,N]);const x=(0,M.A)((async e=>{const t=h.current;t&&(p(e),b(),await(0,ar.A)(t,t.clientWidth*e,800),C())}));return n.Ay.createElement("div",{className:"oyUTEj8I"},n.Ay.createElement(W.A,{round:!0,size:"smaller",className:(0,de.A)("njYoMrKM",0!==y&&"SB4pczOo"),color:0===y?"translucent":"translucent-white",onClick:d,ariaLabel:u("Back")},n.Ay.createElement(q.A,{name:"arrow-left"})),n.Ay.createElement("div",{className:"dIVBSdWi"}),n.Ay.createElement("div",{className:(0,de.A)("sJubG84j","no-scrollbar"),onScroll:function(e){const t=e.currentTarget,{clientWidth:a,scrollLeft:n}=t,s=Math.round(n),i=s%a/a,r=Math.ceil((s+1)/a);g(r);const l=t.querySelector("#premium_feature_preview_video_"+(r-1)),c=t.querySelector(`#premium_feature_preview_video_${r}`);if((0,o.RK)((()=>{t.style.setProperty("--scroll-progress",i.toString()),t.style.setProperty("--abs-scroll-progress",Math.abs(i).toString()),l&&(0,Fn.dH)(l,"reverse",!1),c&&(0,Fn.dH)(c,"reverse",!0)})),E)return;const d=Math.round(s/a);p(d)},ref:h},P.map(((e,a)=>{if("double_limits"===e)return n.Ay.createElement("div",{className:(0,de.A)(Ir,"U7ePgVBR")},n.Ay.createElement("h2",{className:(0,de.A)("mz2Hmd83",f&&"AgmNOqi7")},u(Tr.double_limits)),n.Ay.createElement("div",{className:(0,de.A)("n_rowVPI","custom-scroll"),onScroll:R},r.M$8.map(((e,t)=>{const a=i?.[e][0].toString(),s=i?.[e][1].toString();return n.Ay.createElement(dr,{title:u(Lr[e]),description:u(Rr[e],s),leftValue:a,rightValue:s,colorStepProgress:t/(r.M$8.length-1)})}))));if("premium_stickers"===e)return n.Ay.createElement("div",{className:Ir},n.Ay.createElement("div",{className:Nr},n.Ay.createElement(hr,{isActive:y===a})),n.Ay.createElement("h1",{className:Pr},u(Tr.premium_stickers)),n.Ay.createElement("div",{className:Mr},(0,kt.A)(u(Br.premium_stickers),["br"])));if("stories"===e)return n.Ay.createElement("div",{className:(0,de.A)(Ir,"J1M6fEdo")},n.Ay.createElement(fr,null));const s=t.videoSections.indexOf(e);return-1!==s?n.Ay.createElement("div",{className:Ir},n.Ay.createElement("div",{className:Nr},n.Ay.createElement(wr,{isActive:y===a,videoId:t.videos[s].id,videoThumbnail:t.videos[s].thumbnail,isDown:r.jhT.includes(e),index:a,isReverseAnimation:a===v})),n.Ay.createElement("h1",{className:Pr},u(Tr[t.videoSections[s]])),n.Ay.createElement("div",{className:Mr},(0,kt.A)(u(Br[t.videoSections[s]]),["br"]))):void 0}))),n.Ay.createElement("div",{className:(0,de.A)("yN2611rA",(k||0!==y)&&"rCHMABcD")},n.Ay.createElement(ir,{length:r.O2i.length,active:y,onSelectSlide:x}),B&&n.Ay.createElement(W.A,{className:(0,de.A)("EPfM7AgT"),isShiny:!s,withPremiumGradient:!s,onClick:s?d:L},B)))})),Fr=(0,n.ph)((e=>{let{option:t,checked:a,fullMonthlyAmount:s,onChange:i,className:r,isGiveaway:o}=e;const l=(0,T.A)(),{months:c,amount:d,currency:m}=t,u="users"in t?t.users:void 0,A=Math.floor(d/c),h=u?u>1:void 0,y=(0,n.Kr)((()=>s&&s>A?Math.ceil(100-A/(s/100)):void 0),[s,A]),p=(0,n.hb)((e=>{e.target.checked&&i(c)}),[c,i]);return n.Ay.createElement("label",{className:(0,de.A)(o?"PkseWxFK":"qZA6S2kc",a&&!o&&"EJOQwnRj",r),dir:l.isRtl?"rtl":void 0},n.Ay.createElement("input",{className:"WOEkhx6R",type:"radio",name:"subscription_option",value:c,checked:a,onChange:p}),n.Ay.createElement("div",{className:"BHUCScsU"},n.Ay.createElement("div",{className:"DfYCMUkL"},Boolean(y)&&n.Ay.createElement("span",{className:(0,de.A)("ublijP0j","uqDlP3Zt"),title:l("GiftDiscount")}," −",y,"%"),l("Months",c)),n.Ay.createElement("div",{className:"poxOXJ2o"},o||h?`${(0,Qi.A)(d,m,l.code)} x ${u}`:l("PricePerMonth",(0,Qi.A)(A,m,l.code))),n.Ay.createElement("div",{className:"IGMrERf_"},(0,Qi.A)(d,m,l.code))))})),Vr="yKm9hKQP",Dr=a.p+"telegram-a.PremiumAds.a758f19ece91fe91318e.svg",_r=a.p+"telegram-a.PremiumBadge.1c630afcfd1112ad16d0.svg",Ur=a.p+"telegram-a.PremiumChats.89d9d315638e283ca895.svg",Or=a.p+"telegram-a.PremiumEffects.4eab9caad8e9c276842d.svg",Jr=a.p+"telegram-a.PremiumEmoji.26515017c8f6dc4f3f67.svg",Kr=a.p+"telegram-a.PremiumFile.884dd3865acfe594fc61.svg",jr=a.p+"telegram-a.PremiumLastSeen.9575a548770d23785846.svg",Gr=a.p+"telegram-a.PremiumLimits.08701cb6df3cf756c5f7.svg",zr=a.p+"telegram-a.PremiumLogo.a5c0e88cd478f4d76d82.svg",Hr=a.p+"telegram-a.PremiumMessagePrivacy.950cab3e87c60c5733a6.svg",$r=a.p+"telegram-a.PremiumReactions.7fee56ab6b58c82fd15e.svg",qr=a.p+"telegram-a.PremiumSpeed.d0a43b6780c411c2f84a.svg",Wr=a.p+"telegram-a.PremiumStatus.c42f9c4b68f9c2c4537a.svg",Yr=a.p+"telegram-a.PremiumStickers.7b5a8531a41b43d0da12.svg",Qr=a.p+"telegram-a.PremiumTags.3b187054cc90f8e16cb7.svg",Zr=a.p+"telegram-a.PremiumTranslate.cb2dcbb898d96cb35469.svg",Xr=a.p+"telegram-a.PremiumVideo.288cb61931e33d913f0a.svg",eo=a.p+"telegram-a.PremiumVoice.b3a2893dbe481108ab94.svg",to=8*A.$,ao={stories:Wr,double_limits:Gr,infinite_reactions:$r,premium_stickers:Yr,animated_emoji:Jr,no_ads:Dr,voice_to_text:eo,profile_badge:_r,faster_download:qr,more_upload:Kr,advanced_chat_management:Ur,animated_userpics:Xr,emoji_status:Wr,translations:Zr,saved_tags:Qr,last_seen:jr,message_privacy:Hr,effects:Or},no=(0,n.ph)((0,s.EK)((e=>{const{premiumModal:t}=(0,c.nTw)(e),a=t?.fromUserId?(0,c.mBe)(e,t.fromUserId):void 0,n=a?.emojiStatus?e.customEmojis.byId[a.emojiStatus.documentId]:void 0,s=n?(0,c.ycM)(e,n.stickerSetInfo):void 0;return{currentUserId:e.currentUserId,promo:t?.promo,isSuccess:t?.isSuccess,isGift:t?.isGift,monthsAmount:t?.monthsAmount,fromUser:a,fromUserStatusEmoji:n,fromUserStatusSet:s,toUser:t?.toUserId?(0,c.mBe)(e,t.toUserId):void 0,initialSection:t?.initialSection,isPremium:(0,c.g29)(e),limitChannels:(0,Yi.B)(e,"channels"),limitFolders:(0,Yi.B)(e,"dialogFilters"),limitPins:(0,Yi.B)(e,"dialogFolderPinned"),limitLinks:(0,Yi.B)(e,"channelsPublic"),limits:e.appConfig?.limits,premiumSlug:e.appConfig?.premiumInvoiceSlug,premiumBotUsername:e.appConfig?.premiumBotUsername,premiumPromoOrder:e.appConfig?.premiumPromoOrder}}))((e=>{let{isOpen:t,currentUserId:a,fromUser:i,fromUserStatusEmoji:o,fromUserStatusSet:c,promo:d,initialSection:m,isPremium:u,limitChannels:A,limitLinks:h,limitFolders:y,limitPins:p,limits:v,premiumSlug:g,premiumBotUsername:E,isSuccess:b,isGift:C,toUser:f,monthsAmount:S,premiumPromoOrder:k}=e;const w=(0,n.li)(null),{closePremiumModal:N,openInvoice:I,requestConfetti:P,openTelegramLink:B,loadStickers:L,openStickerSet:R}=(0,s.ko)(),x=(0,T.A)(),F=(0,Us.A)(),[V,D]=(0,n.J0)(!0),[_,U]=(0,n.J0)(m),[O,J]=(0,n.J0)();(0,n.vJ)((()=>{t||(D(!0),U(void 0))}),[t]);const K=(0,M.A)((e=>{U(e)})),G=(0,M.A)((()=>{U(void 0)})),z=(0,M.A)((e=>{w.current&&(g?I({type:"slug",slug:g}):E&&(B({url:`${r.jsp}${E}?start=${e||"promo"}`}),N()))})),H=(0,M.A)((()=>{O?z(String(O.months)):z()})),$=(0,M.A)((e=>{const t=d?.options.find((t=>t.months===e));J(t)})),Y=(0,M.A)((()=>{const e=w.current;if(e&&t){const{top:t,left:a,width:n,height:s}=e.querySelector(".modal-content").getBoundingClientRect();P({top:t,left:a,width:n,height:s,withStars:!0})}}));(0,n.vJ)((()=>{b&&Y()}),[b,Y]),(0,j.A)((e=>{let[t]=e;t!==u&&Y()}),[u,Y]);const Z=(0,n.Kr)((()=>k?k.filter((e=>r.O2i.includes(e))):r.O2i),[k]);(0,n.vJ)((()=>{o&&!c&&L({stickerSetInfo:o.stickerSetInfo})}),[L,o,c]),(0,n.vJ)((()=>{const[e]=d?.options??[];J(e)}),[d]);const X=(0,M.A)((()=>{c&&R({stickerSetInfo:c})})),ee=(0,n.Kr)((()=>{const e=d?.options.find((e=>1===e.months));if(e)return Number(e.amount)}),[d]),ae=(0,n.Kr)((()=>{if(!O)return;const{amount:e,months:t,currency:a}=O,n=Math.floor(e/t);return(0,Qi.v)(F,n,a)}),[O,F]);if(d&&(!o||c))return n.Ay.createElement(Q.A,{className:"sfbpMFHM",onClose:N,isOpen:t,dialogRef:w},n.Ay.createElement(te.Ay,{name:"slide",activeKey:_?1:0,className:"ELNkgPve"},_?n.Ay.createElement(xr,{initialSection:_,onBack:G,promo:d,onClickSubscribe:z,isPremium:u,limits:v,premiumPromoOrder:k,subscriptionOption:O}):n.Ay.createElement("div",{className:(0,de.A)("ZpOIPrhp","custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;D(t<=150)}},n.Ay.createElement(W.A,{round:!0,size:"smaller",className:"XyN3eWog",color:"translucent",onClick:()=>N(),ariaLabel:x("Close")},n.Ay.createElement(q.A,{name:"close"})),o?n.Ay.createElement(Zi.A,{className:"mQwvY9LA",onClick:X,documentId:o.id,isBig:!0,size:to}):n.Ay.createElement("img",{className:"mlMezt6b",src:zr,alt:"",draggable:!1}),n.Ay.createElement("h2",{className:(0,de.A)("y71v6ECL",c&&"xw_GbDj7")},function(){if(C)return(0,kt.A)(i?.id===a?x("TelegramPremiumUserGiftedPremiumOutboundDialogTitle",[(0,l.YgS)(f),S]):x("TelegramPremiumUserGiftedPremiumDialogTitle",[(0,l.YgS)(i),S]),["simple_markdown","emoji"]);if(c&&i){const e=x("lng_premium_emoji_status_title").replace("{user}",(0,l.YgS)(i)),[t,a]=e.split("{link}"),s=c.thumbCustomEmojiId?n.Ay.createElement(Zi.A,{className:"Y0jTcadE",documentId:c.thumbCustomEmojiId}):void 0,r=n.Ay.createElement("span",{className:"FLzl2ng5",onClick:X},s,(0,kt.A)(c.title));return[(0,kt.A)(t),r,(0,kt.A)(a)]}return(0,kt.A)(i?x("TelegramPremiumUserDialogTitle",(0,l.YgS)(i)):x(u?"TelegramPremiumSubscribedTitle":"TelegramPremium"),["simple_markdown","emoji"])}()),n.Ay.createElement("div",{className:"cUcKXV3j"},(0,kt.A)(C?i?.id===a?x("TelegramPremiumUserGiftedPremiumOutboundDialogSubtitle",(0,l.YgS)(f)):x("TelegramPremiumUserGiftedPremiumDialogSubtitle"):x(c?"TelegramPremiumUserStatusDialogSubtitle":i?"TelegramPremiumUserDialogSubtitle":u?"TelegramPremiumSubscribedSubtitle":"TelegramPremiumSubtitle"),["simple_markdown","emoji"])),!u&&!C&&n.Ay.createElement("div",{className:"xZC_Oajr"},d?.options.map((e=>n.Ay.createElement(Fr,{className:"gygsbDbE",key:e.amount,option:e,onChange:$,fullMonthlyAmount:ee,checked:O?.months===e.months})))),n.Ay.createElement("div",{className:(0,de.A)("Bc_F0RKb",V&&"ltXo0Xi7")},n.Ay.createElement("h2",{className:"xysPdANX"},x("TelegramPremium"))),n.Ay.createElement("div",{className:(0,de.A)("c3Ee2oSo",u&&"yWEHoJOL")},Z.map(((e,t)=>n.Ay.createElement(tr,{key:e,title:x(Tr[e]),text:"double_limits"===e?x(Br[e],[A,y,p,h,4]):x(Br[e]),icon:ao[e],index:t,count:Z.length,section:e,onClick:K}))),n.Ay.createElement("div",{className:(0,de.A)(Vr,"l1WlNpmu"),dir:x.isRtl?"rtl":void 0},n.Ay.createElement("p",null,(0,kt.A)(x("AboutPremiumDescription"),["simple_markdown"])),n.Ay.createElement("p",null,(0,kt.A)(x("AboutPremiumDescription2"),["simple_markdown"]))),function(){if(d&&(!C||i?.id!==a))return n.Ay.createElement("div",{className:Vr,dir:x.isRtl?"rtl":void 0},(0,Un.f)({text:d.statusText,entities:d.statusEntities}))}()),!u&&O&&n.Ay.createElement("div",{className:"nCnlO9UZ"},n.Ay.createElement(W.A,{className:"c1tMxuFH",isShiny:!0,withPremiumGradient:!0,onClick:H},x("SubscribeToPremium",ae))))))})));var so=a(24956),io=a(31722);const ro="ItemPickerItem",oo=(0,n.ph)((e=>{let{className:t,isSearchable:a,searchInputId:s,items:i,filterValue:r,notFoundText:l,isLoading:c,noScrollRestore:d,filterPlaceholder:m,isViewOnly:u,itemInputType:A,itemClassName:h,withDefaultPadding:y,forceRenderAllItems:p,onFilterChange:v,onDisabledClick:g,onLoadMore:E,...b}=e;const C=(0,T.A)(),f=(0,n.li)(null),S=b.allowMultiple,k=S?b.lockedSelectedValues:void 0,w=S?b.lockedUnselectedValues:void 0;(0,n.vJ)((()=>{if(!a)return;const e=window.setTimeout((()=>{(0,o.YS)((()=>{f.current?.focus()}))}),500);return()=>{window.clearTimeout(e)}}),[a]);const N=(0,n.Kr)((()=>S?b.selectedValues:b.selectedValue?[b.selectedValue]:ln.p),[S,b.selectedValue,b.selectedValues]),I=(0,n.Kr)((()=>new Set(k)),[k]),P=(0,n.Kr)((()=>new Set(w)),[w]),B=(0,n.Kr)((()=>{if(r)return i.map((e=>e.value));const e=[],t=[],a=[];return i.forEach((n=>{I.has(n.value)?e.push(n):P.has(n.value)?a.push(n):t.push(n)})),e.concat(t,a).map((e=>e.value))}),[r,i,I,P]),L=(0,M.A)((e=>{if(S){const t=N.slice(),a=t.indexOf(e);return a>=0?t.splice(a,1):t.push(e),void b.onSelectedValuesChange?.(t)}b.onSelectedValueChange?.(e)})),[R,x]=(0,Es.A)(E,B,Boolean(p||r)),F=(0,M.A)((e=>{const{value:t}=e.currentTarget;v?.(t)})),V=(0,n.hb)((e=>{const t=i.find((t=>t.value===e));if(!t)return;const{label:a,subLabel:s,isLoading:r}=t,o=P.has(e),l=I.has(e),c=o||l,d=N.includes(e);return n.Ay.createElement(ws.A,{key:e,className:(0,de.A)(ro,h),title:a,subtitle:s,disabled:c,inactive:u,ripple:!0,inputElement:c?n.Ay.createElement(q.A,{name:"lock-badge"}):"radio"===A?n.Ay.createElement(so.A,{checked:d,disabled:c,isLoading:r,onlyInput:!0}):"checkbox"===A?n.Ay.createElement(js.A,{checked:d,disabled:c,isLoading:r,onlyInput:!0}):void 0,onClick:()=>L(e),onDisabledClick:g&&(()=>g(e,l))})}),[i,P,I,N,u,g,A,h]);return n.Ay.createElement("div",{className:(0,de.A)(io.A.container,t)},a&&n.Ay.createElement("div",{className:(0,de.A)(io.A.header,"custom-scroll"),dir:C.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{id:s,ref:f,value:r,onChange:F,placeholder:m||C("Search")})),R?.length?n.Ay.createElement(rs.A,{className:(0,de.A)(io.A.pickerList,y&&io.A.padded,"custom-scroll"),items:R,itemSelector:`.${ro}`,onLoadMore:x,noScrollRestore:d},R.map((e=>V(e)))):c||!R||R.length?n.Ay.createElement(fs.A,null):n.Ay.createElement("p",{className:io.A.noResults},l||C("SearchEmptyViewTitle")))})),lo={root:"wzzA3MFh",pickerSelector:"xhujrq9i",pickerTitle:"YuRK4e7S",picker:"YF9nLkCK",footer:"ATCZ2Q5G"},co=(0,n.ph)((e=>{let{isOpen:t,onClose:a,onSubmit:i,countryList:r,selectionLimit:o}=e;const{showNotification:l}=(0,s.ko)(),c=(0,T.A)(),[d,m]=(0,n.J0)([]),u=(0,D.A)(d)===d,A=(0,n.Kr)((()=>r?r.filter((e=>!e.isHidden&&"FT"!==e.iso2)).map((e=>{let{iso2:t,defaultName:a}=e;return{value:t,label:a}})):[]),[r]),h=(0,M.A)((e=>{o&&e.length>o?l({message:c("BoostingSelectUpToWarningCountries",o)}):m(e)})),y=(0,M.A)((()=>{i(d),a()}));return n.Ay.createElement(Q.A,{className:lo.root,isOpen:t,onClose:a,onEnter:y},n.Ay.createElement("div",{className:lo.container},n.Ay.createElement("div",{className:lo.pickerSelector},n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",onClick:a},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("h4",{className:lo.pickerTitle},c("BoostingSelectCountry")))),n.Ay.createElement("div",{className:(0,de.A)(lo.main,"custom-scroll")},n.Ay.createElement(oo,{className:lo.picker,items:A,selectedValues:d,onSelectedValuesChange:h,noScrollRestore:u,allowMultiple:!0,itemInputType:"checkbox"})),n.Ay.createElement("div",{className:lo.footer},n.Ay.createElement(W.A,{size:"smaller",onClick:y},c("SelectCountries.OK"))))}));var mo=a(1526),uo=a(96530),Ao=a(11124),ho=a(34642);const yo=(0,n.ph)((e=>{let{isOpen:t,giveawayChatId:a,selectionLimit:i,initialSelectedIds:r,onSelectedIdsConfirmed:o,onClose:c}=e;const{showNotification:d}=(0,s.ko)(),m=(0,T.A)(),[u,A]=(0,n.J0)(void 0),[h,y]=(0,n.J0)(""),[p,v,g]=(0,I.A)(),[E,b]=(0,n.J0)(r);(0,n.vJ)((()=>{b(r)}),[r]);const C=(0,n.Kr)((()=>{const e=(0,s.mS)(),t=e.chats.byId,{active:n,archived:i}=e.chats.listIds,r=(n||[]).concat(i||[]);return(0,on.Am)(r).map((e=>t[e])).filter((e=>e&&((0,l.WXB)(e)||(0,l.VsK)(e))&&e.id!==a)).map((e=>e.id))}),[a]),f=(0,n.Kr)((()=>{const e=C?(0,rn.PU)({ids:C,query:h,type:"chat"}):[];return(0,vs.A)(e,!1,E)}),[C,h,E]),S=(0,M.A)((e=>{const t=(0,s.mS)().chats.byId,a=e.filter((e=>!E.includes(e))).find((e=>{const a=t[e];return a&&!(0,l.gAJ)(a)}));E?.length>=i?d({message:m("BoostingSelectUpToWarningChannelsPlural",i)}):a?(A(a),v()):b(e)})),k=(0,M.A)((()=>{u&&b((0,on.Am)([...E,u])),g()})),w=(0,M.A)((()=>{o(E),c()}));return n.Ay.createElement(ho.A,{isOpen:t,onClose:c,title:m("RequestPeer.ChooseChannelTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:m("Save"),onConfirm:w,onEnter:w},n.Ay.createElement(cn.A,{itemIds:f,selectedIds:E,filterValue:h,filterPlaceholder:m("Search"),onSelectedIdsChange:S,onFilterChange:y,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"}),n.Ay.createElement(tn.A,{title:m("BoostingGiveawayPrivateChannel"),text:m("BoostingGiveawayPrivateChannelWarning"),confirmLabel:m("Add"),isOpen:p,onClose:g,confirmHandler:k}))})),po=(0,n.ph)((e=>{let{option:t,checked:a,name:s,text:i,img:r,isLink:o,onChange:l,onClickAction:c,className:d,userNames:m,selectedMemberIds:u}=e;const A=(0,T.A)();let h=A(i);o&&u?.length&&(h=u.length>2?`${u.length}`:m);const y=(0,M.A)((e=>{e.target.checked&&l(t)})),p=(0,M.A)((()=>{c?.()}));return n.Ay.createElement("label",{className:(0,de.A)("w3OGYFKn",d),dir:A.isRtl?"rtl":void 0,role:"button",tabIndex:0},n.Ay.createElement("input",{className:"xy4AclZa",type:"radio",name:"giveaway_option",value:t,checked:a,onChange:y,onClick:e=>e.stopPropagation()}),n.Ay.createElement("div",{className:"TTgSI7Xh"},n.Ay.createElement("img",{className:"lGhZJbMF",src:r,alt:"",draggable:!1}),n.Ay.createElement("div",{className:"sEt7TF59"},n.Ay.createElement("h3",{className:"u4NzVBBi"},A(`${s}`)),o?n.Ay.createElement("div",{className:"y7XfPOoG",onClick:p},n.Ay.createElement("span",null,h),n.Ay.createElement(q.A,{name:"next"})):n.Ay.createElement("span",{className:"kt2ZKZ6j"},h))))})),vo=(0,n.ph)((0,s.EK)(((e,t)=>{let{giveawayChatId:a}=t;const n=a?(0,c.AWZ)(e,a):void 0;return n?{members:n.members,adminMembersById:n.adminMembersById}:{}}))((e=>{let{isOpen:t,selectionLimit:a,members:i,adminMembersById:r,initialSelectedIds:o,onSelectedIdsConfirmed:c,onClose:d}=e;const{showNotification:m}=(0,s.ko)(),u=(0,T.A)(),[A,h]=(0,n.J0)(""),[y,p]=(0,n.J0)(o);(0,n.vJ)((()=>{p(o)}),[o]);const v=(0,n.Kr)((()=>{const e=(0,s.mS)(),{byId:t,statusesById:a}=e.users;if(!i?.length)return[];const n=r&&new Set(Object.keys(r)),o=(0,l.UBH)(i.map((e=>{let{userId:t}=e;return t})),t,a);return n?o.filter((e=>!n.has(e))):o}),[r,i]),g=(0,n.Kr)((()=>{const e=(0,s.mS)().users.byId,t=v?(0,rn.PU)({ids:v,query:A,type:"user"}):[];return(0,vs.A)((0,on.Am)(t).filter((t=>{const a=e[t];return!a||!(0,l.tvf)(a)})))}),[v,A]),E=(0,M.A)((e=>{e.length>a?m({message:u("BoostingSelectUpToWarningUsers",a)}):p(e)})),b=(0,M.A)((()=>{c(y),d()}));return n.Ay.createElement(ho.A,{isOpen:t,onClose:d,title:u("BoostingAwardSpecificUsers"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:u("Save"),onConfirm:b,onEnter:b},n.Ay.createElement(cn.A,{itemIds:g,selectedIds:y,filterValue:A,filterPlaceholder:u("Search"),onSelectedIdsChange:E,onFilterChange:h,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"}))}))),go="rZRDMqUL",Eo="JjDLNrKG",bo="p5Hn4Q6E",Co="rniPcuiP",fo="G9H3tm6D",So="xKl2UeV8",ko="HLx3wTBD",wo="Ftr7zf2v",No="Ce0Ob2tg",Io="rDFQAfTt",Po="LZ3vPzak",Mo="Z9QJQ6IS",To="ldn4mh2T";var Bo=a(72078),Lo=a(68153),Ro=a(65741),xo=a(45318);const Fo={3:Lo,6:Bo,12:Ro},Vo=(0,n.ph)((0,s.EK)((e=>{const{giveawayModal:t}=(0,c.nTw)(e),a=t?.chatId,n=a?(0,c.hds)(e,a):void 0,s=n&&(0,l.WXB)(n);return{chatId:a,gifts:t?.gifts,selectedMemberList:t?.selectedMemberIds,selectedChannelList:t?.selectedChannelIds,giveawayBoostPerPremiumLimit:e.appConfig?.giveawayBoostsPerPremium,isStarsGiftEnabled:e.appConfig?.isStarsGiftEnabled,userSelectionLimit:e.appConfig?.giveawayAddPeersMax,countrySelectionLimit:e.appConfig?.giveawayCountriesMax,countryList:e.countryList.general,prepaidGiveaway:t?.prepaidGiveaway,isChannel:s,starsGiftOptions:t?.starOptions}}))((e=>{let{chatId:t,gifts:a,isOpen:i,isChannel:o,selectedMemberList:c,selectedChannelList:d,giveawayBoostPerPremiumLimit:m=r.CQG,countryList:u,prepaidGiveaway:A,countrySelectionLimit:h=r.y67,userSelectionLimit:y=r.qbC,isStarsGiftEnabled:p,starsGiftOptions:v}=e;const g=(0,n.li)(null),{closeGiveawayModal:E,openInvoice:b,openPremiumModal:C,launchPrepaidGiveaway:f,launchPrepaidStarsGiveaway:S}=(0,s.ko)(),k=(0,T.A)(),[w,N,P]=(0,I.A)(),[B,L,R]=(0,I.A)(),[x,F,V]=(0,I.A)(),[D,_,U]=(0,I.A)(),[O,J,K]=(0,I.A)(),j=[{name:"Premium.Title",text:"BoostingWinnersRandomly",value:"premium_giveaway",img:Bo,actions:"createPremiumGiveaway",isLink:!0,onClickAction:()=>{_()}}];p&&j.push({name:"TelegramStars",text:"BoostingWinnersRandomly",value:"stars_giveaway",img:xo,actions:"createStarsGiveaway",isLink:!1});const[G,z]=(0,n.J0)(Date.now()+2592e5),[H,$]=(0,n.J0)(!0),[X,ee]=(0,n.J0)(5),[te,ae]=(0,n.J0)(j[0].value),[ne,se]=(0,n.J0)(),[ie,re]=(0,n.J0)("all"),[oe,le]=(0,n.J0)(),[ce,me]=(0,n.J0)([]),[ue,Ae]=(0,n.J0)([]),[he,ye]=(0,n.J0)([]),[pe,ve]=(0,n.J0)(!1),[ge,Ee]=(0,n.J0)(!1),[be,Ce]=(0,n.J0)(void 0),[fe,Se]=(0,n.J0)(void 0),[ke,we]=(0,n.J0)(void 0),Ne="premium_giveaway"===te,Ie="stars_giveaway"===te,Pe=Ne&&!ce.length?X:ce.length,Me=Pe*m,Te=ne?.yearlyBoosts,Be=(0,n.Kr)((()=>[{value:"all",label:k(o?"BoostingAllSubscribers":"BoostingAllMembers"),subLabel:he&&he.length>0?k("Giveaway.ReceiverType.Countries",he.length):k("BoostingFromAllCountries")},{value:"new",label:k(o?"BoostingNewSubscribers":"BoostingNewMembers"),subLabel:he&&he.length>0?k("Giveaway.ReceiverType.Countries",he.length):k("BoostingFromAllCountries")}]),[o,k,he]),Le=k("Months",oe),Re="starsGiveaway"===A?.type,xe="giveaway"===A?.type,Fe=(0,n.Kr)((()=>a?.find((e=>e.months===oe&&e.users===Pe))),[a,oe,Pe]),Ve=(0,n.Kr)((()=>v?.find((e=>Re&&e.stars===ke?.stars))),[ke,v,Re]),De=(0,n.Kr)((()=>a?.filter((e=>e.users===Pe))),[a,Pe]),_e=(0,n.Kr)((()=>{const e=De?.reduce(((e,t)=>t.amount<e.amount?t:e),De[0]);return e&&Math.floor(e.amount/e.months)}),[De]),Ue=(0,n.Kr)((()=>(0,on.Am)(a?.map((e=>e.users))||[]).sort(((e,t)=>e-t))),[a]),Oe=(0,n.Kr)((()=>(0,on.Am)(ne?.winners?.map((e=>e.users))||[]).sort(((e,t)=>e-t))),[ne]);(0,n.vJ)((()=>{i&&a?.length&&!Re&&le(a?.[0].months)}),[i,a,Re]),(0,n.vJ)((()=>{i&&v?.length&&!xe&&se(v?.[0])}),[i,v,xe]),(0,n.vJ)((()=>{i&&Re&&(ee(A.quantity),we(A))}),[i,Re,A]),(0,n.vJ)((()=>{i&&xe&&(ee(A.quantity),Se(A),le(A.months))}),[i,xe,A]),(0,n.vJ)((()=>{c&&me(c)}),[c]),(0,n.vJ)((()=>{d&&Ae(d)}),[d]);const Je=(0,M.A)((()=>{C()})),je=(0,M.A)((()=>{we(void 0),Se(void 0),se(void 0),le(void 0),ee(5),E()})),Ge=(0,M.A)((()=>{b(Ne?ce?.length?{type:"giftcode",boostChannelId:t,userIds:ce,currency:Fe.currency,amount:Fe.amount,option:Fe}:{type:"giveaway",chatId:t,additionalChannelIds:ue,isOnlyForNewSubscribers:"new"===ie,countries:he,areWinnersVisible:pe,prizeDescription:be,untilDate:G/1e3,currency:Fe.currency,amount:Fe.amount,option:Fe}:{type:"starsgiveaway",chatId:t,additionalChannelIds:ue,isOnlyForNewSubscribers:"new"===ie,countries:he,areWinnersVisible:pe,prizeDescription:be,untilDate:G/1e3,currency:ne.currency,amount:ne.amount,stars:ne.stars,users:X}),je()})),ze=(0,M.A)((()=>{Re?S({chatId:t,giveawayId:ke.id,paymentPurpose:{additionalChannelIds:ue,countries:he,prizeDescription:be,areWinnersVisible:pe,untilDate:G/1e3,stars:ke.stars,currency:Ve.currency,amount:Ve.amount,users:ke.quantity}}):f({chatId:t,giveawayId:fe.id,paymentPurpose:{additionalChannelIds:ue,countries:he,prizeDescription:be,areWinnersVisible:pe,untilDate:G/1e3,currency:Fe.currency,amount:Fe.amount}}),V(),je()})),He=(0,M.A)((e=>{ee(e)})),$e=(0,M.A)((e=>{ee(e)})),qe=(0,M.A)((e=>{Ce(e.target.value)})),We=(0,n.Kr)((()=>{const e=(0,s.mS)().users.byId;return ce?.map((t=>(0,l.YgS)(e[t]))).join(", ")}),[ce]),Ye=(0,M.A)((e=>{re(e)})),Qe=(0,M.A)((e=>{ae(e),me([]),ee(5)})),Ze=(0,M.A)((e=>{z(e.getTime()),P()})),Xe=(0,M.A)((e=>{ye(e)})),et=(0,M.A)((e=>{me(e),e.length||ae("premium_giveaway")})),tt=(0,M.A)((e=>{Ae(e)})),at=(0,M.A)((e=>{ve(e.target.checked)})),nt=(0,M.A)((e=>{Ee(e.target.checked)})),st=(0,M.A)((()=>{L()})),it=(0,M.A)((e=>{se(e)}));function rt(){return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:go},n.Ay.createElement("h2",{className:bo},k("BoostingChannelsGroupsIncludedGiveaway")),n.Ay.createElement(Wa.A,{inactive:!0,className:"chat-item-clickable contact-list-item"},n.Ay.createElement(cs.A,{chatId:t,status:k(o?"BoostingChannelWillReceiveBoost":"BoostingGroupWillReceiveBoost",Me||Te,"i")})),ue?.map((e=>n.Ay.createElement(Wa.A,{ripple:!0,key:e,className:"chat-item-clickable contact-list-item",onClick:()=>function(e){const t=ue.filter((t=>t!==e));Ae(t)}(e),rightElement:n.Ay.createElement(q.A,{name:"close",className:"UZdErfVI"})},n.Ay.createElement(cs.A,{chatId:e.toString()})))),ue.length<9&&n.Ay.createElement(Wa.A,{icon:"add",ripple:!0,onClick:J,className:"sOXvh85b",iconClassName:"aGbyR60s"},k("BoostingAddChannelOrGroup"))),n.Ay.createElement("div",{className:go},n.Ay.createElement("h2",{className:bo},k("BoostingEligibleUsers")),n.Ay.createElement("div",{className:Eo},n.Ay.createElement(Z.A,{name:"subscribers",options:Be,selected:ie,onChange:Ye,onClickAction:st,subLabelClassName:"txXJxVFu",isLink:!0}))),n.Ay.createElement("div",{className:Co},(0,kt.A)(k(o?"BoostGift.LimitSubscribersInfo":"lng_giveaway_users_about_group"))),n.Ay.createElement("div",{className:go},n.Ay.createElement("div",{className:Mo},n.Ay.createElement("h2",{className:Po},k("BoostingGiveawayAdditionalPrizes")),n.Ay.createElement(sn.A,{label:k("BoostingGiveawayAdditionalPrizes"),checked:ge,onChange:nt})),ge&&n.Ay.createElement("div",{className:"eQVP0Nx8"},n.Ay.createElement("h2",{className:Po},X),n.Ay.createElement(Y.A,{className:"qMYNwiUZ",value:be,onChange:qe,label:k("BoostingGiveawayEnterYourPrize")}))),ge?Ie||Re?void 0:n.Ay.createElement("div",{className:Co},be?.length?(0,kt.A)(k("BoostingGiveawayAdditionPrizeCountNameHint",fe?[fe.quantity,be,Le]:[Pe,be,Le],void 0,oe),["simple_markdown"]):(0,kt.A)(k("BoostingGiveawayAdditionPrizeCountHint",fe?[fe.quantity,Le]:[Pe,Le],void 0,oe),["simple_markdown"])):n.Ay.createElement("div",{className:Co},(0,kt.A)(k("BoostingGiveawayAdditionPrizeHint"))),n.Ay.createElement("div",{className:go},n.Ay.createElement("div",{className:Mo},n.Ay.createElement("h2",{className:Po},k("BoostingGiveawayShowWinners")),n.Ay.createElement(sn.A,{label:k("BoostingGiveawayAdditionalPrizes"),checked:pe,onChange:at}))),n.Ay.createElement("div",{className:Co},(0,kt.A)(k("BoostingGiveawayShowWinnersHint"))),n.Ay.createElement("div",{className:(0,de.A)(go,(fe||ke||Ie)&&Io)},n.Ay.createElement("h2",{className:bo},k("BoostingDateWhenGiveawayEnds")),n.Ay.createElement(W.A,{ariaLabel:k("BoostGift.DateEnds"),className:(0,de.A)("GeKqKRgP","expire-limit"),isText:!0,onClick:N},n.Ay.createElement("h3",{className:Po},k("BoostGift.DateEnds")),(0,Ke.L2)(G,k.code))))}return n.Ay.createElement(Q.A,{className:"P0kLOw15",onClose:je,isOpen:i,dialogRef:g,onEnter:fe||ke?F:Ge},n.Ay.createElement("div",{className:"SqiN63Ef",onScroll:function(e){const{scrollTop:t}=e.currentTarget;$(t<=150)}},n.Ay.createElement(W.A,{round:!0,size:"smaller",className:"OX6_HqAd",color:"translucent",onClick:je,ariaLabel:k("Close")},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("img",{className:"Me2hCsMs",src:zr,alt:"",draggable:!1}),n.Ay.createElement("h2",{className:"UVDnB0Wq"},(0,kt.A)(k("BoostingBoostsViaGifts"))),n.Ay.createElement("div",{className:"v5yGzV6v"},(0,kt.A)(k(o?"BoostingGetMoreBoost":"BoostingGetMoreBoostsGroup"))),n.Ay.createElement("div",{className:(0,de.A)("U6XNIToQ",H&&"tDZc21ZC")},n.Ay.createElement("h2",{className:"v6hiGpEn"},k("BoostingBoostsViaGifts"))),fe||ke?n.Ay.createElement("div",{className:"q1y2qUTn"},n.Ay.createElement("div",null,ke?n.Ay.createElement("img",{className:To,src:xo,alt:""}):n.Ay.createElement("img",{className:To,src:Fo[fe.months],alt:""})),n.Ay.createElement("div",{className:"IsT38nlq"},n.Ay.createElement("h3",{className:Po},ke?k("Giveaway.Stars.Prepaid.Title",ke?.stars):k("BoostingTelegramPremiumCountPlural",fe.quantity)),n.Ay.createElement("p",{className:"TsGuei3B"},ke?k("Giveaway.Stars.Prepaid.Desc",ke?.quantity):k("PrepaidGiveawayMonths",fe?.months))),n.Ay.createElement("div",{className:fo},n.Ay.createElement("div",{className:(0,de.A)(So,ko)},n.Ay.createElement(q.A,{name:"boost",className:wo}),n.Ay.createElement("div",{className:No,dir:k.isRtl?"rtl":void 0},ke?ke?.boosts:fe.quantity*(m??r.CQG))))):n.Ay.createElement("div",{className:(0,de.A)(go,"sQ5PkKEs")},n.Ay.createElement("div",{className:Eo},j.map((e=>n.Ay.createElement(po,{key:e.name,name:e.name,text:e.text,option:e.value,img:e.img,onChange:Qe,checked:te===e.value,isLink:e.isLink,userNames:We,selectedMemberIds:ce,onClickAction:e.onClickAction}))))),Ne&&!ce?.length&&n.Ay.createElement(n.Ay.Fragment,null,!fe&&!ke&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:go},n.Ay.createElement("div",{className:fo},n.Ay.createElement("h2",{className:bo},k("BoostingQuantityPrizes")),n.Ay.createElement("div",{className:(0,de.A)(So,ko)},n.Ay.createElement(q.A,{name:"boost",className:wo}),n.Ay.createElement("div",{className:No,dir:k.isRtl?"rtl":void 0},Me))),n.Ay.createElement(Ao.A,{rangeCount:Pe,marks:Ue,onChange:He})),n.Ay.createElement("div",{className:Co},(0,kt.A)(k("BoostingChooseHowMany")))),rt()),Ie&&n.Ay.createElement(n.Ay.Fragment,null,!ke&&!fe&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:go},n.Ay.createElement("div",{className:fo},n.Ay.createElement("h2",{className:bo},k("BoostingStarsOptions")),n.Ay.createElement("div",{className:(0,de.A)(So,ko)},n.Ay.createElement(q.A,{name:"boost",className:wo}),n.Ay.createElement("div",{className:No,dir:k.isRtl?"rtl":void 0},Te))),n.Ay.createElement(mo.A,{className:"cLhNkYPB",options:v,selectedStarCount:X,selectedStarOption:ne,onClick:it})),n.Ay.createElement("div",{className:(0,de.A)(Co,"bzRAETfR")},(0,kt.A)(k("BoostGift.Stars.Info"))),n.Ay.createElement("div",{className:go},n.Ay.createElement("h2",{className:bo},k("BoostingStarsQuantityPrizes")),n.Ay.createElement(Ao.A,{rangeCount:X,marks:Oe,onChange:$e}),n.Ay.createElement("div",{className:Co},(0,kt.A)(k("BoostingStarsQuantityPrizesInfo"))))),rt()),!fe&&!ke&&Ne&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:go},n.Ay.createElement("h2",{className:bo},k("BoostingDurationOfPremium")),n.Ay.createElement("div",{className:Eo},De?.map((e=>n.Ay.createElement(Fr,{isGiveaway:!0,key:e.months,option:e,fullMonthlyAmount:_e,checked:e.months===oe,onChange:le}))))),n.Ay.createElement("div",{className:(0,de.A)(Co,Io)},function(){const e=k("GiftPremiumListFeaturesAndTerms").match(/([^*]*)\*([^*]+)\*(.*)/);if(e&&!(e.length<4))return n.Ay.createElement("p",{className:"eNQ_nrKr"},e[1],n.Ay.createElement(uo.A,{isPrimary:!0,onClick:Je},e[2]),e[3])}())),te&&n.Ay.createElement("div",{className:"hD_AEzjd"},n.Ay.createElement(W.A,{className:"ILuhBsJG",onClick:fe||ke?F:Ge},k("BoostingStartGiveaway")))),n.Ay.createElement(Ys,{isOpen:w,isFutureMode:!0,withTimePicker:!0,onClose:P,onSubmit:Ze,selectedAt:G,submitButtonLabel:k("Save")}),n.Ay.createElement(co,{isOpen:B,onClose:R,countryList:u,onSubmit:Xe,selectionLimit:h}),n.Ay.createElement(vo,{isOpen:D,onClose:U,onSelectedIdsConfirmed:et,initialSelectedIds:ce,selectionLimit:y,giveawayChatId:t}),n.Ay.createElement(yo,{isOpen:O,onClose:K,initialSelectedIds:ue,onSelectedIdsConfirmed:tt,selectionLimit:r.cgU,giveawayChatId:t}),n.Ay.createElement(tn.A,{title:k("BoostingStartGiveawayConfirmTitle"),text:k("BoostingStartGiveawayConfirmText"),confirmLabel:k("Start"),isOpen:x,onClose:V,confirmHandler:ze}))}))),Do={dialogFiltersChats:"LimitReachedChatInFolders",uploadMaxFileparts:"LimitReachedFileSize",dialogFilters:"LimitReachedFolders",dialogFolderPinned:"LimitReachedPinDialogs",channelsPublic:"LimitReachedPublicLinks",channels:"LimitReachedCommunities",chatlistInvites:"LimitReachedFolderLinks",chatlistJoined:"LimitReachedSharedFolders",savedDialogsPinned:"LimitReachedPinSavedDialogs"},_o={dialogFiltersChats:"LimitReachedChatInFoldersLocked",uploadMaxFileparts:"LimitReachedFileSizeLocked",dialogFilters:"LimitReachedFoldersLocked",dialogFolderPinned:"LimitReachedPinDialogsLocked",channelsPublic:"LimitReachedPublicLinksLocked",channels:"LimitReachedCommunitiesLocked",chatlistInvites:"LimitReachedFolderLinksLocked",chatlistJoined:"LimitReachedSharedFoldersLocked",savedDialogsPinned:"LimitReachedPinSavedDialogsLocked"},Uo={dialogFiltersChats:"LimitReachedChatInFoldersPremium",uploadMaxFileparts:"LimitReachedFileSizePremium",dialogFilters:"LimitReachedFoldersPremium",dialogFolderPinned:"LimitReachedPinDialogsPremium",channelsPublic:"LimitReachedPublicLinksPremium",channels:"LimitReachedCommunitiesPremium",chatlistInvites:"LimitReachedFolderLinksPremium",chatlistJoined:"LimitReachedSharedFoldersPremium",savedDialogsPinned:"LimitReachedPinSavedDialogsPremium"},Oo={dialogFiltersChats:"chat-badge",uploadMaxFileparts:"file-badge",dialogFilters:"folder-badge",dialogFolderPinned:"pin-badge",channelsPublic:"link-badge",channels:"chats-badge",chatlistInvites:"link-badge",chatlistJoined:"folder-badge",savedDialogsPinned:"pin-badge"},Jo={uploadMaxFileparts:(e,t)=>8e3===t?e("FileSize.GB","4"):4e3===t?e("FileSize.GB","2"):(0,je.v7)(e,t*r.dK5)},Ko=(0,n.ph)((0,s.EK)(((e,t)=>{let{limit:a}=t;const{limits:n}=e.appConfig||{},s=(0,c.g29)(e);return{defaultValue:a?n?.[a][0]:void 0,premiumValue:a?n?.[a][1]:void 0,canBuyPremium:!(0,c.n_C)(e),isPremium:s}}))((e=>{let{defaultValue:t,premiumValue:a,limit:i,isPremium:r,canBuyPremium:o}=e;const{closeLimitReachedModal:l,openPremiumModal:c}=(0,s.ko)(),d=(0,T.A)(),[m,u,A]=(0,I.A)(),h=(0,n.hb)((()=>{c(),u()}),[c,u]);(0,n.vJ)((()=>{!i&&m&&A()}),[m,i,A]);const y=d("LimitReached"),p=i&&Jo[i],v=function(e){let{lang:t,limitType:a,isPremium:n,canBuyPremium:s,defaultValue:i,premiumValue:r,valueFormatter:o}=e;if(!a)return;const l=o?o(t,i):i,c=o?o(t,r):r;return n?t(Uo[a],c):s?t(Do[a],"channelsPublic"===a?c:[l,c]):t(_o[a],l)}({lang:d,limitType:i,isPremium:r,canBuyPremium:o,defaultValue:t,premiumValue:a,valueFormatter:p}),g=i&&Oo[i],E=o&&!r;return n.Ay.createElement(Q.A,{onClose:u,onCloseAnimationEnd:l,isOpen:Boolean(i)&&!m,title:y,className:"QAs_iFxO"},!E&&n.Ay.createElement("div",{className:"Q5d_7bB4"},n.Ay.createElement("i",{className:(0,de.A)("rbnU7JVX",g,"icon")}),n.Ay.createElement("div",{className:"ArEy3hhB"},p?.(d,r?a:t)||(r?a:t))),E&&n.Ay.createElement(or,{className:"k0O6Rnjh",leftValue:p?.(d,t)||t?.toString(),rightValue:p?.(d,a)||a?.toString(),floatingBadgeIcon:g}),n.Ay.createElement("div",null,(0,kt.A)(v||"",["simple_markdown","br"])),n.Ay.createElement("div",{className:"RVM_RSap"},n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:u,color:"primary"},d(E?"Cancel":"OK")),E&&n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:h,color:"primary"},d("IncreaseLimit"),n.Ay.createElement(q.A,{name:"double-badge",className:"esB1OhAF"}))))})));var jo=a(93809),Go=a(81954),zo=a(5912);const Ho=350+r.xB5,$o=.5*A.$;function qo(e,t,a,s){const i=(0,n.li)([]),[r,o]=(0,n.J0)(0),{observe:l,freeze:c,unfreeze:d}=(0,zo.BL)({rootRef:e},(e=>{const t=i.current;e.forEach((e=>{const n=Number(e.target.id.replace(`${a}-`,""));t[n]=e.isIntersecting}));const n=t.reduce(((e,t,a)=>t&&a<e?a:e),1/0);n!==1/0&&o(n)})),{observe:m,freeze:u,unfreeze:A}=(0,zo.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:h}=(0,zo.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:y}=(0,zo.BL)({rootRef:t});return(0,j.A)((()=>{s?(c(),u()):setTimeout((()=>{A(),d()}),Ho)}),[c,u,s,d,A]),{activeSetIndex:r,observeIntersectionForSet:l,observeIntersectionForShowingItems:m,observeIntersectionForPlayingItems:h,observeIntersectionForCovers:y,selectStickerSet:(0,M.A)((t=>{o((n=>{const s=document.getElementById(`${a}-${t}`),i=1===Math.abs(n-t);return(0,Go.Ay)({container:e.current,element:s,position:"start",margin:$o,maxDistance:i?200:80}),t}))}))}}var Wo=a(37479),Yo=a(87094),Qo=a(94519),Zo=a(47483);const Xo=(0,n.ph)((e=>{let{stickerSet:t,size:a=r.TBj,noPlay:i,forcePlayback:o,observeIntersection:d,sharedCanvasRef:m}=e;const{loadStickers:u}=(0,s.ko)(),A=(0,n.li)(null),{hasThumbnail:h,hasVideoThumb:y,hasAnimatedThumb:p,hasStaticThumb:v,thumbCustomEmojiId:g}=t,{customEmoji:E}=(0,Zo.A)(g),C=E?.shouldUseTextColor,f=(0,Yo.A)(A,void 0,!C),S=(0,Wo.A)(f),k=(0,zo.Vz)(A,d),w=k&&!i,N=v&&!y&&!p&&!g||y&&!b.OF&&!p,I=N&&(0,l.Mwy)(t.stickers[0],"preview"),P=(0,G.A)(I,!k),M=(h&&!N||p)&&`stickerSet${t.id}`,T=(0,G.A)(M,!k),B=g||T||P,L=(0,In.A)(B),R=(0,Qo.A)(A,m);return(0,n.vJ)((()=>{k&&!t.stickers?.length&&u({stickerSetInfo:t})}),[k,u,t]),n.Ay.createElement("div",{ref:A,className:(0,de.A)("m6XpTzQX","sticker-set-cover")},B?g?n.Ay.createElement(Zi.A,{documentId:g,size:a,observeIntersectionForPlaying:d,noPlay:i}):p?n.Ay.createElement(ur.A,{className:L,tgsUrl:T,size:a,play:w,isLowPriority:!(0,c.CzR)((0,s.mS)(),t),sharedCanvas:m?.current||void 0,sharedCanvasCoords:R,forceAlways:o}):y&&!N?n.Ay.createElement(Ln.A,{className:(0,de.A)("OZHqKbDL",L),src:T,canPlay:w,style:S,isPriority:o,loop:!0,disablePictureInPicture:!0}):n.Ay.createElement("img",{src:T||P,style:S,className:(0,de.A)("enA6c8gc",L),alt:"",draggable:!1}):(0,je.Qh)(t.title,2))}));var el=a(54464),tl=a(85118),al=a(82855);const nl=[{title:"SetTimeoutFor.Hours",value:1,arg:3600},{title:"SetTimeoutFor.Hours",value:2,arg:7200},{title:"SetTimeoutFor.Hours",value:8,arg:28800},{title:"SetTimeoutFor.Days",value:1,arg:86400},{title:"SetTimeoutFor.Days",value:2,arg:172800}],sl=(0,n.ph)((e=>{let{sticker:t,size:a,noPlay:i,title:r,className:o,noContextMenu:l,isSavedMessages:c,isStatusPicker:d,canViewSet:m,observeIntersection:u,observeIntersectionForShowing:A,isSelected:h,isCurrentUserPremium:y,shouldIgnorePremium:p,noShowPremium:v,sharedCanvasRef:g,withTranslucentThumb:E,forcePlayback:C,onClick:f,clickArg:S,onFaveClick:k,onUnfaveClick:w,onRemoveRecentClick:N,onContextMenuOpen:I,onContextMenuClose:P,onContextMenuClick:B,isEffectEmoji:L,withSparkles:R}=e;const{openStickerSet:x,openPremiumModal:F,setEmojiStatus:V}=(0,s.ko)(),D=(0,n.li)(null),_=(0,n.li)(null),U=(0,T.A)(),O=t.shouldUseTextColor,J=(0,Yo.A)(D,void 0,!O),{id:K,stickerSetInfo:j}=t,G=!t.isFree&&L||t.hasEffect,z=t.isCustomEmoji||L,H=!y&&G&&!p,$=(0,zo.Vz)(D,u),Y=$,Q=$&&!i,Z=(0,zo.Vz)(D,A),{isContextMenuOpen:X,contextMenuAnchor:ee,handleBeforeContextMenu:te,handleContextMenu:ae,handleContextMenuClose:ne,handleContextMenuHide:se}=(0,si.A)(D),ie=Boolean(!l&&ee),re=(0,M.A)((()=>D.current)),le=(0,M.A)((()=>D.current.closest(".custom-scroll, .no-scrollbar"))),ce=(0,M.A)((()=>d?_.current:D.current.querySelector(".sticker-context-menu .bubble"))),me=(0,M.A)((()=>({withPortal:d,shouldAvoidNegativePosition:!0})));(0,n.vJ)((()=>{X?I?.():P?.()}),[X,P,I]),(0,n.vJ)((()=>{$||ne()}),[ne,$]);const ue=(0,M.A)((e=>{e.stopPropagation(),e.preventDefault(),N(t)})),Ae=(0,M.A)((()=>{N(t)})),he=(0,M.A)((()=>{w(t)})),ye=(0,M.A)((()=>{k(t)})),pe=(0,M.A)((()=>{f?.(S,!0)})),ve=(0,M.A)((()=>{f?.(S,void 0,!0)})),ge=(0,M.A)((()=>{x({stickerSetInfo:j})})),Ee=(0,M.A)((function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.preventDefault(),e.stopPropagation(),ne(),B?.(),V({emojiStatus:{type:"regular",documentId:t.id,until:(0,qa.Fm)()+a}})})),be=!b.TF&&N,Ce=(0,de.A)("StickerButton",f&&"interactive",h&&"selected",z&&"custom-emoji",L&&"effect-emoji",o),fe=(0,n.Kr)((()=>{if(!ie||l||z&&!d)return[];const e=[];return z?(nl.forEach((t=>{e.push(n.Ay.createElement(oe.A,{onClick:Ee,clickArg:t.arg},U(t.title,t.value,"i")))})),e):(w&&e.push(n.Ay.createElement(oe.A,{icon:"favorite",onClick:he},U("Stickers.RemoveFromFavorites"))),k&&e.push(n.Ay.createElement(oe.A,{icon:"favorite",onClick:ye},U("Stickers.AddToFavorites"))),!H&&f&&(c||e.push(n.Ay.createElement(oe.A,{onClick:pe,icon:"muted"},U("SendWithoutSound"))),e.push(n.Ay.createElement(oe.A,{onClick:ve,icon:"calendar"},U(c?"SetReminder":"ScheduleMessage")))),m&&e.push(n.Ay.createElement(oe.A,{onClick:ge,icon:"stickers"},U("ViewPackPreview"))),N&&e.push(n.Ay.createElement(oe.A,{icon:"delete",onClick:Ae},U("DeleteFromRecent"))),e)}),[ie,l,z,d,w,k,H,f,m,N,Ee,U,he,ye,c,ve,pe,ge,Ae]);return n.Ay.createElement("div",{ref:D,className:Ce,title:r||t?.emoji,"data-sticker-id":K,onMouseDown:e=>{(0,el.u)(e),te(e)},onClick:()=>{X||(H?F(L?{initialSection:"effects"}:{initialSection:"premium_stickers"}):f?.(S))},onContextMenu:ae},R&&n.Ay.createElement(tl.A,{preset:"button"}),Z&&n.Ay.createElement(al.A,{containerRef:D,sticker:t,isSmall:!0,size:a,shouldLoop:!0,shouldPreloadPreview:!0,noLoad:!Y,noPlay:!Q,noVideoOnMobile:!0,withSharedAnimation:!0,sharedCanvasRef:g,withTranslucentThumb:E,customColor:J,forceAlways:C}),!v&&H&&n.Ay.createElement("div",{className:"sticker-locked"},n.Ay.createElement(q.A,{name:"lock-badge"})),!v&&G&&!H&&n.Ay.createElement("div",{className:"sticker-premium"},n.Ay.createElement(q.A,{name:"star"})),be&&n.Ay.createElement(W.A,{className:"sticker-remove-button",color:"dark",round:!0,noFastClick:!0,onClick:ue},n.Ay.createElement(q.A,{name:"close"})),Boolean(fe.length)&&n.Ay.createElement(Ge.A,{ref:_,isOpen:X,anchor:ee,getTriggerElement:re,getRootElement:le,getMenuElement:ce,getLayout:me,className:"sticker-context-menu",autoClose:!0,withPortal:d,onClose:ne,onCloseAnimationEnd:se},fe))}));var il=a(93545),rl=a(58784),ol=a(64489);const ll=(0,n.ph)((e=>{let{reaction:t,availableReactions:a,isSelected:s,loadAndPlay:i,observeIntersection:o,sharedCanvasRef:c,sharedCanvasHqRef:d,forcePlayback:m,onClick:u,onContextMenu:A}=e;const h=(0,n.li)(null),y="custom"===t.type,p=(0,n.Kr)((()=>a?.find((e=>(0,l.a0K)(e.reaction,t)))),[a,t]),v=p?.staticIcon?.thumbnail?.dataUri,g=p?.selectAnimation?.id,E=(0,Qo.A)(h,c),b=(0,G.A)(p?.selectAnimation?(0,l.mrb)(p.selectAnimation,"full"):void 0,!g),{isContextMenuOpen:C,handleBeforeContextMenu:f,handleContextMenu:S,handleContextMenuClose:k,handleContextMenuHide:w}=(0,si.A)(h,"paid"!==t.type,void 0,void 0,void 0,!0);(0,n.vJ)((()=>{C&&(A?.(t),k(),w())}),[k,A,w,C,t]);const N="paid"===t.type?rl.w.StarReaction:b,I=(0,M.A)((()=>{u(t)})),P=(0,In.A)(b),T=(0,de.A)("AVrrYEbM",s&&"QkdO_lz1",!y&&"sticker-reaction");return n.Ay.createElement("div",{ref:h,className:T,onClick:I,title:p?.title,"data-sticker-id":y?t.documentId:void 0,onMouseDown:f,onContextMenu:S},y?n.Ay.createElement(Zi.A,{ref:h,documentId:t.documentId,size:r.g0Q,noPlay:!i,observeIntersectionForPlaying:o,sharedCanvasRef:c,sharedCanvasHqRef:d,withTranslucentThumb:!0,forceAlways:m}):n.Ay.createElement(ol.A,{tgsUrl:N,thumbDataUri:v,play:i,noLoop:!1,size:r.g0Q,isLowPriority:!0,className:P,sharedCanvas:c.current||void 0,sharedCanvasCoords:E,forceAlways:m}))}));var cl=a(38027);const dl=(0,n.ph)((0,s.EK)((e=>{const t=e.collectibleEmojiStatuses?.statuses;return{collectibleStatuses:t}}))((e=>{let{stickerSet:t,loadAndPlay:a,index:i,idPrefix:o,isNearActive:d,favoriteStickers:m,availableReactions:u,isSavedMessages:A,isStatusPicker:h,isReactionPicker:y,isCurrentUserPremium:p,shouldHideHeader:v,withDefaultTopicIcon:g,selectedReactionIds:E,withDefaultStatusIcon:b,isChatEmojiSet:C,isChatStickerSet:f,isTranslucent:S,noContextMenus:k,forcePlayback:N,observeIntersection:P,observeIntersectionForPlayingItems:B,observeIntersectionForShowingItems:L,onReactionSelect:R,onReactionContext:x,onStickerSelect:F,onStickerUnfave:V,onStickerFave:D,onStickerRemoveRecent:_,onContextMenuOpen:U,onContextMenuClose:O,onContextMenuClick:J,collectibleStatuses:K}=e;const{clearRecentStickers:j,clearRecentCustomEmoji:G,clearRecentReactions:z,openPremiumModal:H,toggleStickerSet:$,loadStickers:Y}=(0,s.ko)(),Q=(0,n.li)(null),Z=(0,n.li)(null),X=(0,n.li)(null),ee=(0,T.A)(),{width:te}=(0,Ce.A)(),[ae,ne,se]=(0,I.A)(),{isMobile:ie}=(0,w.Ay)(),[re,oe]=(0,n.J0)(ml(te)),le=(0,zo.Vz)(Q,P??L),ce=(0,In.A)(le),me=d||le,ue=ie?8:4,Ae=ie?8:10,he=ie?8:4,ye=t.id===r.sR2,pe=t.id===r.j1l,ve=t.id===r.tRH,ge=t.id===r.EPW,Ee=t.isEmoji,be=!ye&&(0,c.Q31)(t),fe=(0,M.A)((()=>{y?z():Ee?G():j(),se()})),Se=(0,M.A)((()=>{be&&!p?H({initialSection:"animated_emoji"}):$({stickerSetId:t.id})})),ke=(0,M.A)((()=>{F?.({mediaType:"sticker",id:r.MyF,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})})),we=(0,M.A)((()=>{F?.({mediaType:"sticker",id:r.zNY,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})})),Ne=Ee?r.g0Q:r.bkT,Ie=Ee?Ae:ue,Pe=Ee?he:ue,Me=(0,M.A)((e=>e?Math.floor((e+Ie)/(Ne+Ie)):ml(te))),Te=(0,M.A)((e=>{oe(Me(e.contentRect.width))}));(0,il.A)(Q,Te),(0,n.vJ)((()=>{Q.current&&oe(Me(Q.current.clientWidth))}),[Me]),(0,n.vJ)((()=>{me&&!t.stickers?.length&&!t.reactions?.length&&t.accessHash&&Y({stickerSetInfo:{id:t.id,accessHash:t.accessHash}})}),[me,Y,t]);const Be=!A&&!p&&be&&!C,Le=t.installedDate&&!t.isArchived,Re=!Le&&t.id!==r.sR2&&t.id!==r.EPW&&t.id!==r.hfH&&t.id!==r.Kp3&&!C&&!f,[xe,,Fe]=(0,I.A)(Re),Ve=3*re-1,De=g||b?t.count+1:t.count,_e=Ne+Pe,Ue=Math.ceil(Math.min(Ve,De)/re)*_e-Pe,Oe=xe?Ue:Math.ceil(De/re)*_e-Pe,Je=(0,n.Kr)((()=>m?new Set(m.map((e=>{let{id:t}=e;return t}))):void 0),[m]),Ke=(0,n.Kr)((()=>K?new Set(K.map((e=>{let{documentId:t}=e;return t}))):void 0),[K]),je=!v&&!ye&&!pe&&Ee&&!ge&&!C&&(!Le||!p&&!A),Ge=(0,n.Kr)((()=>ee(Be?Le?"lng_emoji_premium_restore":"Unlock":"Add")),[Be,ee,Le]);return n.Ay.createElement("div",{ref:Q,key:t.id,id:`${o}-${i}`,className:(0,de.A)("symbol-set",Be&&"symbol-set-locked")},!v&&n.Ay.createElement("div",{className:"symbol-set-header"},n.Ay.createElement("p",{className:(0,de.A)("symbol-set-title",je&&"symbol-set-title-external")},Be&&n.Ay.createElement(q.A,{name:"lock-badge",className:"symbol-set-locked-icon"}),n.Ay.createElement("span",{className:"symbol-set-name"},t.title),(C||f)&&n.Ay.createElement("span",{className:"symbol-set-chat"},ee(C?"GroupEmoji":"GroupStickers")),je&&Boolean(t.stickers)&&n.Ay.createElement("span",{className:"symbol-set-amount"},ee(Ee?"EmojiCount":"Stickers",t.stickers.length,"i"))),ye&&n.Ay.createElement(q.A,{className:"symbol-set-remove",name:"close",onClick:ne}),je&&n.Ay.createElement(W.A,{className:"symbol-set-add-button",withPremiumGradient:be&&!p,onClick:Se,pill:!0,size:"tiny",fluid:!0},Ge)),n.Ay.createElement("div",{className:(0,de.A)("symbol-set-container shared-canvas-container",ce,t.id===r.hfH&&"effect-emojis"),style:`height: ${Oe}px;`},n.Ay.createElement("canvas",{ref:Z,className:"shared-canvas",style:Re?`height: ${Ue}px;`:void 0}),(ye||ve||Re)&&n.Ay.createElement("canvas",{ref:X,className:"shared-canvas"}),g&&n.Ay.createElement(W.A,{className:"StickerButton custom-emoji",color:"translucent",onClick:ke,key:"default-topic-icon"},n.Ay.createElement("img",{src:cl,alt:"Reset",className:"sticker-media",draggable:!1})),b&&n.Ay.createElement(W.A,{className:"StickerButton custom-emoji status-default",color:"translucent",onClick:we,key:"default-status-icon"},n.Ay.createElement(q.A,{name:"star"})),me&&t.reactions?.map((e=>{const s=(0,l.Jjj)(e),i=s?E?.includes(s):void 0;return n.Ay.createElement(ll,{key:`${t.id}_${s}`,reaction:e,isSelected:i,loadAndPlay:a,availableReactions:u,observeIntersection:B,onClick:R,onContextMenu:x,sharedCanvasRef:Z,sharedCanvasHqRef:X,forcePlayback:N})})),me&&t.stickers?.slice(0,xe?Ve:t.stickers.length).map(((e,i)=>{const o=(ye||ve)&&(0,c.CzR)((0,s.mS)(),e.stickerSetInfo),l=Re&&i>=Ve||o?X:Z,d=e.isCustomEmoji?e.id:e.emoji,m=d?E?.includes(d):void 0,u=e.id===r.j1l||Ke?.has(e.id);return n.Ay.createElement(sl,{key:e.id,sticker:e,size:Ne,observeIntersection:B,observeIntersectionForShowing:L,noPlay:!a,isSavedMessages:A,isStatusPicker:h,canViewSet:!0,noContextMenu:k,isCurrentUserPremium:p,shouldIgnorePremium:C,sharedCanvasRef:l,withTranslucentThumb:S,onClick:F,clickArg:e,isSelected:m,onUnfaveClick:ve&&Je?.has(e.id)?V:void 0,onFaveClick:Je?.has(e.id)?void 0:D,onRemoveRecentClick:ye?_:void 0,onContextMenuOpen:U,onContextMenuClose:O,onContextMenuClick:J,forcePlayback:N,isEffectEmoji:t.id===r.hfH,noShowPremium:p&&(t.id===r.Kp3||t.id===r.hfH),withSparkles:u})})),xe&&De>Ve&&n.Ay.createElement(W.A,{className:"StickerButton custom-emoji set-expand",round:!0,color:"translucent",onClick:Fe,key:"more"},"+",De-Ve)),ye&&n.Ay.createElement(tn.A,{text:ee(y?"ClearRecentReactionsAlertMessage":"ClearRecentStickersAlertMessage"),isOpen:ae,onClose:se,confirmHandler:fe,confirmIsDestructive:!0}))})));function ml(e){return e>440?8:e<362?6:7}const ul="p7c8y0LH",Al="zTGriBHY",hl="Qn3lBUNs",yl="HMspKpNp",pl="YKO0Obwy",vl="BZfaP1GD",gl=2.5*A.$,El="custom-emoji-set",bl=new Set([r.sR2,r.tRH,r.EPW]),Cl=new Set([r.sR2,r.tRH,r.EPW]),fl=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a,isStatusPicker:n,isReactionPicker:s}=t;const{stickers:{setsById:i},customEmojis:{byId:r,featuredIds:o,statusRecent:{emojis:l}},recentCustomEmojis:d,reactions:{availableReactions:m,recentReactions:u,topReactions:A,defaultTags:h}}=e,y=Boolean(a&&(0,c.nZ4)(e,a)),p=a?(0,c.AWZ)(e,a):void 0,v=e.collectibleEmojiStatuses?.statuses;return{customEmojisById:r,recentCustomEmojiIds:n?void 0:d,recentStatusEmojis:n?l:void 0,collectibleStatuses:n?v:void 0,stickerSetsById:i,addedCustomEmojiIds:e.customEmojis.added.setIds,canAnimate:(0,c.BWX)(e),isSavedMessages:y,isCurrentUserPremium:(0,c.g29)(e),customEmojiFeaturedIds:o,defaultTopicIconsId:e.defaultTopicIconsId,defaultStatusIconsId:e.defaultStatusIconsId,topReactions:s?A:void 0,recentReactions:s?u:void 0,chatEmojiSetId:p?.emojiSet?.id,isWithPaidReaction:s&&p?.isPaidReactionAvailable,availableReactions:s?m:void 0,defaultTagReactions:s?h:void 0}}))((e=>{let{className:t,pickerListClassName:a,isHidden:i,loadAndPlay:o,addedCustomEmojiIds:d,customEmojisById:m,recentCustomEmojiIds:u,selectedReactionIds:A,recentStatusEmojis:h,collectibleStatuses:y,stickerSetsById:p,chatEmojiSetId:v,topReactions:g,recentReactions:E,availableReactions:C,idPrefix:f=El,customEmojiFeaturedIds:S,canAnimate:k,isReactionPicker:N,isStatusPicker:I,isTranslucent:P,isSavedMessages:B,isCurrentUserPremium:L,withDefaultTopicIcons:R,defaultTopicIconsId:x,defaultStatusIconsId:F,defaultTagReactions:V,isWithPaidReaction:D,onCustomEmojiSelect:_,onReactionSelect:U,onReactionContext:O,onContextMenuOpen:J,onContextMenuClose:K,onContextMenuClick:j}=e;const G=(0,n.li)(null),z=(0,n.li)(null),H=(0,n.li)(null),$=(0,n.li)(null),{isMobile:Y}=(0,w.Ay)(),{handleScroll:Q,isAtBeginning:Z}=is(),X=(0,n.Kr)((()=>I?h:Object.values((0,on._E)(m,u))),[m,I,u,h]),ee=(0,n.Kr)((()=>{const e=y?.map((e=>e.documentId));return m&&e?.map((e=>m[e])).filter(Boolean)}),[m,y]),te=`${f}-custom-emoji`,{activeSetIndex:ae,observeIntersectionForSet:ne,observeIntersectionForPlayingItems:se,observeIntersectionForShowingItems:ie,observeIntersectionForCovers:re,selectStickerSet:oe}=qo(G,z,te,i),le=(0,Dn.A)(o||void 0,r.jhd),ce=(0,T.A)(),me=(0,Us.A)(),ue=Boolean(d),Ae=(0,n.Kr)((()=>{const e=[];if(N&&B&&V?.length&&e.push({id:r.G3A,accessHash:"",title:ce("PremiumPreviewTags"),reactions:V,count:V.length,isEmoji:!0}),N&&!B){const t=g?.slice(0,16)||[];D&&t.unshift({type:"paid"}),t?.length&&e.push({id:r.G3A,accessHash:"",title:ce("Reactions"),reactions:t,count:t.length,isEmoji:!0});const a=(E||[]).filter((e=>!t.some((t=>(0,l.a0K)(t,e))))).slice(0,32),n=(C||[]).filter((e=>{let{isInactive:t}=e;return!t})).map((e=>{let{reaction:t}=e;return t})).filter((e=>!t.some((t=>(0,l.a0K)(t,e)))&&!a.some((t=>(0,l.a0K)(t,e)))));if(n?.length||a?.length){const t=!a?.length,s=a.concat(n);e.push({id:t?r.EPW:r.sR2,accessHash:"",title:ce(t?"PopularReactions":"RecentStickers"),reactions:s,count:s.length,isEmoji:!0})}}else if(I){const t=p[F];if(t?.stickers?.length){const a=(0,on.Xd)(t.stickers.slice(0,7).concat(X||[]),"id");e.push({...t,stickers:a,count:a.length,id:r.sR2,title:ce("RecentStickers"),isEmoji:!0})}ee?.length&&e.push({id:r.j1l,accessHash:"",count:ee.length,stickers:ee,title:me("CollectibleStatusesCategory"),isEmoji:!0})}else if(R){const t=p[x];t.stickers?.length&&e.push({...t,id:r.sR2,title:ce("RecentStickers")})}else X?.length&&e.push({id:r.sR2,accessHash:"0",title:ce("RecentStickers"),stickers:X,count:X.length,isEmoji:!0});const t=[...d||[]];v&&t.unshift(v);const a=(0,on.Am)(t.concat(S||[])),n=Object.values((0,on._E)(p,a));return[...e,...n]}),[d,N,I,R,X,S,p,g,C,ce,E,F,x,B,V,v,D,ee,me]),he=(0,n.Kr)((()=>ue&&0===Ae.filter((e=>e.stickers?.length)).length),[Ae,ue]),ye=(0,jo.A)([],r.jhd),pe=ue&&ye&&!he;(0,di.A)(z,Y||!pe),(0,n.vJ)((()=>{if(!ue)return;const e=z.current;if(!e)return;const t=ae*gl-(e.offsetWidth/2-gl/2);(0,ar.A)(e,t)}),[ue,ae]);const ve=(0,M.A)((e=>{_(e)})),ge=(0,de.A)("StickerPicker","Qk9PEGRE",t);if(!pe)return n.Ay.createElement("div",{className:ge},he?n.Ay.createElement("div",{className:vl},ce("NoStickers")):n.Ay.createElement(fs.A,null));const Ee=(0,de.A)(hl,"no-scrollbar",!Z&&yl),be=(0,de.A)(ul,"U0BL1VvK",b.TF?"no-scrollbar":"custom-scroll",a,Al);return n.Ay.createElement("div",{className:ge},n.Ay.createElement("div",{ref:z,className:Ee},n.Ay.createElement("div",{className:"shared-canvas-container"},n.Ay.createElement("canvas",{ref:H,className:"shared-canvas"}),n.Ay.createElement("canvas",{ref:$,className:"shared-canvas"}),Ae.map((function(e,t){const a=e.stickers?.[0],i=(0,de.A)(pl,t===ae&&"WYeuJNQx"),o=t<r.j41,l=(0,c.CzR)((0,s.mS)(),e);if(e.id!==r.G3A){if(Cl.has(e.id)||e.hasThumbnail||!a){const a=e.id===r.sR2||e.id===r.EPW,s=bl.has(e.id);return n.Ay.createElement(W.A,{key:e.id,className:i,ariaLabel:e.title,round:!0,faded:s,color:"translucent",onClick:()=>oe(a?0:t)},a?n.Ay.createElement(q.A,{name:"recent"}):n.Ay.createElement(Xo,{stickerSet:e,noPlay:!k||!le,forcePlayback:!0,observeIntersection:re,sharedCanvasRef:o?l?$:H:void 0}))}return n.Ay.createElement(sl,{key:e.id,sticker:a,size:r.TBj,title:e.title,className:i,noPlay:!k||!le,observeIntersection:re,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:o?l?$:H:void 0,withTranslucentThumb:P,onClick:oe,clickArg:t,forcePlayback:!0})}})))),n.Ay.createElement("div",{ref:G,onScroll:Q,className:be},Ae.map(((e,t)=>{const a=e.id===r.G3A||e.id===r.sR2&&(R||I),s=e.id===v;return n.Ay.createElement(dl,{key:e.id,stickerSet:e,loadAndPlay:Boolean(k&&le),index:t,idPrefix:te,observeIntersection:ne,observeIntersectionForPlayingItems:se,observeIntersectionForShowingItems:ie,isNearActive:ae>=t-1&&ae<=t+1,isSavedMessages:B,isStatusPicker:I,isReactionPicker:N,shouldHideHeader:a,withDefaultTopicIcon:R&&e.id===r.sR2,withDefaultStatusIcon:I&&e.id===r.sR2,isChatEmojiSet:s,isCurrentUserPremium:L,selectedReactionIds:A,availableReactions:C,isTranslucent:P,onReactionSelect:U,onReactionContext:O,onStickerSelect:ve,onContextMenuOpen:J,onContextMenuClose:K,onContextMenuClick:j,forcePlayback:!0})}))))})));var Sl=a(3325);const kl=(0,n.ph)((0,s.EK)((e=>({areFeaturedStickersLoaded:Boolean(e.customEmojis.featuredIds?.length),isTranslucent:(0,c.cwE)(e)})))((e=>{let{isOpen:t,statusButtonRef:a,areFeaturedStickersLoaded:i,isTranslucent:r,onEmojiStatusSelect:o,onClose:l}=e;const{loadFeaturedEmojiStickers:c}=(0,s.ko)(),d=(0,n.li)(),[m,u,A]=(0,I.A)();(0,n.vJ)((()=>{d.current=a.current.getBoundingClientRect().right}),[t,a]),(0,n.vJ)((()=>{t&&!i&&c()}),[i,t,c]);const h=(0,n.hb)((e=>{o(e),l()}),[l,o]);return n.Ay.createElement(Sl.A,null,n.Ay.createElement(Ge.A,{isOpen:t,noCompact:!0,positionX:"right",bubbleClassName:"hRzvfaRb",onClose:l,transformOriginX:d.current,noCloseOnBackdrop:m},n.Ay.createElement(fl,{idPrefix:"status-emoji-set-",loadAndPlay:t,isHidden:!t,isStatusPicker:!0,isTranslucent:r,onContextMenuOpen:u,onContextMenuClose:A,onCustomEmojiSelect:h,onContextMenuClick:l})))})));var wl=a(10187);const Nl=6*A.$,Il=(0,n.ph)((0,s.EK)(((e,t)=>{let{modal:a}=t;return{currentUser:(0,c.mBe)(e,e.currentUserId),bot:a?.botId?(0,c.mBe)(e,a.botId):void 0}}))((e=>{let{modal:t,currentUser:a,bot:i}=e;const{setEmojiStatus:r,closeSuggestedStatusModal:o,sendWebAppEvent:c}=(0,s.ko)(),d=(0,Us.A)(),m=Boolean(t),u=(0,Cn.A)(t),A=(0,n.Kr)((()=>{if(a&&u)return{...a,emojiStatus:{type:"regular",documentId:u.customEmojiId}}}),[a,u]),h=(0,n.Kr)((()=>{if(!u||!i)return;const e=(0,l.YgS)(i);return u.duration?d("BotSuggestedStatusFor",{bot:e,duration:(0,Ke.A$)(d,u.duration)},{withNodes:!0,withMarkdown:!0}):d("BotSuggestedStatus",{bot:e},{withNodes:!0,withMarkdown:!0})}),[i,d,u]),y=(0,M.A)((()=>{const e=u?.webAppKey;e&&c({webAppKey:e,event:{eventType:"emoji_status_failed",eventData:{error:"USER_DECLINED"}}}),o()})),p=(0,M.A)((()=>{if(!u)return;const e=u.duration?(0,qa.Fm)()+u.duration:void 0;r({referrerWebAppKey:u.webAppKey,emojiStatus:{type:"regular",documentId:u.customEmojiId,until:e}}),o()}));return n.Ay.createElement(Q.A,{isOpen:m,contentClassName:"C9sWDINB",hasAbsoluteCloseButton:!0,isSlim:!0,onClose:y},u&&n.Ay.createElement(Zi.A,{className:"gdG3oY21",documentId:u.customEmojiId,size:Nl,loopLimit:1,forceAlways:!0}),n.Ay.createElement("div",null,n.Ay.createElement("h3",{className:"KVpsce1g"},d("BotSuggestedStatusTitle")),n.Ay.createElement("p",{className:"p7S4AH8A"},h)),A&&n.Ay.createElement(wl.A,{mockPeer:A,withEmojiStatus:!0}),n.Ay.createElement(W.A,{size:"smaller",onClick:p},d("GeneralConfirm")))})));var Pl=a(55317),Ml=a(20333);const Tl="j6xEoljc";function Bl(e,t){return e.find((e=>!e.chatId))||e.filter((e=>t&&e.chatId!==t)).sort(((e,t)=>e.date-t.date))[0]}const Ll=(0,n.ph)((0,s.EK)(((e,t)=>{let{modal:a}=t;const n=a&&(0,c.hds)(e,a?.chatId),s=n&&(0,c.AWZ)(e,n.id),i=a?.myBoosts&&Bl(a.myBoosts,a.chatId);return{chat:n,chatFullInfo:s,prevBoostedChat:i?.chatId?(0,c.hds)(e,i?.chatId):void 0,isCurrentUserPremium:(0,c.g29)(e)}}))((e=>{let{modal:t,chat:a,chatFullInfo:i,prevBoostedChat:r,isCurrentUserPremium:o}=e;const{applyBoost:c,closeBoostModal:d,requestConfetti:m,openPremiumModal:u,loadFullChat:A}=(0,s.ko)(),[h,y,p]=(0,I.A)(),[v,g,E]=(0,I.A)(),[b,C,f]=(0,I.A)(),S=a&&(0,l.WXB)(a),k=Boolean(t),w=(0,T.A)(),N=(0,Us.A)();(0,n.vJ)((()=>{a&&!i&&A({chatId:a.id})}),[a,i]);const P=(0,n.Kr)((()=>{if(a)return(0,l.JsG)(w,a)}),[a,w]),B=(0,n.Kr)((()=>{if(r)return(0,l.JsG)(w,r)}),[r,w]),{isStatusLoaded:L,isBoosted:R,boost:x,title:F,leftText:V,rightText:D,value:_,progress:U,descriptionText:O,canBoostMore:J}=(0,n.Kr)((()=>{if(!t?.boostStatus||!a)return{isStatusLoaded:!1,title:w("Loading")};const{hasMyBoost:e}=t.boostStatus,n=t?.myBoosts&&Bl(t.myBoosts,a.id),s=t?.myBoosts&&(r=t.myBoosts,o=a.id,!r.every((e=>e.chatId===o)));var r,o;const{boosts:c,currentLevel:d,hasNextLevel:m,levelProgress:u,remainingBoosts:A,isMaxLevel:h}=(0,Pl.z)(t.boostStatus,!0),y=e,p=w("BoostsLevel",d),v=m?w("BoostsLevel",d+1):void 0,g=w("ChannelBoost.MoreBoosts",A),E=w(S?"BoostChannel":"BoostGroup"),b=(i?.boostsToUnrestrict||0)-(i?.boostsApplied||0);let C;if(h)C=w("BoostsMaxLevelReached");else if(b>0&&!(0,l.SJk)(a)){const e=w("GroupBoost.BoostToUnrestrict.Times",b);C=w("GroupBoost.BoostToUnrestrict",[e,P])}else C=w("ChannelBoost.MoreBoostsNeeded.Text",[P,g]);return{isStatusLoaded:!0,title:E,leftText:p,rightText:v,value:c.toString(),progress:u,remainingBoosts:A,descriptionText:C,boost:n,isBoosted:y,canBoostMore:s&&!h}}),[a,P,t,w,i,S]),K=!t?.myBoosts?.length&&o,j=x?.chatId&&x.chatId!==t?.chatId,G=(0,M.A)((()=>{p(),c({chatId:a.id,slots:[x.slot]}),m({})})),z=(0,M.A)((()=>{u(),f(),d()})),H=(0,M.A)((()=>{if(!x)return o?void d():void C();J?x.cooldownUntil?g():j?y():G():d()})),$=(0,M.A)((()=>{d()}));return n.Ay.createElement(Q.A,{isOpen:k,title:F,className:"IK2mBqbm",contentClassName:"pUyNTysT",onClose:d},L?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Ml.A,{leftText:V,rightText:D,progress:U,floatingBadgeText:_,floatingBadgeIcon:"boost"}),R&&n.Ay.createElement("div",{className:(0,de.A)(Tl,"hAA6B1lc")},w("ChannelBoost.YouBoostedChannelText",P)),n.Ay.createElement("div",{className:Tl},(0,kt.A)(O,["simple_markdown","emoji"])),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(W.A,{isText:!0,className:"confirm-dialog-button",disabled:K,onClick:H},J?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(q.A,{name:"boost"}),w(S?"ChannelBoost.BoostChannel":"GroupBoost.BoostGroup")):w("OK")),n.Ay.createElement(W.A,{isText:!0,className:"confirm-dialog-button",onClick:$},w("Cancel")))):n.Ay.createElement(fs.A,{className:"zjXCH3pT"}),j&&B&&n.Ay.createElement(Q.A,{isOpen:h,className:"GIFAjZPY",contentClassName:"Jxyz9TaL",onClose:p},n.Ay.createElement("div",{className:"OKp6HS1U"},n.Ay.createElement("div",{className:"NU9itcIm"},n.Ay.createElement(wt.A,{peer:r,size:"large"}),n.Ay.createElement(q.A,{name:"boostcircle",className:"upXvhNRY"})),n.Ay.createElement(q.A,{name:"next",className:"WSJdWV7L"}),n.Ay.createElement(wt.A,{peer:a,size:"large"})),n.Ay.createElement("div",null,(0,kt.A)(w("ChannelBoost.ReplaceBoost",[B,P]),["simple_markdown","emoji"])),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(W.A,{isText:!0,className:"confirm-dialog-button",onClick:G},w("Replace")),n.Ay.createElement(W.A,{isText:!0,className:"confirm-dialog-button",onClick:p},w("Cancel")))),Boolean(x?.cooldownUntil)&&n.Ay.createElement(tn.A,{isOpen:v,isOnlyConfirm:!0,confirmLabel:w("OK"),title:w("ChannelBoost.Error.BoostTooOftenTitle"),onClose:E,confirmHandler:E},(0,kt.A)(w("ChannelBoost.Error.BoostTooOftenText",(0,Ke.A$)(N,x.cooldownUntil-(0,qa.Fm)())),["simple_markdown","emoji"])),!o&&n.Ay.createElement(tn.A,{isOpen:b,confirmLabel:w("Common.Yes"),title:w("PremiumNeeded"),onClose:f,confirmHandler:z},(0,kt.A)(w("PremiumNeededForBoosting"),["simple_markdown","emoji"])))})));var Rl=a(47058),xl=a(70046);const Fl="xVLGjLub",Vl=(0,n.ph)((0,s.EK)(((e,t)=>{let{modal:a}=t;const{message:n}=a||{},s=n&&(0,c.O5q)(e,n.chatId,n.messageId),i=s&&(0,c.Y7C)(e,s);return{currentUserId:e.currentUserId,messageSender:i}}))((e=>{let{currentUserId:t,modal:a,messageSender:i}=e;const{closeGiftCodeModal:o,applyGiftCode:l,focusMessage:c}=(0,s.ko)(),d=(0,T.A)(),m=Boolean(a),u=!(a?.info.toId&&a?.info.toId!==t||a?.info.usedAt),A=(0,M.A)((()=>{a&&a.info.giveawayMessageId&&(c({chatId:a.info.fromId,messageId:a.info.giveawayMessageId}),o())})),h=(0,M.A)((()=>{u?l({slug:a.slug}):o()})),y=(0,n.Kr)((()=>{if(!a)return;const{slug:e,info:t}=a,s=t.fromId||i?.id;return{header:n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("img",{src:zr,alt:"",className:"Mtx4SWww"}),n.Ay.createElement("p",{className:Fl},(0,kt.A)(d("lng_gift_link_about"),["simple_markdown"])),n.Ay.createElement(Rl.A,{title:"BoostingGiftLink",link:`${r.jsp}/giftcode/${e}`})),tableData:[[d("BoostingFrom"),s?{chatId:s}:d("BoostingNoRecipient")],[d("BoostingTo"),t.toId?{chatId:t.toId}:d("BoostingNoRecipient")],[d("BoostingGift"),d("BoostingTelegramPremiumFor",d("Months",t.months,"i"))],[d("BoostingReason"),n.Ay.createElement("span",{className:(0,de.A)(t.giveawayMessageId&&"IzcASdzD"),onClick:A},t.isFromGiveaway&&!t.toId?d("BoostingIncompleteGiveaway"):d(t.isFromGiveaway?"BoostingGiveaway":"BoostingYouWereSelected"))],[d("BoostingDate"),(0,Ke.L2)(1e3*t.date,d.code,!0)]],footer:n.Ay.createElement("span",{className:Fl},(0,kt.A)(t.usedAt?d("BoostingUsedLinkDate",(0,Ke.L2)(1e3*t.usedAt,d.code,!0)):d("BoostingSendLinkToAnyone"),["simple_markdown"]))}}),[d,i?.id,a]);if(y)return n.Ay.createElement(xl.A,{isOpen:m,title:d("lng_gift_link_title"),tableData:y.tableData,header:y.header,footer:y.footer,buttonText:d(u?"BoostingUseLink":"Close"),onButtonClick:h,onClose:o})})));var Dl=a(34132),_l=a(24713);const Ul={description:"dl10exNi","picker-wrapper":"gxWY5c6x",pickerWrapper:"gxWY5c6x","picker-header":"h8N7eyob",pickerHeader:"h8N7eyob","picker-header-info":"Rth2Qu07",pickerHeaderInfo:"Rth2Qu07","selection-toggle":"B6eAugx8",selectionToggle:"B6eAugx8",foldersWrapper:"mwcvgD2S",folders:"LKavx8ww",folder:"qglLx5Dn","button-text":"bgaRuEMs",buttonText:"bgaRuEMs","button-badge":"rTe14Z22",buttonBadge:"rTe14Z22"},Ol=(0,n.ph)((e=>{let{invite:t,folder:a}=e;const{closeChatlistModal:i,joinChatlistInvite:r}=(0,s.ko)(),o=(0,Us.A)(),l=(0,T.A)(),[c,d]=(0,n.J0)(t.missingPeerIds),m=Boolean(t.missingPeerIds.length),u=0===t.alreadyPeerIds.length,A=m?t.missingPeerIds.length:0,h=c.length?c.length.toString():void 0,y=u?o("FolderLinkSubtitleNew"):A?o("FolderLinkSubtitleAdd",{chats:o("FolderLinkSubtitleAddCount",{count:A},{pluralValue:A}),title:(0,Un.f)({text:a.title.text,entities:a.title.entities,noCustomEmojiPlayback:a.noTitleAnimations})},{withNodes:!0,withMarkdown:!0}):o("FolderLinkSubtitleAlready"),p=(0,n.hb)((()=>{i(),c.length&&r({invite:t,peerIds:c})}),[t,c]),v=(0,n.hb)((()=>{const e=c.length===t.missingPeerIds.length;d(e?[]:t.missingPeerIds)}),[t.missingPeerIds,c.length]);return n.Ay.createElement("div",{className:Ul.content},n.Ay.createElement("div",{className:Ul.description},(0,kt.A)(y,["simple_markdown","emoji"])),n.Ay.createElement("div",{className:(0,de.A)(Ul.pickerWrapper,"custom-scroll")},Boolean(t.missingPeerIds.length)&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:Ul.pickerHeader},n.Ay.createElement("div",{className:Ul.pickerHeaderInfo},l("FolderLinkHeaderChatsJoin",c.length,"i")),n.Ay.createElement("div",{className:Ul.selectionToggle,role:"button",tabIndex:0,onClick:v},c.length===t.missingPeerIds.length?l("DeselectAll"):l("SelectAll"))),n.Ay.createElement(cn.A,{itemIds:t.missingPeerIds,onSelectedIdsChange:d,selectedIds:c,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})),n.Ay.createElement("div",{className:Ul.pickerHeader},n.Ay.createElement("div",{className:Ul.pickerHeaderInfo},l("FolderLinkHeaderAlready"))),n.Ay.createElement(cn.A,{itemIds:t.alreadyPeerIds,lockedSelectedIds:t.alreadyPeerIds,selectedIds:t.alreadyPeerIds,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})),n.Ay.createElement(W.A,{size:"smaller",onClick:p},n.Ay.createElement("div",{className:Ul.buttonText},!c.length&&l("OK"),Boolean(c.length)&&n.Ay.createElement(n.Ay.Fragment,null,l("FolderLinkButtonJoinPlural",c.length,"i"),n.Ay.createElement(_l.A,{className:Ul.buttonBadge,text:h,isAlternateColor:!0})))))})),Jl=(0,n.ph)((e=>{let{folder:t,suggestedPeerIds:a=ln.p}=e;const{closeChatlistModal:i,leaveChatlist:r}=(0,s.ko)(),o=(0,T.A)(),[l,c]=(0,n.J0)([]),d=l.length?l.length.toString():void 0,m=(0,n.hb)((()=>{const e=l.length===a.length;c(e?[]:a)}),[a,l.length]),u=(0,n.hb)((()=>{i(),r({folderId:t.id,peerIds:l})}),[t.id,l]);return n.Ay.createElement("div",{className:Ul.content},Boolean(a?.length)&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:Ul.description},(0,kt.A)(o("FolderLinkSubtitleRemove"),["simple_markdown","emoji"])),n.Ay.createElement("div",{className:(0,de.A)(Ul.pickerWrapper,"custom-scroll")},n.Ay.createElement("div",{className:Ul.pickerHeader},n.Ay.createElement("div",{className:Ul.pickerHeaderInfo},o("FolderLinkHeaderChatsQuit",l.length,"i")),n.Ay.createElement("div",{className:Ul.selectionToggle,role:"button",tabIndex:0,onClick:m},l.length===a.length?o("DeselectAll"):o("SelectAll"))),n.Ay.createElement(cn.A,{itemIds:a,onSelectedIdsChange:c,selectedIds:l,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}))),n.Ay.createElement(W.A,{size:"smaller",onClick:u},n.Ay.createElement("div",{className:Ul.buttonText},!l.length&&o("FolderLinkButtonRemove"),Boolean(l.length)&&n.Ay.createElement(n.Ay.Fragment,null,o("FolderLinkButtonRemoveChats"),n.Ay.createElement(_l.A,{className:Ul.buttonBadge,text:d,isAlternateColor:!0})))))})),Kl=(0,n.ph)((e=>{let{invite:t}=e;const{closeChatlistModal:a,joinChatlistInvite:i}=(0,s.ko)(),r=(0,Us.A)(),o=(0,T.A)(),[l,c]=(0,n.J0)(t.peerIds),d=(0,n.Kr)((()=>{const e=(0,s.mS)().chats.byId;return t.peerIds.filter((t=>!e[t].isNotJoined))}),[t.peerIds]),m=l.length-d.length,u=m?m.toString():void 0,A=(0,n.hb)((()=>{a(),i({invite:t,peerIds:l})}),[t,l]),h=(0,n.hb)((()=>{const e=l.length===t.peerIds.length;c(e?d:t.peerIds)}),[t.peerIds,d,l.length]);return n.Ay.createElement("div",{className:Ul.content},n.Ay.createElement("div",{className:Ul.description},r("FolderLinkSubtitleNew")),n.Ay.createElement("div",{className:(0,de.A)(Ul.pickerWrapper,"custom-scroll")},n.Ay.createElement("div",{className:Ul.pickerHeader},n.Ay.createElement("div",{className:Ul.pickerHeaderInfo},o("FolderLinkHeaderChatsJoin",m,"i")),n.Ay.createElement("div",{className:Ul.selectionToggle,role:"button",tabIndex:0,onClick:h},l.length===t.peerIds.length?o("DeselectAll"):o("SelectAll"))),n.Ay.createElement(cn.A,{itemIds:t.peerIds,lockedSelectedIds:d,onSelectedIdsChange:c,selectedIds:l,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})),n.Ay.createElement(W.A,{onClick:A,size:"smaller",disabled:!l.length},n.Ay.createElement("div",{className:Ul.buttonText},r("FolderLinkAddFolder"),n.Ay.createElement(_l.A,{className:Ul.buttonBadge,text:u,isAlternateColor:!0}))))})),jl=(0,n.ph)((0,s.EK)(((e,t)=>{let{modal:a}=t;const{invite:n,removal:s}=a||{},i=s?.folderId||(n&&"folderId"in n?n.folderId:void 0);return{folder:i?(0,c.$aQ)(e,i):void 0}}))((e=>{let{modal:t,folder:a}=e;const{closeChatlistModal:i}=(0,s.ko)(),r=(0,T.A)(),o=Boolean(t),l=(0,D.A)(t)||t,c=(0,D.A)(a)||a,d=(0,n.Kr)((()=>{if(l){if(l.invite){const e=l.invite;return"alreadyPeerIds"in e?e.missingPeerIds.length?r("FolderLinkTitleAddChats"):r("FolderLinkTitleAlready"):r("FolderLinkTitleAdd")}return l.removal?r("FolderLinkTitleRemove"):void 0}}),[r,l]),m=(0,n.Kr)((()=>c?(0,Un.f)({text:c.title.text,entities:c.title.entities,noCustomEmojiPlayback:c.noTitleAnimations}):l?.invite&&"title"in l.invite?(0,Un.f)({text:l.invite.title.text,entities:l.invite.title.entities,noCustomEmojiPlayback:l.invite.noTitleAnimations}):void 0),[c,l]),u=(0,n.Kr)((()=>{if(l?.invite)return"missingPeerIds"in l.invite?l.invite.missingPeerIds.length:void 0}),[l]),A=(0,n.hb)((()=>{if(l){if(l.invite){const e=l.invite;return"alreadyPeerIds"in e?n.Ay.createElement(Ol,{invite:e,folder:c}):n.Ay.createElement(Kl,{invite:e})}return l.removal?n.Ay.createElement(Jl,{folder:c,suggestedPeerIds:l.removal.suggestedPeerIds}):void 0}}),[c,l]);return n.Ay.createElement(Q.A,{isOpen:o,title:d,onClose:i,isSlim:!0,hasCloseButton:!0},m&&(h=m,n.Ay.createElement("div",{className:Ul.foldersWrapper},n.Ay.createElement("div",{className:Ul.folders},n.Ay.createElement(Dl.A,{className:Ul.folder,title:r("FolderLinkPreviewLeft")}),n.Ay.createElement(Dl.A,{className:Ul.folder,isActive:!0,badgeCount:u,isBadgeActive:!0,title:h}),n.Ay.createElement(Dl.A,{className:Ul.folder,title:r("FolderLinkPreviewRight")})))),A());var h})));var Gl=a(29886);const zl={content:"MZ0RCecx",title:"ar8XeydN",participantCount:"un00TXYY",participants:"YvkZ6c2D",participant:"DHJSBDeE",buttons:"KFtrPtNr"},Hl=(0,n.ph)((e=>{let{modal:t}=e;const{acceptChatInvite:a,closeChatInviteModal:i,showNotification:r}=(0,s.ko)(),o=(0,n.li)(null),d=(0,T.A)(),m=(0,Gl.A)(t),{hash:u,inviteInfo:A}=t||m||{},{about:h,isBroadcast:y,participantIds:p,participantsCount:v,photo:g,isRequestNeeded:E}=A||{},b=(0,M.A)((()=>{i()})),C=(0,M.A)((()=>{a({hash:u}),r({message:d(y?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")}),b()})),f=y?"ProfileJoinChannel":"JoinGroup",S=y?"MemberRequests.RequestToJoinChannel":"MemberRequests.RequestToJoinGroup",k=(0,n.Kr)((()=>{if(A)return(0,l.nrT)(A)}),[A]),w=(0,n.Kr)((()=>{if(!p)return;const e=(0,s.mS)();return p.map((t=>(0,c.mBe)(e,t))).filter(Boolean)}),[p]);return(0,di.A)(o,!t||!w),n.Ay.createElement(Q.A,{isOpen:Boolean(t),contentClassName:zl.content,isSlim:!0,onClose:b,onEnter:C},k&&n.Ay.createElement(wt.A,{size:"jumbo",photo:g,peer:k,withVideo:!0}),k&&n.Ay.createElement(Ss.A,{className:zl.title,peer:k}),h&&n.Ay.createElement("p",{className:zl.about},h),n.Ay.createElement("p",{className:zl.participantCount},d(y?"Subscribers":"Members",v,"i")),w&&n.Ay.createElement("div",{ref:o,className:(0,de.A)(zl.participants,"no-scrollbar")},w.map((e=>n.Ay.createElement(Ai.A,{className:zl.participant,peer:e,text:(0,l.YgS)(e)})))),n.Ay.createElement("div",{className:(0,de.A)("dialog-buttons",zl.buttons)},n.Ay.createElement(W.A,{isText:!0,className:"confirm-dialog-button",onClick:C},d(E?S:f)),n.Ay.createElement(W.A,{isText:!0,className:"confirm-dialog-button",onClick:b},d("Cancel"))))}));var $l=a(84685),ql=a(33527),Wl=a(5463);const Yl="La4sUYaq",Ql="Bn5kz5br",Zl=(0,n.ph)((0,s.EK)(((e,t)=>{let{modal:a}=t;const n=a?.chatId?(0,c.v8U)(e,a.chatId):void 0,s=e.appConfig?.channelRestrictAdsLevelMin;return{message:n,minLevelToRestrictAds:s}}))((e=>{let{message:t,minLevelToRestrictAds:a}=e;const{closeAboutAdsModal:i}=(0,s.ko)(),r=(0,n.li)(null),o=Boolean(t),l=t?.canReport,c=(0,Cn.A)(l),d=(0,T.A)(),m=(0,n.Kr)((()=>n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",null,d("SponsoredMessageInfoScreen.Title")),n.Ay.createElement("p",null,(0,kt.A)(d("SponsoredMessageInfoDescription1"),["br"])),n.Ay.createElement("p",null,(0,kt.A)(d("SponsoredMessageInfoDescription2"),["br"])),n.Ay.createElement("p",null,(0,kt.A)(d("SponsoredMessageInfoDescription3"),["br"])),n.Ay.createElement("p",null,n.Ay.createElement($l.A,{url:d("SponsoredMessageAlertLearnMoreUrl"),text:d("SponsoredMessageAlertLearnMoreUrl")})),n.Ay.createElement("p",null,(0,kt.A)(d("SponsoredMessageInfoDescription4"),["br"])))),[d]),{isContextMenuOpen:u,contextMenuAnchor:A,handleContextMenu:h,handleContextMenuClose:y,handleContextMenuHide:p}=(0,si.A)(r,!c),v=(0,M.A)((()=>{i(),y(),p()})),g=(0,n.Kr)((()=>{if(o)return{header:n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:Yl},d("AboutRevenueSharingAds")),n.Ay.createElement("p",{className:(0,de.A)(Ql,"hbsLlXSH")},d("RevenueSharingAdsAlertSubtitle")),n.Ay.createElement(W.A,{ref:r,round:!0,size:"smaller",color:"translucent",className:"JdN5pGTw",onClick:h},n.Ay.createElement(q.A,{name:"more"}))),listItemData:[["lock",d("RevenueSharingAdsInfo1Title"),(0,kt.A)(d("RevenueSharingAdsInfo1Subtitle"),["simple_markdown"])],["revenue-split",d("RevenueSharingAdsInfo2Title"),(0,kt.A)(d("RevenueSharingAdsInfo2Subtitle"),["simple_markdown"])],["nochannel",d("RevenueSharingAdsInfo3Title"),(0,kt.A)(d("RevenueSharingAdsInfo3Subtitle",a),["simple_markdown"])]],footer:n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:Yl},(0,kt.A)(d("RevenueSharingAdsInfo4Title"),["simple_markdown"])),n.Ay.createElement("p",{className:Ql},(0,kt.A)(d("RevenueSharingAdsInfo4Subtitle2",""),["simple_markdown"]),n.Ay.createElement($l.A,{url:d("PromoteUrl"),text:d("LearnMoreArrow")})))}}),[o,d,h,a]);return c?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Wl.A,{isOpen:o,listItemData:g?.listItemData,headerIconName:"channel",withSeparator:!0,header:g?.header,footer:g?.footer,buttonText:d("RevenueSharingAdsUnderstood"),onClose:v}),A&&t&&n.Ay.createElement(ql.A,{isOpen:u,anchor:A,triggerRef:r,message:t,shouldSkipAbout:!0,onItemClick:v,onClose:y,onCloseAnimationEnd:p})):n.Ay.createElement(Q.A,{isOpen:o,className:"LFkgLoAk",contentClassName:"TZE15Pt_",onClose:v},m,n.Ay.createElement(W.A,{size:"smaller",onClick:v},d("RevenueSharingAdsUnderstood")))}))),Xl="t9iZUzOj",ec=(0,n.ph)((e=>{let{isOpen:t,onClose:a}=e;const s=(0,T.A)(),i=(0,Us.A)(),r=(0,n.Kr)((()=>{const e=s("LearnMore");return i("ChannelEarnLearnCoinAbout",{link:n.Ay.createElement($l.A,{url:s("MonetizationInfoTONLink"),text:e},e,n.Ay.createElement(q.A,{name:"next"}))},{withNodes:!0})}),[i,s]),o=(0,n.Kr)((()=>i("MonetizationInfoTONTitle",void 0,{withNodes:!0,specialReplacement:{"💎":n.Ay.createElement(q.A,{className:"ATkOSqJ7",name:"toncoin"})}})),[i]),l=(0,n.Kr)((()=>{if(t)return{header:n.Ay.createElement("h3",{className:Xl},s("lng_channel_earn_learn_title")),listItemData:[["channel",s("lng_channel_earn_learn_in_subtitle"),(0,kt.A)(s("lng_channel_earn_learn_in_about"),["simple_markdown"])],["revenue-split",s("lng_channel_earn_learn_split_subtitle"),(0,kt.A)(s("Monetization.Intro.Split.Text"),["simple_markdown"])],["cash-circle",s("lng_channel_earn_learn_out_subtitle"),(0,kt.A)(s("lng_channel_earn_learn_out_about"),["simple_markdown"])]],footer:n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:Xl},o),n.Ay.createElement("p",{className:"mjveZmdr"},r))}}),[t,s,o,r]);if(l)return n.Ay.createElement(Wl.A,{isOpen:t,listItemData:l.listItemData,headerIconName:"cash-circle",withSeparator:!0,header:l.header,footer:l.footer,buttonText:s("RevenueSharingAdsUnderstood"),onClose:a})}));var tc=a(15535);const ac="oofoCYlu",nc=(0,n.ph)((0,s.EK)((e=>{const{twoFaSettings:{hint:t}}=e;return{passwordHint:t}}))((e=>{let{modal:t,passwordHint:a}=e;const{closeMonetizationVerificationModal:i,clearMonetizationVerificationError:r,processMonetizationRevenueWithdrawalUrl:o}=(0,s.ko)(),l=Boolean(t),c=(0,Cn.A)(t),d=(0,Us.A)(),[m,u]=(0,n.J0)(!1),A=(0,M.A)((e=>{c&&o({peerId:c.chatId,currentPassword:e})})),h=(0,M.A)((()=>{r()})),y=(0,M.A)((()=>{i()}));return n.Ay.createElement(Q.A,{isOpen:l,hasCloseButton:!0,title:d("CheckPasswordTitle"),className:"WqeWhMAS",contentClassName:ac,onClose:y},n.Ay.createElement("div",{className:(0,de.A)(ac,"settings-content password-form custom-scroll")},n.Ay.createElement("div",{className:"settings-item pt-0"},n.Ay.createElement(tc.A,{shouldShowSubmit:!0,placeholder:d("CheckPasswordPlaceholder"),error:c?.errorKey&&d.withRegular(c.errorKey),description:d("CheckPasswordDescription"),clearError:h,isLoading:c?.isLoading,hint:a,isPasswordVisible:m,shouldResetValue:l,onChangePasswordVisibility:u,onSubmit:A}))))}))),sc={content:"MKdSUg2P",chatItem:"qEIwBtp0"},ic=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.mBe)(e,e.currentUserId),a=(0,c.g29)(e);return{currentUser:t,stickerSet:e.defaultStatusIconsId?(0,c.ycM)(e,e.defaultStatusIconsId):void 0,isPremium:a}}))((e=>{let{modal:t,currentUser:a,stickerSet:i,isPremium:r}=e;const{closeEmojiStatusAccessModal:o,toggleUserEmojiStatusPermission:c,sendWebAppEvent:d,openPremiumModal:m,loadDefaultStatusIcons:u}=(0,s.ko)(),A=Boolean(t),h=(0,T.A)(),y=(0,Us.A)(),p=(0,n.li)(null),[v,g]=(0,n.J0)(0);(0,n.vJ)((()=>{A&&!i?.stickers&&u()}),[A,i]);const E=(0,n.Kr)((()=>{if(a&&i?.stickers)return{...a,emojiStatus:{type:"regular",documentId:i.stickers[v].id}}}),[a,i,v]),b=i?.stickers?.length;(0,ni.A)((()=>{b&&g((e=>(e+1)%b))}),b?3e3:void 0);const C=(0,M.A)((()=>n.Ay.createElement(wl.A,{withEmojiStatus:!0,className:sc.chatItem,itemClassName:sc.itemName,mockPeer:E}))),f=(0,M.A)((()=>{t?.bot?.id&&(o(),t?.webAppKey&&(r?(d({webAppKey:t.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"allowed"}}}),c({botId:t.bot.id,isEnabled:!0,isBotAccessEmojiGranted:!0})):(m(),d({webAppKey:t.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}))))})),S=(0,M.A)((()=>{t?.bot?.id&&(o(),t?.webAppKey&&d({webAppKey:t.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}),r&&c({botId:t.bot.id,isEnabled:!1}))})),k=(0,M.A)((()=>{if(t?.bot)return y("EmojiStatusAccessText",{name:(0,l.YgS)(t?.bot)},{withNodes:!0,withMarkdown:!0})}));return n.Ay.createElement(Q.A,{className:(0,de.A)("confirm"),contentClassName:sc.content,isOpen:A,onClose:S},C(),n.Ay.createElement("div",null,k(),n.Ay.createElement("div",{className:"dialog-buttons mt-2",ref:p},n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:f,color:"primary"},h("lng_bot_allow_write_confirm")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:S},y("Cancel")))))}))),rc=(0,n.ph)((0,s.EK)((e=>({currentUser:(0,c.mBe)(e,e.currentUserId)})))((e=>{let{modal:t,currentUser:a}=e;const{closeLocationAccessModal:i,toggleUserLocationPermission:r,sendWebAppEvent:o}=(0,s.ko)(),c=Boolean(t),d=(0,T.A)(),m=(0,Us.A)(),u=(0,n.li)(null),A=(0,M.A)((async()=>{const e=await(0,b.Bu)(),{geolocation:a}=e;t?.bot?.id&&(i(),t?.webAppKey&&(r({botId:t.bot.id,isAccessGranted:!0}),o({webAppKey:t.webAppKey,event:{eventType:"location_requested",eventData:{available:!0,latitude:a?.latitude,longitude:a?.longitude,altitude:a?.altitude,course:a?.heading,speed:a?.speed,horizontal_accuracy:a?.accuracy,vertical_accuracy:a?.accuracy}}})))})),h=(0,M.A)((()=>{t?.bot?.id&&(i(),t?.webAppKey&&(r({botId:t.bot.id,isAccessGranted:!1}),o({webAppKey:t.webAppKey,event:{eventType:"location_requested",eventData:{available:!1}}})))})),y=(0,M.A)((()=>{if(t?.bot)return n.Ay.createElement("div",{className:"CGPoDaLo"},n.Ay.createElement(wt.A,{size:"large",peer:a}),n.Ay.createElement(q.A,{name:"next",className:"pzERgD5x"}),n.Ay.createElement(wt.A,{size:"large",peer:t.bot}))})),p=(0,M.A)((()=>{if(t?.bot)return m("LocationPermissionText",{name:(0,l.YgS)(t?.bot)},{withNodes:!0,withMarkdown:!0})}));return n.Ay.createElement(Q.A,{className:(0,de.A)("confirm"),isOpen:c,onClose:h},y(),n.Ay.createElement("div",null,p(),n.Ay.createElement("div",{className:"dialog-buttons mt-2",ref:u},n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:A,color:"primary"},d("lng_bot_allow_write_confirm")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:h},m("Cancel")))))}))),oc="qJDgUtjV",lc=(0,n.ph)((e=>{let{modal:t}=e;const{reportSponsoredMessage:a,closeReportAdModal:i,openPreviousReportAdModal:r}=(0,s.ko)(),l=(0,T.A)(),c=Boolean(t),d=(0,n.li)(null),m=(0,M.A)(((e,n)=>{const{chatId:s,randomId:i}=t;a({peerId:s,randomId:i,option:n})})),[u,A]=(0,n.Kr)((()=>{if(!t)return[void 0,0];const e=t.sections.length-1;return[t.sections[e],e]}),[t]),h=(0,M.A)((()=>{A?r():i()})),y=(0,n.Kr)((()=>{if(!t)return;const e=l("lng_report_sponsored_reported_learn").split("{link}");return[e[0],n.Ay.createElement($l.A,{text:l("lng_report_sponsored_reported_link"),url:l("ReportAd.Help_URL")}),e[1]]}),[l,t]),p=(0,n.Kr)((()=>{if(!t)return;const e=Boolean(u?.subtitle);return n.Ay.createElement("div",{className:"modal-header-condensed"},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:l(A?"Back":"Close"),onClick:h},n.Ay.createElement(q.A,{name:A?"arrow-left":"close"})),n.Ay.createElement("div",{className:(0,de.A)("modal-title","ZAdG13Ah",e&&"lVVyV0py")},n.Ay.createElement("h3",{className:"mMmY6YR4"},l("ReportAd")),e&&n.Ay.createElement("span",{className:"gSkAFc4u"},u.subtitle)))}),[l,t,A,u?.subtitle]);(0,n.vJ)((()=>{if(!t)return;const e=document.querySelector(`.${te.uo} > .${oc}`);if(!e)return;const a=e.scrollHeight;(0,o.RK)((()=>{d.current.style.height=`${a+56}px`}))}),[t]);const v=(0,M.A)((()=>{const e=document.querySelector(`.${te.VY} > .${oc}`);(0,o.YS)((()=>{const t=e.scrollHeight;(0,o.RK)((()=>{d.current.style.height=`${t+56}px`}))}))}));return n.Ay.createElement(Q.A,{isOpen:c,hasCloseButton:!0,className:"njPBcVYr",header:p,onClose:i},n.Ay.createElement(te.Ay,{name:"slide",className:"HjsGIG6e",ref:d,activeKey:A,onStart:v},n.Ay.createElement("div",{className:oc},n.Ay.createElement("h3",{className:"jrA2dOiw"},u?.title),u?.options.map((e=>n.Ay.createElement(Wa.A,{narrow:!0,secondaryIcon:"next",className:"aFbjDzNo",buttonClassName:"VbE0HzDs",clickArg:e.option,onClick:m},n.Ay.createElement("div",{className:"oWujoaSC"},e.text))))),n.Ay.createElement("p",{className:"k71Zrc_P"},y)))}));var cc=a(94079);const dc="kq9LwNTZ",mc=(0,n.ph)((e=>{let{modal:t}=e;const{reportMessages:a,reportStory:i,closeReportModal:r,openPreviousReportModal:l}=(0,s.ko)(),c=(0,T.A)(),d=Boolean(t),m=(0,n.li)(null),[u,A]=(0,n.J0)(""),h=(0,M.A)(((e,n)=>{const{messageIds:s,subject:r,peerId:o,chatId:l}=t;if(s)switch(r){case"message":a({chatId:l,messageIds:s,option:n});break;case"story":i({storyId:s[0],peerId:o,option:n})}})),[y,p]=(0,n.Kr)((()=>{if(!t)return[void 0,0];const e=t.sections.length-1;return[t?.sections[e],e]}),[t]),v=(0,M.A)((()=>{l()})),g=(0,M.A)((()=>{r()})),E=(0,n.Kr)((()=>{if(!t)return;const e=Boolean(y?.subtitle);return n.Ay.createElement("div",{className:"modal-header-condensed"},p?n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:c("Back"),onClick:v},n.Ay.createElement(q.A,{name:"arrow-left"})):n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:c("Close"),onClick:g},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("div",{className:(0,de.A)("modal-title","Lj_ezEWU",e&&"OYFbu8fQ")},n.Ay.createElement("h3",{className:(0,de.A)("QawchdxB",p&&"CV7kzv9H")},y?.options?c("story"===t?.subject?"ReportStory":"Report"):y?.title),e&&n.Ay.createElement("span",{className:"OUFckTb7"},y.subtitle)))}),[c,t,p,y?.options,y?.subtitle,y?.title]),b=(0,M.A)((e=>{A(e.target.value)}));(0,n.vJ)((()=>{if(!t)return;const e=document.querySelector(`.${te.uo} > .${dc}`);if(!e)return;const a=e.scrollHeight;(0,o.RK)((()=>{m.current.style.height=`${a}px`}))}),[t]);const C=(0,M.A)((()=>{const e=document.querySelector(`.${te.VY} > .${dc}`);(0,o.YS)((()=>{const t=e.scrollHeight;(0,o.RK)((()=>{m.current.style.height=`${t+20}px`}))}))})),f=(0,M.A)((()=>{A(""),r()})),S=(0,M.A)((()=>{const{messageIds:e,subject:n,peerId:s,chatId:r}=t;switch(n){case"message":a({chatId:r,messageIds:e,option:y?.option,description:u});break;case"story":i({storyId:e?.[0],peerId:s,option:y?.option,description:u})}f()}));return n.Ay.createElement(Q.A,{isOpen:d,header:E,onClose:f,contentClassName:"tNysQgHL",className:(0,de.A)("E1bGWeON","story"===t?.subject&&"component-theme-dark")},n.Ay.createElement(te.Ay,{name:"slide",className:"n2VxPirU",ref:m,activeKey:p,onStart:C},n.Ay.createElement("div",{className:dc},y?.options?n.Ay.createElement("h3",{className:"GSfUuTet"},y?.title):void 0,y?.options?.map((e=>n.Ay.createElement(Wa.A,{narrow:!0,nonInteractive:!0,secondaryIcon:"next",className:"RoxwMzvA",buttonClassName:"Z6skYdvb",clickArg:e.option,onClick:h},n.Ay.createElement("div",{className:"FU8m6NUU"},e.text)))),y?.option?n.Ay.createElement("div",{className:"KpptZ3Mk"},n.Ay.createElement(ol.A,{tgsUrl:rl.w.Report,size:100,className:"kO8JC4gK",nonInteractive:!0,forceAlways:!0,noLoop:!1}),n.Ay.createElement(cc.A,{id:"option",className:"yc3szGcx",label:y.isOptional?c("Report2CommentOptional"):c("Report2Comment"),onChange:b,value:u,maxLength:512,maxLengthIndicator:(512-u.length).toString(),noReplaceNewlines:!0}),n.Ay.createElement(W.A,{size:"smaller",onClick:S,disabled:y.isOptional?void 0:!u.length},c("ReportSend"))):void 0)))}));var uc=a(65632),Ac=a(17010);const hc=(0,n.ph)((0,s.EK)(((e,t)=>{let{modal:a}=t;const n=(0,c.SJA)(e),{isBlurred:s,patternColor:i,background:r,backgroundColor:o}=e.settings.themes[n]||{};return{theme:n,isBackgroundBlurred:s,patternColor:i,customBackground:r,backgroundColor:o,bot:a?(0,c.mBe)(e,a?.botId):void 0,currentUserId:e.currentUserId}}))((e=>{let{modal:t,theme:a,isBackgroundBlurred:i,patternColor:r,customBackground:o,backgroundColor:c,bot:d}=e;const{closePreparedInlineMessageModal:m,sendWebAppEvent:u,openSharePreparedMessageModal:A}=(0,s.ko)(),h=(0,Us.A)(),y=Boolean(t),{webAppKey:p,message:v,botId:g}=t||{},E=(0,n.li)(null),b=(0,uc.A)(a,o),C=(0,M.A)((()=>{p&&g&&v&&(A({webAppKey:p,message:v}),m())})),f=(0,M.A)((()=>{m(),p&&u({webAppKey:p,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})})),S=(0,n.Kr)((()=>{if(t)return n.Ay.createElement("div",{className:"P1fPh6h8"},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:h("Close"),onClick:f},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("h3",{className:(0,de.A)("modal-title","E42tgAwD")},h("BotShareMessage")))}),[h,t]),k=(0,n.Kr)((()=>{if(g&&v&&p)return(0,l.i7O)(g,v)}),[g,v,p]),w=(0,de.A)("_6w75ldP","lElCwweL",o&&"CZkpv8n0",c&&"VJAYrDF_",o&&i&&"m8xzfVvU");return n.Ay.createElement(Q.A,{dialogRef:E,isOpen:y,header:S,onClose:f,className:"Rzj2LMLf",contentClassName:"Ve4u2KVI"},n.Ay.createElement("div",{className:(0,de.A)("McJgXCtB","MessageList"),inert:!0,style:(0,gn.A)(`--pattern-color: ${r}`,c&&`--theme-background-color: ${c}`)},n.Ay.createElement("div",{className:w,style:b?`--custom-background: ${b}`:void 0}),k&&n.Ay.createElement(Ac.A,{key:g,message:k,threadId:U.l3,messageListType:"thread",noComments:!0,noReplies:!0,appearanceOrder:0,isJustAdded:!1,isFirstInGroup:!0,isLastInGroup:!0,isLastInList:!1,isFirstInDocumentGroup:!1,isLastInDocumentGroup:!1})),n.Ay.createElement("div",{className:"pNSCKAVN"},n.Ay.createElement("p",{className:"xWnXsG7q"},h("WebAppShareMessageInfo",{user:(0,l.YgS)(d)})),n.Ay.createElement(W.A,{size:"smaller",onClick:C},h("BotShareMessageShare"))))}))),yc=(0,n.ph)((e=>{let{modal:t}=e;const{closeSharePreparedMessageModal:a,sendInlineBotResult:i,sendWebAppEvent:r,showNotification:o}=(0,s.ko)(),d=(0,T.A)(),m=Boolean(t),[u,A,h]=(0,I.A)();(0,n.vJ)((()=>{m&&A()}),[m,A]);const{message:y,filter:p,webAppKey:v}=t||{},g=(0,M.A)((()=>{a(),v&&r({webAppKey:v,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})})),E=(0,M.A)(((e,t)=>{if(y&&v){const n=(0,s.mS)(),m=(0,c.PVB)(n,e);i({chatId:e,threadId:t||U.l3,id:y.result.id,queryId:y.result.queryId}),r({webAppKey:v,event:{eventType:"prepared_message_sent"}}),o({message:d("BotSharedToOne",(0,l.F9N)(d,m))}),a()}}));if(m||u)return n.Ay.createElement(Ms,{isOpen:m,searchPlaceholder:d("Search"),filter:p,onSelectRecipient:E,onClose:g,onCloseAnimationEnd:h})})),pc=["embedLinks","sendPolls","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs","sendStickers","sendGifs"],vc=[...pc,"sendPlain"];function gc(e){const[t,a]=(0,n.J0)({}),[s,i]=(0,n.J0)(!1),[r,o]=(0,n.J0)(!1);(0,n.vJ)((()=>{a(e||{}),i(!1),setTimeout((()=>{o(!1)}),250)}),[e]);const l=(0,n.hb)((n=>{const{name:s}=n.target,r=s;function o(e){return!e||void 0}const l=t;let c={...l,[r]:o(l[r]),..."sendStickers"===r&&{sendGifs:o(l[r])}};const d=()=>{const e=pc.map((e=>c[e]));e.some((e=>!e))?c={...c,sendMedia:void 0}:e.every(Boolean)&&(c={...c,sendMedia:!0})};"sendMedia"!==r?d():c={...c,...pc.reduce(((e,t)=>Object.assign(e,{[t]:c.sendMedia})),{})},"embedLinks"!==r&&!c.embedLinks&&c.sendPlain&&(c={...c,embedLinks:!0}),"sendPlain"!==r&&!c.embedLinks&&c.sendPlain&&(c={...c,sendPlain:void 0}),"sendMedia"!==r&&d();const m=vc.every((e=>c[e]));c={...c,sendMessages:!!m||void 0},a(c),i(!e||Object.keys(c).some((t=>{const a=t;return Boolean(e[a])!==Boolean(c[a])})))}),[e,t]),c=(0,n.hb)((()=>{a(e||{}),i(!1)}),[e]);return{permissions:t,isLoading:r,havePermissionChanged:s,handlePermissionChange:l,setIsLoading:o,resetPermissions:c}}const Ec=["sendPhotos","sendVideos","sendStickers","sendAudios","sendDocs","sendVoices","sendRoundvideos","embedLinks","sendPolls"],bc=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=a?(0,c.hds)(e,a):void 0,s=n&&(0,c.AWZ)(e,n.id);return{chat:n,hasLinkedChat:Boolean(s?.linkedChatId)}}))((e=>{let{chat:t,isMediaDropdownOpen:a,setIsMediaDropdownOpen:i,hasLinkedChat:r,permissions:o,handlePermissionChange:c,className:d,shiftedClassName:m,dropdownClassName:u,withCheckbox:A,getControlIsDisabled:h,permissionGroup:y}=e;const{showNotification:p}=(0,s.ko)(),{isForum:g}=t||{},E=(0,T.A)(),b=(0,n.Kr)((()=>t&&(0,l.gAJ)(t)),[t]),C=r||b,f=(0,n.Kr)((()=>Ec.reduce(((e,t)=>(o[t]||(e+=1),e)),0)),[o]),S=(0,M.A)((e=>{(0,v.A)(e),i(!a)})),k=(0,M.A)((()=>{p({message:E("lng_rights_permission_unavailable")})}));return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendPlain",checked:!o.sendPlain,label:E("UserRestrictionsSend"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("sendPlain")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendMedia",checked:!o.sendMedia,label:E("UserRestrictionsSendMedia"),labelText:`${f}/${Ec.length}`,blocking:!0,permissionGroup:y,rightIcon:a?"up":"down",onChange:c,onClickLabel:S,disabled:h&&h("sendMedia")})),n.Ay.createElement("div",{className:u},n.Ay.createElement("div",{className:d},n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendPhotos",checked:!o.sendPhotos,label:E("UserRestrictionsSendPhotos"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("sendPhotos")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendVideos",checked:!o.sendVideos,label:E("UserRestrictionsSendVideos"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("sendVideos")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendStickers",checked:!o.sendStickers&&!o.sendGifs,label:E("UserRestrictionsSendStickers"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("sendStickers")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendAudios",checked:!o.sendAudios,label:E("UserRestrictionsSendMusic"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("sendAudios")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendDocs",checked:!o.sendDocs,label:E("UserRestrictionsSendFiles"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("sendDocs")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendVoices",checked:!o.sendVoices,label:E("UserRestrictionsSendVoices"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("sendVoices")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendRoundvideos",checked:!o.sendRoundvideos,label:E("UserRestrictionsSendRound"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("sendRoundvideos")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"embedLinks",checked:!o.embedLinks,label:E("UserRestrictionsEmbedLinks"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("embedLinks")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"sendPolls",checked:!o.sendPolls,label:E("UserRestrictionsSendPolls"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("sendPolls")})))),n.Ay.createElement("div",{className:m},n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"inviteUsers",checked:!o.inviteUsers,label:E("UserRestrictionsInviteUsers"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("inviteUsers")})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox"),onClick:C?k:void 0},n.Ay.createElement(js.A,{name:"pinMessages",checked:!o.pinMessages,label:E("UserRestrictionsPinMessages"),disabled:h?h("pinMessages"):C,blocking:!0,permissionGroup:y,onChange:c})),n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox"),onClick:C?k:void 0},n.Ay.createElement(js.A,{name:"changeInfo",checked:!o.changeInfo,label:E("UserRestrictionsChangeInfo"),blocking:!0,permissionGroup:y,disabled:h?h("changeInfo"):C,onChange:c})),g&&n.Ay.createElement("div",{className:(0,de.A)("ListItem",A&&"with-checkbox")},n.Ay.createElement(js.A,{name:"manageTopics",checked:!o.manageTopics,label:E("CreateTopicsPermission"),blocking:!0,permissionGroup:y,onChange:c,disabled:h&&h("manageTopics")}))))})));var Cc=a(77561);const fc="yGhFKTl5",Sc="goI3MITH",kc=(0,n.ph)((0,s.EK)((e=>{const{deleteMessageModal:t}=(0,c.nTw)(e),a=t?.messageIds,n=t?.chatId,{canDeleteForAll:s}=(0,c.jyG)(e,a),i=n?(0,c.hds)(e,n):void 0,r=i&&(0,c.AWZ)(e,i.id),o=r?.linkedChatId,d=Boolean(i)&&(0,l.WXB)(i),m=Boolean(i)&&(0,l.VsK)(i),u=t?.isSchedule,A=t?.onConfirm,h=i&&(0,l.L8L)(i.id)?(0,l.u0l)((0,c.mBe)(e,(0,l.e7w)(i))):void 0,y=Boolean(i&&!(0,l.DXc)(i.id)&&(0,c.yps)(e,i.id)),p=r?.adminMembersById,v=i&&(0,l.ubU)(i,"banUsers"),g=i?.isCreator,E=i?(0,c.ALW)(e,i):void 0,b=i&&(0,l.yn$)(i)&&!s||E,C=i&&((0,l.VsK)(i)||d);return{chat:i,isChannel:d,isSuperGroup:m,messageIds:a,currentUserId:e.currentUserId,canDeleteForAll:!u&&s,contactName:h,willDeleteForCurrentUserOnly:b,willDeleteForAll:C,adminMembersById:p,chatBot:y,canBanUsers:v,linkedChatId:o,isSchedule:u,isCreator:g,onConfirm:A}}))((e=>{let{isOpen:t,chat:a,isChannel:i,isSuperGroup:r,isSchedule:o,currentUserId:d,messageIds:m,isCreator:u,canDeleteForAll:A,contactName:h,willDeleteForCurrentUserOnly:y,willDeleteForAll:p,onConfirm:v,chatBot:g,adminMembersById:E,canBanUsers:b,linkedChatId:C}=e;const{closeDeleteMessageModal:f,deleteMessages:S,reportChannelSpam:k,deleteChatMember:w,deleteScheduledMessages:N,exitMessageSelectMode:I,updateChatMemberBannedRights:P,deleteParticipantHistory:B}=(0,s.ko)(),L=(0,D.A)(t),R=(0,T.A)(),x=(0,Us.A)(),{permissions:F,havePermissionChanged:V,handlePermissionChange:_,resetPermissions:U}=gc(a?.defaultBannedRights),[O,J]=(0,n.J0)(void 0),[K,j]=(0,n.J0)(void 0),[G,z]=(0,n.J0)(void 0),[H,$]=(0,n.J0)(!1),[Y,Z]=(0,n.J0)(!1),[X,ee]=(0,n.J0)(!0),te=(0,n.Kr)((()=>{if(i||!m||!a)return ln.p;const e=(0,s.mS)(),t=(0,c.SpN)(e,a.id,m);return t?(0,on.Am)(t).filter((e=>e?.id!==a?.id&&e?.id!==C)):ln.p}),[a,i,C,m]),ae=(0,M.A)((()=>te.map((e=>({value:`${e.id}`,label:(0,l.F9N)(x,e)||"",leftElement:n.Ay.createElement(wt.A,{size:"small",peer:e})}))))),ne=(0,n.Kr)((()=>te.filter((e=>e.id!==C&&e.id!==d))),[te,d,C]),se=(0,n.Kr)((()=>te.filter((e=>e.id!==d&&e.id!==C))),[te,d,C]),ie=(0,n.Kr)((()=>{const e=te.some((e=>e.id===d));return!b||e?ln.p:te.filter((e=>{const t=E?.[e.id];return u||!t}))}),[te,u,d,b,E]),re=(0,n.Kr)((()=>Boolean(ne.length||se.length||ie.length)),[ne,se,ie])&&!A&&!o&&r,oe=(0,n.Kr)((()=>!te||o?{}:(0,on.pA)(te,(e=>[e.id,(0,l.F9N)(x,e)]))),[o,x,te]),le=(0,n.Kr)((()=>[{value:m&&te.length>=2?"spam":te?.[0]?.id,label:R("ReportSpamTitle"),nestedOptions:m&&te.length>=2?[...ae().filter((e=>e.value!==C&&e.value!==d))]:void 0}]),[m,te,R,C,d]),ce=(0,n.Kr)((()=>[{value:m&&te.length>=2?"delete_all":te?.[0]?.id,label:m&&te.length>=2?R("DeleteAllFromUsers"):R("DeleteAllFrom",Object.values(oe)[0]),nestedOptions:m&&te.length>=2?[...ae().filter((e=>e.value!==C&&e.value!==d))]:void 0}]),[m,te,R,oe,C,d]),me=(0,n.Kr)((()=>[{value:m&&te.length>=2?"ban":te?.[0]?.id,label:m&&te.length>=2?R(Y?"DeleteRestrictUsers":"DeleteBanUsers"):Y?R("KickFromSupergroup"):R("DeleteBan",Object.values(oe)[0]),nestedOptions:m&&te.length>=2?[...ae()]:void 0}]),[Y,R,m,te,oe]),ue=(0,M.A)((()=>{Z((e=>!e))})),Ae=(0,M.A)(((e,t)=>{if(!a)return ln.p;const n=(0,s.mS)();return t.filter((t=>{const s=(0,c.LM$)(n,a.id,t);return s&&e.includes(s.id)}))})),he=(0,M.A)((e=>{Object.entries(e).forEach((e=>{let[t,n]=e;n.length&&k({participantId:t,chatId:a.id,messageIds:n})}))})),ye=(0,M.A)((e=>{S({messageIds:e,shouldDeleteForAll:!0})})),pe=(0,M.A)((e=>{a&&e.forEach((e=>{B({peerId:e,chatId:a.id})}))})),ve=(0,M.A)((e=>{e.forEach((e=>{w({chatId:a.id,userId:e})}))})),ge=(0,M.A)((e=>{e.forEach((e=>{P({chatId:a.id,userId:e,bannedRights:F})}))})),Ee=(0,M.A)((()=>{if(a&&m){if(v?.(),o)N({messageIds:m});else if(re){if(G){const e=(0,s.mS)(),t=G.filter((e=>!Number.isNaN(Number(e)))),n=m.reduce(((n,s)=>{const i=(0,c.LM$)(e,a.id,s);return i&&t.includes(i.id)&&(n[i.id]||(n[i.id]=[]),n[i.id].push(Number(s))),n}),{});he(n)}if(O){const e=O.filter((e=>!Number.isNaN(Number(e))));pe(e)}if(K&&!V){const e=K.filter((e=>!Number.isNaN(Number(e))));ve(e);const t=Ae(e,m);ye(t)}if(K&&V){const e=K.filter((e=>!Number.isNaN(Number(e))));ge(e)}G&&O&&K||S({messageIds:m,shouldDeleteForAll:X})}else S({messageIds:m,shouldDeleteForAll:X});f(),I()}})),be=(0,M.A)((()=>{f()}));return(0,n.vJ)((()=>{!t&&L&&(z(void 0),J(void 0),j(void 0),ee(!0),$(!1),Z(!1),U())}),[t,L,U]),n.Ay.createElement(Q.A,{isOpen:t,onClose:be,onEnter:A?void 0:Ee,className:"SeaF_shb"},n.Ay.createElement("div",{className:"_YNfwDqt"},n.Ay.createElement("div",{className:re&&"axa67kqo",dir:R.isRtl?"rtl":void 0},re&&n.Ay.createElement(Hn.A,{size:"small",peers:te}),n.Ay.createElement("h3",{className:(0,de.A)(re?"U4IFhV0a":"qd6OFHiG")},R("Chat.DeleteMessagesConfirmation",m?.length))),re&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("p",{className:fc},R("DeleteAdditionalActions")),n.Ay.createElement("div",{className:"b6847Kh3"},n.Ay.createElement(Cc.A,{options:le,onChange:z,selected:G,nestedCheckbox:m&&te.length>=2}),ne?.length>0&&n.Ay.createElement(Cc.A,{options:ce,onChange:J,selected:O,nestedCheckbox:m&&te.length>=2}),ie?.length>0&&n.Ay.createElement(Cc.A,{options:me,onChange:j,selected:K,nestedCheckbox:m&&te.length>=2})),n.Ay.createElement("div",{className:(0,de.A)("iv0u9Zw6",Y&&"qCQftA04")},n.Ay.createElement("h3",{className:(0,de.A)(fc,"t3KOsBfm")},R("UserRestrictionsCanDoUsers",te.length)),n.Ay.createElement(bc,{withCheckbox:!0,chatId:a?.id,isMediaDropdownOpen:H,setIsMediaDropdownOpen:$,handlePermissionChange:_,permissions:F,className:(0,de.A)("czTjjKim",H&&"Ifpyv7Jp")})),K&&b?n.Ay.createElement(Wa.A,{narrow:!0,buttonClassName:Sc,onClick:ue},R(Y?"DeleteToggleBanUsers":"DeleteToggleRestrictUsers"),n.Ay.createElement(q.A,{name:Y?"up":"down",className:(0,de.A)(Sc,"ml-2")})):Z(!1)),(A||g||!re)&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("p",null,m&&m.length>1?x("AreYouSureDeleteFewMessages"):x("AreYouSureDeleteSingleMessage")),y&&n.Ay.createElement("p",null,R("lng_delete_for_me_chat_hint",1,"i")),p&&n.Ay.createElement("p",null,R("lng_delete_for_everyone_hint",1,"i"))),A&&n.Ay.createElement(js.A,{className:"dialog-checkbox",label:h?(0,kt.A)(R("DeleteMessagesOptionAlso",h)):R("Conversation.DeleteMessagesForEveryone"),checked:X,onCheck:ee}),n.Ay.createElement("div",{className:(0,de.A)("dialog-buttons",H?"JTT_DIRv":"L4YzeG91")},n.Ay.createElement(W.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:Ee},re?R("DeleteProceedBtn"):x("Delete")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:be},R("Cancel")))))}))),wc=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,l.L8L)(a),s=(0,c.nZ4)(e,a),i=(0,c.hds)(e,a),r=Boolean(i)&&(0,l.WXB)(i),o=Boolean(i)&&(0,l.yn$)(i),d=Boolean(i)&&(0,l.VsK)(i);return{isPrivateChat:n,isChatWithSelf:s,isChannel:r,isGroup:o,isSuperGroup:d,canPinForAll:n&&!s||d||o,contactName:i&&(0,l.L8L)(i.id)?(0,l.u0l)((0,c.mBe)(e,(0,l.e7w)(i))):void 0}}))((e=>{let{isOpen:t,chatId:a,messageId:i,isChannel:r,isGroup:o,isSuperGroup:l,canPinForAll:c,contactName:d,onClose:m}=e;const{pinMessage:u}=(0,s.ko)(),A=(0,n.hb)((()=>{u({chatId:a,messageId:i,isUnpin:!1}),m()}),[a,i,m]),h=(0,n.hb)((()=>{u({chatId:a,messageId:i,isUnpin:!1,isOneSide:!0,isSilent:!0}),m()}),[a,i,m]),y=(0,T.A)();return n.Ay.createElement(Q.A,{isOpen:t,onClose:m,className:"pin",title:y("PinMessageAlertTitle")},n.Ay.createElement("p",null,y(r?"PinMessageAlertChannel":o||l?"PinMessageAlert":"PinMessageAlertChat")),n.Ay.createElement("div",{className:"dialog-buttons-column"},n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:h},y("DialogPin")),c&&n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:A},d?(0,kt.A)(y("Conversation.PinMessagesFor",d)):y("Conversation.PinMessageAlert.PinAndNotifyMembers")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:m},y("Cancel"))))}))),Nc=(0,n.ph)((e=>{let{isOpen:t,pinnedMessagesCount:a=0,onClose:s,onUnpin:i}=e;const r=(0,T.A)();return n.Ay.createElement(Q.A,{isOpen:t,onClose:s,className:"unpin-all",title:r("Chat.PanelUnpinAllMessages")},n.Ay.createElement("p",null,r("Chat.UnpinAllMessagesConfirmation",a,"i")),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:i},r("DialogUnpin")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:s},r("Cancel"))))}));var Ic=a(2178);const Pc=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.nTw)(e),a=(0,c.meB)(e),{type:n,chatId:s}=(0,c.Xf0)(e)||{},i="scheduled"===n,{canDelete:r}=(0,c.jyG)(e),o=Boolean(!i&&(0,c.mDG)(e)),l=(0,c.ori)(e),{messageIds:d}=t.selectedMessages||{},m=!!s&&(0,c.o45)(e,s,d),u=!(i||!s)&&(0,c.Y8y)(e,s,d),A=t.isShareMessageModalShown,h=Boolean(A||t.requestedDraft||t.requestedAttachBotInChat||t.requestedAttachBotInstall||t.reportModal||t.deleteMessageModal);return{chat:a,isSchedule:i,selectedMessagesCount:(0,c.ZZ2)(e),canDeleteMessages:r,canReportMessages:o,canDownloadMessages:l,canForwardMessages:u,selectedMessageIds:d,hasProtectedMessage:m,isAnyModalOpen:h,shouldWarnAboutSvg:e.settings.byKey.shouldWarnAboutSvg}}))((e=>{let{chat:t,canPost:a,isActive:i,messageListType:r,isSchedule:o,selectedMessagesCount:l,canDeleteMessages:c,canReportMessages:d,canDownloadMessages:m,canForwardMessages:u,hasProtectedMessage:A,isAnyModalOpen:h,selectedMessageIds:y,shouldWarnAboutSvg:p}=e;const{exitMessageSelectMode:v,openForwardMenuForSelectedMessages:g,downloadSelectedMessages:E,copySelectedMessages:b,showNotification:C,reportMessages:f,openDeleteMessageModal:S,setSettingOption:k}=(0,s.ko)(),w=(0,T.A)();(e=>{function t(e){e.preventDefault(),(0,s.ko)().copySelectedMessages()}(0,Ic.v)((0,n.Kr)((()=>e?{"Mod+C":t}:void 0),[e]))})(i);const[N,P,B]=(0,I.A)(),[L,R]=(0,n.J0)(!1),x=(0,M.A)((()=>{v()})),F=(0,M.A)((()=>{y&&t&&S({chatId:t.id,messageIds:y,isSchedule:o})}));(0,n.vJ)((()=>i&&!h?(0,fn.A)({onBackspace:c?F:void 0,onDelete:c?F:void 0,onEsc:x}):void 0),[i,F,x,h,c]);const V=(0,M.A)((()=>{b(),C({message:w("Share.Link.Copied")}),v()})),_=(0,M.A)((()=>{E(),v()})),U=(0,M.A)((()=>{p?P():_()})),O=(0,M.A)((()=>{k({shouldWarnAboutSvg:!1}),B(),_()})),J=(0,D.A)(l||void 0,!0),K=w("VoiceOver.Chat.MessagesSelected",i?l:J,"i"),j=(0,M.A)((()=>{y&&t&&(f({chatId:t.id,messageIds:y}),v())})),G=(0,de.A)("MessageSelectToolbar",a&&"with-composer",i&&"shown"),z=(e,t,a,s)=>n.Ay.createElement("div",{role:"button",tabIndex:0,className:(0,de.A)("div-button","item",s&&"destructive"),onClick:a,title:t,"aria-label":t},n.Ay.createElement(q.A,{name:e}));return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:G},n.Ay.createElement("div",{className:"MessageSelectToolbar-inner"},n.Ay.createElement(W.A,{color:"translucent",round:!0,onClick:x,ariaLabel:"Exit select mode"},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("span",{className:"MessageSelectToolbar-count",title:K},K),Boolean(l)&&n.Ay.createElement("div",{className:"MessageSelectToolbar-actions"},"scheduled"!==r&&u&&z("forward",w("Chat.ForwardActionHeader"),g),d&&z("flag",w("Conversation.ReportMessages"),j),m&&!A&&z("download",w("lng_media_download"),U),!A&&z("copy",w("lng_context_copy_selected_items"),V),c&&z("delete",w("EditAdminGroupDeleteMessages"),F,!0)))),n.Ay.createElement(tn.A,{isOpen:N,onClose:B,confirmHandler:O},w("lng_launch_svg_warning"),n.Ay.createElement(js.A,{className:"dialog-checkbox",checked:L,label:w("lng_launch_exe_dont_ask"),onCheck:R})))}))),Mc=(0,n.ph)((0,s.EK)((e=>{const{chatId:t,messageId:a}=(0,c.nTw)(e).seenByModal||{};return t&&a?{seenByDates:(0,c.O5q)(e,t,a)?.seenByDates}:{}}))((function(e){let{isOpen:t,seenByDates:a}=e;const{openChat:i,closeSeenByModal:r}=(0,s.ko)(),o=(0,T.A)(),l=(0,Cn.A)(a,!0),c=(0,n.Kr)((()=>{if(!l)return;const e=Object.keys(l);return e.sort(((e,t)=>l[t]-l[e])),e}),[l]),d=(0,M.A)((e=>{r(),setTimeout((()=>{i({id:e})}),100)})),m=(0,M.A)((()=>{r()}));return n.Ay.createElement(Q.A,{isOpen:t,onClose:r,className:(0,de.A)("slqA9gR2","narrow"),title:`Seen by ${c?.length} users`},n.Ay.createElement("div",{dir:o.isRtl?"rtl":void 0},c&&c.map((e=>n.Ay.createElement(Wa.A,{key:e,className:"chat-item-clickable scroll-item small-icon",onClick:()=>d(e)},n.Ay.createElement(ds.A,{userId:e,noStatusOrTyping:!0,status:(0,Ke.U)(o,1e3*l[e]),statusIcon:"message-read"}))))),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:m},o("Close"))))})));var Tc=a(32581);const Bc="MQxuEIRA",Lc="AEAN1Au4",Rc="F7owtTHj",xc=Q.U+r.xB5,Fc=(0,n.ph)((0,s.EK)((e=>{const{chatId:t,isReadDate:a}=(0,c.nTw)(e).privacySettingsNoticeModal||{};return{user:t?(0,c.mBe)(e,t):void 0,isReadDate:a}}))((e=>{let{isOpen:t,isReadDate:a,user:i}=e;const r=(0,T.A)(),{updateGlobalPrivacySettings:o,openPremiumModal:c,closePrivacySettingsNoticeModal:d,showNotification:m,setPrivacyVisibility:u,loadUser:A}=(0,s.ko)(),h=(0,l.u0l)(i),y=(0,M.A)((()=>{o({shouldHideReadMarks:!1}),d(),setTimeout((()=>{m({message:r("PremiumReadSet")})}),xc)})),p=(0,M.A)((()=>{u({privacyKey:"lastSeen",visibility:"everybody",onSuccess:()=>A({userId:i.id})}),d(),setTimeout((()=>{m({message:r("PremiumLastSeenSet")})}),xc)})),v=(0,M.A)((()=>{d(),setTimeout((()=>{c({initialSection:"last_seen"})}),xc)})),g=(0,M.A)((()=>{d()}));return n.Ay.createElement(Q.A,{isSlim:!0,isOpen:t,onClose:g},n.Ay.createElement("div",{className:"tauadiDm",dir:r.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{className:"i6iFv9YE",color:"translucent",round:!0,size:"smaller",onClick:g,ariaLabel:"Close"},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement(ol.A,{tgsUrl:a?rl.w.ReadTime:rl.w.LastSeen,size:84,className:"i4wZg_0J",nonInteractive:!0,noLoop:!0}),n.Ay.createElement("h2",{className:Bc},r(a?"PremiumReadHeader1":"PremiumLastSeenHeader1")),n.Ay.createElement("p",{className:Lc},(0,kt.A)(r(a?"PremiumReadText1":"PremiumLastSeenText1Locked",h),["simple_markdown"])),n.Ay.createElement(W.A,{size:"smaller",onClick:a?y:p,className:Rc},r(a?"PremiumReadButton1":"PremiumLastSeenButton1")),n.Ay.createElement(Tc.A,{className:"sXXb5yOS"},r("PremiumOr")),n.Ay.createElement("h2",{className:Bc},r("PremiumReadHeader2")),n.Ay.createElement("p",{className:Lc},(0,kt.A)(r(a?"PremiumReadText2":"PremiumLastSeenText2",h),["simple_markdown"])),n.Ay.createElement(W.A,{withPremiumGradient:!0,size:"smaller",onClick:v,className:Rc},r("PremiumLastSeenButton2"))))}))),Vc=(0,n.ph)((0,s.EK)((e=>{const{chatId:t,messageId:a}=(0,c.nTw)(e).reactorModal||{},n=t&&a?(0,c.O5q)(e,t,a):void 0;return{chatId:t,messageId:a,reactions:n?.reactions,reactors:n?.reactors,seenByDates:n?.seenByDates,availableReactions:e.reactions.availableReactions}}))((e=>{let{isOpen:t,reactors:a,reactions:r,chatId:o,messageId:c,seenByDates:d,availableReactions:m}=e;const{loadReactors:u,closeReactorListModal:A,openChat:h}=(0,s.ko)(),y=(0,s.mS)().chats.byId,p=(0,s.mS)().users.byId,v=(0,T.A)(),[g,E,b]=(0,I.A)(!1),[C,f]=(0,n.J0)(void 0),S=a&&r&&a.count>=10&&r.results.length>1,k=(0,n.li)();(0,n.vJ)((()=>{t&&!g&&(k.current=void 0),g&&!t&&(b(),f(void 0))}),[g,t,b]);const w=(0,M.A)((()=>{k.current&&h({id:k.current}),A()})),N=(0,M.A)((()=>{E()})),P=(0,M.A)((e=>{k.current=e,N()})),B=(0,M.A)((()=>{u({chatId:o,messageId:c})})),L=(0,n.Kr)((()=>{const e=[];return a?.reactions?.forEach((t=>{let{reaction:a}=t;e.some((e=>(0,l.a0K)(e,a)))||e.push(a)})),e}),[a]),R=(0,n.Kr)((()=>{if(C)return a?.reactions.filter((e=>{let{reaction:t}=e;return(0,l.a0K)(t,C)})).map((e=>{let{peerId:t}=e;return t}));const e=Object.keys(d||{});return(0,on.Am)(a?.reactions.map((e=>{let{peerId:t}=e;return t})).concat(e||[])||[])}),[C,a,d]),[x,F]=(0,Es.A)(B,R,a&&void 0===a.nextOffset);return(0,n.vJ)((()=>{F?.({direction:i.TN.Backwards})}),[F]),n.Ay.createElement(Q.A,{isOpen:t&&!g,onClose:N,className:"ReactorListModal narrow",title:v("Reactions"),onCloseAnimationEnd:w},S&&n.Ay.createElement("div",{className:"Reactions",dir:v.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{className:(0,de.A)(!C&&"chosen"),size:"tiny",ripple:!0,onClick:()=>f(void 0)},n.Ay.createElement(q.A,{name:"heart"}),Boolean(a?.count)&&(0,je.Vw)(a.count)),L.map((e=>{const t=r?.results.find((t=>(0,l.a0K)(t.reaction,e)))?.count;return n.Ay.createElement(W.A,{key:(0,l.Jjj)(e),className:(0,de.A)((0,l.a0K)(C,e)&&"chosen"),size:"tiny",ripple:!0,onClick:()=>f(e)},n.Ay.createElement(ms.A,{reaction:e,className:"reaction-filter-emoji",availableReactions:m}),Boolean(t)&&(0,je.Vw)(t))}))),n.Ay.createElement("div",{dir:v.isRtl?"rtl":void 0,className:"reactor-list-wrapper"},x?.length?n.Ay.createElement(rs.A,{className:"reactor-list custom-scroll",items:x,onLoadMore:F},x?.flatMap((e=>{const t=p[e]||y[e],s=a?.reactions.filter((t=>t.peerId===e)),i=[],r=d?.[e];return s?.forEach((a=>{C&&!(0,l.a0K)(a.reaction,C)||i.push(n.Ay.createElement(Wa.A,{key:`${e}-${(0,l.Jjj)(a.reaction)}`,className:"chat-item-clickable reactors-list-item",onClick:()=>P(e)},n.Ay.createElement(wt.A,{peer:t,size:"medium"}),n.Ay.createElement("div",{className:"info"},n.Ay.createElement(Ss.A,{peer:t,withEmojiStatus:!0}),n.Ay.createElement("span",{className:"status",dir:"auto"},n.Ay.createElement(q.A,{name:"heart-outline",className:"status-icon"}),(0,Ke.U)(v,1e3*a.addedDate))),a.reaction&&n.Ay.createElement(ms.A,{className:"reactors-list-emoji",reaction:a.reaction,availableReactions:m})))})),C||s?.length||i.push(n.Ay.createElement(Wa.A,{key:`${e}-seen-by`,className:"chat-item-clickable scroll-item small-icon",onClick:()=>P(e)},n.Ay.createElement(ds.A,{userId:e,noStatusOrTyping:!0,avatarSize:"medium",status:r?(0,Ke.U)(v,1e3*r):void 0,statusIcon:"message-read"}))),i}))):n.Ay.createElement(fs.A,null)),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:N},v("Close")))}))),Dc=(0,n.ph)((0,s.EK)(((e,t)=>{let{activeEmojiInteraction:a}=t;const n=void 0!==a.animatedEffect&&(0,c.Nr8)(e,a.animatedEffect);return{effectAnimationId:n?n.id:void 0}}))((e=>{let{effectAnimationId:t,activeEmojiInteraction:a}=e;const{stopActiveEmojiInteraction:i}=(0,s.ko)(),[r,o]=(0,I.A)(!1),[l,c]=(0,I.A)(!1),d=(0,n.li)(),m=(0,M.A)((()=>{o(),d.current&&clearTimeout(d.current),setTimeout((()=>{i({id:a.id})}),250)})),u=(0,M.A)((e=>{e.target?.closest(".AnimatedEmoji")||m()}));(0,n.vJ)((()=>(document.addEventListener("touchstart",u),document.addEventListener("touchmove",u),document.addEventListener("mousedown",u),document.addEventListener("wheel",u),()=>{document.removeEventListener("touchstart",u),document.removeEventListener("touchmove",u),document.removeEventListener("mousedown",u),document.removeEventListener("wheel",u)})),[u]),(0,n.Nf)((()=>{const e=(0,n.VK)();d.current=setTimeout((()=>{m(),e()}),3e3)}),[m]);const A=t&&`sticker${t}`,h=(0,G.A)(A,!t);if(!a.startSize)return;const y=(a.startSize||0)/309;return n.Ay.createElement("div",{className:(0,de.A)("EmojiInteractionAnimation",r&&"hiding",l&&"playing",a.isReversed&&"reversed"),style:`--scale: ${y}; --start-x: ${a.x}px; --start-y: ${a.y}px;`},n.Ay.createElement(ur.A,{key:`effect_${t}`,size:309,tgsUrl:h,play:!0,quality:b.Ni?.5:void 0,forceAlways:!0,noLoop:!0,onLoad:c}))}))),_c=(0,n.ph)((0,s.EK)((e=>{const{chatId:t,messageId:a}=(0,c.nTw)(e).chatLanguageModal||{},n=(0,c.wmb)(e);return{chatId:t,messageId:a,activeTranslationLanguage:t?a?(0,c.Rny)(e,t,a):(0,c.qZq)(e,t):void 0,currentLanguageCode:n}}))((e=>{let{isOpen:t,chatId:a,messageId:i,activeTranslationLanguage:o,currentLanguageCode:l}=e;const{requestMessageTranslation:c,closeChatLanguageModal:d,setSettingOption:m,requestChatTranslation:u}=(0,s.ko)(),[A,h]=(0,n.J0)(""),y=(0,T.A)(),p=(0,M.A)((e=>{a&&(i?c({chatId:a,id:i,toLanguageCode:e}):(m({translationLanguage:e}),u({chatId:a,toLanguageCode:e})),d())})),v=(0,M.A)((e=>{h(e.target.value)})),g=(0,n.Kr)((()=>r.N89.map((e=>({langCode:e,translatedName:new Intl.DisplayNames([l],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)})))),[l]);(0,n.vJ)((()=>{t||h("")}),[t]);const E=(0,n.Kr)((()=>A.trim()?g.filter((e=>{let{langCode:t,translatedName:a,originalName:n}=e;return a.toLowerCase().includes(A.toLowerCase())||n.toLowerCase().includes(A.toLowerCase())||t.toLowerCase().includes(A.toLowerCase())})):g),[g,A]);return n.Ay.createElement(Q.A,{className:"aMjNU9gm",isSlim:!0,isOpen:t,hasCloseButton:!0,title:y("Language"),onClose:d},n.Ay.createElement(Y.A,{key:"search",value:A,onChange:v,placeholder:y("Search"),teactExperimentControlled:!0}),n.Ay.createElement("div",{className:(0,de.A)("r3YNWDQr","custom-scroll")},E.map((e=>{let{langCode:t,originalName:a,translatedName:s}=e;return n.Ay.createElement(Wa.A,{key:t,className:(0,de.A)("T3An6Hoz","no-icon"),secondaryIcon:o===t?"check":void 0,disabled:o===t,multiline:!0,narrow:!0,onClick:()=>p(t)},n.Ay.createElement("span",{className:(0,de.A)("title","dQ9wwFu1")},(0,kt.A)(a,["highlight"],{highlight:A})),n.Ay.createElement("span",{className:(0,de.A)("subtitle","m_J41YYl")},(0,kt.A)(s,["highlight"],{highlight:A})))}))))})));var Uc=a(85982),Oc=a(24899);const Jc={content:"WEJIbFQj",closeButton:"_vwPuDEM",icon:"BUiGM8qZ",title:"Q3NhXpNI",description:"frZbGQ0G"},Kc=(0,n.ph)((0,s.EK)((e=>{const{countryList:t}=e;return{phoneCodeList:t.phoneCodes}}))((e=>{let{modal:t,phoneCodeList:a}=e;const{closeCollectibleInfoModal:i,openChat:r,openUrl:o,showNotification:l}=(0,s.ko)(),c=(0,T.A)(),d="username"===t?.type,m=(0,M.A)((()=>{i()})),u=(0,M.A)((()=>{r({id:t.peerId}),m()})),A=(0,M.A)((()=>{o({url:t.url,shouldSkipModal:!0}),m()})),h=(0,M.A)((()=>{const e=d?(0,Oc.A)(t.collectible):(0,Zs.Ox)(a,t.collectible);(0,Uc.eM)(e),l({message:c(d?"UsernameCopied":"PhoneCopied")}),m()})),y=(0,n.Kr)((()=>{if(!t)return;const e=d?"FragmentUsernameTitle":"FragmentPhoneTitle",n=d?(0,Oc.A)(t.collectible):(0,Zs.Ox)(a,t.collectible);return c(e,n)}),[t,d,a,c]),p=(0,n.Kr)((()=>{if(!t)return;const e=d?"FragmentUsernameMessage":"FragmentPhoneMessage",a=(0,Ke.U)(c,1e3*t.purchaseDate),n=(0,Qi.A)(t.amount,t.currency,c.code),s=(0,Qi.A)(t.cryptoAmount,t.cryptoCurrency,c.code);return c(e,[a,`${s} (${n})`])}),[t,d,c]);return n.Ay.createElement(Q.A,{isOpen:Boolean(t),isSlim:!0,contentClassName:Jc.content,onClose:i},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",className:Jc.closeButton,ariaLabel:c("Close"),onClick:m},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("div",{className:Jc.icon},n.Ay.createElement(ol.A,{tgsUrl:d?rl.w.Mention:rl.w.Fragment,size:60})),n.Ay.createElement("h3",{className:Jc.title},y&&(0,kt.A)(y,["simple_markdown"])),n.Ay.createElement(wl.A,{className:Jc.chip,peerId:t?.peerId,forceShowSelf:!0,clickArg:t?.peerId,onClick:u}),n.Ay.createElement("p",{className:Jc.description},p&&(0,kt.A)(p,["simple_markdown"])),n.Ay.createElement("div",{className:"dialog-buttons dialog-buttons-centered"},n.Ay.createElement(W.A,{className:"confirm-dialog-button",onClick:A},c("FragmentUsernameOpen")),n.Ay.createElement(W.A,{isText:!0,className:"confirm-dialog-button",onClick:h},c(d?"FragmentUsernameCopy":"FragmentPhoneCopy"))))})));var jc=a(24680),Gc=a(57309);function zc(e){return(t,a)=>{const n=(0,c.nTw)(t),{byId:s}=t.chats,{byId:i}=t.users,{fetchingStatus:r,resultsByType:o,chatId:l}=n.globalSearch,d="audio"!==e?e:a?.isVoice?"voice":"audio",{byChatId:m}=t.messages,u=o?.[d]?.foundIds,A=n.activeDownloads;return{theme:(0,c.SJA)(t),isLoading:void 0===u||!!r&&Boolean(r.chats||r.messages),chatsById:s,usersById:i,globalMessagesByChatId:m,foundIds:u,searchChatId:l,activeDownloads:A,isChatProtected:l?(0,c.hds)(t,l)?.isProtected:void 0,shouldWarnAboutSvg:t.settings.byKey.shouldWarnAboutSvg}}}var Hc=a(55429),$c=a(65240),qc=a(42827);const Wc=(0,Ae.nF)((e=>e()),500,!0),Yc=(0,n.ph)((0,s.EK)(zc("audio"))((e=>{let{theme:t,isVoice:a,searchQuery:o,isLoading:c,chatsById:d,usersById:m,globalMessagesByChatId:u,foundIds:A,activeDownloads:h}=e;const{searchMessagesGlobal:y,focusMessage:p,openAudioPlayer:v}=(0,s.ko)(),g=(0,T.A)(),E=a?"voice":"audio",b=(0,n.hb)((e=>{let{direction:t}=e;t===i.TN.Backwards&&Wc((()=>{y({type:E})}))}),[E,y,o]),C=(0,n.Kr)((()=>A&&u?A.map((e=>{const[t,a]=(0,Gc.a)(e);return u[t]?.byId[a]})).filter(Boolean):ln.p),[u,A]),f=(0,n.hb)((e=>{p({chatId:e.chatId,messageId:e.id})}),[p]),S=(0,n.hb)(((e,t)=>{v({chatId:t,messageId:e})}),[v]),k=(0,jo.A)([o],r.jhd)&&!c;return n.Ay.createElement("div",{className:"LeftSearch--content"},n.Ay.createElement(rs.A,{className:"search-content documents-list custom-scroll",items:k?C:void 0,onLoadMore:b,noFastList:!0},!k&&n.Ay.createElement(fs.A,null),k&&(!A||0===A.length)&&n.Ay.createElement(qc.A,{text:g("ChatList.Search.NoResults"),description:g("ChatList.Search.NoResultsDescription")}),k&&A&&A.length>0&&C.map(((e,a)=>{const s=0===a||(0,Ke.$$)(e.date)!==(0,Ke.$$)(C[a-1].date),r=(0,l.edy)(e);return n.Ay.createElement(n.Ay.Fragment,null,s&&n.Ay.createElement("p",{className:"section-heading",key:e.date,dir:g.isRtl?"rtl":void 0},(0,Ke.i6)(g,new Date(1e3*e.date))),n.Ay.createElement("div",{className:"ListItem small-icon",key:e.id},n.Ay.createElement($c.Ay,{key:e.id,theme:t,message:e,origin:i.d9.Search,senderTitle:(0,Hc.N)(g,e,d,m),date:e.date,className:"scroll-item",onPlay:S,onDateClick:f,canDownload:!d[e.chatId]?.isProtected&&!e.isProtected,isDownloading:(0,l.$r_)(h,r)})))}))))})));var Qc=a(47067);const Zc=e=>{const t=(0,n.li)(null),a=(0,n.hb)((a=>{"Enter"===a.key&&t.current===document.activeElement&&e()}),[e]);return(0,n.vJ)((()=>(window.addEventListener("keydown",a,!1),()=>window.removeEventListener("keydown",a,!1))),[a]),t};var Xc=a(97967),ed=a(97046);const td=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a);return{chat:n,user:(0,c.mBe)(e,a),isPinned:(0,c.D3D)(e,a),isMuted:n?(0,l.W1R)(n,(0,c.$5S)(e),(0,c.GrP)(e)):void 0,canChangeFolder:Boolean(e.chatFolders.orderedIds?.length)}}))((e=>{let{chatId:t,withUsername:a,chat:r,user:o,isPinned:c,isMuted:d,canChangeFolder:m,withOpenAppButton:u,onClick:A}=e;const{requestMainWebView:h}=(0,s.ko)(),y=(0,T.A)(),[p,v,g]=(0,I.A)(),[E,b,C]=(0,I.A)(),[f,S,k]=(0,I.A)(),[w,N,P]=(0,I.A)(),B=(0,n.hb)((()=>{S(),b()}),[S,b]),L=(0,n.hb)((()=>{N(),v()}),[N,v]),R=(0,Qc.A)({chat:r,user:o,isPinned:c,isMuted:d,canChangeFolder:m,handleMute:L,handleChatFolderChange:B},!0),x=(0,M.A)((()=>{A(t)})),F=(0,M.A)((e=>{e.stopPropagation();const a=(0,ui.A)();h({botId:t,peerId:t,theme:a})})),V=Zc(x);return n.Ay.createElement(Wa.A,{className:"chat-item-clickable search-result",onClick:x,contextActions:R,buttonRef:V},(0,l.L8L)(t)?n.Ay.createElement(ds.A,{userId:t,withUsername:a,withStory:!0,avatarSize:"medium",storyViewerOrigin:i.G9.SearchResult}):n.Ay.createElement(cs.A,{chatId:t,withUsername:a,avatarSize:"medium",withStory:!0,storyViewerOrigin:i.G9.SearchResult}),u&&o?.hasMainMiniApp&&n.Ay.createElement(W.A,{className:"ChatBadge miniapp",pill:!0,fluid:!0,size:"tiny",onClick:F},y("BotOpen")),w&&n.Ay.createElement(ed.A,{isOpen:p,onClose:g,onCloseAnimationEnd:P,chatId:t}),f&&n.Ay.createElement(Xc.A,{isOpen:E,onClose:C,onCloseAnimationEnd:k,chatId:t}))}))),ad=(0,Ae.nF)((e=>e()),500,!0),nd=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.nTw)(e).globalSearch,a=t.popularBotApps?.peerIds;return{isLoading:!a&&t.fetchingStatus?.botApps,foundIds:a,recentBotIds:e.topBotApps.userIds}}))((e=>{let{searchQuery:t,isLoading:a,foundIds:o,recentBotIds:l}=e;const{searchPopularBotApps:c,openChatWithInfo:d}=(0,s.ko)(),m=(0,n.li)(null),u=(0,T.A)(),[A,h]=(0,n.J0)(!1),y=(0,n.Kr)((()=>{if(!o)return[];const e=new Set(l),a=o.filter((t=>!e.has(t)));return(0,rn.PU)({ids:a,query:t,type:"user"})}),[o,l,t]),p=(0,M.A)((e=>{d({id:e,shouldReplaceHistory:!0})})),v=(0,n.hb)((e=>{let{direction:t}=e;t===i.TN.Backwards&&ad((()=>{c()}))}),[]),g=(0,M.A)((()=>{h((e=>!e))})),E=(0,jo.A)([t],r.jhd)&&!a;return n.Ay.createElement("div",{ref:m,className:"LeftSearch--content"},n.Ay.createElement(rs.A,{className:"search-content custom-scroll",items:E?y:void 0,onLoadMore:v,noFastList:!0},!E&&n.Ay.createElement(fs.A,null),E&&!y?.length&&n.Ay.createElement(qc.A,{text:u("ChatList.Search.NoResults"),description:u("ChatList.Search.NoResultsDescription")}),E&&!t&&Boolean(l?.length)&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading"},l.length>5&&n.Ay.createElement(uo.A,{className:"Link",onClick:g},u(A?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")),u("SearchAppsMine")),l.map(((e,t)=>{if(A||!(t>=5))return n.Ay.createElement(td,{chatId:e,onClick:p,withOpenAppButton:!0})}))),E&&y?.length&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading"},u("SearchAppsPopular")),y.map((e=>n.Ay.createElement(td,{chatId:e,onClick:p,withOpenAppButton:!0}))))))}))),sd=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a);if(!n)return{};const s=(0,l.e7w)(n),i=s?(0,c.mBe)(e,s):void 0;return{chat:n,...s&&{privateChatUser:i}}}))((e=>{let{message:t,searchQuery:a,chatId:i,chat:r,privateChatUser:o}=e;const{focusMessage:c}=(0,s.ko)(),{isMobile:d}=(0,w.Ay)(),m=(0,l.fP4)(t)?void 0:(0,l.CIU)(t),u=(0,G.A)((0,l.EOe)(t,"micro")),A=Boolean((0,l.lkW)(t)),y=(0,M.A)((()=>{c({chatId:i,messageId:t.id,shouldReplaceHistory:!0})})),p=(0,T.A)(),v=Zc(y);if(!r)return;const g=o||r;return n.Ay.createElement(Wa.A,{className:"ChatMessage chat-item-clickable",ripple:!d,onClick:y,buttonRef:v},n.Ay.createElement(wt.A,{peer:g,isSavedMessages:o?.isSelf}),n.Ay.createElement("div",{className:"info"},n.Ay.createElement("div",{className:"info-row"},n.Ay.createElement(Ss.A,{peer:g,withEmojiStatus:!0,isSavedMessages:i===o?.id&&o?.isSelf}),n.Ay.createElement("div",{className:"message-date"},n.Ay.createElement(uo.A,{className:"date"},(0,Ke.be)(p,1e3*t.date)))),n.Ay.createElement("div",{className:"subtitle"},n.Ay.createElement("div",{className:"message",dir:"auto"},function(e,t,a,s,i){if(!a)return(0,h.C)(e,t,void 0,s);const r=(0,l.y2W)(t);return n.Ay.createElement("span",{className:"media-preview"},n.Ay.createElement("img",{src:a,alt:"",className:(0,de.A)("media-preview--image",i&&"round",r&&"media-preview-spoiler"),draggable:!1}),(0,l.zXI)(t)&&n.Ay.createElement(q.A,{name:"play"}),(0,h.C)(e,t,!0,s))}(p,t,u||m,a,A)))))}))),id=(0,n.ph)((e=>{let{searchDate:t,onSelect:a}=e;const s=(0,n.Kr)((()=>function(e){if(e.match(/^\d{2,4}-\d{2}-\d{2}$/g)){const t=new Date(e);return[{date:t,text:(0,Ke.A)(t)}]}const t=[],a=new Date,n=a.getFullYear(),s=a.getTime()>new Date(`${n}-${e}`).getTime()?n:n-1;for(let a=0;a<8;a++){const n=new Date(`${s-a}-${e}`);t.push({date:n,text:(0,Ke.A)(n)})}return t}(t)),[t]);return n.Ay.createElement("section",{className:"DateSuggest custom-scroll custom-scroll-x"},s.map((e=>{let{date:t,text:s}=e;return n.Ay.createElement("div",{onClick:()=>a(t),className:"date-item",key:s},n.Ay.createElement(q.A,{name:"calendar"}),n.Ay.createElement("span",null,s))})))})),rd=2*A.$,od=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a,topicId:n}=t;return{topic:(0,c.S0q)(e,a,n)}}))((e=>{let{topicId:t,topic:a,onClick:s}=e;const i=(0,n.hb)((()=>{s(t)}),[t,s]),r=Zc(i);if(a)return n.Ay.createElement(Wa.A,{className:"chat-item-clickable search-result",onClick:i,buttonClassName:"topic-item",buttonRef:r},n.Ay.createElement(ks.A,{size:rd,topic:a,className:"topic-icon",letterClassName:"topic-icon-letter"}),n.Ay.createElement("div",{dir:"auto",className:"fullName"},(0,kt.A)(a.title)))}))),ld=(0,Ae.nF)((e=>e()),500,!0),cd=(0,n.ph)((0,s.EK)((e=>{const{byId:t}=e.chats,{currentUserId:a,messages:{byChatId:n}}=e,{fetchingStatus:s,resultsByType:i,foundTopicIds:r,chatId:o}=(0,c.nTw)(e).globalSearch,{foundIds:l}=i?.text||{};return{currentUserId:a,foundIds:l,globalMessagesByChatId:n,chatsById:t,fetchingStatus:s,foundTopicIds:r,searchChatId:o}}))((e=>{let{searchQuery:t,dateSearchQuery:a,foundIds:r,globalMessagesByChatId:o,chatsById:l,fetchingStatus:c,foundTopicIds:d,searchChatId:m,onSearchDateSelect:u,onReset:A}=e;const{searchMessagesGlobal:y,openThread:p}=(0,s.ko)(),v=(0,T.A)(),{isMobile:g}=(0,w.Ay)(),E=(0,n.hb)((e=>{let{direction:t}=e;t===i.TN.Backwards&&ld((()=>{y({type:"text"})}))}),[t]),b=(0,n.hb)((e=>{m&&(p({chatId:m,threadId:e,shouldReplaceHistory:!0}),g||A())}),[m,g,A]),C=(0,n.Kr)((()=>r&&0!==r.length?r.map((e=>{const[t,a]=(0,Gc.a)(e);return o?.[t]?.byId[a]})).filter(Boolean).sort(((e,t)=>t.date-e.date)):ln.p),[r,o]),f=c&&!c.chats&&!c.messages&&!C.length&&!d?.length;return n.Ay.createElement("div",{className:"LeftSearch--content"},n.Ay.createElement(rs.A,{className:"search-content custom-scroll chat-list",items:C,onLoadMore:E,noFastList:!0},a&&n.Ay.createElement("div",{className:"chat-selection no-scrollbar"},n.Ay.createElement(id,{searchDate:a,onSelect:u})),f&&n.Ay.createElement(qc.A,{text:v("ChatList.Search.NoResults"),description:v("ChatList.Search.NoResultsDescription")}),Boolean(d?.length)&&n.Ay.createElement("div",{className:"pb-2"},n.Ay.createElement("h3",{className:"section-heading topic-search-heading",dir:v.isRtl?"auto":void 0},v("Topics")),d.map((e=>n.Ay.createElement(od,{chatId:m,topicId:e,onClick:b})))),Boolean(C.length)&&n.Ay.createElement("div",{className:"pb-2"},n.Ay.createElement("h3",{className:"section-heading topic-search-heading",dir:v.isRtl?"auto":void 0},v("SearchMessages")),C.map((function(e){const a=(0,h.C)(v,e),s=l[e.chatId];if(a&&s)return n.Ay.createElement(sd,{chatId:e.chatId,message:e,searchQuery:t})})))))})));var dd=a(49763);const md=(0,Ae.nF)((e=>e()),6e4,!0),ud=(0,n.ph)((0,s.EK)((e=>{const{userIds:t}=e.topPeers,a=e.users.byId,{recentlyFoundChatIds:n}=e;return{topUserIds:t,usersById:a,recentlyFoundChatIds:n}}))((e=>{let{topUserIds:t,usersById:a,recentlyFoundChatIds:i,onReset:r}=e;const{loadTopUsers:o,openChat:c,addRecentlyFoundChatId:d,clearRecentlyFoundChats:m}=(0,s.ko)(),u=(0,n.li)(null);(0,n.vJ)((()=>{md((()=>{o()}))}),[o]),(0,di.A)(u,!t);const A=(0,n.hb)((e=>{c({id:e,shouldReplaceHistory:!0}),r(),setTimeout((()=>{d({id:e})}),250)}),[c,d,r]),h=(0,n.hb)((()=>{m()}),[m]),y=(0,T.A)();return n.Ay.createElement("div",{className:"RecentContacts custom-scroll"},t&&n.Ay.createElement("div",{className:"top-peers-section",dir:y.isRtl?"rtl":void 0},n.Ay.createElement("div",{ref:u,className:"top-peers"},t.map((e=>n.Ay.createElement("div",{key:e,className:"top-peer-item",onClick:()=>A(e),dir:y.isRtl?"rtl":void 0},n.Ay.createElement(wt.A,{peer:a[e]}),n.Ay.createElement("div",{className:"top-peer-name"},(0,kt.A)((0,l.u0l)(a[e])||" "))))))),i&&n.Ay.createElement("div",{className:"search-section pt-1"},n.Ay.createElement("h3",{className:(0,de.A)("section-heading mt-0 recent-chats-header",!t&&"without-border"),dir:y.isRtl?"rtl":void 0},y("Recent"),n.Ay.createElement(W.A,{className:"clear-recent-chats",round:!0,size:"smaller",color:"translucent",ariaLabel:y("Clear"),onClick:h,isRtl:y.isRtl},n.Ay.createElement(q.A,{name:"close"}))),i.map((e=>n.Ay.createElement(td,{chatId:e,withOpenAppButton:!0,onClick:A})))))}))),Ad=(0,Ae.nF)((e=>e()),500,!1),hd=(0,n.ph)((0,s.EK)(((e,t)=>{let{isChannelList:a}=t;const{userIds:n}=e.contactList||{},{currentUserId:s,messages:i}=e;if(!n)return{};const{fetchingStatus:o,globalResults:l,localResults:d,resultsByType:m}=(0,c.nTw)(e).globalSearch,{peerIds:u}=l||{},{peerIds:A}=d||{},{byChatId:h}=i,y=m?.[a?"channels":"text"]?.foundIds,{similarChannelIds:p}=(0,c.dg4)(e,r.rBM)||{};return{currentUserId:s,contactIds:n,accountPeerIds:A,globalPeerIds:u,foundIds:y,globalMessagesByChatId:h,fetchingStatus:o,suggestedChannelIds:p}}))((e=>{let{isChannelList:t,searchQuery:a,searchDate:o,dateSearchQuery:c,currentUserId:d,contactIds:m,accountPeerIds:u,globalPeerIds:A,foundIds:y,globalMessagesByChatId:p,fetchingStatus:v,suggestedChannelIds:g,onReset:E,onSearchDateSelect:b}=e;const{openChat:C,addRecentlyFoundChatId:f,searchMessagesGlobal:S,setGlobalSearchChatId:k,loadChannelRecommendations:N}=(0,s.ko)(),I=(0,n.li)(null),P=(0,T.A)(),B=(0,Us.A)(),{isMobile:L}=(0,w.Ay)(),[R,x]=(0,n.J0)(!1),[F,V]=(0,n.J0)(!1),[D,_]=(0,n.J0)("all"),U=(0,n.li)(null);(0,ge.A)((()=>{t&&N({})}));const O=(0,n.hb)((e=>{let{direction:a}=e;a===i.TN.Backwards&&Ad((()=>{S({type:t?"channels":"text",context:D})}))}),[a,D]),J=(0,n.hb)((e=>{C({id:e,shouldReplaceHistory:!0}),e!==d&&f({id:e}),L||E()}),[C,d,L,f,E]),K=(0,n.hb)((e=>{k({id:e})}),[k]);function j(e){return B("users"===e?"PrivateChatsSearchContext":"groups"===e?"GroupChatsSearchContext":"channels"===e?"ChannelsSearchContext":"AllChatsSearchContext")}const{isContextMenuOpen:G,contextMenuAnchor:z,handleContextMenu:H,handleContextMenuClose:$,handleContextMenuHide:W}=(0,si.A)(U),Y=(0,M.A)((()=>U.current)),Q=(0,M.A)((()=>U.current.querySelector(".chatResultsContextMenu .bubble"))),Z=(0,M.A)((()=>U.current.querySelector(".menuTrigger"))),X=(0,M.A)((e=>{H(e)})),ee=(0,de.A)("icon","iconPlaceholder"),ae=(0,n.Kr)((()=>{if(!t&&(!a||a.startsWith("@")&&a.length<2))return ln.p;const e=(0,s.mS)().chats.byId,n=((0,dd.YA)(r.DSF)??[]).filter((a=>{if(!t)return!0;const n=e[a];return n&&(0,l.WXB)(n)})),i=(0,rn.PU)({ids:n,query:a,type:"chat"});if(t)return i;const o=[...d?[d]:[],...m||[]],c=[...(0,rn.PU)({ids:o,query:a,type:"user"}),...i];return(0,on.Am)([...(0,vs.A)(c,void 0,d?[d]:void 0),...(0,vs.A)(u||[])])}),[a,d,m,u,t]);(0,di.A)(I,!ae.length||t,!0);const ne=(0,n.Kr)((()=>{if(!a||a.length<4||!A)return ln.p;const e=(0,s.mS)().chats.byId,n=A.filter((a=>{if(!t)return!0;const n=e[a];return n&&(0,l.WXB)(n)}));return(0,vs.A)(n,!0)}),[A,t,a]),se=(0,n.Kr)((()=>{if(!a&&!o||!y||0===y.length)return ln.p;const e=(0,s.mS)().chats.byId;return y.map((a=>{const[n,s]=(0,Gc.a)(a),i=e[n];if(i&&(!t||(0,l.WXB)(i)))return p?.[n]?.byId[s]})).filter(Boolean)}),[a,o,y,t,p]);(0,n.vJ)((()=>{a&&S({type:t?"channels":"text",context:D,shouldResetResultsByType:!0,shouldCheckFetchingMessagesStatus:!0})}),[D]);const ie=(0,n.hb)((()=>{x(!R)}),[R]),re=(0,n.hb)((()=>{V(!F)}),[F]),le=se,ce="all"===D&&v&&!v.chats&&!v.messages&&!ae.length&&!ne.length&&!le.length,me=v?.messages;if(!a&&!o&&!t)return n.Ay.createElement(ud,{onReset:E});const ue="all"!==D||Boolean(le.length);return n.Ay.createElement(rs.A,{className:"LeftSearch--content custom-scroll",items:le,onLoadMore:O,noScrollRestoreOnTop:!0,noFastList:!0},c&&n.Ay.createElement("div",{className:"chat-selection no-scrollbar"},n.Ay.createElement(id,{searchDate:c,onSelect:b})),ce&&n.Ay.createElement(qc.A,{text:P("ChatList.Search.NoResults"),description:P("ChatList.Search.NoResultsDescription")}),Boolean(ae.length)&&!t&&n.Ay.createElement("div",{className:"chat-selection no-scrollbar",dir:P.isRtl?"rtl":void 0,ref:I},ae.map((e=>n.Ay.createElement(wl.A,{peerId:e,className:"left-search-local-suggestion",onClick:K,clickArg:e})))),Boolean(ae.length)&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading",dir:P.isRtl?"auto":void 0},ae.length>5&&n.Ay.createElement(uo.A,{className:"Link",onClick:ie},P(R?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")),P(t?"SearchMyChannels":"DialogList.SearchSectionDialogs")),ae.map(((e,t)=>{if(R||!(t>=5))return n.Ay.createElement(td,{withOpenAppButton:!0,chatId:e,onClick:J})}))),Boolean(ne.length)&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading",dir:P.isRtl?"auto":void 0},ne.length>5&&n.Ay.createElement(uo.A,{className:"Link",onClick:re},P(F?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")),P("DialogList.SearchSectionGlobal")),ne.map(((e,t)=>{if(F||!(t>=5))return n.Ay.createElement(td,{chatId:e,withUsername:!0,onClick:J})}))),Boolean(g?.length)&&!a&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading",dir:P.isRtl?"auto":void 0},P("SearchRecommendedChannels")),g.map((e=>n.Ay.createElement(td,{chatId:e,withUsername:!0,onClick:J})))),n.Ay.createElement("div",{className:"menuOwner",ref:U},n.Ay.createElement(Ge.A,{isOpen:G,anchor:z,getTriggerElement:Z,getRootElement:Y,getMenuElement:Q,className:"chatResultsContextMenu",onClose:$,onCloseAnimationEnd:W,autoClose:!0},n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(oe.A,{icon:"all"===D?"check":void 0,customIcon:"all"!==D?n.Ay.createElement("i",{className:ee}):void 0,onClick:()=>_("all")},j("all")),n.Ay.createElement(oe.A,{icon:"users"===D?"check":void 0,customIcon:"users"!==D?n.Ay.createElement("i",{className:ee}):void 0,onClick:()=>_("users")},j("users")),n.Ay.createElement(oe.A,{icon:"groups"===D?"check":void 0,customIcon:"groups"!==D?n.Ay.createElement("i",{className:ee}):void 0,onClick:()=>_("groups")},j("groups")),n.Ay.createElement(oe.A,{icon:"channels"===D?"check":void 0,customIcon:"channels"!==D?n.Ay.createElement("i",{className:ee}):void 0,onClick:()=>_("channels")},j("channels")))),ue&&n.Ay.createElement("div",{className:"search-section"},n.Ay.createElement("h3",{className:"section-heading",dir:P.isRtl?"auto":void 0},!t&&n.Ay.createElement(uo.A,{className:"Link menuTrigger dropDownLink",onClick:X},B("SearchContextCaption",{type:j(D)},{withNodes:!0}),n.Ay.createElement(te.Ay,{name:"fade",shouldCleanup:!0,activeKey:Number(me),className:"iconContainer",slideClassName:"iconContainerSlide"},me&&n.Ay.createElement(fs.A,null),!me&&n.Ay.createElement(q.A,{name:"down"}))),P("SearchMessages")),le.map((function(e){const t=(0,s.mS)().chats.byId,i=(0,h.C)(P,e),r=t[e.chatId];if(i&&r)return n.Ay.createElement(sd,{chatId:e.chatId,message:e,searchQuery:a})})))))})));var yd=a(44589);const pd="documents",vd=(0,Ae.nF)((e=>e()),500,!0),gd=(0,n.ph)((0,s.EK)(zc(pd))((e=>{let{searchQuery:t,isLoading:a,chatsById:o,usersById:c,globalMessagesByChatId:d,foundIds:m,activeDownloads:u,shouldWarnAboutSvg:A}=e;const{searchMessagesGlobal:h,focusMessage:y}=(0,s.ko)(),p=(0,n.li)(null),v=(0,T.A)(),{observe:g}=(0,zo.BL)({rootRef:p,throttleMs:500}),E=(0,n.hb)((e=>{let{direction:t}=e;t===i.TN.Backwards&&vd((()=>{h({type:pd})}))}),[t]),b=(0,n.Kr)((()=>m&&d?m.map((e=>{const[t,a]=(0,Gc.a)(e),n=d[t]?.byId[a];return n&&(0,l.zCu)(n)?n:void 0})).filter(Boolean):ln.p),[d,m]),C=(0,n.hb)((e=>{y({chatId:e.chatId,messageId:e.id})}),[y]),f=(0,jo.A)([t],r.jhd)&&!a;return n.Ay.createElement("div",{ref:p,className:"LeftSearch--content"},n.Ay.createElement(rs.A,{className:"search-content documents-list custom-scroll",items:f?b:void 0,onLoadMore:E,noFastList:!0},!f&&n.Ay.createElement(fs.A,null),f&&(!m||0===m.length)&&n.Ay.createElement(qc.A,{text:v("ChatList.Search.NoResults"),description:v("ChatList.Search.NoResultsDescription")}),f&&m&&m.length>0&&b.map(((e,t)=>{const a=0===t||(0,Ke.$$)(e.date)!==(0,Ke.$$)(b[t-1].date);return n.Ay.createElement(n.Ay.Fragment,null,a&&n.Ay.createElement("p",{className:"section-heading",dir:v.isRtl?"rtl":void 0,key:e.date},(0,Ke.i6)(v,new Date(1e3*e.date))),n.Ay.createElement("div",{className:"ListItem small-icon",key:e.id},n.Ay.createElement(yd.A,{document:(0,l.zCu)(e),message:e,withDate:!0,datetime:e.date,smaller:!0,sender:(0,Hc.N)(v,e,o,c),className:"scroll-item",isDownloading:(0,l.$r_)(u,e.content.document),shouldWarnAboutSvg:A,observeIntersection:g,onDateClick:C})))}))))})));var Ed=a(37378);const bd="links",Cd=(0,Ae.nF)((e=>e()),500,!0),fd=(0,n.ph)((0,s.EK)(zc(bd))((e=>{let{searchQuery:t,isLoading:a,chatsById:o,usersById:l,globalMessagesByChatId:c,foundIds:d,isChatProtected:m}=e;const{searchMessagesGlobal:u,focusMessage:A}=(0,s.ko)(),h=(0,n.li)(null),y=(0,T.A)(),{observe:p}=(0,zo.BL)({rootRef:h,throttleMs:500}),v=(0,n.hb)((e=>{let{direction:t}=e;t===i.TN.Backwards&&Cd((()=>{u({type:bd})}))}),[t]),g=(0,n.Kr)((()=>d&&c?d.map((e=>{const[t,a]=(0,Gc.a)(e);return c[t]?.byId[a]})).filter(Boolean):ln.p),[c,d]),E=(0,n.hb)((e=>{A({chatId:e.chatId,messageId:e.id})}),[A]),b=(0,jo.A)([t],r.jhd)&&!a;return n.Ay.createElement("div",{ref:h,className:"LeftSearch--content"},n.Ay.createElement(rs.A,{className:"search-content documents-list custom-scroll",items:b?g:void 0,onLoadMore:v,noFastList:!0},!b&&n.Ay.createElement(fs.A,null),b&&(!d||0===d.length)&&n.Ay.createElement(qc.A,{text:y("ChatList.Search.NoResults"),description:y("ChatList.Search.NoResultsDescription")}),b&&d&&d.length>0&&g.map(((e,t)=>{const a=0===t||(0,Ke.$$)(e.date)!==(0,Ke.$$)(g[t-1].date);return n.Ay.createElement(n.Ay.Fragment,null,a&&n.Ay.createElement("p",{className:"section-heading",key:e.date,dir:y.isRtl?"rtl":void 0},(0,Ke.i6)(y,new Date(1e3*e.date))),n.Ay.createElement("div",{className:"ListItem small-icon",dir:y.isRtl?"rtl":void 0,key:e.id},n.Ay.createElement(Ed.A,{key:e.id,message:e,senderTitle:(0,Hc.N)(y,e,o,l),isProtected:m||e.isProtected,observeIntersection:p,onMessageClick:E})))}))))})));var Sd=a(81524);const kd="media",wd=(0,Ae.nF)((e=>e()),500,!0),Nd=(0,n.ph)((0,s.EK)(zc(kd))((e=>{let{searchQuery:t,isLoading:a,globalMessagesByChatId:o,foundIds:l,isChatProtected:c}=e;const{searchMessagesGlobal:d,openMediaViewer:m}=(0,s.ko)(),u=(0,n.li)(null),A=(0,T.A)(),{observe:h}=(0,zo.BL)({rootRef:u,throttleMs:500}),y=(0,n.hb)((e=>{let{direction:t}=e;t===i.TN.Backwards&&wd((()=>{d({type:kd})}))}),[d,t]),p=(0,n.Kr)((()=>l&&o?l.map((e=>{const[t,a]=(0,Gc.a)(e);return o[t]?.byId[a]})).filter(Boolean):ln.p),[o,l]),v=(0,n.hb)(((e,t)=>{m({chatId:t,messageId:e,origin:i.TQ.SearchResult})}),[m]),g=(0,jo.A)([t],r.jhd)&&!a,E=g&&l&&l.length>0&&!t,b=g&&l&&l.length>0&&t,C=(0,de.A)("search-content custom-scroll",b&&"chat-list");return n.Ay.createElement("div",{ref:u,className:"LeftSearch--content LeftSearch--media"},n.Ay.createElement(rs.A,{className:C,items:g?p:void 0,itemSelector:t?".ListItem":".Media",onLoadMore:y,noFastList:!0},!g&&n.Ay.createElement(fs.A,null),g&&(!l||0===l.length)&&n.Ay.createElement(qc.A,{text:A("ChatList.Search.NoResults"),description:A("ChatList.Search.NoResultsDescription")}),E&&n.Ay.createElement("div",{className:"media-list",dir:A.isRtl?"rtl":void 0},p.map((e=>n.Ay.createElement(Sd.A,{key:`${e.chatId}-${e.id}`,idPrefix:"search-media",message:e,isProtected:c||e.isProtected,observeIntersection:h,onClick:v})))),b&&p.map((e=>n.Ay.createElement(sd,{key:e.id,chatId:e.chatId,message:e})))))}))),Id=[{type:i.$C.ChatList,key:"SearchTabChats"},{type:i.$C.ChannelList,key:"SearchTabChannels"},{type:i.$C.BotApps,key:"SearchTabApps"},{type:i.$C.Media,key:"SearchTabMedia"},{type:i.$C.Links,key:"SearchTabLinks"},{type:i.$C.Files,key:"SearchTabFiles"},{type:i.$C.Music,key:"SearchTabMusic"},{type:i.$C.Voice,key:"SearchTabVoice"}],Pd=[{type:i.$C.ChatList,key:"SearchTabMessages"},...Id.slice(3)],Md=(0,n.ph)((0,s.EK)((e=>{const{currentContent:t,chatId:a}=(0,c.nTw)(e).globalSearch;return{currentContent:t,chatId:a}}))((e=>{let{searchQuery:t,searchDate:a,isActive:r,currentContent:o=i.$C.ChatList,chatId:l,onReset:c}=e;const{setGlobalSearchContent:d,setGlobalSearchDate:m}=(0,s.ko)(),u=(0,Us.A)(),[A,h]=(0,n.J0)(o),y=(0,n.Kr)((()=>(0,Ke.Rm)(t)),[t]),p=(0,n.Kr)((()=>(l?Pd:Id).map((e=>({...e,title:u(e.key)})))),[l,u]),v=(0,M.A)((e=>{const t=p[e];d({content:t.type}),h(e)})),g=(0,M.A)((e=>{m({date:e.getTime()/1e3})}));(0,ve.A)({isActive:r,onBack:c});const E=(0,n.li)(null),b=(0,Cs.A)(E,r,void 0,".ListItem-button",!0);return n.Ay.createElement("div",{className:"LeftSearch",ref:E,onKeyDown:b},n.Ay.createElement(jc.A,{activeTab:A,tabs:p,onSwitchTab:v}),n.Ay.createElement(te.Ay,{name:u.isRtl?"slideOptimizedRtl":"slideOptimized",renderCount:p.length,activeKey:o},(()=>{switch(o){case i.$C.ChatList:case i.$C.ChannelList:return l?n.Ay.createElement(cd,{searchQuery:t,dateSearchQuery:y,onReset:c,onSearchDateSelect:g}):n.Ay.createElement(hd,{isChannelList:o===i.$C.ChannelList,searchQuery:t,searchDate:a,dateSearchQuery:y,onReset:c,onSearchDateSelect:g});case i.$C.Media:return n.Ay.createElement(Nd,{searchQuery:t});case i.$C.Links:return n.Ay.createElement(fd,{searchQuery:t});case i.$C.Files:return n.Ay.createElement(gd,{searchQuery:t});case i.$C.Music:return n.Ay.createElement(Yc,{key:"audio",searchQuery:t});case i.$C.Voice:return n.Ay.createElement(Yc,{key:"voice",isVoice:!0,searchQuery:t});case i.$C.BotApps:return n.Ay.createElement(nd,{key:"botApps",searchQuery:t});default:return}})()))})));var Td=a(42215);const Bd={currentPassword:"",password:"",hint:"",email:""},Ld=(e,t)=>{switch(t.type){case"setCurrentPassword":return{...e,currentPassword:t.payload};case"setPassword":return{...e,password:t.payload};case"setHint":return{...e,hint:t.payload};case"setEmail":return{...e,email:t.payload};case"reset":return Bd;default:return e}};var Rd=a(31880),xd=a(58968),Fd=a(74984);const Vd=(0,n.ph)((0,s.EK)((e=>({maxChats:(0,Yi.d)(e,"dialogFiltersChats")})))((e=>{let{mode:t,state:a,dispatch:i,isActive:o,onReset:l,onSaveFilter:c,maxChats:d}=e;const m=(0,T.A)(),{openLimitReachedModal:u}=(0,s.ko)(),{chatFilter:A}=a,{selectedChatIds:h,selectedChatTypes:y}=(0,n.Kr)((()=>(0,Rd.a)(a,t,!0)),[t,a]),p="included"===t?xd.V2:xd.LS,[v,g]=(0,n.J0)(!1),E=(0,Fd.Rh)(r.DSF),b=(0,Fd.Rh)(r._E9),C=a.folder.isChatList;(0,n.vJ)((()=>{o||g(!1)}),[o]);const f=(0,n.Kr)((()=>{const e=[...E||[],...b||[]];return(0,on.Am)([...(0,rn.PU)({ids:e,query:A,type:"chat"})])}),[E,b,A]),S=(0,M.A)((e=>{i({type:"setChatFilter",payload:e}),g(!0)})),k=(0,M.A)((e=>{if("included"===t){if(e.length>=d)return void u({limit:"dialogFiltersChats"});i({type:"setIncludeFilters",payload:{...a.includeFilters,includedChatIds:e}})}else i({type:"setExcludeFilters",payload:{...a.excludeFilters,excludedChatIds:e}});g(!0)})),w=(0,M.A)((e=>{const a={};e.forEach((e=>{a[e]=!0})),i("included"===t?{type:"setIncludeFilters",payload:{includedChatIds:h,...a}}:{type:"setExcludeFilters",payload:{excludedChatIds:h,...a}}),g(!0)}));return(0,ve.A)({isActive:o,onBack:l}),f?n.Ay.createElement("div",{className:"Picker settings-folders-chat-list"},n.Ay.createElement(cn.A,{categories:C?void 0:p,itemIds:f,selectedIds:h,selectedCategories:y,filterValue:A,filterPlaceholder:m("Search"),categoryPlaceholderKey:"FilterChatTypes",searchInputId:"new-group-picker-search",isSearchable:!0,withDefaultPadding:!0,withPeerTypes:!0,allowMultiple:!0,itemInputType:"checkbox",onSelectedIdsChange:k,onSelectedCategoriesChange:w,onFilterChange:S}),n.Ay.createElement(un.A,{isShown:v,onClick:c,ariaLabel:m("Save")},n.Ay.createElement(q.A,{name:"check"}))):n.Ay.createElement(fs.A,null)}))),Dd="Please provide a title for this folder.",_d="ChatList.Filter.Error.Empty",Ud=(0,n.ph)((0,s.EK)(((e,t)=>{let{state:a}=t;const{listIds:n}=e.chats,{byId:s,invites:i}=e.chatFolders,r=Object.values(s).reduce(((e,t)=>e+(t.isChatList?1:0)),0);return{loadedActiveChatIds:n.active,loadedArchivedChatIds:n.archived,invites:a.folderId?i[a.folderId]||ln.p:void 0,isRemoved:void 0!==a.folderId&&!s[a.folderId],maxInviteLinks:(0,Yi.d)(e,"chatlistInvites"),maxChatLists:(0,Yi.d)(e,"chatlistJoined"),chatListCount:r}}))((e=>{let{state:t,dispatch:a,onAddIncludedChats:i,onAddExcludedChats:o,onShareFolder:d,onOpenInvite:m,isActive:u,onReset:A,isRemoved:h,onBack:y,loadedActiveChatIds:p,isOnlyInvites:v,loadedArchivedChatIds:g,invites:E,maxInviteLinks:b,maxChatLists:C,chatListCount:f,onSaveFolder:S}=e;const{loadChatlistInvites:k,openLimitReachedModal:w,showNotification:N}=(0,s.ko)(),I="create"===t.mode,P=t.folder.isChatList,[M,B]=(0,n.J0)(!1),[L,R]=(0,n.J0)(!1);(0,n.vJ)((()=>{h&&A()}),[h,A]),(0,n.vJ)((()=>{u&&t.folderId&&t.folder.isChatList&&k({folderId:t.folderId})}),[u,t.folder.isChatList,t.folderId]);const{selectedChatIds:x,selectedChatTypes:F}=(0,n.Kr)((()=>(0,Rd.a)(t,"included")),[t]),{selectedChatIds:V,selectedChatTypes:D}=(0,n.Kr)((()=>(0,Rd.a)(t,"excluded")),[t]);(0,n.vJ)((()=>{B(!1),R(!1)}),[t.folderId]);const[_,U]=(0,n.Kr)((()=>{const e=new Set([...p||[],...g||[]]),t=(0,on.$h)(x,e),a=(0,on.$h)(V,e);return[M?t:t.slice(0,5-F.length),L?a:a.slice(0,5-D.length)]}),[V,x,F,D,L,M,p,g]),O=(0,T.A)();(0,ve.A)({isActive:u,onBack:y});const J=(0,n.hb)((e=>{const{currentTarget:t}=e;a({type:"setTitle",payload:t.value.trim()})}),[a]),K=(0,n.hb)((()=>{a({type:"setIsLoading",payload:!0}),S((()=>{setTimeout((()=>{A()}),500)}))}),[a,S,A]),j=(0,n.hb)((()=>{E?(0,c.w5O)((0,s.mS)(),t.folderId)?f>=C&&!t.folder.isChatList?w({limit:"chatlistJoined"}):E.length<b?t.isTouched?S(d):d():w({limit:"chatlistInvites"}):N({message:O("ChatList.Filter.InviteLink.IncludeExcludeError")}):I&&S(d)}),[E,t.folderId,t.isTouched,f,b,I,S,d,O,C,t.folder.isChatList]),G=(0,n.hb)(((e,a)=>{t.isTouched?S((()=>m(a))):m(a)}),[S,m,t.isTouched]);function z(e){const t="included"===e?F:D,a="included"===e?_:U,s="included"===e?M:L,i=("included"===e?x:V).length-a.length,r="included"===e?()=>B(!0):()=>R(!0);return n.Ay.createElement(n.Ay.Fragment,null,t.map((t=>function(e,t){const a="included"===t?xd.V2.find((t=>{let{type:a}=t;return a===e})):xd.LS.find((t=>{let{type:a}=t;return a===e}));if(a)return n.Ay.createElement(Wa.A,{key:a.type,className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0},n.Ay.createElement(ds.A,{avatarSize:"small",customPeer:a}))}(t,e))),a.map((e=>n.Ay.createElement(Wa.A,{className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0},(0,l.L8L)(e)?n.Ay.createElement(ds.A,{avatarSize:"small",userId:e}):n.Ay.createElement(cs.A,{avatarSize:"small",chatId:e})))),!s&&i>0&&n.Ay.createElement(Wa.A,{key:"load-more",className:"settings-folders-list-item",narrow:!0,onClick:r,icon:"down"},O("FilterShowMoreChats",i,"i")))}return n.Ay.createElement("div",{className:"settings-fab-wrapper"},n.Ay.createElement("div",{className:"settings-content no-border custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header"},n.Ay.createElement(ol.A,{size:r.fwn,tgsUrl:rl.w.FoldersNew,play:String(t.folderId),className:"settings-content-icon"}),I&&n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:O.isRtl?"rtl":void 0},O("FilterIncludeInfo")),n.Ay.createElement(Y.A,{className:"mb-0",label:O("FilterNameHint"),value:t.folder.title.text,onChange:J,error:t.error&&t.error===Dd?Dd:void 0})),!v&&n.Ay.createElement("div",{className:"settings-item pt-3"},t.error&&t.error===_d&&n.Ay.createElement("p",{className:"settings-item-description color-danger mb-2",dir:O.isRtl?"rtl":void 0},O(t.error)),n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:O.isRtl?"rtl":void 0},O("FilterInclude")),n.Ay.createElement(Wa.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:i},O("FilterAddChats")),z("included")),!v&&!P&&n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:O.isRtl?"rtl":void 0},O("FilterExclude")),n.Ay.createElement(Wa.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:o},O("FilterAddChats")),z("excluded")),n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:O.isRtl?"rtl":void 0},O("FolderLinkScreen.Title")),n.Ay.createElement(Wa.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:j},O("ChatListFilter.CreateLinkNew")),E?.map((e=>n.Ay.createElement(Wa.A,{className:"settings-folders-list-item",icon:"link",narrow:!0,multiline:!0,onClick:G,clickArg:e.url},n.Ay.createElement("span",{className:"title",dir:"auto"},e.title||e.url),n.Ay.createElement("span",{className:"subtitle"},O("ChatListFilter.LinkLabelChatCount",e.peerIds.length,"i"))))))),n.Ay.createElement(un.A,{isShown:Boolean(t.isTouched),disabled:t.isLoading,onClick:K,ariaLabel:"edit"===t.mode?"Save changes":"Create folder"},t.isLoading?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})))})));var Od=a(80401);const Jd=(0,Ae.nF)((e=>e()),6e4,!0),Kd=(0,n.ph)((0,s.EK)((e=>{const{orderedIds:t,byId:a,recommended:n}=e.chatFolders;return{folderIds:t,foldersById:a,isPremium:(0,c.g29)(e),recommendedChatFolders:n,maxFolders:(0,Yi.d)(e,"dialogFilters")}}))((e=>{let{isActive:t,onCreateFolder:a,onEditFolder:i,onReset:o,folderIds:c,foldersById:d,isPremium:m,recommendedChatFolders:u,maxFolders:A}=e;const{loadRecommendedChatFolders:h,addChatFolder:y,openLimitReachedModal:p,openDeleteChatFolderModal:v,sortChatFolders:g}=(0,s.ko)(),[E,b]=(0,n.J0)({orderedFolderIds:c,dragOrderIds:c,draggedIndex:void 0}),C=(0,D.A)(c);(0,n.vJ)((()=>{C!==c&&b({orderedFolderIds:c,dragOrderIds:c,draggedIndex:void 0})}),[C,c,E.orderedFolderIds?.length]),(0,n.vJ)((()=>{Jd((()=>{h()}))}),[h]);const f=(0,n.hb)((()=>{Object.keys(d).length>=A-1?p({limit:"dialogFilters"}):a()}),[d,A,a,p]),S=(0,T.A)();(0,ve.A)({isActive:t,onBack:o});const k=(0,Fd.g5)(),w=(0,n.Kr)((()=>{if(c)return c.length<=1?ln.p:c.map((e=>{const t=d[e];return e===r.DSF?{id:e,title:{text:S("FilterAllChats"),entities:[]}}:{id:t.id,title:t.title,subtitle:(0,l.A5e)(S,t,k[t.id]),isChatList:t.isChatList,noTitleAnimations:t.noTitleAnimations}}))}),[c,d,S,k]),N=(0,n.hb)((e=>{Object.keys(d).length>=A-1?p({limit:"dialogFilters"}):y({folder:e})}),[d,A,y,p]),I=(0,n.hb)(((e,t)=>{const a=Math.round(e.y/68),n=E.orderedFolderIds?.indexOf(t)||0,s=E.orderedFolderIds?.filter((e=>e!==t));s&&(0,ue.Bt)(n+a,0,c?.length||0)&&(s.splice(n+a+(m?0:1),0,t),b((e=>({...e,draggedIndex:n,dragOrderIds:s}))))}),[c?.length,m,E.orderedFolderIds]),P=(0,n.hb)((()=>{b((e=>(g({folderIds:e.dragOrderIds}),{...e,orderedFolderIds:e.dragOrderIds,draggedIndex:void 0})))}),[g]),M=(0,n.Kr)((()=>!m||Object.keys(d).length<A-1),[d,m,A]);return n.Ay.createElement("div",{className:"settings-content no-border custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header"},n.Ay.createElement(ol.A,{size:r.fwn,tgsUrl:rl.w.FoldersAll,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},S("CreateNewFilterInfo")),M&&n.Ay.createElement(W.A,{className:"settings-button with-icon mb-2",color:"primary",size:"smaller",pill:!0,fluid:!0,onClick:f,isRtl:S.isRtl},n.Ay.createElement(q.A,{name:"add"}),S("CreateNewFilter"))),n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:S.isRtl?"rtl":void 0},S("Filters")),n.Ay.createElement("div",{className:"settings-sortable-container",style:`height: ${68*(c?.length||0)}px`},w?.length?w.map(((e,a)=>{const s=a>A-1,o=E.draggedIndex===a,l=68*(E.orderedFolderIds?.indexOf(e.id)??0),c=68*(E.dragOrderIds?.indexOf(e.id)??0);return e.id===r.DSF?n.Ay.createElement(Od.A,{key:e.id,id:e.id,onDrag:I,onDragEnd:P,style:`top: ${o?l:c}px;`,knobStyle:(S.isRtl?"left":"right")+": 0.375rem;",isDisabled:!m||!t},n.Ay.createElement(Wa.A,{key:e.id,className:"drag-item mb-2 no-icon settings-sortable-item",narrow:!0,inactive:!0,multiline:!0,isStatic:!0,allowSelection:!0},n.Ay.createElement("span",{className:"title"},(0,Un.f)({text:e.title.text,entities:e.title.entities,noCustomEmojiPlayback:e.noTitleAnimations})),n.Ay.createElement("span",{className:"subtitle"},S("FoldersAllChatsDesc")))):n.Ay.createElement(Od.A,{key:e.id,id:e.id,onDrag:I,onDragEnd:P,style:`top: ${o?l:c}px;`,knobStyle:(S.isRtl?"left":"right")+": 3rem;",isDisabled:s||!t},n.Ay.createElement(Wa.A,{className:"drag-item mb-2 no-icon settings-sortable-item",narrow:!0,secondaryIcon:"more",multiline:!0,contextActions:[{handler:()=>{v({folderId:e.id})},destructive:!0,title:S("Delete"),icon:"delete"}],onClick:()=>{s?p({limit:"dialogFilters"}):i(d[e.id])}},n.Ay.createElement("span",{className:"title"},(0,Un.f)({text:e.title.text,entities:e.title.entities,noCustomEmojiPlayback:e.noTitleAnimations}),s&&n.Ay.createElement(q.A,{name:"lock-badge",className:"settings-folders-blocked-icon"})),n.Ay.createElement("span",{className:"subtitle"},e.isChatList&&n.Ay.createElement(q.A,{name:"link",className:"mr-1"}),e.subtitle)))})):w&&!w.length?n.Ay.createElement("p",{className:"settings-item-description my-4",dir:"auto"},"You have no folders yet."):n.Ay.createElement(fs.A,null))),u&&Boolean(u.length)&&n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("h4",{className:"settings-item-header mb-3",dir:S.isRtl?"rtl":void 0},S("FilterRecommended")),u.map((e=>n.Ay.createElement(Wa.A,{className:"mb-2",narrow:!0,onClick:()=>N(e)},n.Ay.createElement("div",{className:"settings-folders-recommended-item"},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},(0,Un.f)({text:e.title.text,entities:e.title.entities,noCustomEmojiPlayback:e.noTitleAnimations})),n.Ay.createElement("span",{className:"subtitle"},e.description)),n.Ay.createElement(W.A,{className:"px-3",color:"primary",size:"tiny",pill:!0,fluid:!0,isRtl:S.isRtl},S("Add"))))))))})));var jd=a(4438);const Gd=(0,n.ph)((0,s.EK)((e=>{const{folderId:t,url:a,isLoading:n}=(0,c.nTw)(e).shareFolderScreen||{},s=t?(0,c.$aQ)(e,t):void 0,i=t?e.chatFolders.invites[t]?.find((e=>e.url===a)):void 0;return{folderId:t,folder:s,url:a,isLoading:n,peerIds:i?.peerIds}}))((e=>{let{isActive:t,onReset:a,folderId:i,folder:o,peerIds:d,url:m,isLoading:u}=e;const{createChatlistInvite:A,deleteChatlistInvite:h,editChatlistInvite:y,showNotification:p}=(0,s.ko)(),v=(0,Us.A)(),g=(0,T.A)(),[E,b]=(0,n.J0)(!1);(0,ve.A)({isActive:t,onBack:a}),(0,n.vJ)((()=>{u||b(!1)}),[u]),(0,n.vJ)((()=>{!m&&i&&t&&A({folderId:i})}),[i,t,m]);const C=(0,M.A)((()=>{m&&i&&(h({folderId:i,url:m}),a())})),f=(0,n.Kr)((()=>(o?.includedChatIds||[]).concat(o?.pinnedChatIds||[])),[o?.includedChatIds,o?.pinnedChatIds]),[S,k]=(0,n.Kr)((()=>{const e=(0,s.mS)();return(0,on.jB)(f,(t=>(0,c.hXb)(e,t)))}),[f]),[w,N]=(0,n.J0)(d||[]),I=(0,n.li)(!0);(0,mn.A)((e=>{let[t]=e;t!==m&&(I.current=!0),I.current&&(I.current=!1,m?d&&N(d):N(S))}),[m,S,d]);const P=(0,M.A)((e=>{const t=(0,s.mS)(),a=(0,c.mBe)(t,e),n=(0,c.hds)(t,e);a&&(0,l.tvf)(a)?p({message:g("FolderLinkScreen.AlertTextUnavailableBot")}):a?p({message:g("FolderLinkScreen.AlertTextUnavailableUser")}):n&&(0,l.WXB)(n)?p({message:g("FolderLinkScreen.AlertTextUnavailablePublicChannel")}):p({message:g("FolderLinkScreen.AlertTextUnavailablePublicGroup")})})),B=(0,M.A)((e=>{N(e),b(!0)})),L=(0,M.A)((()=>{i&&m&&E&&y({folderId:i,peerIds:w,url:m})})),R=w.length,x=!R||u;return n.Ay.createElement("div",{className:"settings-content no-border custom-scroll SettingsFoldersChatsPicker"},n.Ay.createElement("div",{className:"settings-content-header"},n.Ay.createElement(jd.A,{size:r.fwn,tgsUrl:rl.w.FoldersShare,className:"settings-content-icon"}),o&&n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},v("FolderLinkTitleDescription",{folder:(0,Un.f)({text:o.title.text,entities:o.title.entities,noCustomEmojiPlayback:o.noTitleAnimations}),chats:v("FolderLinkTitleDescriptionChats",{count:R},{pluralValue:R})},{withMarkdown:!0,withNodes:!0}))),n.Ay.createElement(Rl.A,{className:"settings-item",link:m||g("Loading"),withShare:!0,onRevoke:C,isDisabled:!R||E}),n.Ay.createElement("div",{className:"settings-item settings-item-picker"},n.Ay.createElement(cn.A,{itemIds:f,lockedUnselectedIds:k,onSelectedIdsChange:B,selectedIds:w,onDisabledClick:P,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})),n.Ay.createElement(un.A,{isShown:u||E,disabled:x,onClick:L,ariaLabel:"Save changes"},u?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})))}))),zd=(0,n.ph)((e=>{let{currentScreen:t,shownScreen:a,state:r,dispatch:o,isActive:l,onScreenSelect:c,onReset:d}=e;const{openShareChatFolderModal:m,editChatFolder:u,addChatFolder:A}=(0,s.ko)(),h=(0,n.hb)((()=>{t!==i.VS.FoldersCreateFolder&&t!==i.VS.FoldersEditFolder&&t!==i.VS.FoldersEditFolderFromChatList&&t!==i.VS.FoldersEditFolderInvites||setTimeout((()=>{o({type:"reset"})}),200),t!==i.VS.FoldersIncludedChats&&t!==i.VS.FoldersExcludedChats?d():"create"===r.mode?c(i.VS.FoldersCreateFolder):c(i.VS.FoldersEditFolder)}),[r.mode,o,t,d,c]),y="create"===r.mode,p=(0,n.hb)((e=>{const{title:t}=e.folder;if(!t)return o({type:"setError",payload:Dd}),!1;const{selectedChatIds:a,selectedChatTypes:n}=(0,Rd.a)(e,"included");return a.length||Object.keys(n).length?(y?A({folder:e.folder}):u({id:e.folderId,folderUpdate:e.folder}),o({type:"setError",payload:void 0}),o({type:"setIsTouched",payload:!1}),!0):(o({type:"setError",payload:_d}),!1)}),[o,y]),v=(0,n.hb)((e=>{p(r)&&e?.()}),[p,r]),g=(0,n.hb)((()=>{const e=o({type:"saveFilters"});h(),p(e)}),[o,h,p]),E=(0,n.hb)((()=>{o({type:"reset"}),c(i.VS.FoldersCreateFolder)}),[c,o]),b=(0,n.hb)((e=>{o({type:"editFolder",payload:e}),c(i.VS.FoldersEditFolder)}),[o,c]),C=(0,n.hb)((()=>{o({type:"editIncludeFilters"}),c(t===i.VS.FoldersEditFolderFromChatList?i.VS.FoldersIncludedChatsFromChatList:i.VS.FoldersIncludedChats)}),[t,o,c]),f=(0,n.hb)((()=>{o({type:"editExcludeFilters"}),c(t===i.VS.FoldersEditFolderFromChatList?i.VS.FoldersExcludedChatsFromChatList:i.VS.FoldersExcludedChats)}),[t,o,c]),S=(0,n.hb)((()=>{m({folderId:r.folderId,noRequestNextScreen:!0}),o({type:"setIsChatlist",payload:!0}),c(i.VS.FoldersShare)}),[o,c,r.folderId]),k=(0,n.hb)((e=>{m({folderId:r.folderId,url:e,noRequestNextScreen:!0}),c(i.VS.FoldersShare)}),[c,r.folderId]);switch(t){case i.VS.Folders:return n.Ay.createElement(Kd,{onCreateFolder:E,onEditFolder:b,isActive:l||[i.VS.FoldersCreateFolder,i.VS.FoldersEditFolder,i.VS.FoldersIncludedChats,i.VS.FoldersExcludedChats].includes(a),onReset:d});case i.VS.FoldersCreateFolder:case i.VS.FoldersEditFolder:case i.VS.FoldersEditFolderFromChatList:case i.VS.FoldersEditFolderInvites:return n.Ay.createElement(Ud,{state:r,dispatch:o,onAddIncludedChats:C,onAddExcludedChats:f,onShareFolder:S,onOpenInvite:k,onReset:h,isActive:l||[i.VS.FoldersIncludedChats,i.VS.FoldersExcludedChats].includes(a),isOnlyInvites:t===i.VS.FoldersEditFolderInvites,onBack:d,onSaveFolder:v});case i.VS.FoldersIncludedChats:case i.VS.FoldersIncludedChatsFromChatList:return n.Ay.createElement(Vd,{mode:"included",state:r,dispatch:o,onReset:h,onSaveFilter:g,isActive:l});case i.VS.FoldersExcludedChats:case i.VS.FoldersExcludedChatsFromChatList:return n.Ay.createElement(Vd,{mode:"excluded",state:r,dispatch:o,onReset:h,onSaveFilter:g,isActive:l});case i.VS.FoldersShare:return n.Ay.createElement(Gd,{isActive:l,onReset:h});default:return}}));var Hd=a(70934),$d=a(3178);const qd=(0,n.ph)((e=>{let{isActive:t,onReset:a,error:s,isLoading:i,shouldDisablePasswordManager:r,expectedPassword:o,placeholder:l="Current Password",hint:c,submitLabel:d,clearError:m,onSubmit:u}=e;const[A,h]=(0,n.J0)(""),[y,p]=(0,n.J0)(!1),v=(0,n.hb)((e=>{o&&e!==o?h("Passwords Should Be Equal"):u(e)}),[u,o]),g=(0,n.hb)((()=>{m&&m(),h("")}),[m]),E=(0,T.A)();return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content password-form custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement($d.A,{isBig:!0,isPasswordVisible:y})),n.Ay.createElement("div",{className:"settings-item pt-2"},n.Ay.createElement(tc.A,{error:A||s,hint:c,placeholder:l,shouldDisablePasswordManager:r,submitLabel:d||E("Next"),clearError:g,isLoading:i,isPasswordVisible:y,shouldResetValue:t,onChangePasswordVisibility:p,onSubmit:v})))})),Wd=(0,n.ph)((e=>{let{isActive:t,onReset:a}=e;const s=(0,T.A)(),i=(0,n.hb)((()=>{a(!0)}),[a]);return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content local-passcode custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(jd.A,{size:r.BYH,tgsUrl:rl.w.Congratulations,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},"Congratulations!"),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},"Now you can lock the app with a passcode so that others can't open it.")),n.Ay.createElement("div",{className:"settings-item pt-2"},n.Ay.createElement(W.A,{onClick:i},s("Back"))))}));var Yd=a(89704);const Qd=(0,n.ph)((e=>{let{isActive:t,onReset:a,onScreenSelect:s}=e;const r=(0,T.A)();return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content local-passcode custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(ol.A,{tgsUrl:rl.w.Lock,previewUrl:Yd,size:160,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},"Local passcode is enabled.")),n.Ay.createElement("div",{className:"settings-item pt-2"},n.Ay.createElement(Wa.A,{icon:"edit",onClick:()=>s(i.VS.PasscodeChangePasscodeCurrent)},r("Passcode.Change")),n.Ay.createElement(Wa.A,{icon:"password-off",onClick:()=>s(i.VS.PasscodeTurnOff)},r("Passcode.TurnOff"))))})),Zd=(0,n.ph)((e=>{let{isActive:t,onReset:a,onStart:s}=e;const i=(0,T.A)();return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content local-passcode custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(ol.A,{tgsUrl:rl.w.Lock,previewUrl:Yd,size:r.BYH,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description",dir:"auto"},"When you set up an additional passcode, a lock icon will appear on the chats page. Tap it to lock and unlock your Telegram Web A."),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},"Note: if you forget your local passcode, you'll need to log out of Telegram Web A and log in again.")),n.Ay.createElement("div",{className:"settings-item pt-2"},n.Ay.createElement(W.A,{onClick:s},i("EnablePasscode"))))})),Xd=(0,n.ph)((0,s.EK)((e=>({...e.passcode})))((e=>{let{passcode:t,currentScreen:a,shownScreen:r,error:o,isActive:l,isLoading:c,onScreenSelect:d,onSetPasscode:m,onReset:u}=e;const{setPasscode:A,clearPasscode:h,setPasscodeError:y,clearPasscodeError:p}=(0,s.ko)(),v=(0,T.A)(),g=(0,n.hb)((()=>{m(""),d(i.VS.PasscodeNewPasscode)}),[d,m]),E=(0,n.hb)((e=>{m(e),d(i.VS.PasscodeNewPasscodeConfirm)}),[d,m]),b=(0,n.hb)((()=>{A({passcode:t}),m(""),d(i.VS.PasscodeCongratulations)}),[d,m,t,A]),C=(0,n.hb)((e=>{m(""),(0,Hd.UQ)(e).then((()=>{d(i.VS.PasscodeChangePasscodeNew)}),(()=>{y({error:v("PasscodeController.Error.Current")})}))}),[v,d,m,y]),f=(0,n.hb)((e=>{m(e),d(i.VS.PasscodeChangePasscodeConfirm)}),[d,m]),S=(0,n.hb)((e=>{(0,Hd.UQ)(e).then((()=>{h(),d(i.VS.Privacy)}),(()=>{y({error:v("PasscodeController.Error.Current")})}))}),[h,v,d,y]);switch(a){case i.VS.PasscodeDisabled:return n.Ay.createElement(Zd,{onStart:g,isActive:l||[i.VS.PasscodeNewPasscode,i.VS.PasscodeNewPasscodeConfirm,i.VS.PasscodeCongratulations].includes(r),onReset:u});case i.VS.PasscodeNewPasscode:return n.Ay.createElement(qd,{shouldDisablePasswordManager:!0,placeholder:v("EnterNewPasscode"),submitLabel:v("Continue"),onSubmit:E,isActive:l||[i.VS.PasscodeNewPasscodeConfirm,i.VS.PasscodeCongratulations].includes(r),onReset:u});case i.VS.PasscodeNewPasscodeConfirm:return n.Ay.createElement(qd,{shouldDisablePasswordManager:!0,expectedPassword:t,placeholder:v("ReEnterYourPasscode"),submitLabel:v("Continue"),isLoading:c,onSubmit:b,isActive:l||[i.VS.PasscodeCongratulations].includes(r),onReset:u});case i.VS.PasscodeCongratulations:return n.Ay.createElement(Wd,{isActive:l,onReset:u});case i.VS.PasscodeEnabled:return n.Ay.createElement(Qd,{onScreenSelect:d,isActive:l||[i.VS.PasscodeChangePasscodeCurrent,i.VS.PasscodeChangePasscodeNew,i.VS.PasscodeChangePasscodeConfirm,i.VS.PasscodeCongratulations,i.VS.PasscodeTurnOff].includes(r),onReset:u});case i.VS.PasscodeChangePasscodeCurrent:return n.Ay.createElement(qd,{shouldDisablePasswordManager:!0,error:o,clearError:p,placeholder:v("PasscodeController.Current.Placeholder"),onSubmit:C,isActive:l||[i.VS.PasscodeChangePasscodeNew,i.VS.PasscodeChangePasscodeConfirm,i.VS.PasscodeCongratulations].includes(r),onReset:u});case i.VS.PasscodeChangePasscodeNew:return n.Ay.createElement(qd,{shouldDisablePasswordManager:!0,placeholder:v("PleaseEnterNewFirstPassword"),onSubmit:f,isActive:l||[i.VS.PasscodeChangePasscodeConfirm,i.VS.PasscodeCongratulations].includes(r),onReset:u});case i.VS.PasscodeChangePasscodeConfirm:return n.Ay.createElement(qd,{shouldDisablePasswordManager:!0,expectedPassword:t,placeholder:v("PasscodeController.ReEnterPasscode.Placeholder"),isLoading:c,onSubmit:b,isActive:l||[i.VS.PasscodeCongratulations].includes(r),onReset:u});case i.VS.PasscodeTurnOff:return n.Ay.createElement(qd,{shouldDisablePasswordManager:!0,error:o?v(o):void 0,clearError:p,placeholder:v("PasscodeController.Current.Placeholder"),onSubmit:S,isActive:l,onReset:u});default:return}})));var em=a(9267);const tm=(0,n.ph)((function(e){let{premiumSection:t}=e;const{openPremiumModal:a}=(0,s.ko)(),i=(0,T.A)(),r=(0,M.A)((()=>a({initialSection:t})));return n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(Wa.A,{leftElement:n.Ay.createElement(em.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:r},i("PrivacyLastSeenPremium")),n.Ay.createElement("p",{className:"settings-item-description-larger premium-info",dir:i.isRtl?"rtl":void 0},i("lng_messages_privacy_premium_about")))})),am=(0,n.ph)((function(e){let{label:t}=e;const a=(0,T.A)(),{showNotification:i}=(0,s.ko)();return n.Ay.createElement("div",{className:"TGUdGos3",onClick:()=>i({message:a("OptionPremiumRequiredMessage")})},n.Ay.createElement("span",null,t),n.Ay.createElement(q.A,{name:"lock-badge",className:"jWxrRbkh"}))})),nm=(0,n.ph)((0,s.EK)((e=>({shouldNewNonContactPeersRequirePremium:(0,c.BSN)(e),isCurrentUserPremium:(0,c.g29)(e),canLimitNewMessagesWithoutPremium:e.appConfig?.canLimitNewMessagesWithoutPremium})))((function(e){let{isActive:t,canLimitNewMessagesWithoutPremium:a,shouldNewNonContactPeersRequirePremium:i,isCurrentUserPremium:r,onReset:o}=e;const{updateGlobalPrivacySettings:l}=(0,s.ko)(),c=(0,T.A)(),d=r||a,m=(0,n.Kr)((()=>[{value:"everybody",label:c("P2PEverybody")},{value:"contacts_and_premium",label:d?c("PrivacyMessagesContactsAndPremium"):n.Ay.createElement(am,{label:c("PrivacyMessagesContactsAndPremium")}),hidden:!d}]),[c,d]),u=(0,M.A)((e=>{l({shouldNewNonContactPeersRequirePremium:"contacts_and_premium"===e})}));return(0,ve.A)({isActive:t,onBack:o}),n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:c.isRtl?"rtl":void 0},c("PrivacyMessagesTitle")),n.Ay.createElement(Z.A,{name:"privacy-messages",options:m,onChange:u,selected:i?"contacts_and_premium":"everybody"}),n.Ay.createElement("p",{className:"settings-item-description-larger",dir:c.isRtl?"rtl":void 0},c("Privacy.Messages.SectionFooter"))),!d&&n.Ay.createElement(tm,{premiumSection:"message_privacy"}))})));function sm(e){const t=e.platform.toLowerCase(),a=e.deviceModel.toLowerCase(),n=e.systemVersion.toLowerCase();return a.includes("xbox")?"xbox":a.includes("chrome")&&!a.includes("chromebook")?"chrome":a.includes("brave")?"brave":a.includes("vivaldi")?"vivaldi":a.includes("safari")?"safari":a.includes("firefox")?"firefox":a.includes("opera")?"opera":a.includes("samsungbrowser")?"samsung":t.includes("android")?"android":a.includes("iphone")||a.includes("ipad")||t.includes("ios")||t.includes("macos")||n.includes("macos")?"apple":t.includes("ubuntu")||n.includes("ubuntu")?"ubuntu":t.includes("linux")||n.includes("linux")?"linux":t.includes("windows")||n.includes("windows")?"windows":"unknown"}const im={SettingsActiveSession:"M84mrPgu",settingsActiveSession:"M84mrPgu",iconDevice:"Add8P_K4",iconDevice__android:"onkXVGY4",iconDeviceAndroid:"onkXVGY4",iconDevice__apple:"xw13aT8u",iconDeviceApple:"xw13aT8u",iconDevice__brave:"HESrGUdv",iconDeviceBrave:"HESrGUdv",iconDevice__chrome:"Vpej7wm7",iconDeviceChrome:"Vpej7wm7",iconDevice__edge:"ueWE77x9",iconDeviceEdge:"ueWE77x9",iconDevice__firefox:"_lMTmvya",iconDeviceFirefox:"_lMTmvya",iconDevice__linux:"cDVfvyG_",iconDeviceLinux:"cDVfvyG_",iconDevice__opera:"nWqlTxZt",iconDeviceOpera:"nWqlTxZt",iconDevice__safari:"ldFLp1Gf",iconDeviceSafari:"ldFLp1Gf",iconDevice__samsung:"VHNORBGL",iconDeviceSamsung:"VHNORBGL",iconDevice__ubuntu:"QBVivtdu",iconDeviceUbuntu:"QBVivtdu",iconDevice__unknown:"GbjIgrwU",iconDeviceUnknown:"GbjIgrwU",iconDevice__vivaldi:"yieVnjoI",iconDeviceVivaldi:"yieVnjoI",iconDevice__windows:"_0dnTFOE",iconDeviceWindows:"_0dnTFOE",iconDevice__xbox:"fbCjjDpU",iconDeviceXbox:"fbCjjDpU",title:"c6edjhlh",note:"lRqTZAYn",date:"oLnN6crs",box:"wVEXuPlZ",actionHeader:"olQS2T1n",actionName:"KuX1APpO",headerButton:"VT8pZfMu"},rm=(0,n.ph)((0,s.EK)(((e,t)=>{let{hash:a}=t;return{session:a?e.activeSessions.byHash[a]:void 0}}))((e=>{let{isOpen:t,session:a,onClose:i}=e;const{changeSessionSettings:r,terminateAuthorization:o}=(0,s.ko)(),l=(0,T.A)(),c=(0,Cn.A)(a,!0),d=(0,n.hb)((()=>{r({hash:a.hash,areSecretChatsEnabled:!a.areSecretChatsEnabled})}),[r,a]),m=(0,n.hb)((()=>{r({hash:a.hash,areCallsEnabled:!a.areCallsEnabled})}),[r,a]),u=(0,n.hb)((()=>{o({hash:a.hash}),i()}),[i,a,o]);if(c)return n.Ay.createElement(Q.A,{header:n.Ay.createElement("div",{className:"modal-header-condensed",dir:l.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:l("Close"),onClick:i},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},l("SessionPreview.Title")),n.Ay.createElement(W.A,{color:"danger",onClick:u,className:(0,de.A)("modal-action-button",im.headerButton)},l("SessionPreview.TerminateSession"))),isOpen:t,hasCloseButton:!0,onClose:i,className:im.SettingsActiveSession},n.Ay.createElement("div",{className:(0,de.A)(im.iconDevice,c&&im[`iconDevice__${sm(c)}`])}),n.Ay.createElement("h3",{className:im.title,dir:"auto"},c?.deviceModel),n.Ay.createElement("div",{className:im.date,"aria-label":l("PrivacySettings.LastSeen")},(0,Ke.L2)(1e3*c.dateActive,l.code)),n.Ay.createElement("dl",{className:im.box},n.Ay.createElement("dt",null,l("SessionPreview.App")),n.Ay.createElement("dd",null,c?.appName," ",c?.appVersion,","," ",c?.platform," ",c?.systemVersion),n.Ay.createElement("dt",null,l("SessionPreview.Ip")),n.Ay.createElement("dd",null,c?.ip),n.Ay.createElement("dt",null,l("SessionPreview.Location")),n.Ay.createElement("dd",null,c&&function(e){return[e.region,e.country].filter(Boolean).join(", ")}(c))),n.Ay.createElement("p",{className:im.note},l("SessionPreview.IpDesc")),n.Ay.createElement("h4",{className:im.actionHeader},l("AuthSessions.View.AcceptTitle")),n.Ay.createElement(Wa.A,{onClick:d},n.Ay.createElement("span",{className:im.actionName},l("SessionPreview.Accept.Secret")),n.Ay.createElement(sn.A,{id:"accept_secrets",label:"On",checked:c.areSecretChatsEnabled})),n.Ay.createElement(Wa.A,{onClick:m},n.Ay.createElement("span",{className:im.actionName},l("SessionPreview.Accept.Calls")),n.Ay.createElement(sn.A,{id:"accept_calls",label:"On",checked:c.areCallsEnabled})))})));function om(e){return[e.region,e.country].filter(Boolean).join(", ")}const lm=(0,n.ph)((0,s.EK)((e=>e.activeSessions))((e=>{let{isActive:t,onReset:a,byHash:i,orderedHashes:r,ttlDays:o}=e;const{terminateAuthorization:l,terminateAllAuthorizations:c,changeSessionTtl:d}=(0,s.ko)(),m=(0,T.A)(),[u,A,h]=(0,I.A)(),[y,p]=(0,n.J0)(),[v,g,E]=(0,I.A)(),b=(0,n.Kr)((()=>{if(void 0!==o)return o<=7?"7":o<=30?"30":o<=93?"90":o<=183?"183":o>183?"365":void 0}),[o]),C=(0,n.Kr)((()=>{const e=[{label:m("Weeks",1,"i"),value:"7"},{label:m("Months",1,"i"),value:"30"},{label:m("Months",3,"i"),value:"90"},{label:m("Months",6,"i"),value:"183"}];return o&&o>=365&&e.push({label:m("Years",1,"i"),value:"365"}),e}),[m,o]),f=(0,n.hb)((e=>{l({hash:e})}),[l]),S=(0,n.hb)((()=>{h(),c()}),[h,c]),k=(0,n.hb)((e=>{p(e),g()}),[g]),w=(0,n.hb)((()=>{p(void 0),E()}),[E]),N=(0,n.hb)((e=>{d({days:Number(e)})}),[d]),P=(0,n.Kr)((()=>{const e=r.find((e=>i[e].isCurrent));return e?i[e]:void 0}),[i,r]),M=(0,n.Kr)((()=>r.filter((e=>!i[e].isCurrent))),[i,r]),B=Boolean(M.length);return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content custom-scroll SettingsActiveSessions"},P&&(R=P,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0},m("AuthSessions.CurrentSession")),n.Ay.createElement(Wa.A,{narrow:!0,inactive:!0,icon:`device-${sm(R)}`,iconClassName:"icon-device"},n.Ay.createElement("div",{className:"multiline-item full-size",dir:"auto"},n.Ay.createElement("span",{className:"title",dir:"auto"},R.deviceModel),n.Ay.createElement("span",{className:"subtitle black tight"},R.appName," ",R.appVersion,", ",R.platform," ",R.systemVersion),n.Ay.createElement("span",{className:"subtitle"},R.ip," - ",om(R)))),B&&n.Ay.createElement(Wa.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:A},m("TerminateAllSessions")))),B&&(L=M,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0},m("OtherSessions")),L.map((function(e){const t=i[e];return n.Ay.createElement(Wa.A,{key:t.hash,ripple:!0,narrow:!0,contextActions:[{title:"Terminate",icon:"stop",destructive:!0,handler:()=>{f(t.hash)}}],icon:`device-${sm(t)}`,iconClassName:"icon-device",onClick:()=>{k(t.hash)}},n.Ay.createElement("div",{className:"multiline-item full-size",dir:"auto"},n.Ay.createElement("span",{className:"date"},(0,Ke.be)(m,1e3*t.dateActive)),n.Ay.createElement("span",{className:"title"},t.deviceModel),n.Ay.createElement("span",{className:"subtitle black tight"},t.appName," ",t.appVersion,", ",t.platform," ",t.systemVersion),n.Ay.createElement("span",{className:"subtitle"},t.ip," ",om(t))))})))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0},m("TerminateOldSessionHeader")),n.Ay.createElement("p",{className:"settings-item-description-larger"},m("IfInactiveFor")),n.Ay.createElement(Z.A,{name:"session_ttl",options:C,selected:b,onChange:N})),B&&n.Ay.createElement(tn.A,{isOpen:u,onClose:h,text:m("AreYouSureSessions"),confirmLabel:m("TerminateAllSessions"),confirmHandler:S,confirmIsDestructive:!0,areButtonsInColumn:!0}),n.Ay.createElement(rm,{isOpen:v,hash:y,onClose:w}));var L,R}))),cm="YRYk96ki",dm=(0,n.ph)((0,s.EK)(((e,t)=>{let{hash:a}=t;const n=a?e.activeWebSessions.byHash[a]:void 0;return{session:n,bot:n?e.users.byId[n.botId]:void 0}}))((e=>{let{isOpen:t,session:a,bot:i,onClose:r}=e;const{terminateWebAuthorization:o}=(0,s.ko)(),l=(0,T.A)(),c=(0,Cn.A)(a,!0),d=(0,Cn.A)(i,!0),m=(0,n.hb)((()=>{o({hash:a.hash}),r()}),[r,a,o]);if(c)return n.Ay.createElement(Q.A,{header:n.Ay.createElement("div",{className:"modal-header-condensed",dir:l.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:l("Close"),onClick:r},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},l("WebSessionsTitle")),n.Ay.createElement(W.A,{color:"danger",onClick:m,className:(0,de.A)("modal-action-button","lUf0RJ2h")},l("AuthSessions.LogOut"))),isOpen:t,hasCloseButton:!0,onClose:r,className:"Wd0fmiSY"},n.Ay.createElement(wt.A,{className:"OhZHdRsP",peer:d,size:"large"}),d&&n.Ay.createElement(Ss.A,{className:"EQ7__xGn",peer:d}),n.Ay.createElement("div",{className:cm},c?.domain),n.Ay.createElement("dl",{className:"kmCTIfvf"},n.Ay.createElement("dt",null,l("AuthSessions.View.Browser")),n.Ay.createElement("dd",null,c?.browser),n.Ay.createElement("dt",null,l("SessionPreview.Ip")),n.Ay.createElement("dd",null,c?.ip),n.Ay.createElement("dt",null,l("SessionPreview.Location")),n.Ay.createElement("dd",null,c?.region)),n.Ay.createElement("p",{className:cm},l("AuthSessions.View.LocationInfo")))}))),mm={avatar:"v0wP46TR","clear-help":"WnnxcARX",clearHelp:"WnnxcARX",subtitle:"uEUfjByC"},um=(0,n.ph)((0,s.EK)((e=>{const{byHash:t,orderedHashes:a}=e.activeWebSessions;return{byHash:t,orderedHashes:a}}))((e=>{let{isActive:t,byHash:a,orderedHashes:i,onReset:r}=e;const{terminateWebAuthorization:o,terminateAllWebAuthorizations:l}=(0,s.ko)(),c=(0,T.A)(),[d,m,u]=(0,I.A)(),[A,h]=(0,n.J0)(),[y,p,v]=(0,I.A)(),g=(0,n.hb)((e=>{o({hash:e})}),[o]),E=(0,n.hb)((()=>{u(),l()}),[u,l]),b=(0,n.hb)((e=>{h(e),p()}),[p]),C=(0,n.hb)((()=>{h(void 0),v()}),[v]);var f;if((0,n.vJ)((()=>{i.length||r()}),[r,i]),(0,ve.A)({isActive:t,onBack:r}),i.length)return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(Wa.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:m},c("AuthSessions.LogOutApplications")),n.Ay.createElement("p",{className:(0,de.A)("settings-item-description",mm.clearHelp)},c("ClearOtherWebSessionsHelp"))),(f=i,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:c.isRtl?"rtl":void 0},c("WebSessionsTitle")),f.map((function(e){const t=a[e],i=(0,s.mS)().users.byId[t.botId];return n.Ay.createElement(Wa.A,{key:t.hash,ripple:!0,narrow:!0,contextActions:[{title:"Terminate",icon:"stop",destructive:!0,handler:()=>{g(t.hash)}}],onClick:()=>b(t.hash)},n.Ay.createElement(wt.A,{className:mm.avatar,peer:i,size:"tiny"}),n.Ay.createElement("div",{className:"multiline-item full-size",dir:"auto"},n.Ay.createElement("span",{className:"date"},(0,Ke.be)(c,1e3*t.dateActive)),i&&n.Ay.createElement(Ss.A,{className:mm.title,peer:i}),n.Ay.createElement("span",{className:(0,de.A)("subtitle","black","tight",mm.platform)},t.domain,", ",t.browser,", ",t.platform),n.Ay.createElement("span",{className:(0,de.A)("subtitle",mm.subtitle)},t.ip," ",t.region)))})))),n.Ay.createElement(tn.A,{isOpen:d,onClose:u,title:c("AuthSessions.LogOutApplications"),text:c("AreYouSureWebSessions"),confirmHandler:E,confirmIsDestructive:!0}),n.Ay.createElement(dm,{isOpen:y,hash:A,onClose:C}))}))),Am=(0,n.ph)((e=>{let{stickerSet:t,noPlay:a,className:s,observeIntersection:i,onClick:o}=e;const l=(0,T.A)(),c=t?.stickers?.[0],d=(0,M.A)((()=>{c&&o(c)}));if(t?.stickers)return n.Ay.createElement(Wa.A,{className:(0,de.A)("StickerSetCard","chat-item-clickable small-icon",s),style:`height: ${r.yq1}px;`,inactive:!c,onClick:d},function(){if(t)return t.hasThumbnail||!c?n.Ay.createElement(W.A,{ariaLabel:t.title,color:"translucent",isRtl:l.isRtl},n.Ay.createElement(Xo,{stickerSet:t,size:r.RCH,noPlay:a,observeIntersection:i})):n.Ay.createElement(sl,{sticker:c,size:r.RCH,title:t.title,noPlay:a,observeIntersection:i,noContextMenu:!0,isCurrentUserPremium:!0,clickArg:void 0})}(),n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("div",{className:"title"},t.title),n.Ay.createElement("div",{className:"subtitle"},l("StickerPack.StickerCount",t.count,"i"))))})),hm=(0,n.ph)((0,s.EK)((e=>({...(0,on.Up)(e.settings.byKey,["shouldSuggestCustomEmoji"]),customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,canPlayAnimatedEmojis:(0,c.BWX)(e)})))((e=>{let{isActive:t,customEmojiSetIds:a,stickerSetsById:i,shouldSuggestCustomEmoji:r,canPlayAnimatedEmojis:o,onReset:l}=e;const{openStickerSet:c,setSettingOption:d}=(0,s.ko)(),m=(0,T.A)(),u=(0,n.li)(null),{observe:A}=(0,zo.BL)({rootRef:u});(0,ve.A)({isActive:t,onBack:l});const h=(0,n.hb)((e=>{c({stickerSetInfo:e.stickerSetInfo})}),[c]),y=(0,n.hb)((e=>{d({shouldSuggestCustomEmoji:e})}),[d]),p=(0,n.Kr)((()=>a&&Object.values((0,on.Up)(i,a))),[a,i]);return n.Ay.createElement("div",{className:"settings-content custom-scroll"},p&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(js.A,{label:m("SuggestAnimatedEmoji"),checked:r,onCheck:y}),n.Ay.createElement("div",{className:"mt-4",ref:u},p.map((e=>n.Ay.createElement(Am,{key:e.id,stickerSet:e,observeIntersection:A,onClick:h,noPlay:!o})))),n.Ay.createElement("p",{className:"settings-item-description mt-3",dir:"auto"},(0,kt.A)(m("EmojiBotInfo"),["links"]))))}))),ym=(0,n.ph)((0,s.EK)((e=>(0,on.Up)(e.settings.byKey,["canAutoLoadPhotoFromContacts","canAutoLoadPhotoInPrivateChats","canAutoLoadPhotoInGroups","canAutoLoadPhotoInChannels","canAutoLoadVideoFromContacts","canAutoLoadVideoInPrivateChats","canAutoLoadVideoInGroups","canAutoLoadVideoInChannels","canAutoLoadFileFromContacts","canAutoLoadFileInPrivateChats","canAutoLoadFileInGroups","canAutoLoadFileInChannels","autoLoadFileMaxSizeMb"])))((e=>{let{isActive:t,onReset:a,canAutoLoadPhotoFromContacts:i,canAutoLoadPhotoInPrivateChats:o,canAutoLoadPhotoInGroups:l,canAutoLoadPhotoInChannels:c,canAutoLoadVideoFromContacts:d,canAutoLoadVideoInPrivateChats:m,canAutoLoadVideoInGroups:u,canAutoLoadVideoInChannels:A,canAutoLoadFileFromContacts:h,canAutoLoadFileInPrivateChats:y,canAutoLoadFileInGroups:p,canAutoLoadFileInChannels:v,autoLoadFileMaxSizeMb:g}=e;const{setSettingOption:E}=(0,s.ko)(),b=(0,Us.A)();(0,ve.A)({isActive:t,onBack:a});const C=(0,n.hb)((e=>b("AutodownloadSizeLimitUpTo",{limit:b("FileSizeMB",{count:r.$gx[e]})})),[b]),f=(0,n.hb)((e=>{E({autoLoadFileMaxSizeMb:r.$gx[e]})}),[E]);function S(e,t,a,s,i,o){return n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:b.isRtl?"rtl":void 0},e),n.Ay.createElement(js.A,{label:b("AutoDownloadSettingsContacts"),checked:a,onCheck:e=>E({[`canAutoLoad${t}FromContacts`]:e})}),n.Ay.createElement(js.A,{label:b("AutoDownloadSettingsPrivateChats"),checked:s,onCheck:e=>E({[`canAutoLoad${t}InPrivateChats`]:e})}),n.Ay.createElement(js.A,{label:b("AutoDownloadSettingsGroupChats"),checked:i,onCheck:e=>E({[`canAutoLoad${t}InGroups`]:e})}),n.Ay.createElement(js.A,{label:b("AutoDownloadSettingsChannels"),checked:o,onCheck:e=>E({[`canAutoLoad${t}InChannels`]:e})}),"File"===t&&function(){const e=r.$gx.indexOf(g);return n.Ay.createElement("div",{className:"pt-5"},n.Ay.createElement(ze.A,{label:b("AutoDownloadMaxFileSize"),min:0,max:5,value:-1!==e?e:2,renderValue:C,onChange:f}))}())}return n.Ay.createElement("div",{className:"settings-content custom-scroll"},S(b("AutoDownloadPhotosTitle"),"Photo",i,o,l,c),S(b("AutoDownloadVideosTitle"),"Video",d,m,u,A),S(b("AutoDownloadFilesTitle"),"File",h,y,p,v))}))),pm={root:"Ys1i4ssl",item:"skaVPMTF"},vm=["af","als","am","an","ar","arz","as","ast","av","az","azb","ba","bar","bcl","be","bg","bh","bn","bo","bpy","br","bs","bxr","ca","cbk","ce","ceb","ckb","co","cs","cv","cy","da","de","diq","dsb","dty","dv","el","eml","en","eo","es","et","eu","fa","fi","fr","frr","fy","ga","gd","gl","gn","gom","gu","gv","he","hi","hif","hr","hsb","ht","hu","hy","ia","id","ie","ilo","io","is","it","ja","jbo","jv","ka","kk","km","kn","ko","krc","ku","kv","kw","ky","la","lb","lez","li","lmo","lo","lrc","lt","lv","mai","mg","mhr","min","mk","ml","mn","mr","mrj","ms","mt","mwl","my","myv","mzn","nah","nap","nds","ne","new","nl","nn","no","oc","or","os","pa","pam","pfl","pl","pms","pnb","ps","pt","qu","rm","ro","ru","rue","sa","sah","sc","scn","sco","sd","sh","si","sk","sl","so","sq","sr","su","sv","sw","ta","te","tg","th","tk","tl","tr","tt","tyv","ug","uk","ur","uz","vec","vep","vi","vls","vo","wa","war","wuu","xal","xmf","yi","yo","yue","zh"],gm=r.N89.filter((e=>vm.includes(e))),Em=(0,n.ph)((0,s.EK)((e=>{const{doNotTranslate:t}=e.settings.byKey;return{doNotTranslate:t}}))((e=>{let{isActive:t,doNotTranslate:a,onReset:i}=e;const{setSettingOption:r}=(0,s.ko)(),o=(0,T.A)().code||"en",[l,c]=(0,n.J0)([]),[d,m]=(0,n.J0)(""),u=(0,n.Kr)((()=>{const e=gm.map((e=>({langCode:e,translatedName:new Intl.DisplayNames([o],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)}))).filter(Boolean).map((e=>{let{langCode:t,translatedName:a,originalName:n}=e;return{label:a,subLabel:n,value:t}}));if(!d.trim()){const t=e.find((e=>e.value===o)),a=e.filter((e=>e.value!==o));return t?[t,...a]:e}return e?.filter((e=>e.label.toLowerCase().includes(d.toLowerCase())))}),[o,d]);(0,mn.A)((e=>{let[n,s]=e;if(n===t&&s?.find((e=>e===o)))return;const[i]=(0,on.jB)(u,(e=>a.includes(e.value)));c([...i.map((e=>e.value))])}),[t,a,l.length,o,u]);const A=(0,M.A)((e=>{c(e),r({doNotTranslate:e})}));return(0,ve.A)({isActive:t,onBack:i}),n.Ay.createElement("div",{className:(0,de.A)(pm.root,"settings-content infinite-scroll")},n.Ay.createElement("div",{className:(0,de.A)(pm.item)},n.Ay.createElement(oo,{className:pm.picker,items:u,selectedValues:l,onSelectedValuesChange:A,filterValue:d,onFilterChange:m,isSearchable:!0,allowMultiple:!0,withDefaultPadding:!0,itemInputType:"checkbox",searchInputId:"lang-picker-search"})))}))),bm=(0,n.ph)((e=>{let{chatId:t,usernames:a,onEditUsername:i}=e;const{showNotification:r,toggleUsername:o,toggleChatUsername:l,sortUsernames:c,sortChatUsernames:d}=(0,s.ko)(),m=(0,T.A)(),[u,A]=(0,n.J0)(),h=(0,n.Kr)((()=>a.map((e=>{let{username:t}=e;return t}))),[a]),y=(0,D.A)(h),[p,v]=(0,n.J0)({orderedUsernames:h,dragOrderUsernames:h,draggedIndex:void 0});(0,n.vJ)((()=>{y!==h&&v({orderedUsernames:h,dragOrderUsernames:h,draggedIndex:void 0})}),[y,h]);const g=(0,n.hb)((e=>{(0,Uc.eM)(`@${e}`),r({message:m("UsernameCopied")})}),[m,r]),E=(0,n.hb)((e=>{e.isEditable?i(e.username):A(e)}),[i]),b=(0,n.hb)((()=>{A(void 0)}),[]),C=(0,n.hb)((()=>{u&&(t?l({chatId:t,username:u.username,isActive:!u.isActive}):o({username:u.username,isActive:!u.isActive}),b())}),[t,b,l,o,u]),f=(0,n.hb)(((e,t)=>{const a=Math.round(e.y/60),n=p.orderedUsernames?.indexOf(t)||0,s=p.orderedUsernames?.filter((e=>e!==t));s&&(0,ue.Bt)(n+a,0,h.length)&&(s.splice(n+a,0,t),v((e=>({...e,draggedIndex:n,dragOrderUsernames:s}))))}),[p.orderedUsernames,h.length]),S=(0,n.hb)((()=>{v((e=>(t?d({chatId:t,usernames:e.dragOrderUsernames}):c({usernames:e.dragOrderUsernames}),{...e,orderedUsernames:e.dragOrderUsernames,draggedIndex:void 0})))}),[t,d,c]);return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"PaO1MMi5"},n.Ay.createElement("h4",{className:"wSswdVkR",dir:m.isRtl?"rtl":void 0},m("lng_usernames_subtitle")),n.Ay.createElement("div",{className:"lAeeBh9K",style:`height: ${60*a.length}px`},a.map(((e,t)=>{const a=p.draggedIndex===t,s=60*(p.orderedUsernames?.indexOf(e.username)??0),i=60*(p.dragOrderUsernames?.indexOf(e.username)??0),r=e.isEditable?"lng_usernames_edit":e.isActive?"lng_usernames_active":"lng_usernames_non_active";return n.Ay.createElement(Od.A,{key:e.username,id:e.username,onDrag:f,onDragEnd:S,style:`top: ${a?s:i}px;`,knobStyle:(m.isRtl?"left":"right")+": 3rem;",isDisabled:!e.isActive},n.Ay.createElement(Wa.A,{key:e.username,className:(0,de.A)("drag-item mb-2 no-icon","l04OwRBg"),narrow:!0,secondaryIcon:"more",icon:e.isActive?"link":"link-broken",multiline:!0,contextActions:[{handler:()=>{g(e.username)},title:m("Copy"),icon:"copy"}],onClick:()=>{E(e)}},n.Ay.createElement("span",{className:"title"},"@",e.username),n.Ay.createElement("span",{className:"subtitle"},m(r))))}))),n.Ay.createElement("p",{className:"oiJc22Aj",dir:m.isRtl?"rtl":void 0},m("lng_usernames_description"))),n.Ay.createElement(tn.A,{isOpen:Boolean(u),onClose:b,title:m(u?.isActive?"Username.DeactivateAlertTitle":"Username.ActivateAlertTitle"),text:m(u?.isActive?"Username.DeactivateAlertText":"Username.ActivateAlertText"),confirmLabel:m(u?.isActive?"Username.DeactivateAlertHide":"Username.ActivateAlertShow"),confirmHandler:C,confirmIsDestructive:!u?.isActive}))}));var Cm=a(11422);const fm=/https:\/\/t\.me\/?/i,Sm=(0,Ae.sg)((e=>e()),250,!1),km=(0,n.ph)((e=>{let{currentUsername:t,asLink:a,isLoading:i,isUsernameAvailable:o,checkedUsername:l,onChange:c}=e;const{checkUsername:d,checkPublicLink:m}=(0,s.ko)(),[u,A]=(0,n.J0)(t||""),h=(0,T.A)(),y=a?"SetUrl":"Username",p=h(a?"SetUrlPlaceholder":"Username"),v=(0,D.A)(o),g=t!==u?o??v:void 0,E=u&&t!==u&&l!==u,[b,C]=(0,n.Kr)((()=>u.length?u.length<Cm.tX?[void 0,h(`${y}InvalidShort`)]:u.length>Cm.Tk?[void 0,h(`${y}InvalidLong`)]:Cm.Ny.test(u)?void 0===g||E?[]:[g?h(`${y}Available`,p):void 0,!1===g?h(`${y}InUse`):void 0]:[void 0,h(`${y}Invalid`)]:[]),[u,g,E,h,y,p]);(0,n.vJ)((()=>{A(t||"")}),[a,t]);const f=(0,n.hb)((e=>{const n=e.target.value.trim();if(a&&!n.match(fm))return void(n.length||(A(""),c?.("")));const s=n.replace(fm,"");A(s),(""===s||(0,Cm.BU)(s,!0))&&(c?.(s),Sm((()=>{s!==t&&(a?m:d)({username:s})})))}),[a,m,d,t,c]);return n.Ay.createElement(Y.A,{value:`${a?r.jsp:""}${u}`,onChange:f,label:E?h("Checking"):p,error:C,success:b,readOnly:i,teactExperimentControlled:!0})}));var wm=a(43434);const Nm=(0,Ae.nF)((e=>e()),6e4,!0),Im="Please provide your first name",Pm=(0,n.ph)((0,s.EK)((e=>{const{currentUserId:t}=e,{progress:a,isUsernameAvailable:n,checkedUsername:s,error:i}=(0,c.nTw)(e).profileEdit||{},r=t?(0,c.mBe)(e,t):void 0,o=(0,Yi.d)(e,"aboutLength");if(!r)return{progress:a,checkedUsername:s,isUsernameAvailable:n,editUsernameError:i,maxBioLength:o};const{firstName:d,lastName:m,usernames:u}=r,A=t?(0,c.vGo)(e,t):void 0;return{currentAvatarHash:(0,l.cP1)(r),currentFirstName:d,currentLastName:m,currentBio:A?.bio,progress:a,isUsernameAvailable:n,checkedUsername:s,editUsernameError:i,maxBioLength:o,usernames:u}}))((e=>{let{isActive:t,currentAvatarHash:a,currentFirstName:o,currentLastName:l,currentBio:c,progress:d,checkedUsername:m,editUsernameError:u,isUsernameAvailable:A,maxBioLength:h,usernames:y,onReset:p}=e;const{loadCurrentUser:v,updateProfile:g}=(0,s.ko)(),E=(0,T.A)(),b=(0,n.Kr)((()=>y?.find((e=>{let{isEditable:t}=e;return t}))),[y]),C=b?.username||"",[f,S]=(0,n.J0)(!1),[k,w]=(0,n.J0)(!1),[N,I]=(0,n.J0)(),[P,M]=(0,n.J0)(),[B,L]=(0,n.J0)(o||""),[R,x]=(0,n.J0)(l||""),[F,V]=(0,n.J0)(c||""),[_,O]=(0,n.J0)(C),J=(0,G.A)(a,!1,U.qZ.BlobUrl),K=d===i.DV.InProgress,j=!1===_,z=(0,D.A)(A),H=A??z,$=y&&y.length>1,W=(0,n.Kr)((()=>!j&&(Boolean(P)||k||f&&!0===H)),[j,P,k,f,H]);(0,ve.A)({isActive:t,onBack:p}),(0,n.vJ)((()=>{Nm((()=>{v()}))}),[v]),(0,n.vJ)((()=>{M(void 0)}),[J]),(0,n.vJ)((()=>{L(o||""),x(l||""),V(c||"")}),[o,l,c]),(0,n.vJ)((()=>{O(C||"")}),[C]),(0,n.vJ)((()=>{d===i.DV.Complete&&(w(!1),S(!1),I(void 0))}),[d]);const Q=(0,n.hb)((e=>{M(e)}),[]),Z=(0,n.hb)((e=>{L(e.target.value),w(!0)}),[]),X=(0,n.hb)((e=>{x(e.target.value),w(!0)}),[]),ee=(0,n.hb)((e=>{V(e.target.value),w(!0)}),[]),te=(0,n.hb)((e=>{O(e),S(C!==e)}),[C]),ae=(0,n.hb)((()=>{const e=B.trim(),t=R.trim(),a=F.trim();_&&(e.length?g({photo:P,...k&&{firstName:e,lastName:t,bio:a},...f&&{username:_}}):I(Im))}),[P,B,R,F,k,_,f,g]);return n.Ay.createElement("div",{className:"settings-fab-wrapper"},n.Ay.createElement("div",{className:"settings-content no-border custom-scroll"},n.Ay.createElement("div",{className:"settings-edit-profile settings-item"},n.Ay.createElement(wm.A,{currentAvatarBlobUrl:J,onChange:Q,title:"Edit your profile photo",disabled:K}),n.Ay.createElement(Y.A,{value:B,onChange:Z,label:E("FirstName"),disabled:K,error:N===Im?N:void 0}),n.Ay.createElement(Y.A,{value:R,onChange:X,label:E("LastName"),disabled:K}),n.Ay.createElement(cc.A,{value:F,onChange:ee,label:E("UserBio"),disabled:K,maxLength:h,maxLengthIndicator:h?(h-F.length).toString():void 0}),n.Ay.createElement("p",{className:"settings-item-description",dir:E.isRtl?"rtl":void 0},(0,kt.A)(E("lng_settings_about_bio"),["br","simple_markdown"]))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:E.isRtl?"rtl":void 0},E("Username")),n.Ay.createElement("div",{className:"settings-input"},n.Ay.createElement(km,{currentUsername:C,isLoading:K,isUsernameAvailable:A,checkedUsername:m,onChange:te})),u===r.Y3M&&function(){const e=`${r.jsp}${r.NjX}`;return n.Ay.createElement("p",{className:"settings-item-description",dir:E.isRtl?"rtl":void 0},E("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map((t=>"PURCHASE_LINK"===t?n.Ay.createElement($l.A,{url:e,text:`@${r.NjX}`}):t)))}(),n.Ay.createElement("p",{className:"settings-item-description",dir:E.isRtl?"rtl":void 0},(0,kt.A)(E("UsernameHelp"),["br","simple_markdown"])),_&&n.Ay.createElement("p",{className:"settings-item-description",dir:E.isRtl?"rtl":void 0},E("lng_username_link"),n.Ay.createElement("br",null),n.Ay.createElement("span",{className:"username-link"},r.jsp,_))),$&&n.Ay.createElement(bm,{usernames:y,onEditUsername:O})),n.Ay.createElement(un.A,{isShown:W,onClick:ae,disabled:K,ariaLabel:E("Save")},K?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})))})));var Mm=a(61182),Tm=a(15006);const Bm=(0,n.ph)((0,s.EK)((e=>({shouldForceHttpTransport:e.settings.byKey.shouldForceHttpTransport,shouldAllowHttpTransport:e.settings.byKey.shouldAllowHttpTransport,shouldCollectDebugLogs:e.settings.byKey.shouldCollectDebugLogs,shouldDebugExportedSenders:e.settings.byKey.shouldDebugExportedSenders})))((e=>{let{isActive:t,onReset:a,shouldForceHttpTransport:i,shouldAllowHttpTransport:o,shouldCollectDebugLogs:l,shouldDebugExportedSenders:c}=e;const{requestConfetti:d,setSettingOption:m,requestWave:u}=(0,s.ko)(),A=(0,n.li)(null),[h,y]=(0,n.J0)(!1),p=(0,T.A)(),[v,g]=(0,n.J0)(!1);(0,n.vJ)((()=>{window.electron?.getIsAutoUpdateEnabled().then(g)}),[]),(0,ve.A)({isActive:t,onBack:a});const E=(0,M.A)((()=>{const e=new File([(0,Mm.F8)()],r.lFE,{type:"text/plain"}),t=URL.createObjectURL(e);(0,Sn.A)(t,r.lFE)})),C=(0,n.hb)((e=>{window.electron?.setIsAutoUpdateEnabled(e)}),[]),f=(0,M.A)((e=>{u({startX:e.clientX,startY:e.clientY})})),S=(0,M.A)((()=>{d({withStars:!0})})),k=(0,M.A)((()=>{const e=A.current;e&&(0,Tm.U)(e)&&(y(!0),setTimeout((()=>{y(!1)}),1500))}));return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(ol.A,{tgsUrl:rl.w.Experimental,size:200,className:"experimental-duck",nonInteractive:!0,noLoop:!1}),n.Ay.createElement("p",{className:"settings-item-description pt-3",dir:"auto"},p("lng_settings_experimental_about"))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(Wa.A,{onClick:S,icon:"animations"},n.Ay.createElement("div",{className:"title"},"Launch some confetti!")),n.Ay.createElement(Wa.A,{onClick:f,icon:"story-expired",disabled:!b.J6},n.Ay.createElement("div",{className:"title"},"Start wave")),n.Ay.createElement(Wa.A,{ref:A,onClick:k,icon:"spoiler",disabled:!b.bW,style:h?"visibility: hidden":""},n.Ay.createElement("div",{className:"title"},"Vaporize this button")),n.Ay.createElement(js.A,{label:"Allow HTTP Transport",checked:Boolean(o),onCheck:()=>m({shouldAllowHttpTransport:!o})}),n.Ay.createElement(js.A,{label:"Force HTTP Transport",disabled:!o,checked:Boolean(i),onCheck:()=>m({shouldForceHttpTransport:!i})}),n.Ay.createElement(js.A,{label:p("DebugMenuEnableLogs"),checked:Boolean(l),onCheck:()=>m({shouldCollectDebugLogs:!l})}),n.Ay.createElement(js.A,{label:"Enable exported senders debug",checked:Boolean(c),onCheck:()=>m({shouldDebugExportedSenders:!c})}),b.cp&&n.Ay.createElement(js.A,{label:"Enable autoupdates",checked:Boolean(v),onCheck:C}),n.Ay.createElement(Wa.A,{onClick:E,icon:"bug"},n.Ay.createElement("div",{className:"title"},"Download log"))))})));var Lm=a(6e4),Rm=a(84382);const xm=(0,n.ph)((0,s.EK)((e=>{const{theme:t,shouldUseSystemTheme:a}=e.settings.byKey;return{...(0,on.Up)(e.settings.byKey,["messageTextSize","animationLevel","messageSendKeyCombo","isSensitiveEnabled","canChangeSensitive","timeFormat"]),theme:t,shouldUseSystemTheme:a}}))((e=>{let{isActive:t,onScreenSelect:a,onReset:r,messageTextSize:o,messageSendKeyCombo:l,timeFormat:c,theme:d,shouldUseSystemTheme:m}=e;const{setSettingOption:u}=(0,s.ko)(),A=(0,Us.A)(),{isMobile:h}=(0,w.Ay)(),y=h&&(b.pz||b.Ni),p=[{label:A("SettingsTimeFormat12"),value:"12h"},{label:A("SettingsTimeFormat24"),value:"24h"}],v=[{label:A("EmptyChatAppearanceLight"),value:"light"},{label:A("EmptyChatAppearanceDark"),value:"dark"},{label:A("EmptyChatAppearanceSystem"),value:"auto"}],g=y?void 0:[{value:"enter",label:A("SettingsSendEnter"),subLabel:A("SettingsSendEnterDescription")},{value:"ctrl-enter",label:A(b.MP||b.pz?"SettingsSendCmdenter":"SettingsSendCtrlenter"),subLabel:A("SettingsSendPlusEnterDescription")}],E=(0,n.hb)((e=>{document.documentElement.style.setProperty("--composer-text-size",`${Math.max(e,b.pz?16:15)}px`),document.documentElement.style.setProperty("--message-meta-height",`${Math.floor(1.3125*e)}px`),document.documentElement.style.setProperty("--message-text-size",`${e}px`),document.documentElement.setAttribute("data-message-text-size",e.toString()),u({messageTextSize:e})}),[u]),C=(0,n.hb)((e=>{const t="auto"===e?(0,Rm.V)():e;u({theme:t}),u({shouldUseSystemTheme:"auto"===e})}),[u]),f=(0,n.hb)((e=>{u({timeFormat:e}),u({wasTimeFormatSetManually:!0}),(0,Lm.bV)(e)}),[u]),S=(0,n.hb)((e=>{u({messageSendKeyCombo:e})}),[u]),[k,N]=(0,n.J0)(!1);(0,n.vJ)((()=>{window.electron?.getIsTrayIconEnabled().then(N)}),[]);const I=(0,n.hb)((e=>{window.electron?.setIsTrayIconEnabled(e)}),[]);return(0,ve.A)({isActive:t,onBack:r}),n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("h4",{className:"settings-item-header",dir:A.isRtl?"rtl":void 0},A("Settings")),n.Ay.createElement(ze.A,{label:A("TextSize"),min:12,max:20,value:o,onChange:E}),n.Ay.createElement(Wa.A,{icon:"photo",narrow:!0,onClick:()=>a(i.VS.GeneralChatBackground)},A("ChatBackground")),b.cp&&b.H8&&n.Ay.createElement(js.A,{label:A("SettingsTray"),checked:Boolean(k),onCheck:I})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:A.isRtl?"rtl":void 0},A("Theme")),n.Ay.createElement(Z.A,{name:"theme",options:v,selected:m?"auto":d,onChange:C})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:A.isRtl?"rtl":void 0},A("SettingsTimeFormat")),n.Ay.createElement(Z.A,{name:"timeformat",options:p,selected:c,onChange:f})),g&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:A.isRtl?"rtl":void 0},A("SettingsKeyboard")),n.Ay.createElement(Z.A,{name:"keyboard-send-settings",options:g,onChange:S,selected:l})))})));var Fm=a(52844),Vm=a(74824);const Dm=(0,n.ph)((e=>{let{wallpaper:t,theme:a,isSelected:s,onClick:o}=e;const{slug:l,document:c}=t,d=`wallpaper${c.id}`,m=c.previewBlobUrl,u=(0,G.A)(`${d}?size=m`),A=(0,wn.A)(c.thumbnail?.dataUri,Boolean(u),!0),{transitionClassNames:h}=(0,De.A)(Boolean(u||m),void 0,void 0,"slow"),y=(0,n.li)(!1),[p,v]=(0,n.J0)(!1),{mediaData:g,loadProgress:E}=(0,z.A)(d,!p),b=!1===(0,D.A)(p),{shouldRender:C,transitionClassNames:f}=(0,De.A)(p&&!g||l===i.Vw,void 0,b,"slow"),S=(0,n.li)();S.current=a;const k=(0,n.hb)((()=>{(async()=>{const e=await(0,J.sZ)(g);await Vm.save(r.nfi,S.current,e),o(l)})()}),[g,o,l]);(0,n.vJ)((()=>{g&&y.current&&(k(),y.current=!1)}),[g,k]);const w=(0,n.hb)((()=>{g?k():(y.current=!0,v((e=>!e)))}),[g,k]),N=(0,de.A)("WallpaperTile",s&&"selected");return n.Ay.createElement("div",{className:N,onClick:w},n.Ay.createElement("div",{className:"media-inner"},n.Ay.createElement("canvas",{ref:A,className:"thumbnail"}),n.Ay.createElement("img",{src:u||m,className:(0,de.A)("full-media",h),alt:"",draggable:!1}),C&&n.Ay.createElement("div",{className:(0,de.A)("spinner-container",f)},n.Ay.createElement(le.A,{progress:E,onClick:w}))))})),_m=(0,Ae.nF)((e=>e()),6e4,!0),Um=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.SJA)(e),{background:a,isBlurred:n}=e.settings.themes[t]||{},{loadedWallpapers:s}=e.settings;return{background:a,isBlurred:n,loadedWallpapers:s,theme:t}}))((e=>{let{isActive:t,onScreenSelect:a,onReset:o,background:l,isBlurred:c,loadedWallpapers:d,theme:m}=e;const{loadWallpapers:u,uploadWallpaper:A,setThemeSettings:h}=(0,s.ko)(),y=(0,n.li)();y.current=m,(0,n.vJ)((()=>{_m((()=>{u()}))}),[u]);const p=(0,n.hb)((e=>{const{files:t}=e.target,a=(0,J.kc)(t);a?.length&&A(a[0])}),[A]),v=(0,n.hb)((()=>{(0,Fm.p)("image/jpeg",p,!0)}),[p]),g=(0,n.hb)((()=>{a(i.VS.GeneralChatBackgroundColor)}),[a]),E=(0,n.hb)((()=>{h({theme:m,background:void 0,backgroundColor:void 0,isBlurred:!0,patternColor:"dark"===m?r.MkD:r.be8})}),[h,m]),b=(0,n.hb)((e=>{h({theme:y.current,background:e});const t=d&&d.find((t=>t.slug===e));t?.document.thumbnail&&(0,ti.rX)(t.document.thumbnail.dataUri).then((e=>{const t=(0,ti.Yi)(e),a=`#${(0,ti.v2)(e)}`;h({theme:y.current,backgroundColor:a,patternColor:t})}))}),[d,h]),C=(0,n.hb)((e=>{h({theme:y.current,isBlurred:e.target.checked})}),[h]),f=(0,T.A)();(0,ve.A)({isActive:t,onBack:o});const S=d?.[0]&&d[0].slug===i.Vw;return n.Ay.createElement("div",{className:"SettingsGeneralBackground settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement(Wa.A,{icon:"camera-add",className:"mb-0",disabled:S,onClick:v},f("UploadImage")),n.Ay.createElement(Wa.A,{icon:"colorize",className:"mb-0",onClick:g},f("SetColor")),n.Ay.createElement(Wa.A,{icon:"favorite",onClick:E},f("ThemeResetToDefaults")),n.Ay.createElement(js.A,{label:f("BackgroundBlurred"),checked:Boolean(c),onChange:C})),d?n.Ay.createElement("div",{className:"settings-wallpapers"},d.map((e=>n.Ay.createElement(Dm,{key:e.slug,wallpaper:e,theme:m,isSelected:l===e.slug,onClick:b})))):n.Ay.createElement(fs.A,null))}))),Om=(0,ti.bM)((0,ti.xp)("e6ebee")),Jm=["#e6ebee","#b2cee1","#008dd0","#c6e7cb","#c4e1a6","#60b16e","#ccd0af","#a6a997","#7a7072","#fdd7af","#fdb76e","#dd8851"];function Km(e,t){return{colorPosition:[Math.round(e[1]*(t.colorRect.width-1)),Math.round((1-e[2])*(t.colorRect.height-1))],huePosition:Math.round(e[0]*(t.hueRect.width-1))}}function jm(e,t){let{colorPosition:a,huePosition:n}=e;return[n/(t.hueRect.width-1),a[0]/(t.colorRect.width-1),1-a[1]/(t.colorRect.height-1)]}const Gm=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.SJA)(e),{backgroundColor:a}=e.settings.themes[t]||{};return{backgroundColor:a,theme:t}}))((e=>{let{isActive:t,onReset:a,theme:i,backgroundColor:r}=e;const{setThemeSettings:o}=(0,s.ko)(),l=(0,n.li)();l.current=i;const c=(0,n.li)(null),d=(0,n.li)(null),m=(0,n.li)(null),u=(0,n.li)(!0),[A,h]=(0,n.J0)(function(e){return e&&e.startsWith("#")?(0,ti.bM)((0,ti.xp)(e.replace("#",""))):Om}(r)),y=(0,n.li)(A);(0,n.vJ)((()=>{y.current=A}),[A]);const[p,v,g]=(0,I.A)(),[E,b]=(0,n.J0)(""),[C,f]=(0,n.J0)(""),S=(0,n.li)(),k=(0,n.li)();(0,n.vJ)((()=>{const e={offsetLeft:d.current.offsetLeft,...(0,on.Up)(d.current.getBoundingClientRect(),["top","width","height"])},t={offsetLeft:m.current.offsetLeft,...(0,on.Up)(m.current.getBoundingClientRect(),["width"])};function a(t){const a=[Math.min(Math.max(0,t.pageX-e.offsetLeft),e.width-1),Math.min(Math.max(0,t.pageY-e.top+c.current.scrollTop),e.height-1)],{huePosition:n}=Km(y.current,S.current);return h(jm({colorPosition:a,huePosition:n},S.current)),v(),!0}function n(e){const{colorPosition:a}=Km(y.current,S.current),n=Math.min(Math.max(0,e.pageX-t.offsetLeft),t.width-1);return h(jm({colorPosition:a,huePosition:n},S.current)),v(),!0}S.current={colorRect:e,hueRect:t},(0,me.wJ)(d.current,{onCapture:a,onDrag:a,onRelease:g,onClick:g,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0}),(0,me.wJ)(m.current,{onCapture:n,onDrag:n,onRelease:g,onClick:g,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0})}),[v,g]);const{colorPosition:w=[0,0],huePosition:N=0}=S.current?Km(A,S.current):{},P=(0,ti.v2)((0,ti.Zf)(A)),M=A[0],T=(0,ti.v2)((0,ti.Zf)([M,1,1]));(0,n.vJ)((()=>{const e=(0,ti.Zf)(A),t=`#${(0,ti.v2)(e)}`;if(b(e.join(", ")),f(t),!u.current){const a=(0,ti.Yi)(e);o({theme:l.current,background:void 0,backgroundColor:t,patternColor:a})}u.current=!1}),[A,o]),(0,n.vJ)((()=>{!function(e,t,a,n){let s,i,r;a.current&&n.current?(s=n.current.colorRect.width,i=n.current.colorRect.height,r=a.current):(s=e.offsetWidth,i=e.offsetHeight,r=e.getContext("2d"),e.width=s,e.height=i,a.current=r);const o=r.createImageData(s,i),l=o.data,c=(0,ti.Zf)([t,1,1]);let d=0;for(let e=0;e<i;e++){const t=1-e/(i-1),a=[255*t,255*t,255*t],n=[c[0]*t,c[1]*t,c[2]*t];for(let e=0;e<s;e++){const t=e/(s-1);l[d++]=a[0]+(n[0]-a[0])*t,l[d++]=a[1]+(n[1]-a[1])*t,l[d++]=a[2]+(n[2]-a[2])*t,l[d++]=255}}r.putImageData(o,0,0)}(d.current.firstChild,M,k,S)}),[M]),(0,n.vJ)((()=>{!function(e){const t=e.offsetWidth;e.width=t,e.height=1;const a=e.getContext("2d"),n=a.createImageData(t,1),s=n.data;let i=0;for(let e=0;e<t;e++){const a=e/(t-1),n=(0,ti.Zf)([a,1,1]);s[i++]=n[0],s[i++]=n[1],s[i++]=n[2],s[i++]=255}a.putImageData(n,0,0)}(m.current.firstChild)}),[]);const B=(0,n.hb)((e=>{const t=e.currentTarget.value.replace(/[^\d, ]/g,"").slice(0,13);if(t.match(/^\d{1,3},\s?\d{1,3},\s?\d{1,3}$/)){const e=t.split(",").map((e=>Number(e.trim())));h((0,ti.bM)(e))}e.currentTarget.value=t}),[]),L=(0,n.hb)((e=>{const t=e.currentTarget.value.replace(/[^0-9a-fA-F]/g,"").slice(0,6);t.match(/^#?[0-9a-fA-F]{6}$/)&&h((0,ti.bM)((0,ti.xp)(t.replace("#","")))),e.currentTarget.value=t}),[]),R=(0,n.hb)((e=>{h((0,ti.bM)((0,ti.xp)(e.currentTarget.dataset.color.replace("#",""))))}),[]),x=(0,de.A)("SettingsGeneralBackgroundColor settings-content custom-scroll",p&&"is-dragging");return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{ref:c,className:x},n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement("div",{ref:d,className:"color-picker"},n.Ay.createElement("canvas",null),n.Ay.createElement("div",{className:"handle",style:`transform: translate(${w[0]}px, ${w[1]}px); background-color: #${P};`})),n.Ay.createElement("div",{ref:m,className:"hue-picker"},n.Ay.createElement("canvas",null),n.Ay.createElement("div",{className:"handle",style:`transform: translateX(${N}px); background-color: #${T};`})),n.Ay.createElement("div",{className:"tools"},n.Ay.createElement(Y.A,{value:C,label:"HEX",onChange:L}),n.Ay.createElement(Y.A,{value:E,label:"RGB",onChange:B}))),n.Ay.createElement("div",{className:"predefined-colors"},Jm.map((e=>n.Ay.createElement("div",{className:(0,de.A)("predefined-color",e===`#${P}`?"active":void 0),"data-color":e,style:`background-color: ${e};`,onClick:R})))))}))),zm=(0,n.ph)((e=>{let{currentScreen:t,editedFolderId:a,onReset:r,onScreenSelect:o}=e;const{signOut:l,openDeleteChatFolderModal:c}=(0,s.ko)(),{isMobile:d}=(0,w.Ay)(),[m,u]=(0,n.J0)(!1),A=function(e,t){const a=(0,n.li)(0),s=(0,n.li)();return(0,n.hb)((()=>{if(a.current++,5===a.current)return a.current=0,void t();s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{a.current=0}),300)}),[5,t])}(0,(()=>{o(i.VS.Experimental)})),h=(0,n.hb)((()=>{u(!0)}),[]),y=(0,n.hb)((()=>{u(!1)}),[]),p=(0,n.hb)((()=>{a&&c({folderId:a})}),[a,c]),v=(0,n.hb)((()=>{y(),l({forceInitApi:!0})}),[y,l]),g=(0,n.Kr)((()=>e=>{let{onTrigger:t,isOpen:a}=e;return n.Ay.createElement(W.A,{round:!0,ripple:!d,size:"smaller",color:"translucent",className:a?"active":"",onClick:t,ariaLabel:"More actions"},n.Ay.createElement(q.A,{name:"more"}))}),[d]),E=(0,T.A)(),b=(0,Us.A)();return n.Ay.createElement("div",{className:"left-header"},n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",onClick:r,ariaLabel:E("AccDescrGoBack")},n.Ay.createElement(q.A,{name:"arrow-left"})),function(){switch(t){case i.VS.EditProfile:return n.Ay.createElement("h3",null,E("lng_settings_information"));case i.VS.General:return n.Ay.createElement("h3",null,E("General"));case i.VS.QuickReaction:return n.Ay.createElement("h3",null,E("DoubleTapSetting"));case i.VS.CustomEmoji:return n.Ay.createElement("h3",null,E("Emoji"));case i.VS.Notifications:return n.Ay.createElement("h3",null,E("Notifications"));case i.VS.DataStorage:return n.Ay.createElement("h3",null,E("DataSettings"));case i.VS.Privacy:return n.Ay.createElement("h3",null,E("PrivacySettings"));case i.VS.Language:return n.Ay.createElement("h3",null,E("Language"));case i.VS.DoNotTranslate:return n.Ay.createElement("h3",null,E("DoNotTranslate"));case i.VS.Stickers:return n.Ay.createElement("h3",null,E("StickersName"));case i.VS.Experimental:return n.Ay.createElement("h3",null,E("lng_settings_experimental"));case i.VS.GeneralChatBackground:return n.Ay.createElement("h3",null,E("ChatBackground"));case i.VS.GeneralChatBackgroundColor:return n.Ay.createElement("h3",null,E("SetColor"));case i.VS.PrivacyPhoneNumber:return n.Ay.createElement("h3",null,E("PrivacyPhone"));case i.VS.PrivacyLastSeen:return n.Ay.createElement("h3",null,E("PrivacyLastSeen"));case i.VS.PrivacyProfilePhoto:return n.Ay.createElement("h3",null,E("Privacy.ProfilePhoto"));case i.VS.PrivacyBio:return n.Ay.createElement("h3",null,E("PrivacyBio"));case i.VS.PrivacyBirthday:return n.Ay.createElement("h3",null,E("PrivacyBirthday"));case i.VS.PrivacyGifts:return n.Ay.createElement("h3",null,b("PrivacyGifts"));case i.VS.PrivacyForwarding:return n.Ay.createElement("h3",null,E("PrivacyForwards"));case i.VS.PrivacyVoiceMessages:return n.Ay.createElement("h3",null,E("PrivacyVoiceMessages"));case i.VS.PrivacyMessages:return n.Ay.createElement("h3",null,E("PrivacyMessages"));case i.VS.PrivacyGroupChats:return n.Ay.createElement("h3",null,E("AutodownloadGroupChats"));case i.VS.PrivacyPhoneCall:return n.Ay.createElement("h3",null,E("Calls"));case i.VS.PrivacyLastSeenAllowedContacts:case i.VS.PrivacyProfilePhotoAllowedContacts:case i.VS.PrivacyBioAllowedContacts:case i.VS.PrivacyGroupChatsAllowedContacts:return n.Ay.createElement("h3",null,E("AlwaysShareWith"));case i.VS.PrivacyLastSeenDeniedContacts:case i.VS.PrivacyProfilePhotoDeniedContacts:case i.VS.PrivacyBioDeniedContacts:case i.VS.PrivacyGroupChatsDeniedContacts:return n.Ay.createElement("h3",null,E("NeverShareWith"));case i.VS.PrivacyPhoneNumberAllowedContacts:case i.VS.PrivacyBirthdayAllowedContacts:case i.VS.PrivacyGiftsAllowedContacts:case i.VS.PrivacyForwardingAllowedContacts:case i.VS.PrivacyVoiceMessagesAllowedContacts:case i.VS.PrivacyPhoneCallAllowedContacts:case i.VS.PrivacyPhoneP2PAllowedContacts:return n.Ay.createElement("h3",null,E("AlwaysAllow"));case i.VS.PrivacyPhoneNumberDeniedContacts:case i.VS.PrivacyBirthdayDeniedContacts:case i.VS.PrivacyGiftsDeniedContacts:case i.VS.PrivacyForwardingDeniedContacts:case i.VS.PrivacyVoiceMessagesDeniedContacts:case i.VS.PrivacyPhoneCallDeniedContacts:case i.VS.PrivacyPhoneP2PDeniedContacts:return n.Ay.createElement("h3",null,E("NeverAllow"));case i.VS.Performance:return n.Ay.createElement("h3",null,b("MenuAnimations"));case i.VS.ActiveSessions:return n.Ay.createElement("h3",null,E("SessionsTitle"));case i.VS.ActiveWebsites:return n.Ay.createElement("h3",null,E("OtherWebSessions"));case i.VS.PrivacyBlockedUsers:return n.Ay.createElement("h3",null,E("BlockedUsers"));case i.VS.TwoFaDisabled:case i.VS.TwoFaEnabled:return n.Ay.createElement("h3",null,E("TwoStepVerification"));case i.VS.TwoFaNewPassword:case i.VS.TwoFaChangePasswordNew:case i.VS.TwoFaChangePasswordConfirm:return n.Ay.createElement("h3",null,E("PleaseEnterCurrentPassword"));case i.VS.TwoFaNewPasswordConfirm:return n.Ay.createElement("h3",null,E("PleaseReEnterPassword"));case i.VS.TwoFaNewPasswordHint:case i.VS.TwoFaChangePasswordHint:return n.Ay.createElement("h3",null,E("PasswordHint"));case i.VS.TwoFaNewPasswordEmail:case i.VS.TwoFaRecoveryEmail:return n.Ay.createElement("h3",null,E("RecoveryEmailTitle"));case i.VS.TwoFaNewPasswordEmailCode:case i.VS.TwoFaRecoveryEmailCode:return n.Ay.createElement("h3",null,"Recovery Email Code");case i.VS.TwoFaCongratulations:return n.Ay.createElement("h3",null,E("TwoStepVerificationPasswordSet"));case i.VS.TwoFaChangePasswordCurrent:case i.VS.TwoFaTurnOff:case i.VS.TwoFaRecoveryEmailCurrentPassword:return n.Ay.createElement("h3",null,E("PleaseEnterCurrentPassword"));case i.VS.PasscodeDisabled:case i.VS.PasscodeEnabled:case i.VS.PasscodeNewPasscode:case i.VS.PasscodeNewPasscodeConfirm:case i.VS.PasscodeCongratulations:return n.Ay.createElement("h3",null,E("Passcode"));case i.VS.PasscodeTurnOff:return n.Ay.createElement("h3",null,E("PasscodeController.Disable.Title"));case i.VS.PasscodeChangePasscodeCurrent:case i.VS.PasscodeChangePasscodeNew:return n.Ay.createElement("h3",null,E("PasscodeController.Change.Title"));case i.VS.PasscodeChangePasscodeConfirm:return n.Ay.createElement("h3",null,E("PasscodeController.ReEnterPasscode.Placeholder"));case i.VS.Folders:return n.Ay.createElement("h3",null,E("Filters"));case i.VS.FoldersCreateFolder:return n.Ay.createElement("h3",null,E("FilterNew"));case i.VS.FoldersShare:return n.Ay.createElement("h3",null,E("FolderLinkScreen.Title"));case i.VS.FoldersEditFolder:case i.VS.FoldersEditFolderFromChatList:case i.VS.FoldersEditFolderInvites:return n.Ay.createElement("div",{className:"settings-main-header"},n.Ay.createElement("h3",null,E("FilterEdit")),Boolean(a)&&n.Ay.createElement(re.A,{className:"settings-more-menu",trigger:g,positionX:"right"},n.Ay.createElement(oe.A,{icon:"delete",destructive:!0,onClick:p},E("Delete"))));case i.VS.FoldersIncludedChats:case i.VS.FoldersIncludedChatsFromChatList:case i.VS.FoldersExcludedChats:case i.VS.FoldersExcludedChatsFromChatList:return n.Ay.createElement("h3",null,E(t===i.VS.FoldersIncludedChats||t===i.VS.FoldersIncludedChatsFromChatList?"FilterInclude":"FilterExclude"));default:return n.Ay.createElement("div",{className:"settings-main-header"},n.Ay.createElement("h3",{onClick:A},E("SETTINGS")),n.Ay.createElement(W.A,{round:!0,ripple:!d,size:"smaller",color:"translucent",onClick:()=>o(i.VS.EditProfile),ariaLabel:E("lng_settings_information")},n.Ay.createElement(q.A,{name:"edit"})),n.Ay.createElement(re.A,{className:"settings-more-menu",trigger:g,positionX:"right"},n.Ay.createElement(oe.A,{icon:"logout",onClick:h},E("LogOutTitle"))))}}(),n.Ay.createElement(tn.A,{isOpen:m,onClose:y,text:E("lng_sure_logout"),confirmLabel:E("AccountSettings.Logout"),confirmHandler:v,confirmIsDestructive:!0}))})),Hm=(0,n.ph)((0,s.EK)((e=>{const{language:t,canTranslate:a,canTranslateChats:n,doNotTranslate:s}=e.settings.byKey,i=e.settings.languages;return{isCurrentUserPremium:(0,c.g29)(e),languages:i,language:t,canTranslate:a,canTranslateChats:n,doNotTranslate:s}}))((e=>{let{isActive:t,isCurrentUserPremium:a,languages:r,language:o,canTranslate:l,canTranslateChats:c,doNotTranslate:d,onScreenSelect:m,onReset:u}=e;const{loadLanguages:A,setSettingOption:h,openPremiumModal:y}=(0,s.ko)(),[p,v]=(0,n.J0)(o),[g,E,C]=(0,I.A)(),f=a&&c,S=(0,T.A)();(0,n.vJ)((()=>{r?.length||A()}),[r]);const k=(0,M.A)((e=>{v(e),E(),(0,Lm.wT)(e,(()=>{C(),h({language:e})}))})),w=(0,n.Kr)((()=>{if(!r)return;const e=(window.navigator.language||"en").toLowerCase(),t=e.substr(0,2);return r.map((e=>{let{langCode:t,nativeName:a,name:n}=e;return{value:t,label:a,subLabel:n,isLoading:t===p&&g}})).sort((a=>!e||a.value!==e&&a.value!==t?0:-1))}),[g,r,p]),N=(0,M.A)((e=>{h({canTranslate:e})})),P=(0,M.A)((e=>{h({canTranslateChats:e})})),B=(0,M.A)((()=>{a||y({initialSection:"translations"})})),L=(0,n.Kr)((()=>{if(b.CM&&d.length)return 1===d.length?new Intl.DisplayNames([o],{type:"language"}).of(d[0]):S("Languages",d.length)}),[d,S,o]),R=(0,M.A)((()=>{m(i.VS.DoNotTranslate)}));return(0,ve.A)({isActive:t,onBack:u}),n.Ay.createElement("div",{className:"settings-content settings-language custom-scroll"},b.CM&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(js.A,{label:S("ShowTranslateButton"),checked:l,onCheck:N}),n.Ay.createElement(js.A,{label:S("ShowTranslateChatButton"),checked:f,disabled:!a,rightIcon:a?void 0:"lock",onClickLabel:B,onCheck:P}),(l||f)&&n.Ay.createElement(Wa.A,{narrow:!0,onClick:R},S("DoNotTranslate"),n.Ay.createElement("span",{className:"settings-item__current-value"},L)),n.Ay.createElement("p",{className:"settings-item-description mb-0 mt-1"},S("lng_translate_settings_about"))),n.Ay.createElement("div",{className:"settings-item settings-item-picker"},n.Ay.createElement("h4",{className:"settings-item-header"},S("Localization.InterfaceLanguage")),w?n.Ay.createElement(oo,{items:w,selectedValue:p,forceRenderAllItems:!0,onSelectedValueChange:k,itemInputType:"radio",className:"settings-picker"}):n.Ay.createElement(fs.A,null)))})));var $m=a(86046),qm=a(44784),Wm=a(70195);const Ym=(0,n.ph)((0,s.EK)((e=>{const{currentUserId:t}=e,a=(0,c.hc)(e),n=e.stars?.balance;return{sessionCount:e.activeSessions.orderedHashes.length,currentUserId:t,canBuyPremium:!(0,c.n_C)(e),isGiveawayAvailable:a,starsBalance:n}}))((e=>{let{isActive:t,currentUserId:a,sessionCount:o,canBuyPremium:l,isGiveawayAvailable:c,starsBalance:d,onScreenSelect:m,onReset:u}=e;const{loadMoreProfilePhotos:A,openPremiumModal:h,openSupportChat:y,openUrl:p,openGiftRecipientPicker:v,openStarsBalanceModal:g}=(0,s.ko)(),[E,b,C]=(0,I.A)(!1),f=(0,Us.A)();(0,n.vJ)((()=>{a&&A({peerId:a,isPreload:!0})}),[a]),(0,ve.A)({isActive:t,onBack:u});const S=(0,M.A)((()=>{y(),C()}));return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-main-menu self-profile"},a&&n.Ay.createElement(Wm.A,{peerId:a,canPlayVideo:Boolean(t),forceShowSelf:!0}),a&&n.Ay.createElement(qm.A,{chatOrUserId:a,isInSettings:!0})),n.Ay.createElement("div",{className:"settings-main-menu"},n.Ay.createElement(Wa.A,{icon:"settings",narrow:!0,onClick:()=>m(i.VS.General)},f("TelegramGeneralSettingsViewController")),n.Ay.createElement(Wa.A,{icon:"animations",narrow:!0,onClick:()=>m(i.VS.Performance)},f("MenuAnimations")),n.Ay.createElement(Wa.A,{icon:"unmute",narrow:!0,onClick:()=>m(i.VS.Notifications)},f("Notifications")),n.Ay.createElement(Wa.A,{icon:"data",narrow:!0,onClick:()=>m(i.VS.DataStorage)},f("DataSettings")),n.Ay.createElement(Wa.A,{icon:"lock",narrow:!0,onClick:()=>m(i.VS.Privacy)},f("PrivacySettings")),n.Ay.createElement(Wa.A,{icon:"folder",narrow:!0,onClick:()=>m(i.VS.Folders)},f("Filters")),n.Ay.createElement(Wa.A,{icon:"active-sessions",narrow:!0,onClick:()=>m(i.VS.ActiveSessions)},f("SessionsTitle"),o>0&&n.Ay.createElement("span",{className:"settings-item__current-value"},o)),n.Ay.createElement(Wa.A,{icon:"language",narrow:!0,onClick:()=>m(i.VS.Language)},f("Language"),n.Ay.createElement("span",{className:"settings-item__current-value"},f.languageInfo.nativeName)),n.Ay.createElement(Wa.A,{icon:"stickers",narrow:!0,onClick:()=>m(i.VS.Stickers)},f("MenuStickers"))),n.Ay.createElement("div",{className:"settings-main-menu"},l&&n.Ay.createElement(Wa.A,{leftElement:n.Ay.createElement(em.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),narrow:!0,onClick:()=>h()},f("TelegramPremium")),n.Ay.createElement(Wa.A,{leftElement:n.Ay.createElement(em.A,{className:"icon ListItem-main-icon",type:"gold",size:"big"}),narrow:!0,onClick:()=>g({})},f("MenuStars"),Boolean(d)&&n.Ay.createElement("span",{className:"settings-item__current-value"},(0,$m.ZF)(f,d))),c&&n.Ay.createElement(Wa.A,{icon:"gift",narrow:!0,onClick:()=>v()},f("MenuSendGift"))),n.Ay.createElement("div",{className:"settings-main-menu"},n.Ay.createElement(Wa.A,{icon:"ask-support",narrow:!0,onClick:b},f("AskAQuestion")),n.Ay.createElement(Wa.A,{icon:"help",narrow:!0,onClick:()=>p({url:r.r9K})},f("MenuTelegramFaq")),n.Ay.createElement(Wa.A,{icon:"privacy-policy",narrow:!0,onClick:()=>p({url:r.pkx})},f("MenuPrivacyPolicy"))),n.Ay.createElement(tn.A,{isOpen:E,confirmLabel:f("OK"),title:f("AskAQuestion"),textParts:f("MenuAskText",void 0,{withNodes:!0,renderTextFilters:["br"]}),confirmHandler:S,onClose:C}))})));var Qm=a(5560),Zm=a(56133);const Xm=(0,n.ph)((0,s.EK)((e=>({hasPrivateChatsNotifications:Boolean(e.settings.byKey.hasPrivateChatsNotifications),hasPrivateChatsMessagePreview:Boolean(e.settings.byKey.hasPrivateChatsMessagePreview),hasGroupNotifications:Boolean(e.settings.byKey.hasGroupNotifications),hasGroupMessagePreview:Boolean(e.settings.byKey.hasGroupMessagePreview),hasBroadcastNotifications:Boolean(e.settings.byKey.hasBroadcastNotifications),hasBroadcastMessagePreview:Boolean(e.settings.byKey.hasBroadcastMessagePreview),hasContactJoinedNotifications:Boolean(e.settings.byKey.hasContactJoinedNotifications),hasWebNotifications:e.settings.byKey.hasWebNotifications,hasPushNotifications:e.settings.byKey.hasPushNotifications,notificationSoundVolume:e.settings.byKey.notificationSoundVolume})))((e=>{let{isActive:t,onReset:a,hasPrivateChatsNotifications:i,hasPrivateChatsMessagePreview:r,hasGroupNotifications:o,hasGroupMessagePreview:l,hasBroadcastNotifications:c,hasBroadcastMessagePreview:d,hasContactJoinedNotifications:m,hasPushNotifications:u,hasWebNotifications:A,notificationSoundVolume:h}=e;const{loadNotificationSettings:y,updateContactSignUpNotification:p,updateNotificationSettings:v,updateWebNotificationSettings:g}=(0,s.ko)();(0,n.vJ)((()=>{y()}),[y]);const E=(0,Zm.A)(500,!0),b=(0,Qm.M2)(),C=b&&!(0,Qm.Ac)(),f=(0,n.hb)(((e,t,a)=>{const n="contact"===t?!i:!("group"===t?o:c),s="contact"===t?r:"group"===t?l:d;v({peerType:t,..."silent"===a&&{isSilent:!e.target.checked,shouldShowPreviews:s},..."showPreviews"===a&&{shouldShowPreviews:e.target.checked,isSilent:n}})}),[d,c,l,o,r,i,v]),S=(0,n.hb)((e=>{const t=e.target.checked;g({hasWebNotifications:t,...!t&&{hasPushNotifications:!1}})}),[g]),k=(0,n.hb)((e=>{g({hasPushNotifications:e.target.checked})}),[g]),w=(0,n.hb)((e=>{f(e,"contact","silent")}),[f]),N=(0,n.hb)((e=>{f(e,"contact","showPreviews")}),[f]),I=(0,n.hb)((e=>{f(e,"group","silent")}),[f]),P=(0,n.hb)((e=>{f(e,"group","showPreviews")}),[f]),M=(0,n.hb)((e=>{f(e,"broadcast","silent")}),[f]),T=(0,n.hb)((e=>{f(e,"broadcast","showPreviews")}),[f]),B=(0,n.hb)((e=>{p({isSilent:!e.target.checked})}),[p]),L=(0,n.hb)((e=>{g({notificationSoundVolume:e}),E((()=>(0,Qm.BA)(void 0,e)))}),[E,g]),R=(0,Us.A)();return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:R.isRtl?"rtl":void 0},R("NotificationsWeb")),n.Ay.createElement(js.A,{label:R("NotificationsWeb"),subLabel:R(A?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:A,disabled:!b,onChange:S}),n.Ay.createElement(js.A,{label:R("NotificationsOffline"),disabled:!A||!C,subLabel:R(C?u?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled":"SettingsOfflineNotificationUnsupported"),checked:u,onChange:k}),n.Ay.createElement("div",{className:"settings-item-slider"},n.Ay.createElement(ze.A,{label:R("NotificationsSound"),min:0,max:10,disabled:!b,value:h,onChange:L}))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:R.isRtl?"rtl":void 0},R("AutodownloadPrivateChats")),n.Ay.createElement(js.A,{label:R("NotificationsForPrivateChats"),subLabel:R(i?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:i,onChange:w}),n.Ay.createElement(js.A,{label:R("MessagePreview"),disabled:!i,subLabel:R(r?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:r,onChange:N})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:R.isRtl?"rtl":void 0},R("FilterGroups")),n.Ay.createElement(js.A,{label:R("NotificationsForGroups"),subLabel:R(o?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:o,onChange:I}),n.Ay.createElement(js.A,{label:R("MessagePreview"),disabled:!o,subLabel:R(l?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:l,onChange:P})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:R.isRtl?"rtl":void 0},R("FilterChannels")),n.Ay.createElement(js.A,{label:R("NotificationsForChannels"),subLabel:R(c?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:c,onChange:M}),n.Ay.createElement(js.A,{label:R("MessagePreview"),disabled:!c,subLabel:R(d?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:d,onChange:T})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:R.isRtl?"rtl":void 0},R("PhoneOther")),n.Ay.createElement(js.A,{label:R("ContactJoined"),checked:m,onChange:B})))})));var eu=a(20714),tu=a(22986);const au=["SettingsPerformanceSliderLow","SettingsPerformanceSliderMedium","SettingsPerformanceSliderHigh"],nu=["SettingsPerformanceSliderLow","SettingsPerformanceSliderCustom","SettingsPerformanceSliderHigh"],su=[["SettingsPerformanceInterfaceAnimations",[{key:"pageTransitions",label:"SettingsPerformancePageTransitions"},{key:"messageSendingAnimations",label:"SettingsPerformanceSending"},{key:"mediaViewerAnimations",label:"SettingsPerformanceMediaViewer"},{key:"messageComposerAnimations",label:"SettingsPerformanceComposer"},{key:"contextMenuAnimations",label:"SettingsPerformanceContextAnimation"},{key:"contextMenuBlur",label:"SettingsPerformanceContextBlur",disabled:!b.Fy},{key:"rightColumnAnimations",label:"SettingsPerformanceRightColumn"},{key:"snapEffect",label:"SettingsPerformanceThanos"}]],["SettingsPerformanceStickers",[{key:"animatedEmoji",label:"SettingsPerformanceAnimatedEmoji"},{key:"loopAnimatedStickers",label:"SettingsPerformanceLoopStickers"},{key:"reactionEffects",label:"SettingsPerformanceReactionEffects"},{key:"stickerEffects",label:"SettingsPerformanceStickerEffects"}]],["SettingsPerformanceMediaAutoplay",[{key:"autoplayGifs",label:"SettingsPerformanceAutoplayGif"},{key:"autoplayVideos",label:"SettingsPerformanceAutoplayVideo"}]]],iu=(0,n.ph)((0,s.EK)((e=>({performanceSettings:(0,c.Cw0)(e)})))((function(e){let{isActive:t,performanceSettings:a,onReset:i}=e;const{setSettingOption:o,updatePerformanceSettings:l}=(0,s.ko)();(0,ve.A)({isActive:t,onBack:i});const c=(0,Us.A)(),[d,m]=(0,n.J0)({}),u=(0,n.Kr)((()=>su.reduce(((e,t,n)=>{let[,s]=t;return e[n]=s.every((e=>{let{key:t}=e;return a[t]})),e}),{})),[a]),A=(0,n.Kr)((()=>(0,tu.T)(a,eu.LH)?r.zP3:(0,tu.T)(a,eu.PI)?r.dnp:(0,tu.T)(a,eu.PX)?r.zHL:r.M8B),[a]),h=(0,n.Kr)((()=>(A===r.M8B?nu:au).map((e=>c(e)))),[A,c]),y=(0,n.hb)(((e,t)=>{e.preventDefault();const a=Number(t);m((e=>({...e,[a]:!e[a]})))}),[]),p=(0,n.hb)((e=>{const t=e===r.dnp?eu.PI:e===r.zHL?eu.PX:eu.LH;o({animationLevel:e}),l(t)}),[o]),v=(0,n.hb)((e=>{const{name:t,checked:a}=e.target,n=su.find((e=>{let[a]=e;return a===t}));if(!n)return;const s=n[1].reduce(((e,t)=>{let{key:n}=t;return e[n]=a,e}),{});l(s)}),[]),g=(0,n.hb)((e=>{const{name:t,checked:a}=e.target;l({[t]:a})}),[]);return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:c.isRtl?"rtl":void 0},c("SettingsPerformanceSliderTitle")),n.Ay.createElement("p",{className:"settings-item-description",dir:c.isRtl?"rtl":void 0},c("SettingsPerformanceSliderSubtitle")),n.Ay.createElement(ze.A,{options:h,value:A===r.M8B?r.zHL:A,onChange:p})),n.Ay.createElement("div",{className:"settings-item-simple settings-item__with-shifted-dropdown"},n.Ay.createElement("h3",{className:"settings-item-header",dir:"auto"},"Resource-Intensive Processes"),su.map(((e,t)=>{let[s,i]=e;return n.Ay.createElement("div",{key:s,className:"settings-dropdown-section"},n.Ay.createElement("div",{className:"ListItem with-checkbox"},n.Ay.createElement(js.A,{name:s,value:t.toString(),checked:u[t],label:c(s),rightIcon:d[t]?"up":"down",onChange:v,onClickLabel:y})),Boolean(d[t])&&n.Ay.createElement("div",{className:"DropdownList DropdownList--open"},i.map((e=>{let{key:t,label:s,disabled:i}=e;if("snapEffect"!==t||b.bW)return n.Ay.createElement(js.A,{key:t,name:t,checked:a[t],label:c(s),disabled:i,onChange:g})}))))}))))}))),ru=(0,n.ph)((0,s.EK)((e=>{const{settings:{byKey:{hasPassword:t,isSensitiveEnabled:a,canChangeSensitive:n,shouldArchiveAndMuteNewNonContact:s,canDisplayChatInTitle:i,shouldNewNonContactPeersRequirePremium:r},privacy:o},blocked:l,passcode:{hasPasscode:d},appConfig:m}=e;return{isCurrentUserPremium:(0,c.g29)(e),hasPassword:t,hasPasscode:Boolean(d),blockedCount:l.totalCount,webAuthCount:e.activeWebSessions.orderedHashes.length,isSensitiveEnabled:a,canDisplayAutoarchiveSetting:Boolean(m?.canDisplayAutoarchiveSetting),shouldArchiveAndMuteNewNonContact:s,canChangeSensitive:n,shouldNewNonContactPeersRequirePremium:r,privacy:o,canDisplayChatInTitle:i,canSetPasscode:(0,c.Ntz)(e)}}))((e=>{let{isActive:t,isCurrentUserPremium:a,hasPassword:r,hasPasscode:o,blockedCount:l,webAuthCount:c,isSensitiveEnabled:d,canChangeSensitive:m,canDisplayAutoarchiveSetting:u,shouldArchiveAndMuteNewNonContact:A,shouldNewNonContactPeersRequirePremium:h,canDisplayChatInTitle:y,canSetPasscode:p,privacy:v,onScreenSelect:g,onReset:E}=e;const{loadPrivacySettings:b,loadBlockedUsers:C,loadContentSettings:f,updateContentSettings:S,loadGlobalPrivacySettings:k,updateGlobalPrivacySettings:w,loadWebAuthorizations:N,setSettingOption:I}=(0,s.ko)();(0,n.vJ)((()=>{C(),b(),f(),N()}),[]),(0,n.vJ)((()=>{t&&k()}),[t,k]);const P=(0,T.A)(),M=(0,Us.A)();(0,ve.A)({isActive:t,onBack:E});const B=(0,n.hb)((e=>{w({shouldArchiveAndMuteNewNonContact:e})}),[w]),L=(0,n.hb)((e=>{I({canDisplayChatInTitle:e})}),[]),R=(0,n.hb)((e=>{S(e)}),[S]);function x(e){if(!e)return P("Loading");const{visibility:t,shouldAllowPremium:a,botsPrivacy:n}=e,s="everybody"===t,i="allow"===n&&!s,r=e.blockChatIds.length+e.blockUserIds.length,o=e.allowChatIds.length+e.allowUserIds.length,l=[];r&&l.push(`-${r}`),o&&!s&&l.push(`+${o}`);const c=[i?M("PrivacyValueBots"):"",M.conjunction(l)].filter(Boolean).join(" ");if(i&&!s)return c;if(a)return P(c?"ContactsAndPremium":"PrivacyPremium");switch(t){case"everybody":return`${P("P2PEverybody")} ${c}`;case"contacts":return`${P("P2PContacts")} ${c}`;case"nobody":return`${P("P2PNobody")} ${c}`}}return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item pt-3"},n.Ay.createElement(Wa.A,{icon:"delete-user",narrow:!0,onClick:()=>g(i.VS.PrivacyBlockedUsers)},P("BlockedUsers"),n.Ay.createElement("span",{className:"settings-item__current-value"},l||"")),p&&n.Ay.createElement(Wa.A,{icon:"key",narrow:!0,onClick:()=>g(o?i.VS.PasscodeEnabled:i.VS.PasscodeDisabled)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("Passcode")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},P(o?"PasswordOn":"PasswordOff")))),n.Ay.createElement(Wa.A,{icon:"lock",narrow:!0,onClick:()=>g(r?i.VS.TwoFaEnabled:i.VS.TwoFaDisabled)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("TwoStepVerification")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},P(r?"PasswordOn":"PasswordOff")))),c>0&&n.Ay.createElement(Wa.A,{icon:"web",narrow:!0,onClick:()=>g(i.VS.ActiveWebsites)},P("PrivacySettings.WebSessions"),n.Ay.createElement("span",{className:"settings-item__current-value"},c))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:P.isRtl?"rtl":void 0},P("PrivacyTitle")),n.Ay.createElement(Wa.A,{narrow:!0,className:"no-icon",onClick:()=>g(i.VS.PrivacyPhoneNumber)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("PrivacyPhoneTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.phoneNumber)))),n.Ay.createElement(Wa.A,{narrow:!0,className:"no-icon",onClick:()=>g(i.VS.PrivacyLastSeen)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("LastSeenTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.lastSeen)))),n.Ay.createElement(Wa.A,{narrow:!0,className:"no-icon",onClick:()=>g(i.VS.PrivacyProfilePhoto)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("PrivacyProfilePhotoTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.profilePhoto)))),n.Ay.createElement(Wa.A,{narrow:!0,className:"no-icon",onClick:()=>g(i.VS.PrivacyBio)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("PrivacyBio")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.bio)))),n.Ay.createElement(Wa.A,{narrow:!0,className:"no-icon",onClick:()=>g(i.VS.PrivacyBirthday)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("PrivacyBirthday")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.birthday)))),n.Ay.createElement(Wa.A,{narrow:!0,className:"no-icon",onClick:()=>g(i.VS.PrivacyGifts)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},M("PrivacyGifts")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.gifts)))),n.Ay.createElement(Wa.A,{narrow:!0,className:"no-icon",onClick:()=>g(i.VS.PrivacyForwarding)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("PrivacyForwardsTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.forwards)))),n.Ay.createElement(Wa.A,{narrow:!0,className:"no-icon",onClick:()=>g(i.VS.PrivacyPhoneCall)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("WhoCanCallMe")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.phoneCall)))),n.Ay.createElement(Wa.A,{narrow:!0,allowDisabledClick:!0,rightElement:a&&n.Ay.createElement(em.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>g(i.VS.PrivacyVoiceMessages)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("PrivacyVoiceMessagesTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.voiceMessages)))),n.Ay.createElement(Wa.A,{narrow:!0,rightElement:a&&n.Ay.createElement(em.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>g(i.VS.PrivacyMessages)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("PrivacyMessagesTitle")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},P(h?"PrivacyMessagesContactsAndPremium":"P2PEverybody")))),n.Ay.createElement(Wa.A,{narrow:!0,className:"no-icon",onClick:()=>g(i.VS.PrivacyGroupChats)},n.Ay.createElement("div",{className:"multiline-item"},n.Ay.createElement("span",{className:"title"},P("WhoCanAddMe")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},x(v.chatInvite))))),m&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:P.isRtl?"rtl":void 0},P("lng_settings_sensitive_title")),n.Ay.createElement(js.A,{label:P("lng_settings_sensitive_disable_filtering"),subLabel:P("lng_settings_sensitive_about"),checked:Boolean(d),disabled:!m,onCheck:R})),u&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:P.isRtl?"rtl":void 0},P("NewChatsFromNonContacts")),n.Ay.createElement(js.A,{label:P("ArchiveAndMute"),subLabel:P("ArchiveAndMuteInfo"),checked:Boolean(A),onCheck:B})),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:P.isRtl?"rtl":void 0},P("lng_settings_window_system")),n.Ay.createElement(js.A,{label:P("lng_settings_title_chat_name"),checked:Boolean(y),onCheck:L})))}))),ou=(0,n.ph)((0,s.EK)((e=>{const{users:{byId:t},blocked:{ids:a},contactList:n,currentUserId:s}=e;return{usersById:t,blockedIds:a,contactIds:n?.userIds,localContactIds:(0,c.nTw)(e).userSearch.localUserIds,currentUserId:s}}))((e=>{let{usersById:t,blockedIds:a,contactIds:i,localContactIds:r,currentUserId:o,isOpen:c,onClose:d}=e;const{setUserSearchQuery:m,blockUser:u}=(0,s.ko)(),A=(0,T.A)(),[h,y]=(0,n.J0)("");(0,n.vJ)((()=>{m({query:h})}),[h,m]);const p=(0,n.Kr)((()=>{const e=(0,on.Am)([...i||[],...r||[]].filter((e=>e!==o&&!a.includes(e))));return(0,rn.PU)({ids:e,query:h,type:"user"}).sort(((e,a)=>{const n=(0,l.YgS)(t[e])||"",s=(0,l.YgS)(t[a])||"";return n.localeCompare(s)}))}),[a,i,o,h,r,t]),v=(0,n.hb)((e=>{u({userId:e}),d()}),[d]);return n.Ay.createElement(Ps,{isOpen:c,chatOrUserIds:p,searchPlaceholder:A("BlockedUsers.BlockUser"),search:h,onSearchChange:y,onSelectChatOrUser:v,onClose:d})}))),lu=(0,n.ph)((0,s.EK)((e=>{const{chats:{byId:t},users:{byId:a},blocked:{ids:n},countryList:{phoneCodes:s}}=e;return{chatsByIds:t,usersByIds:a,blockedIds:n,phoneCodeList:s}}))((e=>{let{isActive:t,onReset:a,chatsByIds:i,usersByIds:o,blockedIds:c,phoneCodeList:d}=e;const{unblockUser:m}=(0,s.ko)(),u=(0,T.A)(),[A,h,y]=(0,I.A)(),p=(0,n.hb)((e=>{m({userId:e})}),[m]);(0,ve.A)({isActive:t,onBack:a});const v=(0,n.Kr)((()=>c.reduce(((e,t)=>{const a=(0,l.L8L)(t)?o[t]:void 0,n=a&&!a.phoneNumber&&(0,l.KlG)(a);return n&&(e[t]=n),e}),{})),[c,o]);return n.Ay.createElement("div",{className:"settings-fab-wrapper"},n.Ay.createElement("div",{className:"settings-content infinite-scroll"},n.Ay.createElement("div",{className:"settings-item no-border"},n.Ay.createElement("p",{className:"settings-item-description-larger mt-0 mb-2",dir:u.isRtl?"rtl":void 0},u("BlockedUsersInfo"))),n.Ay.createElement("div",{className:"chat-list custom-scroll"},c?.length?n.Ay.createElement("div",{className:"scroll-container settings-item"},c.map(((e,t)=>function(e,t,a){const s=(0,l.L8L)(e),c=o[e],m=i[e],u=c||m,A=(0,de.A)("Chat chat-item-clickable blocked-list-item small-icon",s?"private":"group"),h=v[e];return n.Ay.createElement(Wa.A,{key:`blocked_${e}`,className:A,ripple:!0,narrow:!0,contextActions:[{title:"Unblock",icon:"unlock",handler:()=>{p(e)}}],style:`top: ${(0+t)*r.yq1}px;`},n.Ay.createElement(wt.A,{size:"medium",peer:u}),n.Ay.createElement("div",{className:"contact-info",dir:"auto"},u&&n.Ay.createElement(Ss.A,{peer:u}),c?.phoneNumber&&n.Ay.createElement("div",{className:"contact-phone",dir:"auto"},(0,Zs.Ox)(d,c.phoneNumber)),h&&n.Ay.createElement("div",{className:"contact-username",dir:"auto"},"@",h)))}(e,t)))):c&&!c.length?n.Ay.createElement("div",{className:"no-results",dir:"auto"},u("NoBlocked")):n.Ay.createElement(fs.A,{key:"loading"}))),n.Ay.createElement(un.A,{isShown:!0,className:"block-user-button",onClick:h,ariaLabel:u("BlockContact")},n.Ay.createElement(q.A,{name:"add"})),n.Ay.createElement(ou,{isOpen:A,onClose:y}))})));function cu(e){switch(e){case i.VS.PrivacyPhoneNumber:case i.VS.PrivacyPhoneNumberAllowedContacts:case i.VS.PrivacyPhoneNumberDeniedContacts:return"phoneNumber";case i.VS.PrivacyLastSeen:case i.VS.PrivacyLastSeenAllowedContacts:case i.VS.PrivacyLastSeenDeniedContacts:return"lastSeen";case i.VS.PrivacyProfilePhoto:case i.VS.PrivacyProfilePhotoAllowedContacts:case i.VS.PrivacyProfilePhotoDeniedContacts:return"profilePhoto";case i.VS.PrivacyBio:case i.VS.PrivacyBioAllowedContacts:case i.VS.PrivacyBioDeniedContacts:return"bio";case i.VS.PrivacyBirthday:case i.VS.PrivacyBirthdayAllowedContacts:case i.VS.PrivacyBirthdayDeniedContacts:return"birthday";case i.VS.PrivacyGifts:case i.VS.PrivacyGiftsAllowedContacts:case i.VS.PrivacyGiftsDeniedContacts:return"gifts";case i.VS.PrivacyForwarding:case i.VS.PrivacyForwardingAllowedContacts:case i.VS.PrivacyForwardingDeniedContacts:return"forwards";case i.VS.PrivacyVoiceMessages:case i.VS.PrivacyVoiceMessagesAllowedContacts:case i.VS.PrivacyVoiceMessagesDeniedContacts:return"voiceMessages";case i.VS.PrivacyGroupChats:case i.VS.PrivacyGroupChatsAllowedContacts:case i.VS.PrivacyGroupChatsDeniedContacts:return"chatInvite";case i.VS.PrivacyPhoneCall:case i.VS.PrivacyPhoneCallAllowedContacts:case i.VS.PrivacyPhoneCallDeniedContacts:return"phoneCall";case i.VS.PrivacyPhoneP2P:case i.VS.PrivacyPhoneP2PAllowedContacts:case i.VS.PrivacyPhoneP2PDeniedContacts:return"phoneP2P";case i.VS.PrivacyAddByPhone:return"addByPhone"}}const du=(0,n.ph)((0,s.EK)((e=>({isCurrentUserPremium:(0,c.g29)(e),shouldHideReadMarks:Boolean((0,c.KIM)(e))})))((e=>{let{isCurrentUserPremium:t,shouldHideReadMarks:a,visibility:i}=e;const{updateGlobalPrivacySettings:r,openPremiumModal:o}=(0,s.ko)(),l=(0,T.A)(),c="nobody"===i||"contacts"===i,d=(0,M.A)((e=>r({shouldHideReadMarks:e}))),m=(0,M.A)((()=>{o({initialSection:"last_seen"})}));return n.Ay.createElement(n.Ay.Fragment,null,c&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(js.A,{label:l("HideReadTime"),checked:a,onCheck:d}),n.Ay.createElement("p",{className:"settings-item-description-larger",dir:l.isRtl?"rtl":void 0},(0,kt.A)(l("HideReadTimeInfo"),["br"]))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(Wa.A,{leftElement:n.Ay.createElement(em.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:m},l(t?"PrivacyLastSeenPremiumForPremium":"PrivacyLastSeenPremium")),n.Ay.createElement("p",{className:"settings-item-description-larger premium-info",dir:l.isRtl?"rtl":void 0},l(t?"PrivacyLastSeenPremiumInfoForPremium":"PrivacyLastSeenPremiumInfo"))))})));var mu=a(91356);const uu=(0,n.ph)((e=>{let{currentUserId:t,hasCurrentUserFullInfo:a,currentUserFallbackPhoto:i}=e;const{loadFullUser:r,uploadProfilePhoto:o,deleteProfilePhoto:l,showNotification:c}=(0,s.ko)(),d=(0,T.A)(),[m,u,A]=(0,I.A)(!1),h=(0,n.li)(null);(0,n.vJ)((()=>{a||r({userId:t})}),[a,t,r]);const y=(0,n.hb)((e=>{o({file:e,isFallback:!0}),c({message:d("Privacy.ProfilePhoto.PublicPhotoSuccess")})}),[d,c,o]),p=(0,n.hb)((()=>{A(),l({photo:i})}),[A,l,i]),v=(0,n.hb)((()=>{h.current?.click()}),[]);return n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(Wa.A,{narrow:!0,icon:"camera-add",onClick:v},n.Ay.createElement(mu.A,{onChange:y,inputRef:h}),d(i?"Privacy.ProfilePhoto.UpdatePublicPhoto":"Privacy.ProfilePhoto.SetPublicPhoto")),i&&n.Ay.createElement(Wa.A,{narrow:!0,leftElement:n.Ay.createElement(wt.A,{photo:i,size:"mini",className:"Qvhl9Jjv"}),onClick:u,destructive:!0},d(i.isVideo?"Privacy.ProfilePhoto.RemovePublicVideo":"Privacy.ProfilePhoto.RemovePublicPhoto"),n.Ay.createElement(tn.A,{isOpen:m,onClose:A,text:d("Privacy.ResetPhoto.Confirm"),confirmLabel:d("Delete"),confirmHandler:p,confirmIsDestructive:!0})),n.Ay.createElement("p",{className:"settings-item-description-larger",dir:d.isRtl?"rtl":void 0},d("Privacy.ProfilePhoto.PublicPhotoInfo")))}));function Au(e){let{screen:t,privacy:a,onScreenSelect:r,isPremiumRequired:o}=e;const{setPrivacyVisibility:l}=(0,s.ko)(),c=(0,T.A)(),d=(0,Us.A)(),m=(0,n.Kr)((()=>{const e=t!==i.VS.PrivacyAddByPhone,a=[{value:"everybody",label:c("P2PEverybody")},{value:"contacts",label:o?n.Ay.createElement(am,{label:c("P2PContacts")}):c("P2PContacts"),hidden:o}];return e&&a.push({value:"nobody",label:o?n.Ay.createElement(am,{label:c("P2PNobody")}):c("P2PNobody"),hidden:o}),a}),[c,t,o]),u=(0,n.Kr)((()=>t===i.VS.PrivacyAddByPhone?{shouldShowDenied:!1,shouldShowAllowed:!1}:{shouldShowDenied:"nobody"!==a?.visibility,shouldShowAllowed:"everybody"!==a?.visibility}),[a,t]),A=cu(t),h=(0,n.Kr)((()=>{switch(t){case i.VS.PrivacyGifts:return d("PrivacyGiftsInfo");case i.VS.PrivacyLastSeen:return c("CustomHelp");case i.VS.PrivacyAddByPhone:return c("everybody"===a?.visibility?"PrivacyPhoneInfo":"PrivacyPhoneInfo3");case i.VS.PrivacyVoiceMessages:return c("PrivacyVoiceMessagesInfo");default:return}}),[c,d,t,a]),y=(0,n.Kr)((()=>{switch(t){case i.VS.PrivacyPhoneNumber:return c("PrivacyPhoneTitle");case i.VS.PrivacyAddByPhone:return c("PrivacyPhoneTitle2");case i.VS.PrivacyLastSeen:return c("LastSeenTitle");case i.VS.PrivacyProfilePhoto:return c("PrivacyProfilePhotoTitle");case i.VS.PrivacyBio:return c("PrivacyBioTitle");case i.VS.PrivacyBirthday:return c("PrivacyBirthdayTitle");case i.VS.PrivacyGifts:return d("PrivacyGiftsTitle");case i.VS.PrivacyForwarding:return c("PrivacyForwardsTitle");case i.VS.PrivacyVoiceMessages:return c("PrivacyVoiceMessagesTitle");case i.VS.PrivacyGroupChats:return c("WhoCanAddMe");case i.VS.PrivacyPhoneCall:return c("WhoCanCallMe");case i.VS.PrivacyPhoneP2P:return c("PrivacyP2P");default:return}}),[c,d,t]),p=(0,M.A)(((e,t,a,n)=>{const s=e?.length||0,i=t?.length||0,r="allow"===n;if(!s&&!i&&!r)return c(a?"PrivacyPremium":"EditAdminAddUsers");if(a)return c("ContactsAndPremium");const o=s>0?c("Users",s):void 0,l=i>0?c("Chats",i):void 0;return[r?d("PrivacyValueBots"):"",d.conjunction([o,l].filter(Boolean))].filter(Boolean).join(" ")})),v=(0,n.Kr)((()=>p(a?.allowUserIds,a?.allowChatIds,a?.shouldAllowPremium,a?.botsPrivacy)),[a]),g=(0,n.Kr)((()=>p(a?.blockUserIds,a?.blockChatIds)),[a]),E=(0,n.hb)((e=>{l({privacyKey:A,visibility:e})}),[A]),b=(()=>{switch(t){case i.VS.PrivacyPhoneNumber:return i.VS.PrivacyPhoneNumberAllowedContacts;case i.VS.PrivacyLastSeen:return i.VS.PrivacyLastSeenAllowedContacts;case i.VS.PrivacyProfilePhoto:return i.VS.PrivacyProfilePhotoAllowedContacts;case i.VS.PrivacyBio:return i.VS.PrivacyBioAllowedContacts;case i.VS.PrivacyBirthday:return i.VS.PrivacyBirthdayAllowedContacts;case i.VS.PrivacyGifts:return i.VS.PrivacyGiftsAllowedContacts;case i.VS.PrivacyForwarding:return i.VS.PrivacyForwardingAllowedContacts;case i.VS.PrivacyPhoneCall:return i.VS.PrivacyPhoneCallAllowedContacts;case i.VS.PrivacyPhoneP2P:return i.VS.PrivacyPhoneP2PAllowedContacts;case i.VS.PrivacyVoiceMessages:return i.VS.PrivacyVoiceMessagesAllowedContacts;default:return i.VS.PrivacyGroupChatsAllowedContacts}})(),C=(()=>{switch(t){case i.VS.PrivacyPhoneNumber:return i.VS.PrivacyPhoneNumberDeniedContacts;case i.VS.PrivacyLastSeen:return i.VS.PrivacyLastSeenDeniedContacts;case i.VS.PrivacyProfilePhoto:return i.VS.PrivacyProfilePhotoDeniedContacts;case i.VS.PrivacyBio:return i.VS.PrivacyBioDeniedContacts;case i.VS.PrivacyBirthday:return i.VS.PrivacyBirthdayDeniedContacts;case i.VS.PrivacyGifts:return i.VS.PrivacyGiftsDeniedContacts;case i.VS.PrivacyForwarding:return i.VS.PrivacyForwardingDeniedContacts;case i.VS.PrivacyPhoneCall:return i.VS.PrivacyPhoneCallDeniedContacts;case i.VS.PrivacyPhoneP2P:return i.VS.PrivacyPhoneP2PDeniedContacts;case i.VS.PrivacyVoiceMessages:return i.VS.PrivacyVoiceMessagesDeniedContacts;default:return i.VS.PrivacyGroupChatsDeniedContacts}})();return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:c.isRtl?"rtl":void 0},y),n.Ay.createElement(Z.A,{name:`visibility-${A}`,options:m,onChange:E,selected:a?.visibility}),h&&n.Ay.createElement("p",{className:"settings-item-description-larger",dir:c.isRtl?"rtl":void 0},h)),!o&&(u.shouldShowAllowed||u.shouldShowDenied)&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:c.isRtl?"rtl":void 0},c("PrivacyExceptions")),u.shouldShowAllowed&&n.Ay.createElement(Wa.A,{narrow:!0,icon:"add-user",onClick:()=>{r(b)}},n.Ay.createElement("div",{className:"multiline-item full-size"},n.Ay.createElement("span",{className:"title"},c("AlwaysAllow")),n.Ay.createElement("span",{className:"subtitle"},v))),u.shouldShowDenied&&n.Ay.createElement(Wa.A,{narrow:!0,icon:"delete-user",onClick:()=>{r(C)}},n.Ay.createElement("div",{className:"multiline-item full-size"},n.Ay.createElement("span",{className:"title"},c("NeverAllow")),n.Ay.createElement("span",{className:"subtitle"},g)))),o&&n.Ay.createElement(tm,null))}const hu=(0,n.ph)((0,s.EK)(((e,t)=>{let a,n,{screen:s}=t;const{currentUserId:r,settings:{privacy:o}}=e,l=(0,c.vGo)(e,r);switch(s){case i.VS.PrivacyPhoneNumber:a=o.phoneNumber,n=o.addByPhone;break;case i.VS.PrivacyLastSeen:a=o.lastSeen;break;case i.VS.PrivacyProfilePhoto:a=o.profilePhoto;break;case i.VS.PrivacyBio:a=o.bio;break;case i.VS.PrivacyBirthday:a=o.birthday;break;case i.VS.PrivacyGifts:a=o.gifts;break;case i.VS.PrivacyPhoneP2P:case i.VS.PrivacyPhoneCall:a=o.phoneCall,n=o.phoneP2P;break;case i.VS.PrivacyForwarding:a=o.forwards;break;case i.VS.PrivacyVoiceMessages:a=o.voiceMessages;break;case i.VS.PrivacyGroupChats:a=o.chatInvite}return a?{primaryPrivacy:a,secondaryPrivacy:n,currentUserId:r,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto,isPremiumRequired:s===i.VS.PrivacyVoiceMessages&&!(0,c.g29)(e)}:{currentUserId:r,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto}}))((e=>{let{screen:t,isActive:a,primaryPrivacy:s,secondaryPrivacy:r,currentUserId:o,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c,isPremiumRequired:d,onScreenSelect:m,onReset:u}=e;(0,ve.A)({isActive:a,onBack:u});const A=(0,n.Kr)((()=>{switch(t){case i.VS.PrivacyPhoneCall:return i.VS.PrivacyPhoneP2P;case i.VS.PrivacyPhoneNumber:return"nobody"===s?.visibility?i.VS.PrivacyAddByPhone:void 0;default:return}}),[s,t]);return n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement(Au,{screen:t,privacy:s,onScreenSelect:m,isPremiumRequired:d}),t===i.VS.PrivacyProfilePhoto&&"everybody"!==s?.visibility&&n.Ay.createElement(uu,{currentUserId:o,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c}),t===i.VS.PrivacyLastSeen&&n.Ay.createElement(du,{visibility:s?.visibility}),A&&n.Ay.createElement(Au,{screen:A,privacy:r,onScreenSelect:m}))}))),yu=[xd.lw];function pu(e,t){const{privacy:a}=e.settings;switch(t){case i.VS.PrivacyPhoneNumberAllowedContacts:case i.VS.PrivacyPhoneNumberDeniedContacts:return a.phoneNumber;case i.VS.PrivacyLastSeenAllowedContacts:case i.VS.PrivacyLastSeenDeniedContacts:return a.lastSeen;case i.VS.PrivacyProfilePhotoAllowedContacts:case i.VS.PrivacyProfilePhotoDeniedContacts:return a.profilePhoto;case i.VS.PrivacyBioAllowedContacts:case i.VS.PrivacyBioDeniedContacts:return a.bio;case i.VS.PrivacyBirthdayAllowedContacts:case i.VS.PrivacyBirthdayDeniedContacts:return a.birthday;case i.VS.PrivacyGiftsAllowedContacts:case i.VS.PrivacyGiftsDeniedContacts:return a.gifts;case i.VS.PrivacyPhoneCallAllowedContacts:case i.VS.PrivacyPhoneCallDeniedContacts:return a.phoneCall;case i.VS.PrivacyPhoneP2PAllowedContacts:case i.VS.PrivacyPhoneP2PDeniedContacts:return a.phoneP2P;case i.VS.PrivacyForwardingAllowedContacts:case i.VS.PrivacyForwardingDeniedContacts:return a.forwards;case i.VS.PrivacyVoiceMessagesAllowedContacts:case i.VS.PrivacyVoiceMessagesDeniedContacts:return a.voiceMessages;case i.VS.PrivacyGroupChatsDeniedContacts:case i.VS.PrivacyGroupChatsAllowedContacts:return a.chatInvite}}const vu=(0,n.ph)((0,s.EK)(((e,t)=>{let{screen:a}=t;return{currentUserId:e.currentUserId,settings:pu(e,a)}}))((e=>{let{isAllowList:t,withPremiumCategory:a,withMiniAppsCategory:o,screen:c,isActive:d,currentUserId:m,settings:u,onScreenSelect:A,onReset:h}=e;const{setPrivacySettings:y}=(0,s.ko)(),p=(0,T.A)(),v=(0,Us.A)(),g=(0,n.Kr)((()=>({isCustomPeer:!0,type:"bots",title:v("PrivacyValueBots"),avatarIcon:"bots",isAvatarSquare:!0,peerColorId:6})),[v]),E=(0,n.Kr)((()=>[g]),[g]),b=(0,n.Kr)((()=>u?t?[...u.allowUserIds,...u.allowChatIds]:[...u.blockUserIds,...u.blockChatIds]:[]),[t,u]),C=(0,n.Kr)((()=>u?u.shouldAllowPremium?[xd.lw.type]:"allow"===u.botsPrivacy&&t?[g.type]:[]:[]),[u,t,g]),[f,S]=(0,n.J0)(""),[k,w]=(0,n.J0)(!1),[N,I]=(0,n.J0)(b),[P,M]=(0,n.J0)(C);(0,n.vJ)((()=>{d||(I(b),M(C))}),[d,C,b]);const B=(0,Fd.Rh)(r.DSF),L=(0,Fd.Rh)(r._E9),R=(0,n.Kr)((()=>{const e=(0,s.mS)().chats.byId,t=(0,s.mS)().users.byId,a=(0,on.Am)([...B||[],...L||[]]).filter((a=>{const n=e[a],s=t[a],i=s&&(0,l.PL2)(s),o=n&&(0,l.WXB)(n);return a!==m&&a!==r.zv8&&!o&&!i})),n=(0,rn.PU)({ids:a,query:f});return f?n:(0,on.Am)([...b,...a])}),[B,L,b,f,m]),x=(0,n.hb)((e=>{M(e),w(!0)}),[]),F=(0,n.hb)((e=>{I(e),w(!0)}),[]),V=(0,n.hb)((()=>{y({privacyKey:cu(c),isAllowList:Boolean(t),updatedIds:N,isPremiumAllowed:P.includes(xd.lw.type)||void 0,botsPrivacy:o?P.includes(g.type)?"allow":"disallow":"none"}),A(i.VS.Privacy)}),[t,o,P,N,A,c,g]);return(0,ve.A)({isActive:d,onBack:h}),n.Ay.createElement("div",{className:"NewChat-inner step-1"},n.Ay.createElement(cn.A,{categories:a?yu:o&&t?E:void 0,itemIds:R||[],selectedIds:N,selectedCategories:P,filterValue:f,filterPlaceholder:p(t?"AlwaysAllowPlaceholder":"NeverAllowPlaceholder"),categoryPlaceholderKey:"PrivacyUserTypes",searchInputId:"new-group-picker-search",isSearchable:!0,onSelectedIdsChange:F,onSelectedCategoriesChange:x,onFilterChange:S,allowMultiple:!0,itemInputType:"checkbox",withDefaultPadding:!0,withStatus:!0}),n.Ay.createElement(un.A,{isShown:k,onClick:V,ariaLabel:p(t?"AlwaysAllow":"NeverAllow")},n.Ay.createElement(q.A,{name:"check"})))}))),gu=(0,n.ph)((0,s.EK)((e=>{const{config:t,reactions:a}=e;return{availableReactions:a.availableReactions,selectedReaction:t?.defaultReaction}}))((e=>{let{isActive:t,availableReactions:a,selectedReaction:i,onReset:r}=e;const{setDefaultReaction:o}=(0,s.ko)();(0,ve.A)({isActive:t,onBack:r});const l=(0,n.Kr)((()=>(a||[]).filter((e=>!e.isInactive)).map((e=>({label:n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(ms.A,{reaction:e.reaction,availableReactions:a}),e.title),value:e.reaction.emoticon})))),[a]),c=(0,n.hb)((e=>{o({reaction:{type:"emoji",emoticon:e}})}),[o]);return n.Ay.createElement("div",{className:"settings-content settings-item custom-scroll settings-quick-reaction"},n.Ay.createElement(Z.A,{name:"quick-reaction-settings",options:l,selected:i,onChange:c,withIcon:!0}))}))),Eu=1.5*A.$,bu=(0,n.ph)((0,s.EK)((e=>({...(0,on.Up)(e.settings.byKey,["shouldSuggestStickers","shouldUpdateStickerSetOrder"]),addedSetIds:e.stickers.added.setIds,customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,defaultReaction:e.config?.defaultReaction,availableReactions:e.reactions.availableReactions,canPlayAnimatedEmojis:(0,c.BWX)(e)})))((e=>{let{isActive:t,addedSetIds:a,customEmojiSetIds:r,stickerSetsById:o,defaultReaction:l,shouldSuggestStickers:c,shouldUpdateStickerSetOrder:d,availableReactions:m,canPlayAnimatedEmojis:u,onReset:A,onScreenSelect:h}=e;const{setSettingOption:y,openStickerSet:p}=(0,s.ko)(),v=(0,T.A)(),g=(0,n.li)(null),{observe:E}=(0,zo.BL)({rootRef:g}),b=(0,n.hb)((e=>{p({stickerSetInfo:e.stickerSetInfo})}),[p]),C=(0,n.hb)((e=>{y({shouldUpdateStickerSetOrder:e})}),[y]),f=(0,n.hb)((e=>{y({shouldSuggestStickers:e})}),[y]),S=(0,n.Kr)((()=>a&&Object.values((0,on.Up)(o,a))),[a,o]);return(0,ve.A)({isActive:t,onBack:A}),n.Ay.createElement("div",{className:"settings-content custom-scroll"},n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement(js.A,{label:v("SuggestStickers"),checked:c,onCheck:f}),n.Ay.createElement(Wa.A,{narrow:!0,onClick:()=>h(i.VS.CustomEmoji),icon:"smile"},v("StickersList.EmojiItem"),r&&n.Ay.createElement("span",{className:"settings-item__current-value"},r.length)),l&&n.Ay.createElement(Wa.A,{className:"SettingsDefaultReaction",narrow:!0,onClick:()=>h(i.VS.QuickReaction)},n.Ay.createElement(ms.A,{reaction:l,className:"current-default-reaction",size:Eu,availableReactions:m}),n.Ay.createElement("div",{className:"title"},v("DoubleTapSetting")))),n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:v.isRtl?"rtl":void 0},v("InstalledStickers.DynamicPackOrder")),n.Ay.createElement(js.A,{label:v("InstalledStickers.DynamicPackOrder"),checked:d,onCheck:C}),n.Ay.createElement("p",{className:"settings-item-description mt-3",dir:"auto"},v("InstalledStickers.DynamicPackOrderInfo"))),S&&n.Ay.createElement("div",{className:"settings-item"},n.Ay.createElement("h4",{className:"settings-item-header",dir:v.isRtl?"rtl":void 0},v("ChooseStickerMyStickerSets")),n.Ay.createElement("div",{ref:g},S.map((e=>n.Ay.createElement(Am,{key:e.id,stickerSet:e,observeIntersection:E,onClick:b,noPlay:!u})))),n.Ay.createElement("p",{className:"settings-item-description mt-3",dir:"auto"},(0,kt.A)(v("StickersBotInfo"),["links"]))))}))),Cu=(0,n.ph)((e=>{let{isActive:t,onReset:a,onScreenSelect:s}=e;const o=(0,T.A)(),l=(0,n.hb)((()=>{s(i.VS.Privacy)}),[s]);return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(jd.A,{size:r.r2x,tgsUrl:rl.w.Congratulations,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},o("TwoStepVerificationPasswordSetInfo"))),n.Ay.createElement("div",{className:"settings-item pt-2"},n.Ay.createElement(W.A,{onClick:l},o("TwoStepVerificationPasswordReturnSettings"))))}));var fu=a(79577);const Su=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.nTw)(e).recoveryEmail;return{animatedEmoji:(0,c.oei)(e,"💌"),codeLength:e.twoFaSettings.waitingEmailCodeLength,recoveryEmail:t}}))((e=>{let{animatedEmoji:t,codeLength:a,isLoading:s,error:i,clearError:r,onSubmit:o,isActive:l,onReset:c,recoveryEmail:d}=e;const m=(0,n.li)(null),{isMobile:u}=(0,w.Ay)(),A=u?550:400,[h,y]=(0,n.J0)("");(0,n.vJ)((()=>{b.TF||setTimeout((()=>{m.current.focus()}),A)}),[A]);const p=(0,T.A)();(0,ve.A)({isActive:l,onBack:c});const v=(0,n.hb)((e=>{i&&r&&r();const t=e.target.value.slice(0,a);t.length===a&&o(t),y(t),e.target.value=t}),[r,a,i,o]);return n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(fu.A,{sticker:t,size:160,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},p("TwoStepAuth.ConfirmEmailDescription",d))),n.Ay.createElement("div",{className:"settings-item pt-2"},n.Ay.createElement(Y.A,{value:h,ref:m,inputMode:"decimal",label:p("YourEmailCode"),error:i,onChange:v}),s&&n.Ay.createElement(fs.A,null)))}))),ku=(0,n.ph)((e=>{let{isActive:t,onReset:a,onScreenSelect:s}=e;const r=(0,T.A)();return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(ol.A,{tgsUrl:rl.w.Lock,previewUrl:Yd,size:160,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},(0,kt.A)(r("EnabledPasswordText"),["br"]))),n.Ay.createElement("div",{className:"settings-item pt-2"},n.Ay.createElement(Wa.A,{icon:"edit",onClick:()=>s(i.VS.TwoFaChangePasswordCurrent)},r("ChangePassword")),n.Ay.createElement(Wa.A,{icon:"password-off",onClick:()=>s(i.VS.TwoFaTurnOff)},r("TurnPasswordOff")),n.Ay.createElement(Wa.A,{icon:"email",onClick:()=>s(i.VS.TwoFaRecoveryEmailCurrentPassword)},r("SetRecoveryEmail"))))})),wu=(0,n.ph)((0,s.EK)(((e,t)=>{let{icon:a}=t;return{animatedEmoji:(0,c.oei)(e,"email"===a?"💌":"💡")}}))((e=>{let{animatedEmoji:t,type:a="text",isLoading:s,error:i,placeholder:r,shouldConfirm:o,clearError:l,onSubmit:c,isActive:d,onReset:m}=e;const u=(0,n.li)(null),{isMobile:A}=(0,w.Ay)(),h=A?550:400,[y,p]=(0,n.J0)(""),[v,g,E]=(0,I.A)(!1);(0,n.vJ)((()=>{b.TF||setTimeout((()=>{u.current.focus()}),h)}),[h]);const C=(0,n.hb)((e=>{i&&l&&l(),p(e.target.value)}),[l,i]),f=(0,n.hb)((()=>{c()}),[c]),S=(0,n.hb)((()=>{E(),c()}),[c,E]),k=(0,T.A)();return(0,ve.A)({isActive:d,onBack:m}),n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(fu.A,{sticker:t,size:160,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},k("RecoveryEmailSubtitle"))),n.Ay.createElement("div",{className:"settings-item pt-2"},n.Ay.createElement("form",{action:"",onSubmit:e=>{e.preventDefault(),u.current&&c(y)}},n.Ay.createElement(Y.A,{ref:u,value:y,inputMode:a,label:r,error:i,onChange:C}),y?n.Ay.createElement(W.A,{type:"submit",isLoading:s,ripple:!0},k("Continue")):n.Ay.createElement(W.A,{isText:!0,isLoading:s,ripple:!0,onClick:o?g:f},k("YourEmailSkip"))),o&&n.Ay.createElement(Q.A,{className:"narrow",isOpen:v,title:k("YourEmailSkipWarning"),onClose:E},(0,kt.A)(k("YourEmailSkipWarningText"),["br","simple_markdown"]),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(W.A,{color:"danger",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:S},k("YourEmailSkip")),n.Ay.createElement(W.A,{color:"primary",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:E},k("Cancel"))))))}))),Nu=(0,n.ph)((e=>{let{isActive:t,onReset:a,onStart:s}=e;const i=(0,T.A)();return(0,ve.A)({isActive:t,onBack:a}),n.Ay.createElement("div",{className:"settings-content two-fa custom-scroll"},n.Ay.createElement("div",{className:"settings-content-header no-border"},n.Ay.createElement(ol.A,{tgsUrl:rl.w.Lock,previewUrl:Yd,size:160,className:"settings-content-icon"}),n.Ay.createElement("p",{className:"settings-item-description mb-3",dir:"auto"},i("SetAdditionalPasswordInfo"))),n.Ay.createElement("div",{className:"settings-item pt-0"},n.Ay.createElement(W.A,{onClick:s},i("EditAdminTransferSetPassword"))))})),Iu=(0,n.ph)((0,s.EK)((e=>({...e.twoFaSettings})))((e=>{let{currentScreen:t,shownScreen:a,state:r,hint:o,isLoading:l,errorKey:c,waitingEmailCodeLength:d,dispatch:m,isActive:u,onScreenSelect:A,onReset:h}=e;const{updatePassword:y,checkPassword:p,clearTwoFaError:v,updateRecoveryEmail:g,provideTwoFaEmailCode:E,clearPassword:b}=(0,s.ko)(),C=(0,Us.A)(),f=(0,T.A)();(0,n.vJ)((()=>{d&&(t===i.VS.TwoFaNewPasswordEmail?A(i.VS.TwoFaNewPasswordEmailCode):t===i.VS.TwoFaRecoveryEmail&&A(i.VS.TwoFaRecoveryEmailCode))}),[t,A,d]);const S=(0,n.hb)((()=>{m({type:"reset"}),A(i.VS.TwoFaNewPassword)}),[m,A]),k=(0,n.hb)((e=>{m({type:"setPassword",payload:e}),A(i.VS.TwoFaNewPasswordConfirm)}),[m,A]),w=(0,n.hb)((()=>{A(i.VS.TwoFaNewPasswordHint)}),[A]),N=(0,n.hb)((e=>{m({type:"setHint",payload:e}),A(i.VS.TwoFaNewPasswordEmail)}),[m,A]),I=(0,n.hb)((e=>{m({type:"setEmail",payload:e}),y({...r,email:e,onSuccess:()=>{A(i.VS.TwoFaCongratulations)}})}),[m,A,r,y]),P=(0,n.hb)((e=>{m({type:"setCurrentPassword",payload:e}),p({currentPassword:e,onSuccess:()=>{A(i.VS.TwoFaChangePasswordNew)}})}),[p,m,A]),M=(0,n.hb)((e=>{m({type:"setPassword",payload:e}),A(i.VS.TwoFaChangePasswordConfirm)}),[m,A]),B=(0,n.hb)((()=>{A(i.VS.TwoFaChangePasswordHint)}),[A]),L=(0,n.hb)((e=>{m({type:"setHint",payload:e}),y({...r,hint:e,onSuccess:()=>{A(i.VS.TwoFaCongratulations)}})}),[m,A,r,y]),R=(0,n.hb)((e=>{b({currentPassword:e,onSuccess:()=>{A(i.VS.Privacy)}})}),[b,A]),x=(0,n.hb)((e=>{m({type:"setCurrentPassword",payload:e}),p({currentPassword:e,onSuccess:()=>{A(i.VS.TwoFaRecoveryEmail)}})}),[p,m,A]),F=(0,n.hb)((e=>{m({type:"setEmail",payload:e}),g({...r,email:e,onSuccess:()=>{A(i.VS.TwoFaCongratulations)}})}),[m,A,r,g]),V=(0,n.hb)((e=>{E({code:e})}),[E]);switch(t){case i.VS.TwoFaDisabled:return n.Ay.createElement(Nu,{onStart:S,isActive:u||[i.VS.TwoFaNewPassword,i.VS.TwoFaNewPasswordConfirm,i.VS.TwoFaNewPasswordHint,i.VS.TwoFaNewPasswordEmail,i.VS.TwoFaNewPasswordEmailCode,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaNewPassword:return n.Ay.createElement(qd,{placeholder:f("PleaseEnterPassword"),submitLabel:f("Continue"),onSubmit:k,isActive:u||[i.VS.TwoFaNewPasswordConfirm,i.VS.TwoFaNewPasswordHint,i.VS.TwoFaNewPasswordEmail,i.VS.TwoFaNewPasswordEmailCode,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaNewPasswordConfirm:return n.Ay.createElement(qd,{expectedPassword:r.password,placeholder:f("PleaseReEnterPassword"),submitLabel:f("Continue"),onSubmit:w,isActive:u||[i.VS.TwoFaNewPasswordHint,i.VS.TwoFaNewPasswordEmail,i.VS.TwoFaNewPasswordEmailCode,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaNewPasswordHint:return n.Ay.createElement(wu,{icon:"hint",placeholder:f("PasswordHintPlaceholder"),onSubmit:N,isActive:u||[i.VS.TwoFaNewPasswordEmail,i.VS.TwoFaNewPasswordEmailCode,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaNewPasswordEmail:return n.Ay.createElement(wu,{icon:"email",type:"email",isLoading:l,error:c&&C.withRegular(c),clearError:v,placeholder:f("RecoveryEmailTitle"),shouldConfirm:!0,onSubmit:I,isActive:u||[i.VS.TwoFaNewPasswordEmailCode,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaNewPasswordEmailCode:return n.Ay.createElement(Su,{isLoading:l,error:c&&C.withRegular(c),clearError:v,onSubmit:V,isActive:u||a===i.VS.TwoFaCongratulations,onReset:h});case i.VS.TwoFaCongratulations:return n.Ay.createElement(Cu,{onScreenSelect:A,isActive:u,onReset:h});case i.VS.TwoFaEnabled:return n.Ay.createElement(ku,{onScreenSelect:A,isActive:u||[i.VS.TwoFaChangePasswordCurrent,i.VS.TwoFaChangePasswordNew,i.VS.TwoFaChangePasswordConfirm,i.VS.TwoFaChangePasswordHint,i.VS.TwoFaTurnOff,i.VS.TwoFaRecoveryEmailCurrentPassword,i.VS.TwoFaRecoveryEmail,i.VS.TwoFaRecoveryEmailCode,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaChangePasswordCurrent:return n.Ay.createElement(qd,{isLoading:l,error:c&&C.withRegular(c),clearError:v,hint:o,onSubmit:P,isActive:u||[i.VS.TwoFaChangePasswordNew,i.VS.TwoFaChangePasswordConfirm,i.VS.TwoFaChangePasswordHint,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaChangePasswordNew:return n.Ay.createElement(qd,{placeholder:f("PleaseEnterNewFirstPassword"),onSubmit:M,isActive:u||[i.VS.TwoFaChangePasswordConfirm,i.VS.TwoFaChangePasswordHint,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaChangePasswordConfirm:return n.Ay.createElement(qd,{expectedPassword:r.password,placeholder:f("PleaseReEnterPassword"),onSubmit:B,isActive:u||[i.VS.TwoFaChangePasswordHint,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaChangePasswordHint:return n.Ay.createElement(wu,{isLoading:l,error:c&&C.withRegular(c),clearError:v,icon:"hint",placeholder:f("PasswordHintPlaceholder"),onSubmit:L,isActive:u||a===i.VS.TwoFaCongratulations,onReset:h});case i.VS.TwoFaTurnOff:return n.Ay.createElement(qd,{isLoading:l,error:c&&C.withRegular(c),clearError:v,hint:o,onSubmit:R,isActive:u,onReset:h});case i.VS.TwoFaRecoveryEmailCurrentPassword:return n.Ay.createElement(qd,{isLoading:l,error:c&&C.withRegular(c),clearError:v,hint:o,onSubmit:x,isActive:u||[i.VS.TwoFaRecoveryEmail,i.VS.TwoFaRecoveryEmailCode,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaRecoveryEmail:return n.Ay.createElement(wu,{icon:"email",type:"email",placeholder:f("RecoveryEmailTitle"),onSubmit:F,isActive:u||[i.VS.TwoFaRecoveryEmailCode,i.VS.TwoFaCongratulations].includes(a),onReset:h});case i.VS.TwoFaRecoveryEmailCode:return n.Ay.createElement(Su,{isLoading:l,error:c&&C.withRegular(c),clearError:v,onSubmit:V,isActive:u||a===i.VS.TwoFaCongratulations,onReset:h});default:return}}))),Pu=Object.keys(i.VS).length/2,Mu=[i.VS.TwoFaDisabled,i.VS.TwoFaNewPassword,i.VS.TwoFaNewPasswordConfirm,i.VS.TwoFaNewPasswordHint,i.VS.TwoFaNewPasswordEmail,i.VS.TwoFaNewPasswordEmailCode,i.VS.TwoFaCongratulations,i.VS.TwoFaEnabled,i.VS.TwoFaChangePasswordCurrent,i.VS.TwoFaChangePasswordNew,i.VS.TwoFaChangePasswordConfirm,i.VS.TwoFaChangePasswordHint,i.VS.TwoFaTurnOff,i.VS.TwoFaRecoveryEmailCurrentPassword,i.VS.TwoFaRecoveryEmail,i.VS.TwoFaRecoveryEmailCode],Tu=[i.VS.PasscodeDisabled,i.VS.PasscodeEnabled],Bu=[i.VS.Folders,i.VS.FoldersCreateFolder,i.VS.FoldersEditFolder,i.VS.FoldersEditFolderFromChatList,i.VS.FoldersEditFolderInvites,i.VS.FoldersIncludedChats,i.VS.FoldersIncludedChatsFromChatList,i.VS.FoldersExcludedChats,i.VS.FoldersExcludedChatsFromChatList,i.VS.FoldersShare],Lu=[i.VS.PrivacyBlockedUsers,i.VS.ActiveWebsites],Ru=[i.VS.PrivacyPhoneNumberAllowedContacts,i.VS.PrivacyPhoneNumberDeniedContacts],xu=[i.VS.PrivacyLastSeenAllowedContacts,i.VS.PrivacyLastSeenDeniedContacts],Fu=[i.VS.PrivacyProfilePhotoAllowedContacts,i.VS.PrivacyProfilePhotoDeniedContacts],Vu=[i.VS.PrivacyBioAllowedContacts,i.VS.PrivacyBioDeniedContacts],Du=[i.VS.PrivacyBirthdayAllowedContacts,i.VS.PrivacyBirthdayDeniedContacts],_u=[i.VS.PrivacyGiftsAllowedContacts,i.VS.PrivacyGiftsDeniedContacts],Uu=[i.VS.PrivacyPhoneCallAllowedContacts,i.VS.PrivacyPhoneCallDeniedContacts],Ou=[i.VS.PrivacyPhoneP2PAllowedContacts,i.VS.PrivacyPhoneP2PDeniedContacts],Ju=[i.VS.PrivacyForwardingAllowedContacts,i.VS.PrivacyForwardingDeniedContacts],Ku=[i.VS.PrivacyVoiceMessagesAllowedContacts,i.VS.PrivacyVoiceMessagesDeniedContacts],ju=[i.VS.PrivacyGroupChatsAllowedContacts,i.VS.PrivacyGroupChatsDeniedContacts],Gu=(0,n.ph)((e=>{let{isActive:t,currentScreen:a,foldersState:r,foldersDispatch:o,onScreenSelect:l,onReset:d,shouldSkipTransition:m}=e;const{closeShareChatFolderModal:u}=(0,s.ko)(),[A,h]=(0,Td.A)(Ld,Bd),[y,p]=(0,n.J0)(""),v=(0,M.A)((e=>{const t=(0,c.nTw)((0,s.mS)()).shareFolderScreen?.isFromSettings;a===i.VS.FoldersShare&&u(),!0===e||void 0!==t&&!t?d(!0):(a!==i.VS.FoldersCreateFolder&&a!==i.VS.FoldersEditFolder&&a!==i.VS.FoldersEditFolderFromChatList&&a!==i.VS.FoldersEditFolderInvites||setTimeout((()=>{o({type:"reset"})}),200),a!==i.VS.FoldersIncludedChats&&a!==i.VS.FoldersExcludedChats?d():"create"===r.mode?l(i.VS.FoldersCreateFolder):l(i.VS.FoldersEditFolder))}));function g(e,s,c,d){return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(zm,{currentScreen:a,onReset:v,onScreenSelect:l,editedFolderId:r.folderId}),function(e,s){const c={[i.VS.PrivacyPhoneNumber]:Ru.includes(s),[i.VS.PrivacyLastSeen]:xu.includes(s),[i.VS.PrivacyProfilePhoto]:Fu.includes(s),[i.VS.PrivacyBio]:Vu.includes(s),[i.VS.PrivacyBirthday]:Du.includes(s),[i.VS.PrivacyGifts]:_u.includes(s),[i.VS.PrivacyPhoneCall]:Uu.includes(s),[i.VS.PrivacyPhoneP2P]:Ou.includes(s),[i.VS.PrivacyForwarding]:Ju.includes(s),[i.VS.PrivacyVoiceMessages]:Ku.includes(s),[i.VS.PrivacyGroupChats]:ju.includes(s)},d=Mu.includes(s),m=Tu.includes(s),u=Bu.includes(s),g=Lu.includes(s)||d||m||Object.keys(c).map(Number).includes(s)||Object.values(c).includes(!0);switch(a){case i.VS.Main:return n.Ay.createElement(Ym,{onScreenSelect:l,isActive:t,onReset:v});case i.VS.EditProfile:return n.Ay.createElement(Pm,{isActive:t&&e,onReset:v});case i.VS.General:return n.Ay.createElement(xm,{onScreenSelect:l,isActive:e||s===i.VS.GeneralChatBackgroundColor||s===i.VS.GeneralChatBackground||s===i.VS.QuickReaction||s===i.VS.CustomEmoji||g||u,onReset:v});case i.VS.QuickReaction:return n.Ay.createElement(gu,{isActive:e,onReset:v});case i.VS.CustomEmoji:return n.Ay.createElement(hm,{isActive:e,onReset:v});case i.VS.Notifications:return n.Ay.createElement(Xm,{isActive:e,onReset:v});case i.VS.DataStorage:return n.Ay.createElement(ym,{isActive:e,onReset:v});case i.VS.Privacy:return n.Ay.createElement(ru,{onScreenSelect:l,isActive:e||g,onReset:v});case i.VS.Language:return n.Ay.createElement(Hm,{isActive:e||s===i.VS.DoNotTranslate,onReset:v,onScreenSelect:l});case i.VS.DoNotTranslate:return n.Ay.createElement(Em,{isActive:e,onReset:v});case i.VS.Stickers:return n.Ay.createElement(bu,{isActive:e,onReset:v,onScreenSelect:l});case i.VS.Experimental:return n.Ay.createElement(Bm,{isActive:e,onReset:v});case i.VS.GeneralChatBackground:return n.Ay.createElement(Um,{onScreenSelect:l,isActive:e||s===i.VS.GeneralChatBackgroundColor,onReset:v});case i.VS.GeneralChatBackgroundColor:return n.Ay.createElement(Gm,{isActive:e,onReset:v});case i.VS.ActiveSessions:return n.Ay.createElement(lm,{isActive:e,onReset:v});case i.VS.ActiveWebsites:return n.Ay.createElement(um,{isActive:e,onReset:v});case i.VS.PrivacyBlockedUsers:return n.Ay.createElement(lu,{isActive:e,onReset:v});case i.VS.PrivacyPhoneNumber:case i.VS.PrivacyLastSeen:case i.VS.PrivacyProfilePhoto:case i.VS.PrivacyBio:case i.VS.PrivacyBirthday:case i.VS.PrivacyGifts:case i.VS.PrivacyPhoneCall:case i.VS.PrivacyForwarding:case i.VS.PrivacyVoiceMessages:case i.VS.PrivacyGroupChats:return n.Ay.createElement(hu,{screen:a,onScreenSelect:l,isActive:e||c[a],onReset:v});case i.VS.PrivacyPhoneNumberAllowedContacts:case i.VS.PrivacyLastSeenAllowedContacts:case i.VS.PrivacyProfilePhotoAllowedContacts:case i.VS.PrivacyBioAllowedContacts:case i.VS.PrivacyBirthdayAllowedContacts:case i.VS.PrivacyGiftsAllowedContacts:case i.VS.PrivacyPhoneCallAllowedContacts:case i.VS.PrivacyPhoneP2PAllowedContacts:case i.VS.PrivacyForwardingAllowedContacts:case i.VS.PrivacyVoiceMessagesAllowedContacts:case i.VS.PrivacyGroupChatsAllowedContacts:return n.Ay.createElement(vu,{isAllowList:!0,withPremiumCategory:a===i.VS.PrivacyGroupChatsAllowedContacts,withMiniAppsCategory:a===i.VS.PrivacyGiftsAllowedContacts,screen:a,onScreenSelect:l,isActive:e||c[a],onReset:v});case i.VS.PrivacyPhoneNumberDeniedContacts:case i.VS.PrivacyLastSeenDeniedContacts:case i.VS.PrivacyProfilePhotoDeniedContacts:case i.VS.PrivacyBioDeniedContacts:case i.VS.PrivacyBirthdayDeniedContacts:case i.VS.PrivacyGiftsDeniedContacts:case i.VS.PrivacyPhoneCallDeniedContacts:case i.VS.PrivacyPhoneP2PDeniedContacts:case i.VS.PrivacyForwardingDeniedContacts:case i.VS.PrivacyVoiceMessagesDeniedContacts:case i.VS.PrivacyGroupChatsDeniedContacts:return n.Ay.createElement(vu,{screen:a,onScreenSelect:l,isActive:e,onReset:v});case i.VS.PrivacyMessages:return n.Ay.createElement(nm,{isActive:e,onReset:v});case i.VS.Folders:case i.VS.FoldersCreateFolder:case i.VS.FoldersEditFolder:case i.VS.FoldersEditFolderFromChatList:case i.VS.FoldersEditFolderInvites:case i.VS.FoldersIncludedChats:case i.VS.FoldersIncludedChatsFromChatList:case i.VS.FoldersExcludedChats:case i.VS.FoldersExcludedChatsFromChatList:case i.VS.FoldersShare:return n.Ay.createElement(zd,{currentScreen:a,shownScreen:s,state:r,dispatch:o,isActive:e,onScreenSelect:l,onReset:v});case i.VS.TwoFaDisabled:case i.VS.TwoFaNewPassword:case i.VS.TwoFaNewPasswordConfirm:case i.VS.TwoFaNewPasswordHint:case i.VS.TwoFaNewPasswordEmail:case i.VS.TwoFaNewPasswordEmailCode:case i.VS.TwoFaCongratulations:case i.VS.TwoFaEnabled:case i.VS.TwoFaChangePasswordCurrent:case i.VS.TwoFaChangePasswordNew:case i.VS.TwoFaChangePasswordConfirm:case i.VS.TwoFaChangePasswordHint:case i.VS.TwoFaTurnOff:case i.VS.TwoFaRecoveryEmailCurrentPassword:case i.VS.TwoFaRecoveryEmail:case i.VS.TwoFaRecoveryEmailCode:return n.Ay.createElement(Iu,{currentScreen:a,state:A,dispatch:h,shownScreen:s,isActive:e,onScreenSelect:l,onReset:v});case i.VS.PasscodeDisabled:case i.VS.PasscodeNewPasscode:case i.VS.PasscodeNewPasscodeConfirm:case i.VS.PasscodeChangePasscodeCurrent:case i.VS.PasscodeChangePasscodeNew:case i.VS.PasscodeChangePasscodeConfirm:case i.VS.PasscodeCongratulations:case i.VS.PasscodeEnabled:case i.VS.PasscodeTurnOff:return n.Ay.createElement(Xd,{currentScreen:a,passcode:y,onSetPasscode:p,shownScreen:s,isActive:e,onScreenSelect:l,onReset:v});case i.VS.Performance:return n.Ay.createElement(iu,{isActive:e,onReset:v});default:return}}(e,d))}return n.Ay.createElement(te.Ay,{id:"Settings",name:m?"none":b.Uh,activeKey:a,renderCount:Pu,shouldWrap:!0,withSwipeControl:!0},g)})),zu=(0,n.ph)((0,s.EK)((e=>{const{userIds:t}=e.contactList||{},{byId:a,statusesById:n}=e.users;return{usersById:a,userStatusesById:n,contactIds:t}}))((e=>{let{isActive:t,filter:a,usersById:r,userStatusesById:o,contactIds:c,onReset:d}=e;const{openChat:m,openNewContactDialog:u}=(0,s.ko)(),A=(0,T.A)(),{isMobile:h}=(0,w.Ay)();(0,ve.A)({isActive:t,onBack:d});const y=(0,n.hb)((e=>{m({id:e,shouldReplaceHistory:!0})}),[m]),p=(0,n.Kr)((()=>{if(!c)return;const e=(0,rn.PU)({ids:c,query:a,type:"user"});return(0,l.UBH)(e,r,o)}),[c,a,r,o]),[v,g]=(0,Es.A)(void 0,p,Boolean(a));return n.Ay.createElement(rs.A,{items:v,onLoadMore:g,className:"chat-list custom-scroll"},v?.length?v.map((e=>n.Ay.createElement(Wa.A,{key:e,className:"chat-item-clickable contact-list-item",onClick:()=>y(e)},n.Ay.createElement(ds.A,{userId:e,forceShowSelf:!0,avatarSize:"large",withStory:!0,storyViewerOrigin:i.G9.ChatList,ripple:!h})))):v&&!v.length?n.Ay.createElement("p",{className:"no-results",key:"no-results",dir:"auto"},a.length?"No contacts matched your search.":"Contact list is empty."):n.Ay.createElement(fs.A,{key:"loading"}),n.Ay.createElement(un.A,{key:"create-new-contact",isShown:!0,onClick:u,ariaLabel:A("CreateNewContact")},n.Ay.createElement(q.A,{name:"add-user-filled"})))}))),Hu=(0,n.ph)((0,s.EK)((e=>{const{userIds:t}=e.contactList||{},{query:a,fetchingStatus:n,globalResults:s,localResults:i}=(0,c.nTw)(e).globalSearch,{peerIds:r}=s||{},{peerIds:o}=i||{};return{localContactIds:t,searchQuery:a,isSearching:n?.chats,globalPeerIds:r,localPeerIds:o}}))((e=>{let{isChannel:t,isActive:a,selectedMemberIds:i,localContactIds:r,searchQuery:o,isSearching:c,localPeerIds:d,globalPeerIds:m,onSelectedMemberIdsChange:u,onNextStep:A,onReset:h}=e;const{setGlobalSearchQuery:y}=(0,s.ko)(),p=(0,T.A)();(0,ve.A)({isActive:a,onBack:h});const v=(0,n.hb)((e=>{y({query:e})}),[]),g=(0,n.Kr)((()=>{const e=(0,s.mS)().users.byId,t=r?(0,rn.PU)({ids:r,query:o,type:"user"}):[];return(0,vs.A)((0,on.Am)([...t,...d||[],...m||[]]).filter((t=>{const a=e[t];return a&&!a.isSelf&&(a.canBeInvitedToGroup||!(0,l.tvf)(a))})),!1,i)}),[r,o,d,m,i]),E=(0,n.hb)((()=>{y({query:""}),A()}),[A]);return n.Ay.createElement("div",{className:"NewChat step-1"},n.Ay.createElement("div",{className:"left-header"},n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",onClick:h,ariaLabel:"Return to Chat List"},n.Ay.createElement(q.A,{name:"arrow-left"})),n.Ay.createElement("h3",null,p("GroupAddMembers"))),n.Ay.createElement("div",{className:"NewChat-inner step-1"},n.Ay.createElement(cn.A,{itemIds:g,selectedIds:i,filterValue:o,filterPlaceholder:p("SendMessageTo"),searchInputId:"new-group-picker-search",isLoading:c,isSearchable:!0,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox",withDefaultPadding:!0,onSelectedIdsChange:u,onFilterChange:v}),n.Ay.createElement(un.A,{isShown:!0,onClick:E,ariaLabel:t?"Continue To Channel Info":"Continue To Group Info"},n.Ay.createElement(q.A,{name:"arrow-right"}))))}))),$u=(0,n.ph)((0,s.EK)((e=>{const{progress:t,error:a}=(0,c.nTw)(e).chatCreation||{};return{creationProgress:t,creationError:a,maxGroupSize:e.config?.maxGroupSize}}))((e=>{let{isChannel:t,isActive:a,memberIds:r,maxGroupSize:o,creationProgress:c,creationError:d,onReset:m}=e;const{createGroupChat:u,createChannel:A}=(0,s.ko)(),h=(0,T.A)();(0,ve.A)({isActive:a,onBack:m});const[y,p]=(0,n.J0)(""),[v,g]=(0,n.J0)(""),[E,b]=(0,n.J0)(),[C,f]=(0,n.J0)(),S="Chat title can't be empty",k="Channel title can't be empty",w=c===i.n7.InProgress;(0,n.vJ)((()=>{if(t)return;if(!r.length||r.length>4)return void p("");const e=(0,s.mS)(),a=e.users.byId,n=[e.currentUserId,...r].map((e=>(0,l.u0l)(a[e]))).filter(Boolean),i=n.slice(0,-1).join(", ")+h("CreateGroup.PeersTitleLastDelimeter")+n[n.length-1];p(i)}),[t,r,h]);const N=(0,n.hb)((e=>{const{value:t}=e.currentTarget,a=t.replace(/^\s+/,"");p(a),a!==t&&(e.currentTarget.value=a)}),[]),I=(0,n.hb)((e=>{g(e.currentTarget.value)}),[]),P=(0,n.hb)((()=>{y.length?o&&r.length>=o?f("Sorry, creating supergroups is not yet supported"):u({title:y,photo:E,memberIds:r}):f(S)}),[y,r,o,u,E]),M=(0,n.hb)((()=>{y.length?A({title:y,about:v,photo:E,memberIds:r}):f(k)}),[y,A,v,E,r,k]);(0,n.vJ)((()=>{c===i.n7.Complete&&m(!0)}),[c,m]);const B=d&&h(d)||(C!==S&&C!==k?C:void 0);return n.Ay.createElement("div",{className:"NewChat"},n.Ay.createElement("div",{className:"left-header"},n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>m(),ariaLabel:"Return to member selection"},n.Ay.createElement(q.A,{name:"arrow-left"})),n.Ay.createElement("h3",null,h(t?"NewChannel":"NewGroup"))),n.Ay.createElement("div",{className:"NewChat-inner step-2"},n.Ay.createElement(wm.A,{onChange:b,title:h("AddPhoto")}),n.Ay.createElement(Y.A,{value:y,onChange:N,label:h(t?"EnterChannelName":"GroupName"),error:C===S||C===k?C:void 0}),t&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Y.A,{value:v,onChange:I,label:h("DescriptionOptionalPlaceholder")}),n.Ay.createElement("p",{className:"note"},h("DescriptionInfo"))),B&&n.Ay.createElement("p",{className:"error"},B),r.length>0&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:"chat-members-heading"},h("GroupInfo.ParticipantCount",r.length,"i")),n.Ay.createElement("div",{className:"chat-members-list custom-scroll"},r.map((e=>n.Ay.createElement(Wa.A,{inactive:!0,className:"chat-item-clickable"},n.Ay.createElement(ds.A,{userId:e}))))))),n.Ay.createElement(un.A,{isShown:0!==y.length,onClick:t?M:P,disabled:w,ariaLabel:t?h("ChannelIntro.CreateChannel"):"Create Group"},w?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"arrow-right"})))}))),qu=Object.keys(i.Bn).length/2,Wu=(0,n.ph)((e=>{let{isActive:t,isChannel:a=!1,content:s,onContentChange:r,onReset:o}=e;const[l,c]=(0,n.J0)([]),d=(0,n.hb)((()=>{r(a?i.Bn.NewChannelStep2:i.Bn.NewGroupStep2)}),[a,r]);return n.Ay.createElement(te.Ay,{id:"NewChat",name:b.Uh,renderCount:qu,activeKey:s},(e=>{switch(s){case i.Bn.NewChannelStep1:case i.Bn.NewGroupStep1:return n.Ay.createElement(Hu,{isChannel:a,isActive:t,selectedMemberIds:l,onSelectedMemberIdsChange:c,onNextStep:d,onReset:o});case i.Bn.NewChannelStep2:case i.Bn.NewGroupStep2:return n.Ay.createElement($u,{isChannel:a,isActive:e&&t,memberIds:l,onReset:o});default:return}}))}));var Yu=a(34458),Qu=a(11462),Zu=a(24920),Xu=a(75343),eA=a(40175),tA=a(62830),aA=a(90054);const nA=(0,n.ph)((e=>{let{isActive:t,isForumPanelOpen:a,archiveSettings:i,isStoryRibbonShown:o,onReset:l,onTopicSearch:c,onSettingsScreenSelect:d,onLeftColumnContentChange:m,foldersDispatch:u}=e;const{updateArchiveSettings:A}=(0,s.ko)(),h=(0,T.A)();(0,ve.A)({isActive:t,onBack:l});const y=(0,M.A)((()=>{A({isHidden:!1})})),{shouldDisableDropdownMenuTransitionRef:p,handleDropdownMenuTransitionEnd:v}=(0,Zu.A)(a),{shouldRender:g,transitionClassNames:E}=(0,De.A)(!a,void 0,void 0,!1),{shouldRenderForumPanel:b,handleForumPanelAnimationEnd:C,handleForumPanelAnimationStart:f,isAnimationStarted:S}=(0,Qu.A)(a),k=a&&S,{shouldRender:w,transitionClassNames:N,isClosing:I}=(0,De.A)(o,void 0,void 0,"",!1,Yu.UG+r.xB5);return n.Ay.createElement("div",{className:"ArchivedChats"},n.Ay.createElement("div",{className:(0,de.A)("left-header",!w&&"left-header-shadow")},h.isRtl&&n.Ay.createElement("div",{className:"DropdownMenuFiller"}),n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",onClick:l,ariaLabel:"Return to chat list",className:(0,de.A)(h.isRtl&&"rtl",k&&h.isRtl&&"right-aligned",p.current&&h.isRtl&&"disable-transition"),onTransitionEnd:v},n.Ay.createElement(q.A,{name:"arrow-left"})),g&&n.Ay.createElement("h3",{className:E},h("ArchivedChats")),n.Ay.createElement("div",{className:"story-toggler-wrapper"},n.Ay.createElement(eA.A,{canShow:!0,isArchived:!0})),i.isHidden&&n.Ay.createElement(re.A,{className:"archived-chats-more-menu",positionX:"right",onTransitionEnd:h.isRtl?v:void 0},n.Ay.createElement(oe.A,{icon:"archive-from-main",onClick:y},h("lng_context_archive_to_list")))),n.Ay.createElement("div",{className:(0,de.A)("chat-list-wrapper",w&&"with-story-ribbon",N)},w&&n.Ay.createElement(Xu.A,{isArchived:!0,className:"left-header-shadow",isClosing:I}),n.Ay.createElement(tA.A,{folderType:"archived",isActive:t,isForumPanelOpen:k,onSettingsScreenSelect:d,onLeftColumnContentChange:m,foldersDispatch:u,archiveSettings:i})),b&&n.Ay.createElement(aA.A,{isOpen:a,onTopicSearch:c,onOpenAnimationStart:f,onCloseAnimationEnd:C}))})),sA=(0,n.ph)((0,s.EK)((e=>{const{byId:t,orderedIds:a}=e.chatFolders;return{foldersById:t,folderOrderedIds:a}}))((e=>{let{isOpen:t,chatId:a,foldersById:i,folderOrderedIds:o,onClose:l,onCloseAnimationEnd:c}=e;const{editChatFolders:d}=(0,s.ko)(),m=(0,T.A)(),u=(0,n.Kr)((()=>i?Object.keys(i).reduce(((e,t)=>{const{includedChatIds:n,pinnedChatIds:s}=i[Number(t)];return(n.includes(a)||s?.includes(a))&&e.push(t),e}),[]):[]),[a,i]),[A,h]=(0,n.J0)(u),y=(0,n.Kr)((()=>o?.filter((e=>e!==r.DSF)).map((e=>{const t=i?i[e]:void 0;return{label:t?(0,Un.f)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations}):"",value:String(e)}}))||[]),[o,i]),p=(0,n.hb)((()=>{const e=u.filter((e=>!A.includes(e))).map(Number),t=A.filter((e=>!u.includes(e))).map(Number);d({chatId:a,idsToRemove:e,idsToAdd:t}),l()}),[a,d,u,l,A]);if(i&&o)return n.Ay.createElement(Q.A,{isOpen:t,onClose:l,onCloseAnimationEnd:c,onEnter:p,className:(0,de.A)("_fJBBCCE","delete"),contentClassName:"EG5lPWY1",title:m("FilterAddTo")},n.Ay.createElement("div",{className:(0,de.A)("heYMHiUt","custom-scroll")},n.Ay.createElement(Cc.A,{className:"dialog-checkbox-group",options:y,selected:A,onChange:h})),n.Ay.createElement("div",{className:"_jtqAaUU"},n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(W.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:p},m("FilterAddTo")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:l},m("Cancel")))))})));var iA=function(e){return e.OneHour="3600",e.FourHours="14400",e.EightHours="28800",e.OneDay="86400",e.ThreeDays="259200",e.Forever="-1",e}(iA||{});const rA=(0,n.ph)((e=>{let{isOpen:t,chatId:a,topicId:i,onClose:o,onCloseAnimationEnd:l}=e;const[c,d]=(0,n.J0)(iA.Forever),{updateChatMutedState:m,updateTopicMutedState:u}=(0,s.ko)(),A=(0,T.A)(),h=(0,n.Kr)((()=>[{label:A("MuteFor.Hours",1),value:iA.OneHour},{label:A("MuteFor.Hours",4),value:iA.FourHours},{label:A("MuteFor.Hours",8),value:iA.EightHours},{label:A("MuteFor.Days",1),value:iA.OneDay},{label:A("MuteFor.Days",3),value:iA.ThreeDays},{label:A("MuteFor.Forever"),value:iA.Forever}]),[A]),y=(0,n.hb)((()=>{let e;e=c===iA.Forever?r.fRl:Math.floor(Date.now()/1e3)+Number(c),i?u({chatId:a,topicId:i,muteUntil:e}):m({chatId:a,muteUntil:e}),o()}),[a,c,o,i]);return n.Ay.createElement(Q.A,{isOpen:t,onClose:o,onCloseAnimationEnd:l,onEnter:y,className:"delete",title:A("Notifications")},n.Ay.createElement(Z.A,{className:"dialog-checkbox-group",name:"muteFor",options:h,selected:c,onChange:d}),n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(W.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:y},A("Common.Done")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:o},A("Cancel"))))}));var oA=a(99515),lA=a(24531);const cA=(0,n.ph)((0,s.EK)(((e,t)=>{let{fromSticker:a,stickerSetShortName:n}=t;const s=(0,c.Xf0)(e),{chatId:i,threadId:r}=s||{},o=i&&(0,c.hds)(e,i),d=i?(0,c.AWZ)(e,i):void 0,m=o?(0,l.Q_H)(o,d):void 0,u=i&&r?(0,c.Vw0)(e,i,r):void 0,A=Boolean(!u?.isCommentsInfo&&u?.fromChannelId),h=i&&r?(0,c.S0q)(e,i,r):void 0,y=Boolean(o&&r&&(0,l.__m)(o,h,A,d)&&m?.canSendStickers),p=Boolean(i)&&(0,c.nZ4)(e,i),v=a?a.stickerSetInfo:n?{shortName:n}:void 0,g=v?(0,c.ycM)(e,v):void 0;return{canScheduleUntilOnline:Boolean(i)&&(0,c.RBq)(e,i),canSendStickers:y,isSavedMessages:p,shouldSchedule:(0,c.PIP)(e),stickerSet:g,isCurrentUserPremium:(0,c.g29)(e),shouldUpdateStickerSetOrder:e.settings.byKey.shouldUpdateStickerSetOrder,currentMessageList:s}}))((e=>{let{isOpen:t,fromSticker:a,stickerSetShortName:i,stickerSet:o,canSendStickers:l,canScheduleUntilOnline:c,shouldSchedule:d,isSavedMessages:m,isCurrentUserPremium:u,shouldUpdateStickerSetOrder:A,currentMessageList:h,onClose:y}=e;const{loadStickers:p,toggleStickerSet:v,sendMessage:g,showNotification:E}=(0,s.ko)(),b=(0,n.li)(null),C=(0,n.li)(null),f=(0,T.A)(),{isMobile:S}=(0,w.Ay)(),k=(0,D.A)(o),N=o||k,I=Boolean(!N?.isArchived&&N?.installedDate),P=N?.isEmoji,[M,B]=(0,lA.A)(c),{handleScroll:L,isAtBeginning:R}=is(),{observe:x}=(0,zo.BL)({rootRef:b,throttleMs:200,isDisabled:!t});(0,n.vJ)((()=>{t&&!N?.stickers&&p({stickerSetInfo:a?a.stickerSetInfo:{shortName:i}})}),[t,a,p,i,N]);const F=(0,n.hb)(((e,t,a)=>{h&&(e={...e,isPreloadedGlobally:!0},d||a?M((a=>{g({messageList:h,sticker:e,isSilent:t,scheduledAt:a}),y()})):(g({messageList:h,sticker:e,isSilent:t,shouldUpdateStickerSetOrder:A&&I}),y()))}),[h,d,M,y,A,I]),V=(0,n.hb)((()=>{N&&(v({stickerSetId:N.id}),y())}),[y,N,v]),_=(0,n.hb)((()=>{if(!N)return;const{shortName:e}=N,t=P?"addemoji":"addstickers",a=`${r.jsp}${t}/${e}`;(0,Uc.eM)(a),E({message:f("LinkCopied")})}),[P,f,N,E]),U=(0,n.Kr)((()=>e=>{let{onTrigger:t,isOpen:a}=e;return n.Ay.createElement(W.A,{round:!0,ripple:!S,size:"smaller",color:"translucent",className:a?"active":"",onClick:t,ariaLabel:"More actions"},n.Ay.createElement(q.A,{name:"more"}))}),[S]);return n.Ay.createElement(Q.A,{className:(0,de.A)("StickerSetModal",P&&"custom-emoji"),isOpen:t,onClose:y,header:function(){const e=(0,de.A)("modal-header",!R&&"with-top-border");return n.Ay.createElement("div",{className:e,dir:f.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:f("Close"),onClick:y},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},N?(0,kt.A)(N.title,["emoji","links"]):f("AccDescrStickerSet")),n.Ay.createElement(re.A,{className:"stickers-more-menu with-menu-transitions",trigger:U,positionX:"right"},n.Ay.createElement(oe.A,{icon:"copy",onClick:_},f("StickersCopy"))))}()},N?.stickers?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{ref:b,className:"stickers custom-scroll",onScroll:L},n.Ay.createElement("div",{className:"shared-canvas-container stickers-grid"},n.Ay.createElement("canvas",{ref:C,className:"shared-canvas"}),N.stickers.map((e=>n.Ay.createElement(sl,{sticker:e,size:P?r.$nk:r.GhT,observeIntersection:x,onClick:l&&!P?F:void 0,clickArg:e,isSavedMessages:m,isCurrentUserPremium:u,sharedCanvasRef:C}))))),n.Ay.createElement("div",{className:"button-wrapper"},n.Ay.createElement(W.A,{size:"smaller",fluid:!0,color:I?"danger":"primary",onClick:V},(()=>{if(!N)return f("Loading");const e=P?"Emoji":"Sticker";return f(I?`StickerPack.Remove${e}Count`:`StickerPack.Add${e}Count`,N.count,"i")})()))):n.Ay.createElement(fs.A,null),B)}))),dA={root:"nZYT4vJ3",sets:"JzkmXjFF"},mA=(0,n.ph)((0,s.EK)((e=>({canPlayAnimatedEmojis:(0,c.BWX)(e)})))((e=>{let{customEmojiSetIds:t,canPlayAnimatedEmojis:a,onClose:i}=e;const{openStickerSet:r}=(0,s.ko)(),o=(0,T.A)(),l=(0,n.Kr)((()=>t?.map((e=>(0,s.mS)().stickers.setsById[e]))),[t]),c=(0,n.li)(null),{observe:d}=(0,zo.BL)({rootRef:c,isDisabled:!l}),m=(0,D.A)(l),u=l||m,A=(0,M.A)((e=>{r({stickerSetInfo:e.stickerSetInfo})}));return n.Ay.createElement(Q.A,{isOpen:Boolean(l),className:dA.root,onClose:i,hasCloseButton:!0,title:o("lng_custom_emoji_used_sets")},n.Ay.createElement("div",{className:(0,de.A)(dA.sets,"custom-scroll"),ref:c,teactFastList:!0},u?.map((e=>n.Ay.createElement(Am,{key:e.id,className:dA.setCard,stickerSet:e,onClick:A,observeIntersection:d,noPlay:!a})))))})));var uA=a(54314),AA=a(60859);const hA={settings:{icon:"bots",label:"BotSettings"},help:{icon:"help",label:"BotHelp"}},yA=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a,threadId:n}=t;const s=(0,c.hds)(e,a);if(!s||s.isRestricted)return{};const i=(0,l.L8L)(s.id),r=i?(0,c.mBe)(e,a):void 0,o=r&&(0,l.GhJ)(r),d=n===U.l3,m=(0,c.nZ4)(e,a),{chatId:u,threadId:A}=(0,c.Xf0)(e)||{},h=d&&!r&&((0,l.WXB)(s)||(0,l.YEQ)(s)),y=(0,l.DXc)(a)?void 0:(0,c.yps)(e,a),p=i?(0,c.vGo)(e,a):void 0,v=i?void 0:(0,c.AWZ)(e,a),g=p||v,E=(0,c.X2D)(e,a),b=(0,c.S0q)(e,a,n),C=s.isForum&&(s.isCreator||!(0,l.SqZ)(s,"manageTopics")||(0,l.ubU)(s,"manageTopics")),f=b&&(0,l.l1p)(s,b),S=(0,c.e5V)(e,a),k=(0,c.jGY)(e,a)&&g?.isTranslationDisabled,w=(0,l.cG0)(a,n,e.currentUserId)?(0,c.hds)(e,String(n)):void 0;return{chat:s,isMuted:(0,l.W1R)(s,(0,c.$5S)(e),(0,c.GrP)(e)),isPrivate:i,isTopic:s?.isForum&&!d,isForum:s?.isForum,isForumAsMessages:s?.isForumAsMessages,canAddContact:o,canDeleteChat:(0,l.ICW)(s),canReportChat:h,canGift:E,hasLinkedChat:Boolean(v?.linkedChatId),botCommands:y?p?.botInfo?.commands:void 0,botPrivacyPolicyUrl:y?p?.botInfo?.privacyPolicyUrl:void 0,isChatInfoShown:(0,c.nTw)(e).isChatInfoShown&&u===a&&A===n,canCreateTopic:C,canEditTopic:f,canManage:S,isRightColumnShown:(0,c.gjV)(e),canTranslate:k,isBlocked:p?.isBlocked,isBot:Boolean(y),isChatWithSelf:m,savedDialog:w}}))((e=>{let{chatId:t,threadId:a,isOpen:i,withExtraActions:r,anchor:o,isChannel:l,botCommands:c,botPrivacyPolicyUrl:d,withForumActions:m,isTopic:u,isForum:A,isForumAsMessages:h,isChatInfoShown:y,canStartBot:p,canSubscribe:v,canReportChat:g,canSearch:E,canCall:b,canMute:C,canViewStatistics:f,canViewMonetization:S,canViewBoosts:k,pendingJoinRequests:N,canLeave:P,canEnterVoiceChat:B,canCreateVoiceChat:L,chat:R,isPrivate:x,isMuted:F,canDeleteChat:V,canGift:D,hasLinkedChat:_,canAddContact:U,canCreateTopic:O,canEditTopic:J,canManage:K,isRightColumnShown:j,canTranslate:G,isBlocked:z,isBot:H,isChatWithSelf:$,savedDialog:q,canShowBoostModal:W,onJoinRequestsClick:Y,onSubscribeChannel:Q,onSearchClick:Z,onAsMessagesClick:X,onClose:ee,onCloseAnimationEnd:te}=e;const{updateChatMutedState:ae,enterMessageSelectMode:ne,sendBotCommand:se,restartBot:ie,requestMasterAndJoinGroupCall:re,createGroupCall:le,openLinkedChat:ce,openAddContactDialog:de,requestMasterAndRequestCall:me,toggleStatistics:ue,openMonetizationStatistics:Ae,openBoostStatistics:he,openGiftModal:ye,openThreadWithInfo:pe,openCreateTopicPanel:ve,openEditTopicPanel:ge,openChat:Ee,openUrl:be,toggleManagement:Ce,togglePeerTranslations:fe,blockUser:Se,unblockUser:ke,setViewForumAsMessages:we,openBoostModal:Ne,reportMessages:Ie}=(0,s.ko)(),{isMobile:Pe}=(0,w.Ay)(),[Me,Te]=(0,n.J0)(!0),[Be,Le]=(0,n.J0)(!1),[Re,xe]=(0,n.J0)(!1),[Fe,Ve]=(0,n.J0)(!1),[_e,Ue,Oe]=(0,I.A)(),{x:Je,y:Ke}=o;(0,De.A)(i,te,void 0,!1);const je=(0,Dn.A)(!(y||!A)||void 0,200),ze=(0,M.A)((()=>{Ve(!1),ee()})),He=(0,M.A)((()=>{Te(!1),Ie({chatId:t,messageIds:[]}),ee()})),$e=(0,M.A)((()=>{Te(!1),xe(!0)})),qe=(0,M.A)((()=>{Te(!1),ee()})),We=(0,M.A)((()=>{pe({chatId:t,threadId:a}),Le(!j),qe()})),Ye=(0,M.A)((()=>{xe(!1),ee()})),Qe=(0,M.A)((()=>{se({command:"/start"})})),Ze=(0,M.A)((()=>{ie({chatId:t})})),Xe=(0,M.A)((()=>{ae({chatId:t,isMuted:!1}),qe()})),et=(0,M.A)((()=>{Ue(),Ve(!0),Te(!1)})),tt=(0,M.A)((()=>{ve({chatId:t}),Le(!j),qe()})),at=(0,M.A)((()=>{Ce({force:!0}),Le(!j),qe()})),nt=(0,M.A)((()=>{ge({chatId:t,topicId:Number(a)}),Le(!j),qe()})),st=(0,M.A)((()=>{Ee({id:void 0}),we({chatId:t,isEnabled:!1}),qe()})),it=(0,M.A)((()=>{L?le({chatId:t}):re({chatId:t}),qe()})),rt=(0,M.A)((()=>{ce({id:t}),qe()})),ot=(0,M.A)((()=>{ye({forUserId:t}),qe()})),lt=(0,M.A)((()=>{de({userId:t}),qe()})),ct=(0,M.A)((()=>{Q(),qe()})),dt=(0,M.A)((()=>{me({userId:t,isVideo:!0}),qe()})),mt=(0,M.A)((()=>{me({userId:t}),qe()})),ut=(0,M.A)((()=>{Z(),qe()})),At=(0,M.A)((()=>{ue(),Le(!j),qe()})),ht=(0,M.A)((()=>{Ae({chatId:t}),Le(!j),qe()})),yt=(0,M.A)((()=>{k?(he({chatId:t}),Le(!j)):Ne({chatId:t}),qe()})),pt=(0,M.A)((()=>{fe({chatId:t,isEnabled:!0}),qe()})),vt=(0,M.A)((()=>{ne(),qe()})),gt=(0,M.A)((()=>{X(),qe()})),Et=(0,M.A)((()=>{Se({userId:t}),qe()})),bt=(0,M.A)((()=>{ke({userId:t}),qe()}));(0,n.vJ)(bn.M6,[]);const Ct=(0,T.A)(),ft=(0,n.Kr)((()=>{const e=c?.map((e=>{let{command:t}=e;const a=hA[t];if(a)return n.Ay.createElement(oe.A,{key:t,icon:a.icon,onClick:()=>{se({command:`/${t}`}),qe()}},Ct(a.label))})),t=c?.some((e=>{let{command:t}=e;return"privacy"===t}));return[...e||[],H&&n.Ay.createElement(oe.A,{icon:"privacy-policy",onClick:()=>{t&&!d?se({command:"/privacy"}):be({url:d||Ct("BotDefaultPrivacyPolicy")}),qe()}},Ct("BotPrivacyPolicy"))].filter(Boolean)}),[c,Ct,d,H]),St=(0,n.Kr)((()=>{if(R)return Ct(q?"Delete":x?"DeleteChatUser":V?"GroupInfo.DeleteAndExit":l?"LeaveChannel":"Group.LeaveGroup")}),[V,R,l,x,q,Ct]);return n.Ay.createElement(Sl.A,null,n.Ay.createElement("div",{className:"HeaderMenuContainer"},n.Ay.createElement(Ge.A,{isOpen:Me,positionX:"right",style:`left: ${Je}px;top: ${Ke}px;`,onClose:qe,shouldCloseFast:Be},Pe&&E&&n.Ay.createElement(oe.A,{icon:"search",onClick:ut},Ct("Search")),m&&O&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(oe.A,{icon:"comments",onClick:tt},Ct("lng_forum_create_topic")),n.Ay.createElement(AA.A,null)),je&&n.Ay.createElement(oe.A,{icon:"info",onClick:We},Ct(u?"lng_context_view_topic":"lng_context_view_group")),K&&!J&&n.Ay.createElement(oe.A,{icon:"edit",onClick:at},Ct("Edit")),J&&n.Ay.createElement(oe.A,{icon:"edit",onClick:nt},Ct("lng_forum_topic_edit")),Pe&&!m&&A&&!u&&n.Ay.createElement(oe.A,{icon:"forums",onClick:st},Ct("Chat.ContextViewAsTopics")),m&&Boolean(N)&&n.Ay.createElement(oe.A,{icon:"user",onClick:Y},Ct(l?"SubscribeRequests":"MemberRequests"),n.Ay.createElement("div",{className:"right-badge"},N)),m&&!u&&!h&&n.Ay.createElement(oe.A,{icon:"message",onClick:gt},Ct("lng_forum_view_as_messages")),r&&p&&n.Ay.createElement(oe.A,{icon:"bots",onClick:Qe},Ct("BotStart")),r&&v&&n.Ay.createElement(oe.A,{icon:l?"channel":"group",onClick:ct},Ct(l?"ProfileJoinChannel":"ProfileJoinGroup")),W&&!k&&n.Ay.createElement(oe.A,{icon:"boost-outline",onClick:yt},Ct(l?"BoostingBoostChannelMenu":"BoostingBoostGroupMenu")),U&&n.Ay.createElement(oe.A,{icon:"add-user",onClick:lt},Ct("AddContact")),Pe&&b&&n.Ay.createElement(oe.A,{icon:"phone",onClick:mt},Ct("Call")),b&&n.Ay.createElement(oe.A,{icon:"video-outlined",onClick:dt},Ct("VideoCall")),C&&(F?n.Ay.createElement(oe.A,{icon:"unmute",onClick:Xe},Ct("ChatsUnmute")):n.Ay.createElement(oe.A,{icon:"mute",onClick:et},Ct("ChatsMute"),"...")),(B||L)&&n.Ay.createElement(oe.A,{icon:"voice-chat",onClick:it},Ct(L?"StartVoipChat":"VoipGroupJoinCall")),_&&n.Ay.createElement(oe.A,{icon:l?"comments":"channel",onClick:rt},Ct(l?"ViewDiscussion":"lng_profile_view_channel")),!m&&n.Ay.createElement(oe.A,{icon:"select",onClick:vt},Ct("ReportSelectMessages")),k&&n.Ay.createElement(oe.A,{icon:"boost-outline",onClick:yt},Ct("Boosts")),f&&n.Ay.createElement(oe.A,{icon:"stats",onClick:At},Ct("Statistics")),l&&S&&n.Ay.createElement(oe.A,{icon:"cash-circle",onClick:ht},Ct("lng_channel_earn_title")),G&&n.Ay.createElement(oe.A,{icon:"language",onClick:pt},Ct("lng_context_translate")),g&&n.Ay.createElement(oe.A,{icon:"flag",onClick:He},Ct("ReportPeer.Report")),ft,D&&n.Ay.createElement(oe.A,{icon:"gift",onClick:ot},Ct("ProfileSendAGift")),H&&n.Ay.createElement(oe.A,{icon:z?"bots":"hand-stop",onClick:z?Ze:Et},Ct(z?"BotRestart":"Bot.Stop")),x&&!$&&!H&&n.Ay.createElement(oe.A,{icon:z?"user":"hand-stop",onClick:z?bt:Et},Ct(z?"Unblock":"BlockUser")),P&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(AA.A,null),n.Ay.createElement(oe.A,{destructive:!0,icon:"delete",onClick:$e},St))),R&&n.Ay.createElement(uA.A,{isOpen:Re,onClose:Ye,chat:q||R,isSavedDialog:Boolean(q)}),C&&_e&&R?.id&&n.Ay.createElement(ed.A,{isOpen:Fe,onClose:ze,onCloseAnimationEnd:Oe,chatId:R.id})))})));var pA=a(92915),vA=a(81642),gA=a(18653);const EA={root:"vv5ppXel",active:"FVgqrSSK",info:"DboxqiZd",topRow:"Ymu2m1PR",meta:"A2rsvUBm",subtitle:"qUzmwaIn"},bA=(0,n.ph)((e=>{let{isActive:t,message:a,senderPeer:s,messageChat:i,shouldShowChat:r,query:o,className:c,onClick:d}=e;const m=(0,T.A)(),u=a.forwardInfo?.hiddenUserName,A=r?i:s,h=r?(0,l.Q5I)(m,a.chatId,s):void 0,y=(0,M.A)((()=>{d(a)}));return n.Ay.createElement("div",{role:"button",tabIndex:0,className:(0,de.A)(EA.root,t&&EA.active,c),onClick:y},n.Ay.createElement(wt.A,{className:EA.avatar,peer:A,text:u,size:"medium"}),n.Ay.createElement("div",{className:EA.info},n.Ay.createElement("div",{className:EA.topRow},A&&n.Ay.createElement(Ss.A,{peer:A,withEmojiStatus:!0})||u,n.Ay.createElement(vA.A,{className:EA.meta,message:a})),n.Ay.createElement("div",{className:EA.subtitle,dir:"auto"},h&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("span",{className:"sender-name"},(0,kt.A)(h)),n.Ay.createElement("span",{className:"colon"},":")),n.Ay.createElement(gA.A,{message:a,highlight:o,truncateLength:200}))))})),CA={root:"FTMljUuX",header:"OvmjSMwA",active:"DEIUzXQd",avatar:"mp1PmoMq",input:"z2K8Q7ib",mobile:"u0fb78AA",focused:"dqF8dYNx",withDropdown:"AqhBggrp",adaptSearchBorders:"Q9RZQaTu",dropdown:"MFGvbICO",dropdownHidden:"Alee0CKy",results:"RtfTOE72",placeholder:"O1HoZFge",separator:"_Yy43QLl",savedTags:"BcvAfv1E",wrap:"JkESCST6",searchTags:"rO3pH3LI",savedSearchTag:"qA4gov4D",hash:"q5NOmUAM",searchTypes:"rVYZG__K",searchType:"nE1Xwoo7",selectedType:"i29dP8iT",footer:"jyS1l9yn","keyboard-visible":"ao05jKHW",keyboardVisible:"ao05jKHW",counter:"NmmL_cO3",mobileNavigation:"dLO1hlHU",navigationButton:"Z4vLAlsu",navigationDisabled:"IqA7R2xO",jumpIn:"n9kXbTu6"},fA={isCustomPeer:!0,avatarIcon:"channel-filled",titleKey:"SearchPublicPosts"},SA="MiddleSearchResult",kA=(0,Ae.sg)((e=>e()),200,!1),wA=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.Xf0)(e);if(!t)return{};const{chatId:a,threadId:n}=t,s=(0,c.hds)(e,a);if(!s)return{};const{requestedQuery:i,savedTag:r,results:o,fetchingQuery:d,isHashtag:m,type:u}=(0,c.TCk)(e)||{},{totalCount:A,foundIds:h,query:y}=o||{},p=e.currentUserId,v=(0,c.nZ4)(e,a),g=(0,l.cG0)(a,n,p),E=v&&!g?e.savedReactionTags?.byKey:void 0;return{chat:s,requestedQuery:i,totalCount:A,threadId:n,foundIds:h,isHistoryCalendarOpen:Boolean((0,c.nTw)(e).historyCalendarSelectedAt),savedTags:E,savedTag:r,isCurrentUserPremium:(0,c.g29)(e),isSavedMessages:v,fetchingQuery:d,isHashtagQuery:m,currentUserId:p,searchType:u,lastSearchQuery:y}}))((e=>{let{isActive:t,chat:a,threadId:i,requestedQuery:d,savedTags:u,savedTag:A,totalCount:h,lastSearchQuery:y,foundIds:p,isHistoryCalendarOpen:v,isCurrentUserPremium:g,isSavedMessages:E,fetchingQuery:C,isHashtagQuery:f,searchType:S="chat",currentUserId:k}=e;const{updateMiddleSearch:N,resetMiddleSearch:P,performMiddleSearch:B,focusMessage:L,closeMiddleSearch:R,openHistoryCalendar:x,openPremiumModal:F,loadSavedReactionTags:V}=(0,s.ko)(),D=(0,n.li)(null),_=(0,n.li)(null),U=(0,n.li)(null),O=(0,n.li)(!1),{isMobile:J}=(0,w.Ay)(),K=(0,T.A)(),j=(0,Us.A)(),[G,z]=(0,n.J0)(d||""),[H,$]=(0,n.J0)(0),Y=p&&H>0,Q=p&&H<p.length-1,[Z,X]=(0,n.J0)(!t),ee=(0,n.li)(),te=(0,n.li)(!0),[ae,ne,se]=(0,I.A)(),[ie,re]=(0,n.J0)(!0),[oe,le]=(0,n.J0)(!1);!function(e,t){const a=(0,M.A)((a=>{e.every((e=>e.current&&!e.current.contains(a.target)))&&t(a)}));(0,n.vJ)((()=>(document.addEventListener("click",a),()=>{document.removeEventListener("click",a)})),[a])}([D],(0,M.A)((e=>{te.current||e.target.closest(".Modal")||se()})));const ce=Boolean(G&&p||f),me=f&&!G,ue=Boolean(G&&p&&!p.length&&!oe&&!me),he=t&&(ie||!J)&&(ae||"myChats"===S||"channels"===S)&&Boolean(ce||ue||me||u),ye=Boolean(G&&!me||A),pe="chat"===S&&Boolean(p?.length),ge=(0,M.A)((()=>{R()})),Ee=(0,M.A)((()=>{(0,o.YS)((()=>{_.current?.focus()}))})),be=(0,M.A)((()=>{_.current?.blur()}));(0,n.vJ)((()=>{const{visualViewport:e}=window;if(!e)return;const t=document.getElementById("Main"),a=()=>{const{activeElement:a}=document;if(a&&a===_.current){const{pageTop:a,height:n}=e;(0,o.RK)((()=>{t.style.transform=`translateY(${a}px)`,t.style.height=`${n}px`,document.documentElement.scrollTop=a}))}else(0,o.RK)((()=>{t.style.transform="",t.style.height=""}))};return e.addEventListener("resize",a),()=>{e.removeEventListener("resize",a)}}),[]),(0,n.vJ)((()=>{$(-1)}),[y]),(0,n.Nf)((()=>{b.pz&&Array.from(document.querySelectorAll("input")).forEach((e=>{e.disabled=Boolean(t&&e!==_.current)}))}),[t]),(0,n.vJ)((()=>{t?(X(!1),clearTimeout(ee.current)):(_.current.blur(),re(!0),$(0),z(""),ee.current=window.setTimeout((()=>X(!0)),200))}),[t]),(0,n.vJ)((()=>{d&&a?.id&&(z(d),N({chatId:a.id,threadId:i,update:{requestedQuery:void 0}}),le(!0),(0,o.Uz)((()=>{const e=_.current;e&&((0,En.A)(e,!0,!0),ne())})))}),[a?.id,d,i]),(0,mn.A)((e=>{let[a]=e;t!==a&&!G&&y&&z(y)}),[t,y,G]),(0,mn.A)((e=>{let[a]=e;t&&a!==v&&(v?(be(),se()):Ee())}),[v,t]);const Ce=(0,M.A)((()=>{G?.length||A?(z(""),le(!1),P(),Ee()):ge()}));(0,n.vJ)((()=>t?(0,m.A)(Ce):void 0),[t,ge]);const fe=(0,n.Kr)((()=>{if(u)return Object.values(u)}),[u]),Se=Boolean(fe?.length),ke=Se&&!g;(0,n.vJ)((()=>{E&&t&&V()}),[E,t]);const we=(0,M.A)((()=>{const e=a?.id;e&&kA((()=>{O.current||B({chatId:e,threadId:i,query:G})}))})),Ne=(0,M.A)((e=>{if(O.current=!1,e.startsWith("#")&&!f)return N({chatId:a.id,threadId:i,update:{isHashtag:!0}}),z(e.slice(1)),void we();z(e),e||(le(!1),P(),O.current=!0)}));(0,n.vJ)((()=>{G&&we()}),[G]),(0,n.vJ)((()=>{le(Boolean(C))}),[C]),(0,n.vJ)((()=>{p?.length&&p.length-H<5&&we()}),[H,p?.length]),(0,n.vJ)((()=>{if(t)return te.current=!0,window.addEventListener("touchend",e),window.addEventListener("mouseup",e),window.addEventListener("touchstart",a),window.addEventListener("mousedown",a),()=>{a(),window.removeEventListener("touchstart",a),window.removeEventListener("mousedown",a)};function e(){_.current?.focus(),ne(),(0,Ae.IJ)((()=>{te.current=!1}))}function a(){window.removeEventListener("touchend",e),window.removeEventListener("mouseup",e),(0,Ae.IJ)((()=>{te.current=!1}))}}),[t]),(0,ve.A)({isActive:t,onBack:ge});const[Ie,Pe,Me=0]=(0,Es.A)(we,p),Te=(0,n.Kr)((()=>{if(!G&&!A||!Ie?.length)return ln.p;const e=(0,s.mS)();return Ie.map((t=>{const[a,n]=(0,Gc.a)(t),s=(0,c.O5q)(e,a,n);if(!s)return;const i=E||(0,l.DXc)(a)||a===r.Ckz?(0,c.Szq)(e,s):void 0,o=(0,c.Y7C)(e,s);return{searchResultKey:t,message:s,messageChat:(0,c.hds)(e,s.chatId),senderPeer:i||o}})).filter(Boolean)}),[G,A,Ie,E]),Be=(0,M.A)((e=>{const t=(0,Gc.D)(e),a=p?.indexOf(t)||0;$(a+Me),"chat"===S&&re(!1),L({chatId:e.chatId,messageId:e.id,threadId:f?void 0:i}),se()})),Le=(0,M.A)((()=>{re((e=>!e)),ne()})),Re=(0,Cs.A)(U,ce,(e=>{const t=Te?.[-1===e?0:e];t&&(Be(t.message),$(e+Me))}),`.${SA}`,!0),xe=(0,M.A)((e=>{N({chatId:a.id,threadId:i,update:e}),we()})),Fe=(0,M.A)((e=>{ke?F({initialSection:"saved_tags"}):xe({savedTag:e})})),Ve=(0,M.A)((()=>{xe({savedTag:void 0})})),De=(0,M.A)((()=>{f?xe({isHashtag:!1}):A&&Ve()})),_e=(0,M.A)((e=>{xe({type:e}),re(!0)})),Ue=(0,M.A)((()=>{if("chat"===S&&(se(),be(),p)){const e=H+1,[t,a]=(0,Gc.a)(p[e]);L({chatId:t,messageId:a,threadId:i}),$(e)}})),Oe=(0,M.A)((()=>{if("chat"===S&&(se(),be(),p)){const e=H-1,[t,a]=(0,Gc.a)(p[e]);L({chatId:t,messageId:a,threadId:i}),$(e)}}));function Je(e,t){const s=!t&&S===e;switch(e){case"chat":return n.Ay.createElement(wl.A,{className:(0,de.A)(CA.searchType,s&&CA.selectedType),peerId:a?.id,title:K("SearchThisChat"),clickArg:"chat",onClick:t?De:_e});case"myChats":return n.Ay.createElement(wl.A,{className:(0,de.A)(CA.searchType,s&&CA.selectedType),peerId:k,forceShowSelf:!0,title:K("SearchMyMessages"),clickArg:"myChats",onClick:t?De:_e});case"channels":return n.Ay.createElement(wl.A,{className:(0,de.A)(CA.searchType,s&&CA.selectedType),customPeer:fA,title:K("SearchPublicPosts"),clickArg:"channels",onClick:t?De:_e})}}function je(){return n.Ay.createElement("div",{className:(0,de.A)(CA.dropdown,!he&&CA.dropdownHidden)},!J&&n.Ay.createElement("div",{className:CA.separator}),Se&&!f&&n.Ay.createElement("div",{className:(0,de.A)(CA.savedTags,!J&&CA.wrap,"no-scrollbar")},fe.map((e=>{const t=(0,l.a0K)(e.reaction,A);return n.Ay.createElement(pA.A,{containerId:"local-search",key:(0,l.Jjj)(e.reaction),reaction:e.reaction,tag:e,withCount:!0,isDisabled:ke,isChosen:t,onClick:t?Ve:Fe})}))),f&&n.Ay.createElement("div",{className:(0,de.A)(CA.searchTypes,"no-scrollbar")},Je("chat"),Je("myChats"),Je("channels")),ce&&n.Ay.createElement(rs.A,{ref:U,className:(0,de.A)(CA.results,"custom-scroll"),items:Te,preloadBackwards:0,onLoadMore:Pe,onKeyDown:Re},ue&&n.Ay.createElement("span",{key:"nothing",className:CA.placeholder},K("NoResultFoundFor",G)),me&&n.Ay.createElement("span",{key:"enterhash",className:CA.placeholder},K("HashtagSearchPlaceholder")),Te?.map(((e,t)=>{let{message:a,senderPeer:s,messageChat:i,searchResultKey:r}=e;return n.Ay.createElement(bA,{key:r,teactOrderKey:-a.date,className:SA,query:G,message:a,senderPeer:s,messageChat:i,shouldShowChat:f,isActive:H-Me===t,onClick:Be})}))))}return n.Ay.createElement("div",{id:"MiddleSearch",className:(0,de.A)(CA.root,t&&CA.active,!t&&Z&&"visually-hidden",ae&&CA.focused,J&&CA.mobile),ref:D},n.Ay.createElement("div",{className:CA.header},!J&&n.Ay.createElement(wt.A,{className:CA.avatar,peer:a,size:"medium",isSavedMessages:E}),n.Ay.createElement(ls.A,{ref:_,value:G,className:(0,de.A)(CA.input,he&&CA.withDropdown,he&&!J&&CA.adaptSearchBorders),canClose:!J,isLoading:oe,resultsItemSelector:`.${CA.results} .${SA}`,hasUpButton:pe&&!J,hasDownButton:pe&&!J,placeholder:K(f?"SearchHashtagsHint":"Search"),teactExperimentControlled:!0,onChange:Ne,onStartBackspace:De,onReset:Ce,withBackIcon:J,onFocus:ne,focused:ae,onUpClick:Q?Ue:void 0,onDownClick:Y?Oe:void 0},n.Ay.createElement("div",{className:CA.searchTags},A&&n.Ay.createElement(pA.A,{containerId:"local-search-tags",className:CA.savedSearchTag,reaction:A,tag:u[(0,l.Jjj)(A)],onClick:Ve}),f&&n.Ay.createElement("div",{className:CA.hash},"#")),!J&&je()),!J&&n.Ay.createElement("div",{className:CA.icons},n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>x({selectedAt:(0,Ke.CS)(Date.now())}),ariaLabel:K("JumpToDate")},n.Ay.createElement(q.A,{name:"calendar"})))),J&&je(),J&&n.Ay.createElement("div",{className:CA.footer},n.Ay.createElement(W.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>x({selectedAt:(0,Ke.CS)(Date.now())}),ariaLabel:K("JumpToDate")},n.Ay.createElement(q.A,{name:"calendar"})),n.Ay.createElement("div",{className:CA.counter},ye&&(p?.length?K("Of",[Math.max(H+1,1),h]):p&&!p.length&&K("NoResult"))),"chat"===S&&Boolean(p?.length)&&n.Ay.createElement(W.A,{className:CA.viewStyle,size:"smaller",isText:!0,fluid:!0,noForcedUpperCase:!0,onClick:Le},K(ie?"SearchAsChat":"SearchAsList")),pe&&!he&&n.Ay.createElement("div",{className:CA.mobileNavigation},n.Ay.createElement(W.A,{className:(0,de.A)(CA.navigationButton,!Q&&CA.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:Ue,nonInteractive:!Q,ariaLabel:j("AriaSearchOlderResult")},n.Ay.createElement(q.A,{name:"up"})),n.Ay.createElement(W.A,{className:(0,de.A)(CA.navigationButton,!Y&&CA.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:Oe,nonInteractive:!Y,ariaLabel:j("AriaSearchNewerResult")},n.Ay.createElement(q.A,{name:"down"})))))})));var NA=a(80539),IA=a(58734),PA=a(73172);const MA=2.5*A.$,TA=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const{setsById:n,added:s,recent:i,favorite:r,effect:o}=e.stickers,d=(0,c.nZ4)(e,a),m=(0,c.hds)(e,a),u=(0,l.L8L)(a)?void 0:(0,c.AWZ)(e,a)?.stickerSet?.id;return{chat:m,effectStickers:o?.stickers,effectEmojis:o?.emojis,recentStickers:i.stickers,favoriteStickers:r.stickers,stickerSetsById:n,addedSetIds:s.setIds,canAnimate:(0,c.ML4)(e),isSavedMessages:d,isCurrentUserPremium:(0,c.g29)(e),chatStickerSetId:u}}))((e=>{let{chat:t,threadId:a,className:i,isHidden:o,isTranslucent:l,loadAndPlay:c,canSendStickers:d,recentStickers:m,favoriteStickers:u,effectStickers:A,effectEmojis:h,addedSetIds:y,stickerSetsById:p,chatStickerSetId:v,canAnimate:g,isSavedMessages:E,isCurrentUserPremium:C,noContextMenus:f,idPrefix:S,onStickerSelect:k,isForEffects:w}=e;const{loadRecentStickers:N,addRecentSticker:I,unfaveSticker:P,faveSticker:B,removeRecentSticker:L}=(0,s.ko)(),R=(0,n.li)(null),x=(0,n.li)(null),F=(0,n.li)(null),{handleScroll:V,isAtBeginning:D}=is(),_=(0,PA.A)(t?.id,a),U=`${S}-sticker-set`,{activeSetIndex:O,observeIntersectionForSet:J,observeIntersectionForPlayingItems:K,observeIntersectionForShowingItems:j,observeIntersectionForCovers:G,selectStickerSet:z}=qo(R,x,U,o),H=(0,T.A)(),$=Boolean(y),Y=(0,n.Kr)((()=>{if(w&&A){const e=[];return h?.length&&e.push({id:r.hfH,accessHash:"0",title:"",stickers:h,count:h.length,isEmoji:!0}),A?.length&&e.push({id:r.Kp3,accessHash:"0",title:H("StickerEffects"),stickers:A,count:A.length}),e}if(!y)return ln.p;const e=[];u.length&&e.push({id:r.tRH,accessHash:"0",title:H("FavoriteStickers"),stickers:u,count:u.length}),m.length&&e.push({id:r.sR2,accessHash:"0",title:H("RecentStickers"),stickers:m,count:m.length});const t=[...y||[]];v&&t.unshift(v);const a=Object.values((0,on._E)(p,t));return[...e,...a]}),[y,p,u,m,v,H,A,w,h]),Q=(0,n.Kr)((()=>$&&0===Y.filter((e=>e.stickers?.length)).length),[Y,$]);(0,n.vJ)((()=>{c&&(N(),d&&_({type:"chooseSticker"}))}),[d,c,N,_]);const Z=(0,jo.A)([],r.jhd),X=$&&Z&&!Q&&(d||w);(0,di.A)(x,!X||!x.current),(0,n.vJ)((()=>{if(!$)return;const e=x.current;if(!e)return;const t=O*MA-(e.offsetWidth/2-MA/2);(0,ar.A)(e,t)}),[$,O]);const ee=(0,M.A)(((e,t,a)=>{k(e,t,a,!0),I({sticker:e})})),te=(0,M.A)((e=>{P({sticker:e})})),ae=(0,M.A)((e=>{B({sticker:e})})),ne=(0,M.A)((()=>{d&&_({type:"chooseSticker"})})),se=(0,M.A)((e=>{L({sticker:e})}));if(!t)return;const ie=(0,de.A)("lq8BD6Hc",i);if(!X)return n.Ay.createElement("div",{className:ie},d||w?Q?n.Ay.createElement("div",{className:vl},H("NoStickers")):n.Ay.createElement(fs.A,null):n.Ay.createElement("div",{className:vl},H("ErrorSendRestrictedStickersAll")));const re=(0,de.A)(hl,"no-scrollbar",!D&&yl);return n.Ay.createElement("div",{className:ie},!w&&n.Ay.createElement("div",{ref:x,className:re},n.Ay.createElement("div",{className:"shared-canvas-container"},n.Ay.createElement("canvas",{ref:F,className:"shared-canvas"}),Y.map((function(e,a){const s=e.stickers?.[0],i=(0,de.A)(pl,a===O&&"y02WwQk6"),o=a<r.j41;return e.id===r.sR2||e.id===r.tRH||e.id===r.eKB||e.hasThumbnail||!s?n.Ay.createElement(W.A,{key:e.id,className:i,ariaLabel:e.title,round:!0,faded:e.id===r.sR2||e.id===r.tRH,color:"translucent",onClick:()=>z(a)},e.id===r.sR2?n.Ay.createElement(q.A,{name:"recent"}):e.id===r.tRH?n.Ay.createElement(q.A,{name:"favorite"}):e.id===r.eKB?n.Ay.createElement(wt.A,{peer:t,size:"small"}):n.Ay.createElement(Xo,{stickerSet:e,noPlay:!g||!c,observeIntersection:G,sharedCanvasRef:o?F:void 0,forcePlayback:!0})):n.Ay.createElement(sl,{key:e.id,sticker:s,size:r.TBj,title:e.title,className:i,noPlay:!g||!c,observeIntersection:G,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:o?F:void 0,withTranslucentThumb:l,onClick:z,clickArg:a,forcePlayback:!0})})))),n.Ay.createElement("div",{ref:R,onMouseMove:ne,onScroll:V,className:(0,de.A)(ul,b.TF?"no-scrollbar":"custom-scroll",!w&&Al)},Y.map(((e,t)=>n.Ay.createElement(dl,{key:e.id,stickerSet:e,loadAndPlay:Boolean(g&&c),noContextMenus:f,index:t,idPrefix:U,observeIntersection:J,observeIntersectionForPlayingItems:K,observeIntersectionForShowingItems:j,isNearActive:O>=t-1&&O<=t+1,favoriteStickers:u,isSavedMessages:E,isCurrentUserPremium:C,isTranslucent:l,isChatStickerSet:e.id===v,onStickerSelect:ee,onStickerUnfave:te,onStickerFave:ae,onStickerRemoveRecent:se,forcePlayback:!0,shouldHideHeader:e.id===r.hfH})))))}))),BA=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const{availableReactions:n,topReactions:s}=e.reactions,{maxUniqueReactions:i}=e.appConfig||{},{enabledReactions:r,isPaidReactionAvailable:o}=(0,c.AWZ)(e,a)||{};return{enabledReactions:r,availableReactions:n,topReactions:s,reactionsLimit:i,isWithPaidReaction:o}}))((e=>{let{loadAndPlay:t,enabledReactions:a,availableReactions:s,topReactions:i,selectedReactionIds:r,isWithPaidReaction:o,message:c,reactionsLimit:d,onReactionSelect:m,onReactionContext:u}=e;const h=(0,n.li)(null),y=(0,n.li)(null),{width:p}=(0,Ce.A)(),{isTouchScreen:v}=(0,w.Ay)(),g=c?.reactions?.results,E=d&&g&&g.length>=d,b=(0,n.Kr)((()=>{if(E){const e=g.map((e=>{let{reaction:t}=e;return t}));return o&&e.unshift({type:"paid"}),e}if(!a)return[];if("all"===a.type){const e=(s||[]).map((e=>{let{reaction:t}=e;return t}));return o&&e.unshift({type:"paid"}),(0,l.fuR)(e,i)}const e=a.allowed;return o&&e.unshift({type:"paid"}),(0,l.fuR)(e,i)}),[s,a,i,E,g,o]),C=(0,n.Kr)((()=>{const e=Math.min(26.25*A.$,p),t=(p>600?.625:.5)*A.$,a=e-.5*A.$,n=Math.floor((a+t)/(36+t)),s=Math.ceil(b.length/n),i=36*s+(s-1)*t+.5*A.$*2;return Math.min(18*A.$,i)}),[b.length,p]);return n.Ay.createElement("div",{className:"MhpiTAwi",style:`height: ${C}px`},n.Ay.createElement("div",{className:(0,de.A)("NIaqmosK",v?"no-scrollbar":"custom-scroll")},n.Ay.createElement("div",{className:"symbol-set-container shared-canvas-container"},n.Ay.createElement("canvas",{ref:h,className:"shared-canvas"}),n.Ay.createElement("canvas",{ref:y,className:"shared-canvas"}),b.map((e=>{const a=(0,l.Jjj)(e),i=a?r?.includes(a):void 0;return n.Ay.createElement(ll,{key:a,reaction:e,isSelected:i,loadAndPlay:t,availableReactions:s,onClick:m,onContextMenu:u,sharedCanvasRef:h,sharedCanvasHqRef:y})})))))}))),LA=16.375*A.$,RA=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.nTw)(e),a=e.availableEffectById,{chatId:n,messageId:s,storyPeerId:i,storyId:r,position:o,sendAsMessage:d,isForEffects:m}=t.reactionPicker||{},u=i&&r?(0,c.Msb)(e,i,r):void 0,A=n?(0,c.hds)(e,n):void 0,h=n?(0,c.AWZ)(e,n):void 0,y=n&&s?(0,c.O5q)(e,n,s):void 0,p=(0,l.L8L)(n||i||""),v="some"===h?.enabledReactions?.type,{maxUniqueReactions:g}=e.appConfig||{},E="all"===h?.enabledReactions?.type&&h?.enabledReactions?.areCustomAllowed,b=y?.reactions?.results,C=Boolean(g&&b&&b.length>=g);return{message:y,story:u,position:o,shouldUseFullPicker:!(A?.isForbidden||v||C)&&(E||p),isTranslucent:(0,c.cwE)(e),isCurrentUserPremium:(0,c.g29)(e),sendAsMessage:d,isForEffects:m,chatId:n,availableEffectById:a}}))((e=>{let{isOpen:t,message:a,story:i,position:r,isTranslucent:o,isCurrentUserPremium:c,shouldUseFullPicker:d,sendAsMessage:m,chatId:u,isForEffects:A,availableEffectById:h}=e;const{toggleReaction:y,closeReactionPicker:p,sendMessage:v,showNotification:g,sendStoryReaction:E,saveEffectInDraft:b,requestEffectInComposer:C,addLocalPaidReaction:f,openPaidReactionModal:S}=(0,s.ko)(),k=(0,T.A)(),N=(0,Cn.A)(a?.id,!0),I=(0,Cn.A)(a?.chatId,!0),P=(0,Cn.A)(i?.peerId,!0),B=(0,Cn.A)(i?.id),L=(0,Cn.A)(r,!0),R=(0,n.li)(null),x=(0,n.Kr)((()=>{if(L)return B?L:{x:L.x+(d?-23:-21),y:L.y+(d?-64:-10)}}),[B,L,d]),F=(0,M.A)((()=>R.current)),V=(0,M.A)((()=>({withPortal:!0,isDense:!P,deltaX:!(0,w.Ny)()&&R.current?-(R.current.offsetWidth-LA)/2- -11.5:0}))),D=(0,M.A)((e=>{if(!I||!N)return;const t=e.isCustomEmoji?{type:"custom",documentId:e.id}:{type:"emoji",emoticon:e.emoji};y({chatId:I,messageId:N,reaction:t,shouldAddToRecent:!0}),p()})),_=(0,M.A)((e=>{I&&N&&("paid"===e.type?f({chatId:I,messageId:N,count:1}):y({chatId:I,messageId:N,reaction:e,shouldAddToRecent:!0}),p())})),O=(0,M.A)((e=>{"paid"===e.type&&(S({chatId:I,messageId:N}),p())})),J=(0,M.A)((e=>{if("type"in e&&"paid"===e.type)return;const t="id"in e?{type:"custom",documentId:e.id}:e,a="type"in e&&"custom"===e.type?(0,s.mS)().customEmojis.byId[e.documentId]:"id"in e?e:void 0;if(a&&!a.isFree&&!c)return g({message:k("UnlockPremiumEmojiHint"),action:{action:"openPremiumModal",payload:{initialSection:"animated_emoji"}},actionText:k("PremiumMore")}),void p();if(!m)return E({peerId:P,storyId:B,containerId:(0,l.$_j)(P,B),reaction:t,shouldAddToRecent:!0}),void p();let n,i;if("type"in e&&"emoji"===e.type)n=e.emoticon;else{const e=(0,NA.Ay)((0,IA.hB)(a));n=e.text,i=e.entities}v({text:n,entities:i,isReaction:!0}),p()})),K=(0,M.A)((e=>{const t=Object.values(h),a=t.find((t=>t.effectStickerId===e.id))?.id;u&&b({chatId:u,threadId:U.l3,effectId:a}),a&&C({}),p()})),j=(0,n.Kr)((()=>(a?.reactions?.results||[]).reduce(((e,t)=>{let{chosenOrder:a,reaction:n}=t;return void 0!==a&&e.push((0,l.Jjj)(n)),e}),[])),[a?.reactions?.results]);return n.Ay.createElement(Ge.A,{isOpen:t,ref:R,className:(0,de.A)("gBh4WvBC","ReactionPicker"),bubbleClassName:(0,de.A)("qSfKwMzX",!d&&!B&&"dRNSqkOC",B&&"srpBMrqr"),withPortal:!0,noCompact:!0,anchor:x,positionY:i&&"bottom",getTriggerElement:xA,getRootElement:FA,getMenuElement:F,getLayout:V,backdropExcludedSelector:".Modal.confirm",onClose:p},A&&u?n.Ay.createElement(TA,{className:"",isHidden:!t,loadAndPlay:Boolean(t&&d),idPrefix:"message-effect",canSendStickers:!1,noContextMenus:!1,chatId:u,isTranslucent:o,onStickerSelect:K,isForEffects:A}):n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(fl,{chatId:I,idPrefix:"message-emoji-set-",isHidden:!t||!(d||B),loadAndPlay:Boolean(t&&d),isReactionPicker:!0,className:d||B?void 0:"KVwgF6DG",selectedReactionIds:j,isTranslucent:o,onCustomEmojiSelect:B?J:D,onReactionSelect:B?J:_,onReactionContext:O}),!d&&Boolean(I)&&n.Ay.createElement(BA,{chatId:I,loadAndPlay:t,onReactionSelect:B?J:_,onReactionContext:O,selectedReactionIds:j,message:a})))})));function xA(){return document.querySelector("body")}function FA(){return document.querySelector("body")}var VA=a(39074),DA=a(45761);const _A=document.createElement("div");var UA=a(41316),OA=a(3225),JA=a(25498),KA=a(9442),jA=a(91525),GA=a(52988),zA=a(27860);const HA="SHoF85Vw",$A="Zo7u5epf",qA=15*A.$,WA=(0,n.ph)((e=>{let{attachment:t,className:a,isSingle:s,shouldDisplayCompressed:i,shouldDisplayGrouped:o,index:l,onDelete:c,onToggleSpoiler:d}=e;const m=function(e,t){if(t&&e.quick){if(r.gex.has(e.mimeType))return"photo";if(r.fNs.has(e.mimeType))return"video"}return"file"}(t,i),u=(0,M.A)((()=>{d?.(l)})),A=(0,n.Kr)((()=>{switch(m){case"photo":return n.Ay.createElement("img",{className:HA,src:t.blobUrl,alt:"",draggable:!1});case"video":return n.Ay.createElement(n.Ay.Fragment,null,Boolean(t.quick?.duration)&&n.Ay.createElement("div",{className:"nI2M1SBH"},(0,Ke.QO)(t.quick.duration)),n.Ay.createElement("video",{className:HA,src:t.blobUrl,autoPlay:!0,muted:!0,loop:!0,disablePictureInPicture:!0}));default:return n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(GA.A,{className:"B6f6GcvN",name:t.filename,extension:(0,jA.QC)(t.filename,t.mimeType),previewData:t.previewBlobUrl,size:t.size,smaller:!0}),c&&n.Ay.createElement(q.A,{name:"delete",className:(0,de.A)($A,"CYJwy9T_"),onClick:()=>c(l)}))}}),[t,m,l,c]),h="file"===m||!o,y=Boolean("file"!==m&&t.shouldSendAsSpoiler),p="file"!==m,v=(0,de.A)(a,"QucaiGVU",s&&"FjrnqGba",h&&"g0cTsM9d");return n.Ay.createElement("div",{className:v},A,n.Ay.createElement(zA.A,{isVisible:y,thumbDataUri:t.previewBlobUrl||t.blobUrl,width:qA,height:qA}),p&&n.Ay.createElement("div",{className:"bX7LdgxW"},n.Ay.createElement(q.A,{name:t.shouldSendAsSpoiler?"spoiler-disable":"spoiler",className:$A,onClick:u}),c&&n.Ay.createElement(q.A,{name:"delete",className:$A,onClick:()=>c(l)})))}));var YA=a(25897),QA=a(83689),ZA=a(49068);function XA(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e[a?"scrollLeft":"scrollTop"],s=n+e[a?"offsetWidth":"offsetHeight"],i=t[a?"offsetLeft":"offsetTop"],r=i+t[a?"offsetWidth":"offsetHeight"];return i>n&&r<s}function eh(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const r=e[i?"scrollLeft":"scrollTop"],o=r+e[i?"offsetWidth":"offsetHeight"],l="string"==typeof t?e.querySelectorAll(t):t,{length:c}=l,d=[];let m=!1;for(let e=0;e<c;e++){const t=l[e],c=t[i?"offsetLeft":"offsetTop"],u=c+t[i?"offsetWidth":"offsetHeight"];if(s?u>=r-a&&u<=o+a:c<=o+a&&u>=r-a)d.push(e),m=!0;else if(m&&!n)break}return{allElements:l,visibleIndexes:d}}function th(e,t,a){const n=a.current;if(!n||t<0)return;const{visibleIndexes:s,allElements:i}=eh(n,e,8,!0,!0);if(!i.length||!i[t])return;const r=s[0];if(!s.includes(t)||t===r&&!XA(n,i[r])){const e=t>s[s.length-1]?"start":"end";(0,Go.Ay)({container:n,element:i[t],position:e,margin:10})}}function ah(e){let{isActive:t,isHorizontal:a,shouldSaveSelectionOnUpdateItems:s,shouldRemoveSelectionOnReset:i,noArrowNavigation:r,items:o,shouldSelectOnTab:l,onSelect:c,onClose:d}=e;const[m,u]=(0,n.J0)(-1),A=(0,M.A)((e=>o?(0,mr.A)(o.length,e):-1)),h=(0,M.A)(((e,t)=>{t.preventDefault(),u((t=>A(t+e)))})),y=(0,M.A)((e=>{if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return!1;if(!t)return!1;if(o&&o.length&&m>-1){const t=o[m];if(t){if(!1===c(t))return!1;e.preventDefault()}}return!0}));(0,n.vJ)((()=>{t||u(i?-1:0)}),[t,i]);const p=!o||m>o.length-1;return(0,n.vJ)((()=>{s&&!p||u(i?-1:0)}),[p,i,s]),(0,n.vJ)((()=>t?(0,fn.A)({onEsc:d,onUp:r||a?void 0:e=>h(-1,e),onDown:r||a?void 0:e=>h(1,e),onLeft:r||!a?void 0:e=>h(-1,e),onRight:r||!a?void 0:e=>h(1,e),onTab:l?y:void 0,onEnter:y}):void 0),[r,h,y,t,a,d,l]),m}const nh=(0,n.ph)((e=>{let{isOpen:t,onClose:a,onInsertUserName:i,filteredUsers:r}=e;const o=(0,n.li)(null),{shouldRender:l,transitionClassNames:c}=(0,De.A)(t,void 0,void 0,!1),d=(0,M.A)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=(0,s.mS)().users.byId[e];a&&i(a,t)})),m=(0,M.A)(((e,t)=>{e.preventDefault(),d(t)})),u=(0,M.A)((e=>{d(e.id,!0)})),A=ah({isActive:t,items:r,onSelect:u,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:a});(0,n.vJ)((()=>{th(".chat-item-clickable",A,o)}),[A]),(0,n.vJ)((()=>{r&&!r.length&&a()}),[r,a]);const h=(0,D.A)(r?.length?r:void 0,l),y=r&&!r.length?h:r;if(!l||y&&!y.length)return;const p=(0,de.A)("MentionTooltip composer-tooltip custom-scroll",c);return n.Ay.createElement("div",{className:p,ref:o},y?.map(((e,t)=>{let{id:a}=e;return n.Ay.createElement(Wa.A,{key:a,className:"chat-item-clickable scroll-item smaller-icon",onClick:m,clickArg:a,focus:A===t},n.Ay.createElement(ds.A,{userId:a,avatarSize:"small",withUsername:!0}))})))}));var sh=a(78407),ih=a(26440);const rh="AT_d9l0W",oh="AnO3BgVv",lh="caption-input-text",ch=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const{currentUserId:n,recentEmojis:s,customEmojis:i,attachmentSettings:o}=e,d=(0,l.L8L)(a)?void 0:(0,c.AWZ)(e,a),m=(0,c.nZ4)(e,a),{language:u,shouldSuggestCustomEmoji:A}=e.settings.byKey,h=e.emojiKeywords[r.cUY],y=u!==r.cUY?e.emojiKeywords[u]:void 0;return{isChatWithSelf:m,currentUserId:n,groupChatMembers:d?.members,recentEmojis:s,baseEmojiKeywords:h?.keywords,emojiKeywords:y?.keywords,shouldSuggestCustomEmoji:A,customEmojiForEmoji:i.forEmoji.stickers,captionLimit:(0,Yi.d)(e,"captionLength"),attachmentSettings:o}}))((e=>{let{chatId:t,threadId:a,attachments:i,getHtml:c,editingMessage:d,canShowCustomSendMenu:u,captionLimit:A,isReady:h,isChatWithSelf:y,currentUserId:p,groupChatMembers:v,recentEmojis:g,baseEmojiKeywords:E,emojiKeywords:b,isForMessage:C,shouldSchedule:f,shouldSuggestCustomEmoji:S,customEmojiForEmoji:k,attachmentSettings:N,shouldSuggestCompression:P,shouldForceCompression:B,shouldForceAsFile:L,isForCurrentMessageList:R,forceDarkTheme:x,onAttachmentsUpdate:F,onCaptionUpdate:V,onSend:_,onFileAppend:U,onClear:O,onSendSilent:K,onSendScheduled:j,onCustomEmojiSelect:G,onRemoveSymbol:z,onEmojiSelect:H,canScheduleUntilOnline:$,onSendWhenOnline:Y}=e;const Z=(0,n.li)(null),X=(0,n.li)(null),{addRecentCustomEmoji:ee,addRecentEmoji:te,updateAttachmentSettings:ae}=(0,s.ko)(),ne=(0,T.A)(),se=(0,n.li)(null),ie=(0,n.li)(null),le=(0,n.li)(),ce=(0,D.A)(i),me=i.length?i:ce,{isMobile:ue}=(0,w.Ay)(),Ae=d&&Boolean(d),he=d&&d?.groupedId,ye="file"!==(Ae&&i?.length&&(0,l.ESk)(i[0])),[ve,Ee,be]=(0,I.A)(),[Ce,fe]=(0,n.J0)(P??N.shouldCompress),Se=Boolean((Ce||B||he)&&!L),[ke,we]=(0,n.J0)(N.shouldSendGrouped),Ne=N.isInvertedMedia,{handleScroll:Ie,isAtBeginning:Pe,isAtEnd:Me}=is(),{handleScroll:Te,isAtBeginning:Be}=is(),Le=Boolean(i.length),Re=Boolean(me?.length),[xe,Fe,Ve]=(0,I.A)();(0,n.vJ)((()=>{Le||(be(),ae({isInvertedMedia:void 0}))}),[be,Le]);const[De,_e]=(0,n.Kr)((()=>Boolean(me?.every((e=>e.quick||e.audio)))?[!0,!0]:[Boolean(me?.some((e=>e.quick||e.audio))),!1]),[me]),[Ue,Oe]=(0,n.Kr)((()=>Boolean(me?.every((e=>e.shouldSendAsSpoiler)))?[!0,!0]:[Boolean(me?.some((e=>e.shouldSendAsSpoiler))),!1]),[me]),Je=(0,UA.A)(`#${r.e0F}`),{isEmojiTooltipOpen:Ke,filteredEmojis:je,filteredCustomEmojis:Ge,insertEmoji:ze,closeEmojiTooltip:He}=(0,JA.A)(Boolean(h&&(R||!C)&&Re),c,V,r.e0F,g,E,b),{isCustomEmojiTooltipOpen:$e,insertCustomEmoji:qe,closeCustomEmojiTooltip:We}=(0,OA.A)(Boolean(h&&(R||!C)&&Re&&S),c,V,Je,ie,k),{isMentionTooltipOpen:Ye,closeMentionTooltip:Qe,insertMention:Ze,mentionFilteredUsers:Xe}=(0,KA.A)(Boolean(h&&R&&Re),c,V,Je,ie,v,void 0,p);function et(e){ae({isInvertedMedia:e})}(0,n.vJ)((()=>Le?(0,m.A)(O):void 0),[Le,O]),(0,n.vJ)((()=>{Le&&(fe(P??N.shouldCompress),we(N.shouldSendGrouped))}),[N,Le,P]),(0,n.vJ)((()=>{Le||ae({isInvertedMedia:void 0})}),[ae,Le,P]),(0,n.vJ)((()=>{Le&&ue&&(0,VA.DY)()}),[ue,Le]);const{isContextMenuOpen:tt,handleContextMenu:at,handleContextMenuClose:nt,handleContextMenuHide:st}=(0,si.A)(se,!u||!Le),it=(0,M.A)(((e,t)=>{Le&&(((f||t)&&C&&!d?j:e?K:_)(Se,ke,Ne),ae({shouldCompress:void 0===P?Se:void 0,shouldSendGrouped:ke,isInvertedMedia:Ne}))})),rt=(0,M.A)((()=>{it(!0)})),ot=(0,M.A)((()=>{it()})),lt=(0,M.A)((()=>{it(!1,!0)})),ct=(0,M.A)((async e=>{e.preventDefault(),Ve();const{dataTransfer:t}=e,a=await(0,DA.A)(t.items);a?.length&&U(a,Oe)})),dt=(0,M.A)((e=>{const{files:t}=e.target,a=(0,J.kc)(t);a?.length&&U(a,Oe)})),mt=(0,M.A)((()=>{(0,Fm.p)("*",(e=>dt(e)))})),ut=(0,M.A)((e=>{F(i.filter(((t,a)=>a!==e)))})),At=(0,M.A)((()=>{F(i.map((e=>({...e,shouldSendAsSpoiler:!0}))))})),ht=(0,M.A)((()=>{F(i.map((e=>({...e,shouldSendAsSpoiler:void 0}))))})),yt=(0,M.A)((e=>{F(i.map(((t,a)=>a===e?{...t,shouldSendAsSpoiler:!t.shouldSendAsSpoiler||void 0}:t)))})),pt=(0,M.A)((()=>{const e=X.current;if(!e)return;const{width:t,height:a}=e.getBoundingClientRect();e.viewBox.baseVal.width=t,e.viewBox.baseVal.height=a}));(0,il.A)(Z,pt),(0,ge.A)(pt),(0,n.vJ)((()=>{const e=se.current,t=document.getElementById(lh);if(!e||!t)return;const{width:a}=e.getBoundingClientRect();(0,o.RK)((()=>{t.style.setProperty("--margin-for-scrollbar",`${a}px`)}))}),[ne,Le]);const vt=(0,n.Kr)((()=>e=>{let{onTrigger:t,isOpen:a}=e;return n.Ay.createElement(W.A,{round:!0,ripple:!ue,size:"smaller",color:"translucent",className:a?"active":"",onClick:t,ariaLabel:"More actions"},n.Ay.createElement(q.A,{name:"more"}))}),[ue]),gt=(0,pe.A)((()=>{if(!Re)return;const e=A-(t=c(),_A.innerHTML=t,(0,NA.g4)(_A),_A.querySelectorAll("br").forEach((e=>{e.replaceWith("\n")})),_A.textContent?.trim().length||0);var t;return e<=100?e:void 0}),[A,c,Re]),Et=Se&&_e,[bt,Ct,ft]=(0,n.Kr)((()=>Et&&me?[me.every((e=>r.gex.has(e.mimeType))),me.every((e=>r.fNs.has(e.mimeType))),me.every((e=>r.IH3.has(e.mimeType)))]:[!1,!1,!1]),[me,Et]),St=(0,n.Kr)((()=>!!me&&me.some((e=>!r.IH3.has(e.mimeType)))),[me]);if(!me)return;const kt=me.length>1,wt=!(Ae||!De||!(L||B||Se)||kt&&ke);let Nt="";Nt=ne(bt?Ae?"EditMessageReplacePhoto":"PreviewSender.SendPhoto":Ct?Ae?"EditMessageReplaceVideo":"PreviewSender.SendVideo":ft?Ae?"EditMessageReplaceAudio":"PreviewSender.SendAudio":Ae?"EditMessageReplaceFile":"PreviewSender.SendFile",me.length,"i");const It=!Me||!Be;return n.Ay.createElement(Q.A,{isOpen:Le,onClose:O,header:function(){if(me)return n.Ay.createElement("div",{className:"modal-header-condensed",dir:ne.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Cancel attachments",onClick:O},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},Nt),ye&&!he&&n.Ay.createElement(re.A,{className:"attachmeneditingMessaget-modal-more-menu with-menu-transitions",trigger:vt,positionX:"right"},Boolean(!d)&&n.Ay.createElement(oe.A,{icon:"add",onClick:mt},ne("Add")),De&&n.Ay.createElement(n.Ay.Fragment,null,wt&&(Ne?n.Ay.createElement(oe.A,{icon:"move-caption-down",onClick:()=>et(void 0)},ne("PreviewSender.MoveTextDown")):n.Ay.createElement(oe.A,{icon:"move-caption-up",onClick:()=>et(!0)},ne("PreviewSender.MoveTextUp"))),!L&&!B&&(Se?n.Ay.createElement(oe.A,{icon:"document",onClick:()=>fe(!1)},ne(kt?"Attachment.SendAsFiles":"Attachment.SendAsFile")):n.Ay.createElement(oe.A,{icon:"photo",onClick:()=>fe(!0)},kt?"Send All as Media":"Send as Media")),Se&&St&&Boolean(!d)&&(Ue?n.Ay.createElement(oe.A,{icon:"spoiler-disable",onClick:ht},ne("Attachment.DisableSpoiler")):n.Ay.createElement(oe.A,{icon:"spoiler",onClick:At},ne("Attachment.EnableSpoiler")))),kt&&(ke?n.Ay.createElement(oe.A,{icon:"grouped-disable",onClick:()=>we(!1)},"Ungroup All Media"):n.Ay.createElement(oe.A,{icon:"grouped",onClick:()=>we(!0)},"Group All Media"))))}(),className:(0,de.A)("a27O2Qlr",xe&&oh,!Pe&&"Pc1k8G8s",ue&&"khvUZbGZ",ve&&"ir5kkMy1",x&&"component-theme-dark"),noBackdropClose:!0},n.Ay.createElement("div",{className:rh,onDragEnter:Fe,onDrop:ct,onDragOver:function(e){e.preventDefault(),le.current&&(window.clearTimeout(le.current),le.current=void 0)},onDragLeave:e=>{const{relatedTarget:t,target:a}=e;a.matches(`.${rh}`)&&!t&&(le.current=window.setTimeout(Ve,150)),a&&a.closest(`.${oh}`)||(t&&e.stopPropagation(),Ve())},onClick:Ve,"data-attach-description":ne("Preview.Dragging.AddItems",10),"data-dropzone":!0},n.Ay.createElement("svg",{className:"d9O65j_I"},n.Ay.createElement("rect",{className:"jzCBDWMw",x:"0",y:"0",width:"100%",height:"100%",rx:"8"})),n.Ay.createElement("div",{className:(0,de.A)("_bxSIFgj","custom-scroll",It&&"RPVunBe2"),onScroll:Ie},me.map(((e,t)=>n.Ay.createElement(WA,{attachment:e,shouldDisplayCompressed:Se,shouldDisplayGrouped:ke,isSingle:1===me.length,index:t,key:e.uniqueId||t,onDelete:ut,onToggleSpoiler:yt})))),n.Ay.createElement("div",{className:(0,de.A)("EtmiUn2k",It&&"FjjSKMYe")},n.Ay.createElement(nh,{isOpen:Ye,filteredUsers:Xe,onInsertUserName:Ze,onClose:Qe}),n.Ay.createElement(ZA.A,{isOpen:Ke,emojis:je,customEmojis:Ge,addRecentEmoji:te,addRecentCustomEmoji:ee,onEmojiSelect:ze,onCustomEmojiSelect:ze,onClose:He}),n.Ay.createElement(YA.A,{chatId:t,isOpen:$e,addRecentCustomEmoji:ee,onCustomEmojiSelect:qe,onClose:We}),n.Ay.createElement("div",{className:"Te7lIfpB"},n.Ay.createElement(ih.A,{chatId:t,threadId:a,isMobile:ue,isReady:h,isSymbolMenuOpen:ve,openSymbolMenu:Ee,closeSymbolMenu:be,onCustomEmojiSelect:G,onRemoveSymbol:z,onEmojiSelect:H,isAttachmentModal:!0,canSendPlainText:!0,className:"attachment-modal-symbol-menu with-menu-transitions",idPrefix:"attachment",forceDarkTheme:x}),n.Ay.createElement(sh.A,{ref:ie,id:lh,chatId:t,threadId:a,isAttachmentModalInput:!0,customEmojiPrefix:"attachment",isReady:h,isActive:Le,getHtml:c,editableInputId:r.e0F,placeholder:ne("AddCaption"),onUpdate:V,onSend:ot,onScroll:Te,canAutoFocus:Boolean(h&&R&&i.length),captionLimit:gt,shouldSuppressFocus:ue&&ve,onSuppressedFocus:be}),n.Ay.createElement("div",{className:"wDqWK9MD"},n.Ay.createElement(W.A,{ref:se,className:"kNlWmBJI",onClick:ot,onContextMenu:u?at:void 0},ne(f&&!d?"Next":d?"Save":"Send")),u&&n.Ay.createElement(QA.A,{isOpen:tt,canSchedule:C,onSendSilent:y?void 0:rt,onSendSchedule:lt,onClose:nt,onCloseAnimationEnd:st,isSavedMessages:y,onSendWhenOnline:Y,canScheduleUntilOnline:$}))))))}))),dh=(0,n.ph)((e=>{let{isOpen:t,isQuiz:a,shouldBeAnonymous:s,onSend:i,onClear:r}=e;const l=(0,n.li)(null),c=(0,n.li)(null),[d,u]=(0,n.J0)(""),[A,h]=(0,n.J0)([""]),[y,p]=(0,n.J0)(!0),[v,g]=(0,n.J0)(!1),[E,b]=(0,n.J0)(a||!1),[C,f]=(0,n.J0)(""),[S,k]=(0,n.J0)(),[w,N]=(0,n.J0)(!1),I=(0,T.A)(),P=(0,M.A)((e=>{f(e.target.value)})),B=(0,M.A)((e=>{t&&e.current&&e.current.focus()}));(0,n.vJ)((()=>t?(0,m.A)(r):void 0),[t,r]),(0,n.vJ)((()=>{t||(u(""),h([""]),p(!0),g(!1),b(a||!1),f(""),k(void 0),N(!1))}),[a,t]),(0,n.vJ)((()=>B(l)),[B,t]);const L=(0,M.A)((function(){h([...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],""]),(0,o.Uz)((()=>{const e=c.current;e&&(0,o.YS)((()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}))}))})),R=(0,M.A)((()=>{if(N(!1),!t)return;const e=E&&(void 0===S||!A[S].trim()),a=A.map(((e,t)=>{if(e=e.trim())return{text:{text:e},option:String(t),...t===S&&{correct:!0}}})).filter(Boolean),n=d.trim().substring(0,255);if(!n||a.length<2){if(u(n),a.length){const e=A.map((e=>e.trim().substring(0,100))).filter(Boolean);e.length<2?L(e):h(e)}else L();return void N(!0)}if(e)return void N(!0);const s={summary:{question:{text:n},answers:a,...!y&&{isPublic:!0},...v&&{multipleChoice:!0},...E&&{quiz:!0}}};if(E){const{text:e,entities:t}=C&&(0,NA.Ay)(C.substring(0,200))||{};s.quiz={correctAnswers:[String(S)],...e&&{solution:e},...t&&{solutionEntities:t}}}i(s)})),x=(0,M.A)(((e,t)=>{const a=[...A];a[e]=t,a[a.length-1].trim().length&&a.length<10?L(a):h(a)})),F=(0,M.A)((e=>{const t=[...A];t.splice(e,1),h(t),void 0!==S&&(S===e?k(void 0):e<S&&k(S-1)),(0,o.Uz)((()=>{c.current&&c.current.classList.toggle("overflown",c.current.scrollHeight>320)}))})),V=(0,M.A)((e=>{k(Number(e))})),D=(0,M.A)((e=>{p(e.target.checked)})),_=(0,M.A)((e=>{g(e.target.checked)})),U=(0,M.A)((e=>{b(e.target.checked)})),O=(0,M.A)((e=>{13===e.keyCode&&R()})),J=(0,M.A)((e=>{u(e.target.value)})),K=(0,M.A)((()=>{if(w&&!d.trim().length)return I("lng_polls_choose_question")})),j=(0,M.A)((e=>{const t=A.map((e=>e.trim())).filter((e=>e.length));if(w&&t.length<2&&!A[e].trim().length)return I("lng_polls_choose_answers")}));function G(){return A.map(((e,t)=>n.Ay.createElement("div",{className:"option-wrapper"},n.Ay.createElement(Y.A,{label:t!==A.length-1||10===A.length?I("OptionHint"):I("CreatePoll.AddOption"),error:j(t),value:e,onChange:e=>x(t,e.currentTarget.value),onKeyPress:O}),t!==A.length-1&&n.Ay.createElement(W.A,{className:"option-remove-button",round:!0,color:"translucent",size:"smaller",ariaLabel:I("Delete"),onClick:()=>F(t)},n.Ay.createElement(q.A,{name:"close"})))))}return n.Ay.createElement(Q.A,{isOpen:t,onClose:r,header:n.Ay.createElement("div",{className:"modal-header-condensed"},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Cancel poll creation",onClick:r},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("div",{className:"modal-title"},I("NewPoll")),n.Ay.createElement(W.A,{color:"primary",size:"smaller",className:"modal-action-button",onClick:R},I("Create"))),className:"PollModal"},n.Ay.createElement(Y.A,{ref:l,label:I("AskAQuestion"),value:d,error:K(),onChange:J,onKeyPress:O}),n.Ay.createElement("div",{className:"options-divider"}),n.Ay.createElement("div",{className:"options-list custom-scroll",ref:c},n.Ay.createElement("h3",{className:"options-header"},I("PollOptions")),w&&function(){const e=A.map((e=>e.trim())).filter((e=>e.length));return E&&(void 0===S||!e[S])&&n.Ay.createElement("p",{className:"poll-error"},I("lng_polls_choose_correct"))}(),E?n.Ay.createElement(Z.A,{name:"correctOption",options:G().map(((e,t)=>({value:String(t),label:e,hidden:!A[t].trim()}))),selected:String(S),onChange:V}):G()),n.Ay.createElement("div",{className:"options-divider"}),n.Ay.createElement("div",{className:"quiz-mode"},!s&&n.Ay.createElement(js.A,{className:"dialog-checkbox",label:I("PollAnonymous"),checked:y,onChange:D}),n.Ay.createElement(js.A,{className:"dialog-checkbox",label:I("PollMultiple"),checked:v,disabled:E,onChange:_}),n.Ay.createElement(js.A,{className:"dialog-checkbox",label:I("PollQuiz"),checked:E,disabled:v||void 0!==a,onChange:U}),E&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:"options-header"},I("lng_polls_solution_title")),n.Ay.createElement(cc.A,{value:C,onChange:P,noReplaceNewlines:!0}),n.Ay.createElement("div",{className:"note"},I("CreatePoll.ExplanationInfo")))))}));var mh=a(36680),uh=a(52491);const Ah=(0,n.ph)((e=>{let{emoji:t,focus:a,onClick:s}=e;const i=(0,M.A)((e=>{e.preventDefault(),s(t.native,t.id)})),o=(0,de.A)("EmojiButton",a&&"focus"),l=`${r.jht?r.C1b:"."}/img-apple-64/${t.image}.png`,c=uh.On.has(l);return n.Ay.createElement("div",{className:o,onMouseDown:i,title:`:${t.names[0]}:`},b.TL?t.native:n.Ay.createElement("img",{src:l,className:c?void 0:"opacity-transition shown",alt:t.native,loading:"lazy","data-path":l,onLoad:c?void 0:uh.P_,draggable:!1}))})),hh=.625*A.$,yh=.25*A.$,ph=.5*A.$,vh=.5*A.$,gh=(0,n.ph)((e=>{let{category:t,index:a,allEmojis:s,observeIntersection:i,shouldRender:o,onEmojiSelect:l}=e;const c=(0,n.li)(null);(0,zo.mv)(c,i);const d=(0,In.A)(o),m=(0,T.A)(),{isMobile:u}=(0,w.Ay)(),A=u?Math.floor((C.A.get().width-vh+hh)/(r.g0Q+hh)):8,h=Math.ceil(t.emojis.length/A)*(r.g0Q+(u?ph:yh));return n.Ay.createElement("div",{ref:c,key:t.id,id:`emoji-category-${a}`,className:"symbol-set"},n.Ay.createElement("div",{className:"symbol-set-header"},n.Ay.createElement("p",{className:"symbol-set-name",dir:"auto"},m(t.id===r.sR2?"RecentStickers":`Emoji${a}`))),n.Ay.createElement("div",{className:(0,de.A)("symbol-set-container",d),style:`height: ${h}px;`,dir:m.isRtl?"rtl":void 0},o&&t.emojis.map((e=>{const t=s[e];if(!t)return;const a="id"in t?t:t[1];return n.Ay.createElement(Ah,{key:a.id,emoji:a,onClick:l})}))))})),Eh={recent:"recent",people:"smile",nature:"animals",foods:"eats",activity:"sport",places:"car",objects:"lamp",symbols:"language",flags:"flag"},bh=3.25*A.$,Ch=2.625*A.$,fh=[];let Sh,kh,wh;const Nh=(0,n.ph)((0,s.EK)((e=>(0,on.Up)(e,["recentEmojis"])))((e=>{let{className:t,recentEmojis:s,onEmojiSelect:i}=e;const o=(0,n.li)(null),l=(0,n.li)(null),[c,d]=(0,n.J0)(),[m,u]=(0,n.J0)(),[A,h]=(0,n.J0)(0),{isMobile:y}=(0,w.Ay)(),{handleScroll:p,isAtBeginning:v}=is(),{observe:g}=(0,zo.BL)({rootRef:o,throttleMs:200},(e=>{e.forEach((e=>{const{id:t}=e.target;if(!t||!t.startsWith("emoji-category-"))return;const a=Number(t.replace("emoji-category-",""));fh[a]=e.isIntersecting}));const t=fh.reduce(((e,t,a)=>t&&a<e?a:e),1/0);t!==1/0&&h(t)})),E=(0,jo.A)([],r.vVF),C=m&&E;(0,di.A)(l,!(y&&C)),(0,n.vJ)((()=>{if(!c)return;const e=l.current;if(!e)return;const t=A*Ch-e.offsetWidth/2+Ch/2;(0,ar.A)(e,t)}),[c,A]);const f=(0,T.A)(),S=(0,n.Kr)((()=>{if(!c)return ln.p;const e=[...c];return s?.length&&e.unshift({id:r.sR2,name:f("RecentStickers"),emojis:s}),e}),[c,f,s]);(0,n.vJ)((()=>{setTimeout((()=>{const e=()=>{d(wh.categories),u(wh.emojis)};wh?e():async function(){return Sh||(Sh=a.e(996).then(a.t.bind(a,20996,19)),kh=(await Sh).default,wh=(0,uh.cp)(kh)),Sh}().then(e)}),200)}),[]);const k=(0,M.A)((e=>{h(e);const t=o.current.closest(".SymbolMenu-main").querySelector(`#emoji-category-${e}`);(0,Go.Ay)({container:o.current,element:t,position:"start",margin:bh,maxDistance:100})})),N=(0,M.A)(((e,t)=>{i(e,t)})),I=(0,de.A)("EmojiPicker",t);if(!C)return n.Ay.createElement("div",{className:I},n.Ay.createElement(fs.A,null));const P=(0,de.A)("EmojiPicker-header",!v&&"with-top-border");return n.Ay.createElement("div",{className:I},n.Ay.createElement("div",{ref:l,className:P,dir:f.isRtl?"rtl":void 0},S.map((function(e,t){const a=Eh[e.id];return a&&n.Ay.createElement(W.A,{className:"symbol-set-button "+(t===A?"activated":""),round:!0,faded:!0,color:"translucent",onClick:()=>k(t),ariaLabel:e.name},n.Ay.createElement(q.A,{name:a}))}))),n.Ay.createElement("div",{ref:o,onScroll:p,className:(0,de.A)("EmojiPicker-main",b.TF?"no-scrollbar":"custom-scroll")},S.map(((e,t)=>n.Ay.createElement(gh,{category:e,index:t,allEmojis:m,observeIntersection:g,shouldRender:A>=t-1&&A<=t+1,onEmojiSelect:N})))))})));function Ih(){return Ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},Ih.apply(this,arguments)}const Ph=(0,n.ph)((e=>{let{gif:t,isDisabled:a,className:s,observeIntersection:i,onClick:r,onUnsaveClick:o,isSavedMessages:c}=e;const d=(0,n.li)(null),m=(0,T.A)(),u=(0,zo.Vz)(d,i)&&!a,A=!t.hasVideoPreview&&t.thumbnail&&(0,l.sC4)(t,"pictogram"),h=(0,G.A)(A,!u),[y]=(0,n.J0)(t.thumbnail?.dataUri&&!h),p=(0,wn.A)(t.thumbnail?.dataUri,!y),v=(0,l.CtQ)(t)||(0,l.sC4)(t,"full"),g=(0,G.A)(v,!u),E=Boolean(u&&g),{isBuffered:C,bufferingHandlers:f}=(0,Ve.A)(!0),S=u&&!C,k=u&&C,{isContextMenuOpen:w,contextMenuAnchor:N,handleBeforeContextMenu:I,handleContextMenu:P,handleContextMenuClose:B,handleContextMenuHide:L}=(0,si.A)(d),R=(0,M.A)((()=>d.current)),x=(0,M.A)((()=>d.current.closest(".custom-scroll, .no-scrollbar"))),F=(0,M.A)((()=>d.current.querySelector(".gif-context-menu .bubble"))),V=(0,M.A)((()=>{!w&&r&&r({...t,blobUrl:g})})),D=(0,M.A)((e=>{e.stopPropagation(),e.preventDefault(),o(t)})),_=(0,M.A)((()=>{o?.(t)})),U=(0,M.A)((()=>{r({...t,blobUrl:g},!0)})),O=(0,M.A)((()=>{r({...t,blobUrl:g},void 0,!0)})),J=(0,M.A)((e=>{(0,el.u)(e),I(e)}));(0,n.vJ)((()=>{a&&B()}),[B,a]);const K=(0,de.A)("GifButton",t.width&&t.height&&t.width<t.height?"vertical":"horizontal",r&&"interactive",s);return n.Ay.createElement("div",{ref:d,className:K,onMouseDown:J,onClick:V,onContextMenu:P},!b.TF&&o&&n.Ay.createElement(W.A,{className:"gif-unsave-button",color:"dark",pill:!0,noFastClick:!0,onClick:D},n.Ay.createElement(q.A,{name:"close",className:"gif-unsave-button-icon"})),y&&n.Ay.createElement("canvas",{ref:p,className:"thumbnail"}),h&&!k&&n.Ay.createElement("img",{src:h,alt:"",className:"preview",draggable:!1}),E&&n.Ay.createElement(Ln.A,Ih({canPlay:!0,src:g,autoPlay:!0,loop:!0,muted:!0,disablePictureInPicture:!0,playsInline:!0,preload:"none"},f)),S&&n.Ay.createElement(Re.A,{color:h||y?"white":"black"}),r&&void 0!==N&&n.Ay.createElement(Ge.A,{isOpen:w,anchor:N,getTriggerElement:R,getRootElement:x,getMenuElement:F,className:"gif-context-menu",autoClose:!0,onClose:B,onCloseAnimationEnd:L},!c&&n.Ay.createElement(oe.A,{onClick:U,icon:"mute"},m("SendWithoutSound")),n.Ay.createElement(oe.A,{onClick:O,icon:"calendar"},m(c?"SetReminder":"ScheduleMessage")),o&&n.Ay.createElement(oe.A,{destructive:!0,icon:"delete",onClick:_},m("Delete"))))})),Mh=(0,n.ph)((0,s.EK)((e=>{const{chatId:t}=(0,c.Xf0)(e)||{},a=Boolean(t)&&(0,c.nZ4)(e,t);return{savedGifs:e.gifs.saved.gifs,isSavedMessages:a}}))((e=>{let{className:t,loadAndPlay:a,canSendGifs:i,savedGifs:o,isSavedMessages:l,onGifSelect:c}=e;const{loadSavedGifs:d,saveGif:m}=(0,s.ko)(),u=(0,n.li)(null),{observe:A}=(0,zo.BL)({rootRef:u,debounceMs:300});(0,n.vJ)((()=>{a&&d()}),[a,d]);const h=(0,M.A)((e=>{m({gif:e,shouldUnsave:!0})})),y=(0,jo.A)([],r.jhd);return n.Ay.createElement("div",null,n.Ay.createElement("div",{ref:u,className:(0,de.A)("GifPicker",t,b.TF?"no-scrollbar":"custom-scroll")},i?y&&o&&o.length?o.map((e=>n.Ay.createElement(Ph,{key:e.id,gif:e,observeIntersection:A,isDisabled:!a,onClick:i?c:void 0,onUnsaveClick:h,isSavedMessages:l}))):y&&o?n.Ay.createElement("div",{className:"picker-disabled"},"No saved GIFs."):n.Ay.createElement(fs.A,null):n.Ay.createElement("div",{className:"picker-disabled"},"Sending GIFs is not allowed in this chat.")))})));let Th=function(e){return e[e.Emoji=0]="Emoji",e[e.CustomEmoji=1]="CustomEmoji",e[e.Stickers=2]="Stickers",e[e.GIFs=3]="GIFs",e}({});const Bh={[Th.Emoji]:"Emoji",[Th.CustomEmoji]:"StickersList.EmojiItem",[Th.Stickers]:"AccDescrStickers",[Th.GIFs]:"GifsTab"},Lh={[Th.Emoji]:"icon-smile",[Th.CustomEmoji]:"icon-favorite",[Th.Stickers]:"icon-stickers",[Th.GIFs]:"icon-gifs"},Rh=(0,n.ph)((e=>{let{activeTab:t,onSwitchTab:a,onRemoveSymbol:s,onSearchOpen:i,isAttachmentModal:r,canSendPlainText:o,canSearch:l}=e;const c=(0,T.A)();function d(e){return n.Ay.createElement(W.A,{className:"symbol-tab-button "+(t===e?"activated":""),onClick:()=>a(e),ariaLabel:c(Bh[e]),round:!0,faded:!0,color:"translucent"},n.Ay.createElement("i",{className:(0,de.A)("icon",Lh[e])}))}const m=(0,M.A)((()=>{i(t===Th.Stickers?"stickers":"gifs")}));return n.Ay.createElement("div",{className:"SymbolMenu-footer",onClick:function(e){e.stopPropagation()},dir:c.isRtl?"rtl":void 0},t!==Th.Emoji&&t!==Th.CustomEmoji&&l&&n.Ay.createElement(W.A,{className:"symbol-search-button",ariaLabel:t===Th.Stickers?"Search Stickers":"Search GIFs",round:!0,faded:!0,color:"translucent",onClick:m},n.Ay.createElement(q.A,{name:"search"})),o&&d(Th.Emoji),o&&d(Th.CustomEmoji),!r&&d(Th.Stickers),!r&&d(Th.GIFs),(t===Th.Emoji||t===Th.CustomEmoji)&&n.Ay.createElement(W.A,{className:"symbol-delete-button",onClick:s,ariaLabel:"Remove Symbol",round:!0,faded:!0,color:"translucent"},n.Ay.createElement(q.A,{name:"delete-left"})))}));function xh(){return xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},xh.apply(this,arguments)}let Fh=!1;const Vh=(0,n.ph)((0,s.EK)((e=>({isLeftColumnShown:(0,c.nTw)(e).isLeftColumnShown,isBackgroundTranslucent:(0,c.cwE)(e)})))((e=>{let{chatId:t,threadId:a,isOpen:s,canSendStickers:i,canSendGifs:r,isMessageComposer:l,isLeftColumnShown:c,idPrefix:d,isAttachmentModal:m,canSendPlainText:u,className:A,isBackgroundTranslucent:h,onLoad:y,onClose:p,onEmojiSelect:v,onCustomEmojiSelect:g,onStickerSelect:E,onGifSelect:C,onRemoveSymbol:f,onSearchOpen:S,addRecentEmoji:k,addRecentCustomEmoji:N,...I}=e;const[P,B]=(0,n.J0)(0),[L,R]=(0,n.J0)([]),[x,F]=(0,n.J0)([]),{isMobile:V}=(0,w.Ay)(),[D,_]=(0,mh.A)(s,p,void 0,V),{shouldRender:U,transitionClassNames:O}=(0,De.A)(s,p,!1,!1),J=(0,T.A)();!Fh&&s&&(Fh=!0),(0,n.vJ)((()=>{y()}),[y]),(0,n.vJ)((()=>{u||B(2)}),[u]),(0,n.Nf)((()=>{if(V&&s&&!m)return document.body.classList.add("enable-symbol-menu-transforms"),document.body.classList.add("is-symbol-menu-open"),()=>{document.body.classList.remove("is-symbol-menu-open"),setTimeout((()=>{(0,o.RK)((()=>{document.body.classList.remove("enable-symbol-menu-transforms")}))}),350)}}),[m,V,s]);const K=(0,n.li)(L);K.current=L,(0,n.vJ)((()=>{K.current.length&&!s&&(K.current.forEach((e=>{k({emoji:e})})),R([]))}),[s,k]);const j=(0,M.A)(((e,t)=>{R((e=>[...e,t])),v(e)})),G=(0,n.li)(x);G.current=x,(0,n.vJ)((()=>{G.current.length&&!s&&(G.current.forEach((e=>{N({documentId:e})})),R([]))}),[s,N]);const z=(0,M.A)((e=>{F((t=>[...t,e.id])),g(e)})),H=(0,M.A)((e=>{p(),S(e)})),$=(0,M.A)(((e,t,a,n)=>{E?.(e,t,a,!0,n)}));function Y(e,o){switch(P){case Th.Emoji:return n.Ay.createElement(Nh,{className:"picker-tab",onEmojiSelect:j});case Th.CustomEmoji:return n.Ay.createElement(fl,{className:"picker-tab",isHidden:!s||!e,idPrefix:d,loadAndPlay:s&&(e||o),chatId:t,isTranslucent:!V&&h,onCustomEmojiSelect:z});case Th.Stickers:return n.Ay.createElement(TA,{className:"picker-tab",isHidden:!s||!e,loadAndPlay:!!i&&s&&(e||o),idPrefix:d,canSendStickers:i,noContextMenus:!l,chatId:t,threadId:a,isTranslucent:!V&&h,onStickerSelect:$});case Th.GIFs:return n.Ay.createElement(Mh,{className:"picker-tab",loadAndPlay:!!r&&s&&(e||o),canSendGifs:r,onGifSelect:C})}}const Q=n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"SymbolMenu-main",onClick:function(e){e.stopPropagation()}},Fh&&n.Ay.createElement(te.Ay,{name:"slide",activeKey:P,renderCount:Object.values(Bh).length},Y)),V&&n.Ay.createElement(W.A,{round:!0,faded:!0,color:"translucent",ariaLabel:J("Close"),className:"symbol-close-button",size:"tiny",onClick:p},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement(Rh,{activeTab:P,onSwitchTab:B,onRemoveSymbol:f,canSearch:l,onSearchOpen:H,isAttachmentModal:m,canSendPlainText:u}));if(V){if(!U)return;const e=(0,de.A)("SymbolMenu mobile-menu",O,c&&"left-column-open",m&&"in-attachment-modal",l&&"in-middle-column");return m?n.Ay.createElement("div",{className:e},Q):n.Ay.createElement(Sl.A,null,n.Ay.createElement("div",{className:e},Q))}return n.Ay.createElement(Ge.A,xh({isOpen:s,onClose:p,withPortal:m,className:(0,de.A)("SymbolMenu",A),onCloseAnimationEnd:p,onMouseEnter:b.TF?void 0:D,onMouseLeave:b.TF?void 0:_,noCloseOnBackdrop:!b.TF,noCompact:!0},m?I:{positionX:"left",positionY:"bottom"}),Q)})));var Dh=a(91034);const _h=(0,n.ph)((e=>{let{withAvatar:t,focus:a,command:s,description:i,peer:r,clickArg:o,onClick:l}=e;const c=(0,M.A)((()=>{l(o)}));return n.Ay.createElement(Wa.A,{key:s,className:(0,de.A)("BotCommand chat-item-clickable scroll-item",t&&"with-avatar"),multiline:!0,onClick:c,focus:a},t&&n.Ay.createElement(wt.A,{size:"small",peer:r}),n.Ay.createElement("div",{className:"content-inner"},n.Ay.createElement("span",{className:"title"},"/",s),n.Ay.createElement("span",{className:"subtitle"},(0,kt.A)(i))))})),Uh=(0,n.ph)((0,Dh.A)((e=>{let{isOpen:t,chatId:a,withUsername:i,botCommands:r,quickReplies:o,quickReplyMessages:l,self:c,getHtml:d,onClick:m,onClose:u}=e;const{sendBotCommand:A,sendQuickReply:h}=(0,s.ko)(),y=(0,n.li)(null),{shouldRender:p,transitionClassNames:v}=(0,De.A)(t,void 0,void 0,!1),g=(0,M.A)((e=>{let{botId:t,command:a}=e;const n=(0,s.mS)().users.byId[t];A({command:`/${a}${i&&n?`@${n.usernames[0].username}`:""}`}),m()})),E=(0,M.A)((e=>{h({chatId:a,quickReplyId:e}),m()})),b=(0,n.Kr)((()=>{if(o?.length&&l)return o.map((e=>{const t=l[e.topMessageId];return{id:e.id,command:e.shortcut,description:t?.content.text?.text||""}}))}),[o,l]),C=(0,M.A)((e=>!!e.command.startsWith(d().slice(1))&&("id"in e?E(e.id):g(e),!0))),f=ah({isActive:t,items:(0,n.Kr)((()=>{if(r||b)return[].concat(b||[],r||[])}),[r,b]),onSelect:C,onClose:u}),S=r&&!r.length||o&&!o.length;if((0,n.vJ)((()=>{S&&u()}),[S,u]),(0,n.vJ)((()=>{th(".chat-item-clickable",f,y)}),[f]),!p||S)return;const k=(0,de.A)("iaTB59vy","composer-tooltip custom-scroll",v);return n.Ay.createElement("div",{className:k,ref:y},b?.map(((e,t)=>n.Ay.createElement(_h,{key:`quickReply_${e.id}`,command:e.command,description:e.description,peer:c,withAvatar:!0,clickArg:e.id,onClick:E,focus:f===t}))),r?.map(((e,t)=>n.Ay.createElement(_h,{key:`${e.botId}_${e.command}`,command:e.command,description:e.description,peer:(0,s.mS)().users.byId[e.botId],withAvatar:!0,clickArg:e,onClick:g,focus:f+(b?.length||0)===t}))))}))),Oh=(0,n.ph)((e=>{let{isOpen:t,botCommands:a,onClose:i}=e;const{sendBotCommand:r}=(0,s.ko)(),{isMobile:o}=(0,w.Ay)(),[l,c]=(0,mh.A)(t,i,void 0,o),d=(0,M.A)((e=>{r({command:`/${e}`}),i()}));return n.Ay.createElement(Ge.A,{isOpen:t,positionX:"left",positionY:"bottom",onClose:i,className:"BotCommandMenu",onCloseAnimationEnd:i,onMouseEnter:b.TF?void 0:l,onMouseLeave:b.TF?void 0:c,noCloseOnBackdrop:!b.TF,noCompact:!0},a.map((e=>n.Ay.createElement(_h,{key:e.command,command:e.command,description:e.description,clickArg:e.command,onClick:d}))))})),Jh=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const{stickers:n}=e.stickers.forEmoji;return{stickers:n,isSavedMessages:(0,c.nZ4)(e,a),isCurrentUserPremium:(0,c.g29)(e)}}))((e=>{let{chatId:t,threadId:a,isOpen:s,onStickerSelect:i,onClose:o,stickers:l,isSavedMessages:c,isCurrentUserPremium:d}=e;const u=(0,n.li)(null),{shouldRender:A,transitionClassNames:h}=(0,De.A)(s,void 0,void 0,!1),y=(0,D.A)(l,!0),p=l||y,v=(0,PA.A)(t,a),{observe:g}=(0,zo.BL)({rootRef:u,throttleMs:200});(0,n.vJ)((()=>s?(0,m.A)(o):void 0),[s,o]);const E=(0,de.A)("StickerTooltip composer-tooltip custom-scroll",h,!p?.length&&"hidden");return n.Ay.createElement("div",{ref:u,className:E,onMouseMove:()=>{v({type:"chooseSticker"})}},A&&p?p.map((e=>n.Ay.createElement(sl,{key:e.id,sticker:e,size:r.bkT,observeIntersection:g,onClick:s?i:void 0,clickArg:e,isSavedMessages:c,canViewSet:!0,isCurrentUserPremium:d}))):A?n.Ay.createElement(fs.A,null):void 0)}))),Kh={root:"_8sFuAomM",emojiButton:"crWzZ2jr"},jh=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const{stickers:n}=e.customEmojis.forEmoji;return{customEmoji:n,isSavedMessages:(0,c.nZ4)(e,a),isCurrentUserPremium:(0,c.g29)(e)}}))((e=>{let{isOpen:t,addRecentCustomEmoji:a,onCustomEmojiSelect:i,onClose:o,customEmoji:l,isSavedMessages:c,isCurrentUserPremium:d,noPlay:u}=e;const{clearCustomEmojiForEmoji:A}=(0,s.ko)(),h=(0,n.li)(null),{shouldRender:y,transitionClassNames:p}=(0,De.A)(t,void 0,void 0,!1),v=(0,D.A)(l,!0),g=l||v;(0,di.A)(h);const{observe:E}=(0,zo.BL)({rootRef:h,throttleMs:200,isDisabled:!t});(0,n.vJ)((()=>t?(0,m.A)(o):void 0),[t,o]);const b=(0,M.A)((e=>{t&&(i(e),a({documentId:e.id}),A())})),C=(0,de.A)(Kh.root,"composer-tooltip custom-scroll-x",p,!g?.length&&Kh.hidden);return n.Ay.createElement("div",{ref:h,className:C},y&&g?g.map((e=>n.Ay.createElement(sl,{key:e.id,sticker:e,className:Kh.emojiButton,size:r.x6_,observeIntersection:E,onClick:b,clickArg:e,isSavedMessages:c,canViewSet:!0,isCurrentUserPremium:d,noPlay:u}))):y?n.Ay.createElement(fs.A,null):void 0)})));var Gh=a(76283);const zh=(0,n.ph)((e=>{let{isOpen:t,isOpenToBottom:a=!1,isSavedMessages:i,canSchedule:r,canScheduleUntilOnline:o,onSendSilent:l,onSendSchedule:c,onSendWhenOnline:d,onRemoveEffect:m,onClose:u,onCloseAnimationEnd:A,chatId:h,withEffects:y,hasCurrentEffect:p,effectReactions:v,allAvailableReactions:g,onToggleReaction:E,canBuyPremium:C,isCurrentUserPremium:f,isInSavedMessages:S,isInStoryViewer:k,canPlayAnimatedEmojis:w}=e;const{openEffectPicker:N}=(0,s.ko)(),[P,B]=(0,mh.A)(t,u),[L,R]=(0,n.J0)(!1),x=(0,T.A)(),F=(0,Us.A)(),[V,D,_]=(0,I.A)();(0,mn.A)((e=>{let[a]=e;t&&!a&&(_(),R(Boolean(o)))}),[t,o]);const[U,O,J]=(0,I.A)(),K=(0,M.A)((e=>{D(),h&&N({chatId:h,position:e})}));return(0,n.vJ)((()=>{t?setTimeout((()=>{O()}),200):J()}),[t,O,J]),n.Ay.createElement(Ge.A,{isOpen:t,autoClose:!0,positionX:"right",positionY:a?"top":"bottom",className:(0,de.A)("CustomSendMenu","fluid","with-menu-transitions",y&&"with-effects"),onClose:u,onCloseAnimationEnd:A,onMouseEnter:b.TF?void 0:P,onMouseLeave:b.TF?void 0:B,noCloseOnBackdrop:!b.TF},y&&!k&&n.Ay.createElement(Gh.A,{allAvailableReactions:g,effectReactions:v,currentReactions:void 0,onToggleReaction:E,isPrivate:!0,isReady:U,canBuyPremium:C,isCurrentUserPremium:f,isInSavedMessages:S,isForEffects:!0,canPlayAnimatedEmojis:w,onShowMore:K,onClose:u,className:(0,de.A)(V&&"ReactionSelector-hidden")}),n.Ay.createElement("div",{className:(0,de.A)("CustomSendMenu_items",V&&"CustomSendMenu_items-hidden"),dir:x.isRtl?"rtl":void 0},l&&n.Ay.createElement(oe.A,{icon:"mute",onClick:l},x("SendWithoutSound")),r&&c&&n.Ay.createElement(oe.A,{icon:"schedule",onClick:c},x(i?"SetReminder":"ScheduleMessage")),r&&c&&L&&n.Ay.createElement(oe.A,{icon:"user-online",onClick:d},x("SendWhenOnline")),y&&p&&n.Ay.createElement(oe.A,{icon:"delete",onClick:m},F("RemoveEffect"))))}));var Hh=a(41510),$h=a(22802);const qh={B:"bold",STRONG:"bold",I:"italic",EM:"italic",U:"underline",DEL:"strikethrough",CODE:"monospace",SPAN:"spoiler"},Wh=document.createElement("div"),Yh=(0,n.ph)((e=>{let{isOpen:t,anchorPosition:a,selectedRange:s,setSelectedRange:i,onClose:o}=e;const l=(0,n.li)(null),c=(0,n.li)(null),{shouldRender:d,transitionClassNames:u}=(0,De.A)(t),[A,h,y]=(0,I.A)(),[p,g]=(0,n.J0)(""),[E,b]=(0,n.J0)(!1),[C,f]=(0,n.J0)(),[S,k]=(0,n.J0)({});(0,n.vJ)((()=>t?(0,m.A)(o):void 0),[t,o]),(0,$h.A)(t,l,o,!0),(0,n.vJ)((()=>{A?c.current.focus():(g(""),b(!1))}),[A]),(0,n.vJ)((()=>{d||(y(),k({}),f(void 0))}),[y,d]),(0,n.vJ)((()=>{if(!t||!s)return;const e={};let{parentElement:a}=s.commonAncestorContainer;for(;a&&a.id!==r.CfG;){const t=qh[a.tagName];t&&(e[t]=!0),a=a.parentElement}k(e)}),[t,s,h]);const w=(0,M.A)((()=>{if(!s)return;const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(s))})),N=(0,M.A)((()=>{const e=window.getSelection();e&&i(e.getRangeAt(0))})),P=(0,M.A)((e=>{if(s)return Wh.replaceChildren(s.cloneContents()),e&&Wh.querySelectorAll(IA._p).forEach((e=>{e.replaceWith(e.getAttribute("alt"))})),Wh.innerHTML})),B=(0,M.A)((()=>{if(s)return s.commonAncestorContainer.parentElement}));function L(){const e=c.current;if(!e)return;const{offsetWidth:t,scrollWidth:a,scrollLeft:n}=e;if(a<=t)return void f(void 0);let s="";n<a-t&&(s="mask-right"),n>0&&(s+=" mask-left"),f(s)}function R(e){if(S[e])return"active";if("monospace"===e||"strikethrough"===e){if(Object.keys(S).some((t=>t!==e&&Boolean(S[t]))))return"disabled"}else if(S.monospace||S.strikethrough)return"disabled"}const x=(0,M.A)((()=>{if(S.spoiler){const e=B();if(!s||!e||e.dataset.entityType!==U.C7.Spoiler||!e.textContent)return;return e.replaceWith(e.textContent),void k((e=>({...e,spoiler:!1})))}const e=P();document.execCommand("insertHTML",!1,`<span class="spoiler" data-entity-type="${U.C7.Spoiler}">${e}</span>`),o()})),F=(0,M.A)((()=>{k((e=>(document.execCommand(e.bold?"removeFormat":"bold"),Object.keys(e).forEach((t=>{"italic"!==t&&"underline"!==t||!Boolean(e[t])||document.execCommand(t)})),N(),{...e,bold:!e.bold})))})),V=(0,M.A)((()=>{document.execCommand("italic"),N(),k((e=>({...e,italic:!e.italic})))})),D=(0,M.A)((()=>{document.execCommand("underline"),N(),k((e=>({...e,underline:!e.underline})))})),_=(0,M.A)((()=>{if(S.strikethrough){const e=B();if(!s||!e||"DEL"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void k((e=>({...e,strikethrough:!1})))}const e=P();document.execCommand("insertHTML",!1,`<del>${e}</del>`),o()})),O=(0,M.A)((()=>{if(S.monospace){const e=B();if(!s||!e||"CODE"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void k((e=>({...e,monospace:!1})))}const e=P(!0);document.execCommand("insertHTML",!1,`<code class="text-entity-code" dir="auto">${e}</code>`),o()})),J=(0,M.A)((()=>{const e=((0,_s.Tc)(p)||"").split("%").map(encodeURI).join("%");if(E){const t=B();if(!t||"A"!==t.tagName)return;return t.href=e,void o()}const t=P(!0);w(),document.execCommand("insertHTML",!1,`<a href=${e} class="text-entity-link" dir="auto">${t}</a>`),o()})),K=(0,M.A)((e=>{const t={k:h,b:F,u:D,i:V,m:O,s:_,p:x}[function(e){const t=e.key||e.code;return t.startsWith("Key")?t.slice(3).toLowerCase():t}(e)];!e.altKey&&(e.ctrlKey||e.metaKey)&&t&&(e.preventDefault(),e.stopPropagation(),t())}));(0,n.vJ)((()=>(t&&document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K))),[t,K]);const j=(0,T.A)();if(!d)return;const G=(0,de.A)("TextFormatter",u,A&&"link-control-shown"),z=(0,de.A)("TextFormatter-link-url-confirm",Boolean(p.length)&&"shown"),H=a?`left: ${a.x}px; top: ${a.y}px;--text-formatter-left: ${a.x}px;`:"";return n.Ay.createElement("div",{ref:l,className:G,style:H,onKeyDown:function(e){"Enter"===e.key&&A&&(J(),e.preventDefault())},onMouseDown:v.A},n.Ay.createElement("div",{className:"TextFormatter-buttons"},n.Ay.createElement(W.A,{color:"translucent",ariaLabel:"Spoiler text",className:R("spoiler"),onClick:x},n.Ay.createElement(q.A,{name:"eye-closed"})),n.Ay.createElement("div",{className:"TextFormatter-divider"}),n.Ay.createElement(W.A,{color:"translucent",ariaLabel:"Bold text",className:R("bold"),onClick:F},n.Ay.createElement(q.A,{name:"bold"})),n.Ay.createElement(W.A,{color:"translucent",ariaLabel:"Italic text",className:R("italic"),onClick:V},n.Ay.createElement(q.A,{name:"italic"})),n.Ay.createElement(W.A,{color:"translucent",ariaLabel:"Underlined text",className:R("underline"),onClick:D},n.Ay.createElement(q.A,{name:"underlined"})),n.Ay.createElement(W.A,{color:"translucent",ariaLabel:"Strikethrough text",className:R("strikethrough"),onClick:_},n.Ay.createElement(q.A,{name:"strikethrough"})),n.Ay.createElement(W.A,{color:"translucent",ariaLabel:"Monospace text",className:R("monospace"),onClick:O},n.Ay.createElement(q.A,{name:"monospace"})),n.Ay.createElement("div",{className:"TextFormatter-divider"}),n.Ay.createElement(W.A,{color:"translucent",ariaLabel:j("TextFormat.AddLinkTitle"),onClick:h},n.Ay.createElement(q.A,{name:"link"}))),n.Ay.createElement("div",{className:"TextFormatter-link-control"},n.Ay.createElement("div",{className:"TextFormatter-buttons"},n.Ay.createElement(W.A,{color:"translucent",ariaLabel:j("Cancel"),onClick:y},n.Ay.createElement(q.A,{name:"arrow-left"})),n.Ay.createElement("div",{className:"TextFormatter-divider"}),n.Ay.createElement("div",{className:(0,de.A)("TextFormatter-link-url-input-wrapper",C)},n.Ay.createElement("input",{ref:c,className:"TextFormatter-link-url-input",type:"text",value:p,placeholder:"Enter URL...",autoComplete:"off",inputMode:"url",dir:"auto",onChange:function(e){g(e.target.value),L()},onScroll:L})),n.Ay.createElement("div",{className:z},n.Ay.createElement("div",{className:"TextFormatter-divider"}),n.Ay.createElement(W.A,{color:"translucent",ariaLabel:j("Save"),className:"color-primary",onClick:J},n.Ay.createElement(q.A,{name:"check"}))))))})),Qh=(0,n.ph)((e=>{let{emoji:t,focus:a,onClick:s,observeIntersection:i}=e;const r=(0,M.A)((e=>{e.preventDefault(),s?.(t)})),o=(0,de.A)("EmojiButton",a&&"focus");return n.Ay.createElement("div",{className:o,onMouseDown:r,title:t.emoji},n.Ay.createElement(Zi.A,{documentId:t.id,size:32,withSharedAnimation:!0,shouldPreloadPreview:!0,observeIntersectionForPlaying:i}))})),Zh=(0,n.ph)((e=>{let{isOpen:t,emojis:a,customEmojis:s,onClose:i,onEmojiSelect:r,onCustomEmojiSelect:o,addRecentEmoji:l,addRecentCustomEmoji:c}=e;const d=(0,n.li)(null),{shouldRender:m,transitionClassNames:u}=(0,De.A)(t,void 0,void 0,!1),A=(0,Dn.A)(a.length?[...s,...a]:void 0,350)||[];(0,di.A)(d);const{observe:h}=(0,zo.BL)({rootRef:d,throttleMs:200,isDisabled:!t}),y=(0,M.A)((e=>{r(e.native),l({emoji:e.id})})),p=(0,M.A)((e=>{o(e),c({documentId:e.id})})),v=(0,M.A)((e=>{"native"in e?y(e):p(e)})),g=(0,M.A)(((e,t)=>{r(e),l({emoji:t})})),E=(0,M.A)((e=>{o(e),c({documentId:e.id})})),b=ah({isActive:t,isHorizontal:!0,items:A,shouldRemoveSelectionOnReset:!0,onSelect:v,onClose:i});(0,mn.A)((e=>{let[t]=e;void 0!==t&&-1!==t&&function(e,t){const a=t.current;if(!a)return;const{visibleIndexes:n,allElements:s}=eh(a,".EmojiButton",8,!0,!0,!0);if(!s.length||!s[e])return;const i=n[0];if(!n.includes(e)||e===i&&!XA(a,s[i],!0)){const t="start"==(e>n[n.length-1]?"start":"end")?44*e:0;(0,ar.A)(a,t)}}(b,d)}),[b]);const C=(0,de.A)("EmojiTooltip composer-tooltip custom-scroll-x",u);return n.Ay.createElement("div",{ref:d,className:C},m&&A?A.map(((e,t)=>"native"in e?n.Ay.createElement(Ah,{key:e.id,emoji:e,focus:b===t,onClick:g}):n.Ay.createElement(Qh,{key:e.id,emoji:e,focus:b===t,onClick:E,observeIntersection:h}))):m?n.Ay.createElement(fs.A,null):void 0)})),Xh=(0,n.ph)((e=>{let t,{title:a,description:s,thumbnail:i,thumbUrl:r,focus:o,transitionClassNames:c="",onClick:d}=e;const m=(0,G.A)(i?(0,l.cy4)(i):void 0);return r=r||m,r?t=n.Ay.createElement("img",{src:r,className:c,alt:"",decoding:"async",draggable:!1}):a&&(t=(0,je.Qh)(a,1)),n.Ay.createElement(Wa.A,{focus:o,className:"BaseResult chat-item-clickable",onMouseDown:el.u,onClick:d},n.Ay.createElement("span",{className:"thumb"},"string"==typeof t?(0,kt.A)(t):t),n.Ay.createElement("div",{className:"content-inner"},a&&n.Ay.createElement("div",{className:"title"},a),s&&n.Ay.createElement("div",{className:"description"},s)))})),ey=(0,n.ph)((e=>{let{focus:t,inlineResult:a,onClick:s}=e;const{title:i,description:r}=a,o="url"in a?a.url:void 0,l="webThumbnail"in a?a.webThumbnail:void 0,c=(0,M.A)((()=>{s(a)}));return n.Ay.createElement(Xh,{focus:t,thumbnail:l,title:i||o,description:r,onClick:c})})),ty=(0,n.ph)((e=>{let{inlineResult:t,isSavedMessages:a,canSendGifs:s,observeIntersection:i,onClick:r}=e;const{gif:o}=t,l=(0,M.A)(((e,a,n)=>{r(t,a,n)}));if(o)return n.Ay.createElement(Ph,{gif:o,observeIntersection:i,className:"chat-item-clickable",onClick:s?l:void 0,isSavedMessages:a})})),ay=(0,n.ph)((e=>{let t,a,s,{focus:i,isForGallery:r,inlineResult:o,onClick:c}=e;"photo"in o&&(t=o.photo),"thumbnail"in o&&(a=o.thumbnail),"webThumbnail"in o&&(s=o.webThumbnail);const d=(0,G.A)((0,l.cy4)(s)),m=(0,G.A)(t&&(0,l.rIo)(t,"pictogram")),u=(0,In.A)(m||d),A=(0,M.A)((()=>{c(o)}));if(r)return n.Ay.createElement("div",{className:"MediaResult chat-item-clickable",onClick:A},n.Ay.createElement("img",{src:t?.thumbnail?.dataUri||d,alt:"",draggable:!1}),n.Ay.createElement("img",{src:m,className:(0,de.A)("full-media",u),alt:"",draggable:!1}));const{title:h,description:y}=o;return n.Ay.createElement(Xh,{focus:i,thumbnail:s,thumbUrl:m||a?.dataUri,transitionClassNames:u,title:h,description:y,onClick:A})})),ny=(0,n.ph)((e=>{let{inlineResult:t,isSavedMessages:a,observeIntersection:s,onClick:i,isCurrentUserPremium:o}=e;const{sticker:l}=t;if(l)return n.Ay.createElement(sl,{sticker:l,size:r.mD0,observeIntersection:s,title:l.emoji,className:"chat-item-clickable",onClick:i,clickArg:t,isSavedMessages:a,canViewSet:!0,noShowPremium:!0,isCurrentUserPremium:o})})),sy=(0,Ae.nF)((e=>e()),500,!0),iy=(0,n.ph)((e=>{let{isOpen:t,botId:a,isGallery:r,inlineBotResults:o,switchPm:l,switchWebview:c,isSavedMessages:d,canSendGifs:m,loadMore:u,onClose:A,onSelectResult:h,isCurrentUserPremium:y}=e;const{openChat:p,startBot:v,requestSimpleWebView:g}=(0,s.ko)(),E=(0,n.li)(null),{shouldRender:C,transitionClassNames:f}=(0,De.A)(t,void 0,void 0,!1),S=(0,Cn.A)(r,C),{observe:k}=(0,zo.BL)({rootRef:E,debounceMs:200,isDisabled:!t}),w=(0,M.A)((e=>{let{direction:t}=e;t===i.TN.Backwards&&sy(u)})),N=ah({isActive:t,shouldRemoveSelectionOnReset:S,noArrowNavigation:S,items:o,onSelect:h,onClose:A});(0,n.vJ)((()=>{th(".chat-item-clickable",N,E)}),[N]);const I=(0,M.A)((()=>{p({id:a}),v({botId:a,param:l.startParam})})),P=(0,M.A)((()=>{const e=(0,ui.A)();g({botId:a,url:c.url,buttonText:c.text,theme:e,isFromSwitchWebView:!0})})),T=(0,D.A)(o?.length?o:void 0,C),B=o?.length?o:T;if(!C||!B?.length&&!l)return;const L=(0,de.A)("InlineBotTooltip composer-tooltip",b.TF?"no-scrollbar":"custom-scroll",S&&"gallery",f);return n.Ay.createElement(rs.A,{ref:E,className:L,items:B,itemSelector:".chat-item-clickable",noFastList:!0,onLoadMore:w,sensitiveArea:160},l&&n.Ay.createElement(Wa.A,{ripple:!0,className:"switch-pm scroll-item",onClick:I},n.Ay.createElement("span",{className:"title"},l.text)),c&&n.Ay.createElement(Wa.A,{ripple:!0,className:"switch-pm scroll-item",onClick:P},n.Ay.createElement("span",{className:"title"},c.text)),Boolean(B?.length)&&B.map(((e,t)=>{switch(e.type){case"gif":return n.Ay.createElement(ty,{key:e.id,inlineResult:e,observeIntersection:k,onClick:h,isSavedMessages:d,canSendGifs:m});case"photo":return n.Ay.createElement(ay,{key:e.id,isForGallery:S,inlineResult:e,onClick:h});case"sticker":return n.Ay.createElement(ny,{key:e.id,inlineResult:e,observeIntersection:k,onClick:h,isSavedMessages:d,isCurrentUserPremium:y});case"video":case"file":case"game":return n.Ay.createElement(ay,{key:e.id,focus:N===t,inlineResult:e,onClick:h});case"article":case"audio":case"voice":return n.Ay.createElement(ey,{key:e.id,focus:N===t,inlineResult:e,onClick:h});default:return}})))})),ry=(0,n.ph)((e=>{let{isOpen:t,chatId:a,selectedSendAsId:i,sendAsPeerIds:r,isCurrentUserPremium:o,onClose:l}=e;const{saveDefaultSendAs:c,showNotification:d}=(0,s.ko)(),m=(0,s.mS)().users.byId,u=(0,s.mS)().chats.byId,A=(0,T.A)(),h=(0,n.li)(null),[y,p,v]=(0,mh.A)(t,l,void 0);(0,n.vJ)((()=>{t&&v()}),[t,v]);const g=(0,M.A)((e=>{l(),c({chatId:a,sendAsId:e})})),E=ah({isActive:t,items:r,onSelect:g,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:l});return(0,n.vJ)((()=>{th(".chat-item-clickable",E,h)}),[E]),(0,n.vJ)((()=>{r&&!r.length&&l()}),[r,l]),n.Ay.createElement(Ge.A,{isOpen:t,positionX:"left",positionY:"bottom",onClose:l,className:"SendAsMenu",onCloseAnimationEnd:l,onMouseEnter:b.TF?void 0:y,onMouseLeave:b.TF?void 0:p,noCloseOnBackdrop:!b.TF,noCompact:!0},n.Ay.createElement("div",{className:"send-as-title",dir:"auto"},A("SendMessageAsTitle")),m&&u&&r?.map(((e,t)=>{let{id:a,isPremium:s}=e;const r=m[a],l=u[a],c=r||l,h=(0,de.A)(i===a&&"selected");return n.Ay.createElement(Wa.A,{key:a,className:"SendAsItem chat-item-clickable scroll-item with-avatar",onClick:()=>{!s||o?g(a):d({message:A("SelectSendAsPeerPremiumHint"),actionText:A("Open"),action:{action:"openPremiumModal",payload:{}}})},focus:E===t,rightElement:!o&&s&&n.Ay.createElement(q.A,{name:"lock-badge",className:"send-as-icon-locked"})},n.Ay.createElement(wt.A,{size:"small",peer:c,className:h}),n.Ay.createElement("div",{className:"info"},c&&n.Ay.createElement(Ss.A,{peer:c,noFake:!0}),n.Ay.createElement("span",{className:"subtitle"},r?A("VoipGroupPersonalAccount"):A("Subscribers",l?.membersCount,"i"))))})))})),oy=(0,n.ph)((0,s.EK)(((e,t)=>{let{stickerSetId:a}=t;return{set:(0,c.ycM)(e,a),shouldPlay:(0,c.ML4)(e),isCurrentUserPremium:(0,c.g29)(e)}}))((e=>{let{stickerSetId:t,observeIntersection:a,set:i,shouldPlay:o,isModalOpen:l,isCurrentUserPremium:c}=e;const{loadStickers:d,toggleStickerSet:m,openStickerSet:u}=(0,s.ko)(),A=(0,n.li)(null),h=(0,T.A)(),y=i&&!i.isArchived&&Boolean(i.installedDate),p=Boolean(i?.stickers),v=(0,n.Kr)((()=>{if(!i)return[];const e=(i.stickers?.filter((e=>{let{hasEffect:t}=e;return t}))??[]).slice(0,3),t=(i.covers||[]).map((e=>{let{id:t}=e;return t})),a=i.stickers?i.stickers.filter((e=>{let{id:a}=e;return!t.includes(a)})):[];return[...e,...i.covers||[],...a].slice(0,5)}),[i]);(0,n.vJ)((()=>{!p&&v.length<5&&i&&d({stickerSetInfo:{shortName:i.shortName}})}),[p,v.length,d,i,t]);const g=(0,n.hb)((()=>{m({stickerSetId:t})}),[m,t]),E=(0,n.hb)((e=>{u({stickerSetInfo:e.stickerSetInfo})}),[u]);if(!i)return;const b=v.length>0;return n.Ay.createElement("div",{key:i.id,className:"sticker-set",dir:h.isRtl?"rtl":void 0},n.Ay.createElement("div",{className:"sticker-set-header"},n.Ay.createElement("div",{className:"title-wrapper"},n.Ay.createElement("h3",{className:"title",dir:"auto"},i.title),n.Ay.createElement("p",{className:"count",dir:"auto"},h("Stickers",i.count,"i"))),n.Ay.createElement(W.A,{className:y?"is-added":void 0,color:"primary",size:"tiny",pill:!0,fluid:!0,onClick:g},h(y?"Stickers.Installed":"Stickers.Install"))),n.Ay.createElement("div",{className:"sticker-set-main shared-canvas-container"},n.Ay.createElement("canvas",{ref:A,className:"shared-canvas"}),!b&&n.Ay.createElement(Re.A,null),b&&v.map((e=>n.Ay.createElement(sl,{sticker:e,size:r.Rqe,observeIntersection:a,noPlay:!o||l,clickArg:e,onClick:E,noContextMenu:!0,isCurrentUserPremium:c,sharedCanvasRef:A})))))}))),ly=(0,Ae.nF)((e=>e()),6e4,!0),cy=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.BmE)(e),{query:a,resultIds:n}=t||{},{featured:s}=e.stickers;return{query:a,featuredIds:s.setIds,resultIds:n,isModalOpen:Boolean((0,c.nTw)(e).openedStickerSetShortName)}}))((e=>{let{isActive:t,query:a,featuredIds:i,resultIds:r,isModalOpen:o,onClose:l}=e;const{loadFeaturedStickers:c}=(0,s.ko)(),d=(0,n.li)(null),m=(0,T.A)(),{observe:u}=(0,zo.BL)({rootRef:d,throttleMs:200});return(0,n.vJ)((()=>{ly((()=>{c()}))})),(0,ve.A)({isActive:t,onBack:l}),n.Ay.createElement("div",{ref:d,className:"StickerSearch custom-scroll",dir:m.isRtl?"rtl":void 0},function(){if(void 0!==a)return!a&&i?i.map((e=>n.Ay.createElement(oy,{key:e,stickerSetId:e,observeIntersection:u,isModalOpen:o}))):r?r.length?r.map((e=>n.Ay.createElement(oy,{key:e,stickerSetId:e,observeIntersection:u,isModalOpen:o}))):n.Ay.createElement("p",{className:"helper-text",dir:"auto"},"Nothing found."):n.Ay.createElement(fs.A,null)}())}))),dy=(0,n.ph)((0,s.EK)((e=>{const t=(0,c.Wy7)(e),{query:a,results:n}=t||{},{chatId:s,threadId:i}=(0,c.Xf0)(e)||{},r=s?(0,c.hds)(e,s):void 0,o=s?(0,c.AWZ)(e,s):void 0,d=r?(0,c.ALW)(e,r):void 0,m=Boolean(s)&&(0,c.nZ4)(e,s),u=s&&i?(0,c.Vw0)(e,s,i):void 0,A=Boolean(!u?.isCommentsInfo&&u?.fromChannelId),h=s&&i?(0,c.S0q)(e,s,i):void 0;return{query:a,results:n,chat:r,isChatWithBot:d,isSavedMessages:m,canPostInChat:Boolean(r)&&Boolean(i)&&(0,l.__m)(r,h,A,o),canScheduleUntilOnline:Boolean(s)&&(0,c.RBq)(e,s),currentMessageList:(0,c.Xf0)(e)}}))((e=>{let{isActive:t,query:a,results:i,chat:r,chatFullInfo:o,isChatWithBot:c,canScheduleUntilOnline:d,isSavedMessages:m,canPostInChat:u,currentMessageList:A,onClose:h}=e;const{searchMoreGifs:y,sendMessage:p,setGifSearchQuery:v}=(0,s.ko)(),g=(0,n.li)(null),[E,C]=(0,lA.A)(d),{observe:f}=(0,zo.BL)({rootRef:g,debounceMs:300}),S=u&&(0,l.Q_H)(r,o,c).canSendGifs,k=(0,n.hb)(((e,t,a)=>{if(S){if(!A)return;a?E((a=>{p({messageList:A,gif:e,scheduledAt:a,isSilent:t})})):p({messageList:A,gif:e,isSilent:t})}b.TF&&v({query:void 0})}),[S,A,E]),w=(0,n.hb)((()=>{y()}),[y]),N=(0,T.A)();(0,ve.A)({isActive:t,onBack:h});const I=Boolean(void 0!==a&&i&&i.length);return n.Ay.createElement("div",{className:"GifSearch",dir:N.isRtl?"rtl":void 0},n.Ay.createElement(rs.A,{ref:g,className:(0,de.A)("gif-container custom-scroll",I&&"grid"),items:i,itemSelector:".GifButton",preloadBackwards:96,noFastList:!0,onLoadMore:w},function(){if(void 0!==a)return i?i.length?i.map((e=>n.Ay.createElement(Ph,{key:e.id,gif:e,observeIntersection:f,onClick:S?k:void 0,isSavedMessages:m}))):n.Ay.createElement("p",{className:"helper-text",dir:"auto"},N("NoGIFsFound")):n.Ay.createElement(fs.A,null)}()),C)})));var my=a(71950);const uy="OAKzmAva",Ay="BQ6HUOqN",hy="TmJvv2A6",yy="U96CW2I7",py="yxjDeIct",vy="cdfiLmXo",gy="BOfHPv20",Ey="vXi2JQlj",by="bi3fL59p",Cy="GUK4ajPK",fy="YH6jeZIh",Sy="q1LnuIUn",ky="PJZzyVLK",wy="C7NpG5Y9",Ny=(0,n.ph)((function(e){let{postStatistic:t}=e;const a=(0,T.A)();return n.Ay.createElement("div",{className:fy},t.reactionsCount>0&&n.Ay.createElement("span",{className:Sy},n.Ay.createElement(q.A,{name:"heart-outline",className:ky}),(0,je.Vw)(t.reactionsCount)),t.forwardsCount>0&&n.Ay.createElement("span",{className:Sy},n.Ay.createElement(q.A,{name:"forward",className:ky}),(0,je.Vw)(t.forwardsCount)),!t.forwardsCount&&!t.reactionsCount&&a("ChannelStats.SharesCount_ZeroValueHolder"))})),Iy=(0,n.ph)((e=>{let{postStatistic:t,message:a}=e;const i=(0,T.A)(),{toggleMessageStatistics:r}=(0,s.ko)(),o=(0,l.CIU)(a),c=(0,G.A)((0,l.EOe)(a,"micro")),d=Boolean((0,l.lkW)(a)),m=(0,n.hb)((()=>{r({messageId:a.id})}),[r,a.id]);return n.Ay.createElement("div",{className:(0,de.A)(uy,Boolean(c||o)&&Ay),onClick:m},n.Ay.createElement("div",{className:by},n.Ay.createElement("div",{className:Ey},function(e,t,a,s){return a?n.Ay.createElement("span",null,n.Ay.createElement("img",{src:a,alt:"",draggable:!1,className:(0,de.A)(yy,s&&py)}),(0,l.zXI)(t)&&n.Ay.createElement(q.A,{name:"play"}),(0,h.C)(e,t,!0)):(0,h.C)(e,t)}(i,a,c||o,d)),n.Ay.createElement("div",{className:fy},i("ChannelStats.ViewsCount",t.viewsCount,"i"))),n.Ay.createElement("div",{className:Cy},n.Ay.createElement("div",{className:wy},(0,Ke.L2)(1e3*a.date,i.code)),n.Ay.createElement(Ny,{postStatistic:t})))})),Py=(0,n.ph)((function(e){let{chat:t,story:a,postStatistic:i}=e;const r=(0,T.A)(),{toggleStoryStatistics:o}=(0,s.ko)(),c=a&&"content"in a,d=c?a.content.video:void 0,m=c?(0,l.EN7)(a):void 0,u=(0,G.A)(m),A=u||d?.thumbnail?.dataUri,h=(0,M.A)((()=>{o({storyId:i.storyId})}));return n.Ay.createElement("div",{className:(0,de.A)(uy,Ay),onClick:h},n.Ay.createElement("div",{className:by},n.Ay.createElement("div",{className:Ey},function(e,t,a){return n.Ay.createElement("span",null,a?n.Ay.createElement("span",{className:hy},n.Ay.createElement("img",{src:a,alt:"",draggable:!1,className:(0,de.A)(yy,vy,gy)})):n.Ay.createElement(wt.A,{peer:t,size:"small",className:yy,withStorySolid:!0,forceUnreadStorySolid:!0}),e("Story"))}(r,t,u||A)),n.Ay.createElement("div",{className:fy},r("ChannelStats.ViewsCount",i.viewsCount,"i"))),n.Ay.createElement("div",{className:Cy},n.Ay.createElement("div",{className:wy},c&&Boolean(a.date)&&(0,Ke.L2)(1e3*a.date,r.code)),n.Ay.createElement(Ny,{postStatistic:i})))})),My="T1l_4J8z",Ty="S1x1ovkC",By="WxL3i5PM",Ly="aUrozL5_",Ry="QQHwjG88",xy="QGctP1Nk";let Fy,Vy;const Dy={growthGraph:"ChannelStats.Graph.Growth",followersGraph:"ChannelStats.Graph.Followers",muteGraph:"ChannelStats.Graph.Notifications",topHoursGraph:"ChannelStats.Graph.ViewsByHours",viewsBySourceGraph:"ChannelStats.Graph.ViewsBySource",newFollowersBySourceGraph:"ChannelStats.Graph.NewFollowersBySource",languagesGraph:"ChannelStats.Graph.Language",interactionsGraph:"ChannelStats.Graph.Interactions",reactionsByEmotionGraph:"ChannelStats.Graph.Reactions",storyInteractionsGraph:"ChannelStats.Graph.Stories",storyReactionsByEmotionGraph:"ChannelStats.Graph.StoriesReactions"},_y=Object.keys(Dy),Uy={growthGraph:"Stats.GroupGrowthTitle",membersGraph:"Stats.GroupMembersTitle",languagesGraph:"Stats.GroupLanguagesTitle",messagesGraph:"Stats.GroupMessagesTitle",actionsGraph:"Stats.GroupActionsTitle",topHoursGraph:"Stats.GroupTopHoursTitle"},Oy=Object.keys(Uy),Jy=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.gqw)(e,a),s=(0,c.hds)(e,a),i=(0,c.AWZ)(e,a)?.statisticsDcId,r="chatTypeSuperGroup"===s?.type,o=(0,c.zeq)(e,a),l=(0,c._bp)(e,a)?.byId;return{statistics:n,dcId:i,isGroup:r,chat:s,messagesById:o,storiesById:l}}))((e=>{let{chatId:t,chat:i,statistics:r,dcId:o,isGroup:l,messagesById:c,storiesById:d}=e;const m=(0,T.A)(),u=(0,n.li)(null),[A,h]=(0,n.J0)(!1),y=(0,n.li)([]),{loadStatistics:p,loadStatisticsAsyncGraph:v}=(0,s.ko)(),g=(0,P.A)();(0,n.vJ)((()=>{p({chatId:t,isGroup:l})}),[t,p,l]);const E=(0,n.Kr)((()=>l?Oy:_y),[l]),b=(0,n.Kr)((()=>l?Uy:Dy),[l]);return(0,n.vJ)((()=>{r&&E.forEach((e=>{const a=r[e];"string"==typeof a&&v({name:e,chatId:t,token:a,isPercentage:"languagesGraph"===e})}))}),[E,t,r,v]),(0,n.vJ)((()=>{(async()=>{await async function(){return Fy||(Fy=a.e(1184).then(a.bind(a,31184)),Vy=await Fy),Fy}(),A?r&&u.current&&(E.forEach(((e,t)=>{const a=r[e];if("string"==typeof a||y.current.includes(e))return;if(!a)return void y.current.push(e);const{zoomToken:n}=a;Vy.create(u.current.children[t],{title:m(b[e]),...n?{onZoom:e=>(0,$e.px)("fetchStatisticsAsyncGraph",{token:n,x:e,dcId:o}),zoomOutLabel:m("Graph.ZoomOut")}:{},...a}),y.current.push(e),u.current.children[t].classList.remove(xy)})),g()):h(!0)})()}),[E,b,A,r,m,t,v,o,g]),A&&r?n.Ay.createElement("div",{className:(0,de.A)(My,"custom-scroll",A&&Ly)},n.Ay.createElement(my.A,{statistics:r,type:l?"group":"channel",title:m("StatisticOverview")}),!y.current.length&&n.Ay.createElement(fs.A,null),n.Ay.createElement("div",{ref:u},E.map((e=>n.Ay.createElement("div",{key:e,className:(0,de.A)(Ry,xy)})))),Boolean(r.recentPosts?.length)&&n.Ay.createElement("div",{className:"suY9dEIz"},n.Ay.createElement("h2",{className:"evQIkAqx"},m("ChannelStats.Recent.Header")),r.recentPosts.map((e=>{if("msgId"in e){const t=c[e.msgId];if(!t||!("content"in t))return;return n.Ay.createElement(Iy,{key:`statistic_message_${e.msgId}`,message:t,postStatistic:e})}if("storyId"in e&&i){const t=d?.[e.storyId];return n.Ay.createElement(Py,{key:`statistic_story_${e.storyId}`,chat:i,story:t,postStatistic:e})}})))):n.Ay.createElement(fs.A,null)}))),Ky="oXLpD4Y4",jy="paQ2VBe_",Gy="WvFuOAIf",zy=(0,n.ph)((e=>{let{data:t}=e;const a=(0,T.A)(),{openChatByUsername:i}=(0,s.ko)(),r=(0,n.Kr)((()=>t.chat?(0,l.KlG)(t.chat):void 0),[t.chat]),o=(0,n.hb)((()=>{i({username:r,messageId:t.messageId})}),[t.messageId,i,r]);return n.Ay.createElement("div",{className:(0,de.A)(Ky,"statistic-public-forward"),onClick:o},n.Ay.createElement(wt.A,{size:"medium",peer:t.chat}),n.Ay.createElement("div",null,n.Ay.createElement("div",{className:jy},t.title),n.Ay.createElement("div",{className:Gy},a("ChannelStats.ViewsCount",t.views,"i"))))}));let Hy,$y;const qy={viewsGraph:"Stats.MessageInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},Wy=Object.keys(qy),Yy=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.AWZ)(e,a)?.statisticsDcId,s=(0,c.nTw)(e);return{statistics:s.statistics.currentMessage,dcId:n,messageId:s.statistics.currentMessageId}}))((function(e){let{chatId:t,isActive:o,statistics:l,dcId:c,messageId:d}=e;const m=(0,T.A)(),u=(0,n.li)(null),[A,h]=(0,n.J0)(!1),y=(0,n.li)([]),{loadMessageStatistics:p,loadMessagePublicForwards:v,loadStatisticsAsyncGraph:g}=(0,s.ko)(),E=(0,P.A)();(0,n.vJ)((()=>{d&&p({chatId:t,messageId:d})}),[t,p,d]),(0,n.vJ)((()=>{o&&!d||(y.current=[],h(!1))}),[o,d]),(0,n.vJ)((()=>{l&&Wy.forEach((e=>{const a=l[e];"string"==typeof a&&g({name:e,chatId:t,token:a})}))}),[t,l,g]),(0,n.vJ)((()=>{(async()=>{await async function(){return Hy||(Hy=a.e(1184).then(a.bind(a,31184)),$y=await Hy),Hy}(),A?l&&u.current&&(Wy.forEach(((e,t)=>{const a=l[e];if("string"==typeof a||y.current.includes(e))return;if(!a)return void y.current.push(e);const{zoomToken:n}=a;$y.create(u.current.children[t],{title:m(qy[e]),...n?{onZoom:e=>(0,$e.px)("fetchStatisticsAsyncGraph",{token:n,x:e,dcId:c}),zoomOutLabel:m("Graph.ZoomOut")}:{},...a}),y.current.push(e)})),E()):h(!0)})()}),[A,l,m,t,d,g,c,E]);const b=(0,M.A)((e=>{let{direction:a}=e;a===i.TN.Backwards&&d&&v({chatId:t,messageId:d})}));return A&&l&&d?n.Ay.createElement("div",{className:(0,de.A)(My,"custom-scroll",A&&Ly)},n.Ay.createElement(my.A,{statistics:l,type:"message",title:m("StatisticOverview")}),!y.current.length&&n.Ay.createElement(fs.A,null),n.Ay.createElement("div",{ref:u},Wy.map((e=>n.Ay.createElement("div",{className:(0,de.A)(Ry,!y.current.includes(e)&&xy)})))),Boolean(l.publicForwards)&&n.Ay.createElement("div",{className:Ty},n.Ay.createElement("h2",{className:By},m("Stats.Message.PublicShares")),n.Ay.createElement(rs.A,{items:l.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:b,preloadBackwards:r.DRJ,noFastList:!0},l.publicForwardsData.map((e=>n.Ay.createElement(zy,{key:e.messageId,data:e})))))):n.Ay.createElement(fs.A,null)}))),Qy=(0,n.ph)((function(e){let{data:t,chatsById:a,usersById:i}=e;const r=(0,T.A)(),{openChat:o}=(0,s.ko)(),c=i[t.peerId],d=a[t.peerId],m=(0,M.A)((()=>{o({id:c.id})}));return n.Ay.createElement("div",{className:(0,de.A)(Ky,"statistic-public-forward"),onClick:m},n.Ay.createElement(wt.A,{size:"medium",peer:c||d,withStorySolid:!0,forceUnreadStorySolid:!0}),n.Ay.createElement("div",null,n.Ay.createElement("div",{className:jy},c?(0,l.YgS)(c):(0,l.JsG)(r,d)),n.Ay.createElement("div",{className:Gy},t.viewsCount?r("ChannelStats.ViewsCount",t.viewsCount,"i"):r("NoViews"))))}));let Zy,Xy;const ep={viewsGraph:"Stats.StoryInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},tp=Object.keys(ep),ap=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.AWZ)(e,a)?.statisticsDcId,s=(0,c.nTw)(e),i=s.statistics.currentStory,r=s.statistics.currentStoryId,{byId:o}=e.users,{byId:l}=e.chats;return{statistics:i,dcId:n,storyId:r,usersById:o,chatsById:l}}))((function(e){let{chatId:t,isActive:i,statistics:o,dcId:l,storyId:c,chatsById:d,usersById:m}=e;const u=(0,T.A)(),A=(0,n.li)(null),[h,y]=(0,n.J0)(!1),p=(0,n.li)([]),{loadStoryStatistics:v,loadStoryPublicForwards:g,loadStatisticsAsyncGraph:E}=(0,s.ko)(),b=(0,P.A)();(0,n.vJ)((()=>{c&&v({chatId:t,storyId:c})}),[t,c]),(0,n.vJ)((()=>{i&&!c||(p.current=[],y(!1))}),[i,c]),(0,n.vJ)((()=>{o&&tp.forEach((e=>{const a=o[e];"string"==typeof a&&E({name:e,chatId:t,token:a})}))}),[t,o,E]),(0,n.vJ)((()=>{(async()=>{await async function(){return Zy||(Zy=a.e(1184).then(a.bind(a,31184)),Xy=await Zy),Zy}(),h?o&&A.current&&(tp.forEach(((e,t)=>{const a=o[e];if("string"==typeof a||p.current.includes(e))return;if(!a)return void p.current.push(e);const{zoomToken:n}=a;Xy.create(A.current.children[t],{title:u(ep[e]),...n?{onZoom:e=>(0,$e.px)("fetchStatisticsAsyncGraph",{token:n,x:e,dcId:l}),zoomOutLabel:u("Graph.ZoomOut")}:{},...a}),p.current.push(e)})),b()):y(!0)})()}),[h,o,u,t,c,E,l,b]);const C=(0,M.A)((()=>{c&&g({chatId:t,storyId:c})}));return h&&o&&c?n.Ay.createElement("div",{className:(0,de.A)(My,"custom-scroll",h&&Ly)},n.Ay.createElement(my.A,{statistics:o,type:"story",title:u("StatisticOverview")}),!p.current.length&&n.Ay.createElement(fs.A,null),n.Ay.createElement("div",{ref:A},tp.map((e=>n.Ay.createElement("div",{className:(0,de.A)(Ry,!p.current.includes(e)&&xy)})))),Boolean(o.publicForwards)&&n.Ay.createElement("div",{className:Ty},n.Ay.createElement("h2",{className:By},u("Stats.Message.PublicShares")),n.Ay.createElement(rs.A,{items:o.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:C,preloadBackwards:r.DRJ,noFastList:!0},o.publicForwardsData.map((e=>"messageId"in e?n.Ay.createElement(zy,{key:`message_${e.messageId}`,data:e}):n.Ay.createElement(Qy,{key:`story_${e.storyId}`,data:e,chatsById:d,usersById:m})))))):n.Ay.createElement(fs.A,null)})));var np=a(55573);const sp=(0,n.ph)((0,s.EK)(((e,t)=>{let{answer:a}=t;const{voters:n,offsets:s}=(0,c.nTw)(e).pollResults;return{voters:n?.[a.option],offset:s?.[a.option]||""}}))((e=>{let{chat:t,message:a,answer:i,answerVote:r,totalVoters:o,voters:c,offset:d}=e;const{loadPollOptionResults:m,openChat:u,closePollResults:A}=(0,s.ko)(),h=(0,D.A)(r.votersCount),[y,p]=(0,n.J0)(!0),v=Boolean(c),{option:g,text:E}=i,b=(0,T.A)();(0,n.vJ)((()=>{v&&h===r.votersCount||m({chat:t,messageId:a.id,option:g,offset:d,limit:4,shouldResetVoters:!0})}),[r.votersCount,v]);const C=(0,n.hb)((()=>{p(!0),m({chat:t,messageId:a.id,option:g,offset:d,limit:50})}),[t,m,a.id,d,g]);(0,n.vJ)((()=>{p(!1)}),[c]);const f=(0,n.hb)((e=>{u({id:e}),A()}),[A,u]);return n.Ay.createElement("div",{className:"PollAnswerResults"},n.Ay.createElement("div",{className:"poll-voters"},c?c.map((e=>n.Ay.createElement(Wa.A,{key:e,className:"chat-item-clickable",onClick:()=>f(e)},(0,l.L8L)(e)?n.Ay.createElement(ds.A,{avatarSize:"tiny",userId:e,forceShowSelf:!0,noStatusOrTyping:!0}):n.Ay.createElement(cs.A,{avatarSize:"tiny",chatId:e,noStatusOrTyping:!0})))):n.Ay.createElement(fs.A,null),c&&function(){const e=r.votersCount-c.length;return r.votersCount>4&&e>0&&n.Ay.createElement(np.A,{count:e,itemName:"voter",isLoading:y,onClick:C})}()),n.Ay.createElement("div",{className:"answer-head",dir:b.isRtl?"rtl":void 0},n.Ay.createElement("span",{className:"answer-title",dir:"auto"},(0,Un.f)({text:E.text,entities:E.entities})),n.Ay.createElement("span",{className:"answer-percent",dir:b.isRtl?"auto":void 0},(S=r.votersCount,(k=o)>0?(S/k*100).toFixed():0),"%")));var S,k}))),ip=(0,n.ph)((0,s.EK)((e=>{const{pollResults:{chatId:t,messageId:a}}=(0,c.nTw)(e);if(!t||!a)return{};const n=(0,c.hds)(e,t),s=(0,c.O5q)(e,t,a);return{chat:n,message:s,poll:s&&(0,c.zcZ)(e,s)}}))((e=>{let{isActive:t,chat:a,message:s,poll:i,onClose:r}=e;const o=(0,T.A)();if((0,ve.A)({isActive:t,onBack:r}),!s||!i||!a)return n.Ay.createElement(fs.A,null);const{summary:l,results:c}=i;if(!c.results)return;const d=(0,on.dU)(c.results,"option");return n.Ay.createElement("div",{className:"PollResults",dir:o.isRtl?"rtl":void 0},n.Ay.createElement("h3",{className:"poll-question",dir:"auto"},(0,Un.f)({text:l.question.text,entities:l.question.entities})),n.Ay.createElement("div",{className:"poll-results-list custom-scroll"},l.answers.map((e=>n.Ay.createElement(sp,{key:`${i.id}-${e.option}`,chat:a,message:s,answer:e,answerVote:d[e.option],totalVoters:c.totalVoters})))))})));var rp=a(90603);const op="xrnUE4e6",lp="z7kF7tij",cp="T6wFpdQO",dp="CWsWIKQ1",mp="KBl0ycLl",up="iJ1U9kDD",Ap="Rk6PT_yc",hp="qlo3vSEw",yp="r06zwL42",pp=5*A.$,vp=(0,n.ph)((0,s.EK)((e=>{const{createTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,createTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}}))((e=>{let{isActive:t,chat:a,createTopicPanel:i,isCurrentUserPremium:o,onClose:l}=e;const{createTopic:c,openPremiumModal:d}=(0,s.ko)(),[m,u]=(0,n.J0)(""),[A,h]=(0,n.J0)(0),[y,p]=(0,n.J0)(void 0),v=(0,T.A)(),g=Boolean(m),E=Boolean(i?.isLoading);(0,ve.A)({isActive:t,onBack:l}),(0,n.vJ)((()=>{t||(u(""),p(void 0))}),[t]);const b=(0,n.hb)((e=>{u(e.target.value)}),[]),C=(0,n.hb)((()=>{h((e=>(0,mr.A)((0,rp.e$)().length,e+1)))}),[]),f=(0,n.hb)((()=>{c({chatId:a.id,title:m,iconColor:(0,rp.e$)()[A],iconEmojiId:y})}),[a,c,A,y,m]),S=(0,n.hb)((e=>{e.isFree||o||e.id===r.MyF?e.id!==r.MyF?p(e.id):p(void 0):d({initialSection:"animated_emoji"})}),[o,d]),k=(0,n.Kr)((()=>({id:0,title:m,iconColor:(0,rp.e$)()[A],iconEmojiId:y})),[A,y,m]);if(a?.isForum)return n.Ay.createElement("div",{className:op},n.Ay.createElement("div",{className:(0,de.A)(lp,"custom-scroll")},n.Ay.createElement("div",{className:(0,de.A)(cp,dp)},n.Ay.createElement("span",{className:hp},v("CreateTopicTitle")),n.Ay.createElement(te.Ay,{name:"zoomFade",activeKey:Number(k.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:up},n.Ay.createElement(ks.A,{topic:k,className:(0,de.A)(Ap,"K1CTKtBS"),onClick:C,size:pp,noLoopLimit:!0})),n.Ay.createElement(Y.A,{value:m,onChange:b,label:v("lng_forum_topic_title"),disabled:E,teactExperimentControlled:!0})),n.Ay.createElement("div",{className:(0,de.A)(cp,mp)},n.Ay.createElement(fl,{idPrefix:"create-topic-icons-set-",isHidden:!t,loadAndPlay:t,onCustomEmojiSelect:S,className:yp,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0}))),n.Ay.createElement(un.A,{isShown:g,disabled:E,onClick:f,ariaLabel:v("Save")},E?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})))}))),gp=5*A.$,Ep=(0,n.ph)((0,s.EK)((e=>{const{editTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,topic:t?.chatId&&t?.topicId?(0,c.S0q)(e,t.chatId,t.topicId):void 0,editTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}}))((e=>{let{isActive:t,chat:a,topic:i,editTopicPanel:o,isCurrentUserPremium:l,onClose:c}=e;const{editTopic:d,openPremiumModal:m}=(0,s.ko)(),[u,A]=(0,n.J0)(""),[h,y]=(0,n.J0)(void 0),p=(0,T.A)(),v=Boolean(o?.isLoading),g=i?.id===r.HxB;(0,ve.A)({isActive:t,onBack:c}),(0,n.vJ)((()=>{t||(A(""),y(void 0))}),[t]),(0,n.vJ)((()=>{(i?.title||i?.iconEmojiId)&&(A(i.title),y(i.iconEmojiId))}),[i]);const E=(0,n.Kr)((()=>u!==i?.title||h!==i?.iconEmojiId),[h,u,i?.iconEmojiId,i?.title]),b=(0,n.hb)((e=>{const t=e.target.value;A(t)}),[]),C=(0,n.hb)((()=>{d({chatId:a.id,title:u,topicId:i.id,iconEmojiId:h})}),[a,d,h,u,i]),f=(0,n.hb)((e=>{e.isFree||l||e.id===r.MyF?e.id!==r.MyF?y(e.id):y("0"):m({initialSection:"animated_emoji"})}),[l,m]),S=(0,n.Kr)((()=>({...i,title:u,iconEmojiId:h})),[h,u,i]);if(a?.isForum)return n.Ay.createElement("div",{className:op},n.Ay.createElement("div",{className:(0,de.A)(lp,"custom-scroll")},!i&&n.Ay.createElement(fs.A,null),i&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:(0,de.A)(cp,dp,g&&"YftUWqqw")},n.Ay.createElement("span",{className:hp},p(g?"CreateGeneralTopicTitle":"CreateTopicTitle")),n.Ay.createElement(te.Ay,{name:"zoomFade",activeKey:Number(S.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:up},n.Ay.createElement(ks.A,{topic:S,className:Ap,size:gp,noLoopLimit:!0})),n.Ay.createElement(Y.A,{value:u,onChange:b,label:p("lng_forum_topic_title"),disabled:v,teactExperimentControlled:!0})),!g&&n.Ay.createElement("div",{className:(0,de.A)(cp,mp)},n.Ay.createElement(fl,{idPrefix:"edit-topic-icons-set-",isHidden:!t,loadAndPlay:t,onCustomEmojiSelect:f,className:yp,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0})))),n.Ay.createElement(un.A,{isShown:E,disabled:v,onClick:C,ariaLabel:p("Save")},v?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})))}))),bp="Please provide name",Cp=(0,n.ph)((0,s.EK)(((e,t)=>{let{userId:a}=t;const n=(0,c.yps)(e,a),s=(0,c.vGo)(e,a),{progress:i}=(0,c.nTw)(e).management,r=(0,Yi.d)(e,"aboutLength");return{userId:a,user:n,progress:i,currentBio:s?.bio,maxBioLength:r}}))((e=>{let{userId:t,user:a,progress:r,onClose:o,currentBio:c,isActive:d,maxBioLength:m}=e;const{setBotInfo:u,uploadProfilePhoto:A,uploadContactProfilePhoto:h,startBotFatherConversation:y}=(0,s.ko)(),[p,v,g]=(0,I.A)(!1),[E,b,C]=(0,I.A)(!1),[f,S]=(0,n.J0)(),k=(0,T.A)(),w=(0,n.Kr)((()=>a?(0,l.KlG)(a):void 0),[a]);(0,ve.A)({isActive:d,onBack:o});const N=a?(0,l.u0l)(a):"",[P,B]=(0,n.J0)(),[L,R]=(0,n.J0)(N||""),[x,F]=(0,n.J0)(c||""),V=a&&(0,l.cP1)(a),D=(0,G.A)(V,!1,U.qZ.BlobUrl);(0,n.vJ)((()=>{g(),C()}),[t]),(0,n.vJ)((()=>{R(N||""),F(c||"")}),[N,c,a]),(0,n.vJ)((()=>{B(void 0)}),[D]),(0,n.vJ)((()=>{r===i.TD.Complete&&(g(),C(),S(void 0))}),[r]);const _=(0,M.A)((e=>{R(e.target.value),v(),f===bp&&S(void 0)})),O=(0,M.A)((e=>{F(e.target.value),v()})),J=(0,M.A)((e=>{B(e),b()})),K=(0,M.A)((()=>{const e=L.trim(),t=x.trim();e.length?(u({...p&&{bot:a,name:e,description:t}}),P&&A({file:P,...E&&{bot:a}})):S(bp)})),j=(0,M.A)((()=>{y({param:`${w}-intro`})})),z=(0,M.A)((()=>{y({param:`${w}-commands`})})),H=(0,M.A)((()=>{y({param:`${w}`})})),$=(0,n.li)(null),W=(0,n.li)(!1),Q=(0,M.A)((e=>{b(),h({userId:t,file:e,isSuggest:W.current})}));if(!a)return;const Z=r===i.TD.InProgress;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(wm.A,{currentAvatarBlobUrl:D,onChange:J,title:k("ChatSetPhotoOrVideo"),disabled:Z}),n.Ay.createElement(Y.A,{id:"user-name",label:k("PaymentCheckoutName"),onChange:_,value:L,error:f===bp?f:void 0,teactExperimentControlled:!0}),n.Ay.createElement(cc.A,{value:x,onChange:O,label:k("DescriptionPlaceholder"),disabled:Z,maxLength:m,maxLengthIndicator:m?(m-x.length).toString():void 0})),n.Ay.createElement("div",{className:"section"},n.Ay.createElement("div",{className:"dialog-buttons"},n.Ay.createElement(Wa.A,{icon:"bot-commands-filled",ripple:!0,onClick:j},n.Ay.createElement("span",null,k("BotEditIntro"))),n.Ay.createElement(Wa.A,{icon:"bot-command",ripple:!0,onClick:z},n.Ay.createElement("span",null,k("BotEditCommands"))),n.Ay.createElement(Wa.A,{icon:"bots",ripple:!0,onClick:H},n.Ay.createElement("span",null,k("BotChangeSettings"))),n.Ay.createElement("div",{className:"section-info section-info_push"},(0,kt.A)(k("BotManageInfo"),["links"]))))),n.Ay.createElement(un.A,{isShown:p||E,onClick:K,disabled:Z,ariaLabel:k("Save")},Z?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})),n.Ay.createElement(mu.A,{onChange:Q,inputRef:$}))}))),fp="Channel title can't be empty",Sp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a),{management:s}=(0,c.nTw)(e),{progress:i}=s,{invites:r}=s.byChatId[a]||{};return{chat:n,chatFullInfo:(0,c.AWZ)(e,a),progress:i,canChangeInfo:(0,l.ubU)(n,"changeInfo"),canInvite:(0,l.ubU)(n,"inviteUsers"),exportedInvites:r,availableReactions:e.reactions.availableReactions}}),((e,t)=>{let{chatId:a}=t;return Boolean((0,c.hds)(e,a))}))((e=>{let{chatId:t,chat:a,chatFullInfo:r,progress:o,canChangeInfo:c,canInvite:d,exportedInvites:m,isActive:u,availableReactions:A,onScreenSelect:h,onClose:y}=e;const{updateChat:p,closeManagement:v,leaveChannel:g,deleteChannel:E,openChat:b,loadExportedChatInvites:C,loadChatJoinRequests:f}=(0,s.ko)(),S=a?.title||"",k=r?.about||"",w=Boolean(r?.linkedChatId),[N,P,M]=(0,I.A)(),[B,L]=(0,n.J0)(!1),[R,x]=(0,n.J0)(S),[F,V]=(0,n.J0)(k),[D,_]=(0,n.J0)(),[O,J]=(0,n.J0)(),K=a&&(0,l.cP1)(a),j=(0,G.A)(K,!1,U.qZ.BlobUrl),z=(0,T.A)();(0,ve.A)({isActive:u,onBack:y}),(0,n.vJ)((()=>{d&&(C({chatId:t}),C({chatId:t,isRevoked:!0}),f({chatId:t}))}),[t,d]),(0,n.vJ)((()=>{o===i.TD.Complete&&(L(!1),J(void 0))}),[o]);const H=(0,n.Kr)((()=>Object.keys(r?.adminMembersById||{}).length),[r?.adminMembersById]),$=r?.kickedMembers?.length||0,W=(0,n.hb)((()=>{h(i.je.ChatPrivacyType)}),[h]),Q=(0,n.hb)((()=>{h(i.je.Discussion)}),[h]),Z=(0,n.hb)((()=>{h(i.je.Reactions)}),[h]),X=(0,n.hb)((()=>{h(i.je.ChatAdministrators)}),[h]),ee=(0,n.hb)((()=>{h(i.je.Invites)}),[h]),te=(0,n.hb)((()=>{h(i.je.JoinRequests)}),[h]),ae=(0,n.hb)((e=>{_(e),L(!0)}),[]),ne=(0,n.hb)((e=>{x(e.target.value),L(!0)}),[]),se=(0,n.hb)((e=>{V(e.target.value),L(!0)}),[]),ie=(0,n.hb)((()=>{const e=R.trim(),a=F.trim();e.length?p({chatId:t,title:e,about:a,photo:D}):J(fp)}),[F,t,D,R,p]),re=(0,n.hb)((()=>{h(i.je.ChannelSubscribers)}),[h]),oe=(0,n.hb)((()=>{h(i.je.ChannelRemovedUsers)}),[h]),le=(0,n.hb)((()=>{a.isCreator?E({chatId:a.id}):g({chatId:a.id}),M(),v(),b({id:void 0})}),[a.isCreator,a.id,M,v,g,E,b]),ce=(0,n.Kr)((()=>{if(!r?.enabledReactions)return z("ReactionsOff");if("all"===r.enabledReactions.type)return z("ReactionsAll");const e=r.enabledReactions.allowed.length,t=A?.filter((e=>!e.isInactive)).length||0;return t?`${e} / ${t}`:`${e}`}),[A,r?.enabledReactions,z]),de=(0,n.Kr)((()=>(0,l.gAJ)(a)),[a]);if(a.isRestricted||a.isForbidden)return;const me=o===i.TD.InProgress;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(wm.A,{currentAvatarBlobUrl:j,onChange:ae,disabled:!c}),n.Ay.createElement("div",{className:"settings-edit"},n.Ay.createElement(Y.A,{id:"channel-title",label:z("EnterChannelName"),onChange:ne,value:R,error:O===fp?O:void 0,disabled:!c}),n.Ay.createElement(cc.A,{id:"channel-about",label:z("DescriptionPlaceholder"),onChange:se,value:F,maxLength:255,maxLengthIndicator:(255-F.length).toString(),disabled:!c,noReplaceNewlines:!0})),a.isCreator&&n.Ay.createElement(Wa.A,{icon:"lock",multiline:!0,onClick:W},n.Ay.createElement("span",{className:"title"},z("ChannelType")),n.Ay.createElement("span",{className:"subtitle"},z(de?"TypePublic":"TypePrivate"))),n.Ay.createElement(Wa.A,{icon:"message",multiline:!0,onClick:Q,disabled:!c},n.Ay.createElement("span",{className:"title"},z("Discussion")),n.Ay.createElement("span",{className:"subtitle"},z(w?"DiscussionUnlink":"Add"))),d&&n.Ay.createElement(Wa.A,{icon:"link",onClick:ee,multiline:!0,disabled:!m},n.Ay.createElement("span",{className:"title"},z("GroupInfo.InviteLinks")),n.Ay.createElement("span",{className:"subtitle"},m?(0,je.Sm)(m.length):z("Loading"))),Boolean(a.joinRequests?.length)&&n.Ay.createElement(Wa.A,{icon:"add-user-filled",onClick:te,multiline:!0},n.Ay.createElement("span",{className:"title"},z("SubscribeRequests")),n.Ay.createElement("span",{className:"subtitle"},(0,je.Sm)(a.joinRequests.length))),n.Ay.createElement(Wa.A,{icon:"heart-outline",multiline:!0,onClick:Z,disabled:!c},n.Ay.createElement("span",{className:"title"},z("Reactions")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},ce))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Wa.A,{icon:"admin",multiline:!0,onClick:X},n.Ay.createElement("span",{className:"title"},z("ChannelAdministrators")),n.Ay.createElement("span",{className:"subtitle"},H)),n.Ay.createElement(Wa.A,{icon:"group",multiline:!0,onClick:re},n.Ay.createElement("span",{className:"title",dir:"auto"},z("ChannelSubscribers")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},(0,je.Sm)(a.membersCount))),n.Ay.createElement(Wa.A,{icon:"delete-user",multiline:!0,onClick:oe},n.Ay.createElement("span",{className:"title"},z("ChannelBlockedUsers")),n.Ay.createElement("span",{className:"subtitle"},$))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Wa.A,{icon:"delete",ripple:!0,destructive:!0,onClick:P},a.isCreator?z("ChannelDelete"):z("LeaveChannel")))),n.Ay.createElement(un.A,{isShown:B,onClick:ie,disabled:me,ariaLabel:z("Save")},me?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})),n.Ay.createElement(tn.A,{isOpen:N,onClose:M,text:a.isCreator?z("ChannelDeleteAlert"):z("ChannelLeaveAlert"),confirmLabel:a.isCreator?z("ChannelDelete"):z("LeaveChannel"),confirmHandler:le,confirmIsDestructive:!0}))}))),kp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a);return{chat:n,currentUserId:e.currentUserId,isChannel:n&&(0,l.WXB)(n),adminMembersById:(0,c.AWZ)(e,a)?.adminMembersById}}))((e=>{let{isActive:t,chat:a,isChannel:r,currentUserId:o,adminMembersById:c,onScreenSelect:d,onChatMemberSelect:m,onClose:u}=e;const{toggleSignatures:A}=(0,s.ko)(),h=(0,T.A)();(0,ve.A)({isActive:t,onBack:u});const y=Boolean(a?.areSignaturesShown),p=Boolean(a?.areProfilesShown),v=Boolean(a?.isCreator||a&&(0,l.ubU)(a,"addAdmins")),g=r&&(0,l.ubU)(a,"postMessages"),E=(0,n.Kr)((()=>{if(!c)return[];const[e,t]=(0,on.jB)(Object.values(c),(e=>e.isOwner));return[...e,...t]}),[c]),b=(0,M.A)((e=>{m(e.userId,e.promotedByUserId===o),d(i.je.ChatAdminRights)})),C=(0,M.A)((()=>{A({chatId:a.id,areProfilesEnabled:p,areSignaturesEnabled:!y})})),f=(0,M.A)((()=>{A({chatId:a.id,areProfilesEnabled:!p,areSignaturesEnabled:y})})),S=(0,M.A)((()=>{d(i.je.GroupAddAdmins)})),k=(0,M.A)((e=>{if(e.isOwner)return h("ChannelCreator");const t=(0,s.mS)().users.byId,a=e.promotedByUserId?t[e.promotedByUserId]:void 0;return a?h("EditAdminPromotedBy",(0,l.YgS)(a)):h("ChannelAdmin")}));return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Wa.A,{icon:"recent",multiline:!0,disabled:!0},n.Ay.createElement("span",{className:"title"},h("EventLog")),n.Ay.createElement("span",{className:"subtitle"},h(r?"EventLogInfoDetailChannel":"EventLogInfoDetail")))),n.Ay.createElement("div",{className:"section",dir:h.isRtl?"rtl":void 0},n.Ay.createElement("p",{className:"section-help",dir:"auto"},h(r?"Channel.Management.AddModeratorHelp":"Group.Management.AddModeratorHelp")),E.map((e=>n.Ay.createElement(Wa.A,{key:e.userId,className:"chat-item-clickable",onClick:()=>b(e)},n.Ay.createElement(ds.A,{userId:e.userId,status:k(e),forceShowSelf:!0})))),n.Ay.createElement(un.A,{isShown:v,onClick:S,ariaLabel:h("Channel.Management.AddModerator")},n.Ay.createElement(q.A,{name:"add-user-filled"}))),g&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(js.A,{checked:y,label:h("ChannelSignMessages"),onChange:C})),y&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(js.A,{checked:p,label:h("ChannelSignMessagesWithProfile"),onChange:f})),n.Ay.createElement("p",{className:"section-info section-info_push"},h("ChannelSignProfilesInfo"))))))}))),wp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a),{isUsernameAvailable:s,checkedUsername:i,error:r}=(0,c.YK)(e,a);return{chat:n,isChannel:(0,l.WXB)(n),progress:(0,c.nTw)(e).management.progress,error:r,isUsernameAvailable:s,checkedUsername:i,isProtected:n?.isProtected,maxPublicLinks:(0,Yi.d)(e,"channelsPublic"),privateInviteLink:(0,c.AWZ)(e,a)?.inviteLink}}),((e,t)=>{let{chatId:a}=t;return Boolean((0,c.hds)(e,a)&&(0,c.YK)(e,a))}))((e=>{let{chat:t,isActive:a,isChannel:o,progress:c,isUsernameAvailable:d,checkedUsername:m,error:u,isProtected:A,maxPublicLinks:h,privateInviteLink:y,onClose:p}=e;const{updatePublicLink:v,updatePrivateLink:g,toggleIsProtected:E,openLimitReachedModal:b,resetManagementError:C}=(0,s.ko)(),f=(0,n.Kr)((()=>t.usernames?.find((e=>{let{isEditable:t}=e;return t}))),[t.usernames]),S=f?.username||"",k=(0,n.Kr)((()=>(0,l.gAJ)(t)),[t]),[w,N]=(0,n.J0)(!1),[P,M]=(0,n.J0)(k?"public":"private"),[B,L]=(0,n.J0)(),[R,x,F]=(0,I.A)(),[V,_,U]=(0,I.A)(),O=(0,D.A)(d),J=w&&Boolean("public"===P&&(B||S&&""===B)&&(d??O)||"private"===P&&k);(0,ve.A)({isActive:a,onBack:p}),(0,n.vJ)((()=>{N(!1)}),[S]),(0,n.vJ)((()=>{P&&!y&&g()}),[P,y,g]);const K=(0,n.hb)((e=>{L(e),N(!0),u&&C({chatId:t.id})}),[t.id,u]),j=(0,n.hb)(((e,t)=>{if(Object.values((0,s.mS)().chats.byId).filter((e=>{let{isCreator:t,usernames:a}=e;return t&&a?.some((e=>e.isActive))})).length>=h&&"public"===e){b({limit:"channelsPublic"});const e=t.currentTarget.closest(".radio-group");return e.querySelector("[value=public]").checked=!1,void(e.querySelector("[value=private]").checked=!0)}M(e),N(!0)}),[h,b]),G=(0,n.hb)((e=>{E({chatId:t.id,isProtected:"protected"===e})}),[t.id,E]),z=(0,n.hb)((()=>{k&&"private"===P?_():v({username:"public"===P&&B||""})}),[k,_,P,v,B]),H=(0,n.hb)((()=>{v({username:"",shouldDisableUsernames:!0}),U()}),[U,v]),$=(0,n.hb)((()=>{F(),g()}),[F,g]),W=(0,T.A)(),Y=o?"Channel":"Mega",Q=o?"Channel":"Group",X=[{value:"private",label:W(`${Y}Private`),subLabel:W(`${Y}PrivateInfo`)},{value:"public",label:W(`${Y}Public`),subLabel:W(`${Y}PublicInfo`)}],ee=[{value:"allowed",label:W("ChannelVisibility.Forwarding.Enabled")},{value:"protected",label:W("ChannelVisibility.Forwarding.Disabled")}],te=c===i.TD.InProgress,ae="public"===P&&t.usernames&&t.usernames.length>0;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section",dir:W.isRtl?"rtl":void 0},n.Ay.createElement("h3",{className:"section-heading"},W(`${Q}Type`)),n.Ay.createElement(Z.A,{selected:P,name:"channel-type",options:X,onChange:j})),"private"===P?n.Ay.createElement("div",{className:"section",dir:W.isRtl?"rtl":void 0},y?n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement($l.A,{url:y,className:"group-link",text:y}),n.Ay.createElement("p",{className:"section-info",dir:W.isRtl?"rtl":void 0},W(`${Y}PrivateLinkHelp`)),n.Ay.createElement(Wa.A,{icon:"delete",ripple:!0,destructive:!0,onClick:x},W("RevokeLink")),n.Ay.createElement(tn.A,{isOpen:R,onClose:F,text:W("RevokeAlert"),confirmLabel:W("RevokeButton"),confirmHandler:$,confirmIsDestructive:!0})):n.Ay.createElement(fs.A,null)):n.Ay.createElement("div",{className:"section no-border"},n.Ay.createElement(km,{asLink:!0,currentUsername:S,isLoading:te,isUsernameAvailable:d,checkedUsername:m,onChange:K}),u===r.Y3M&&function(){const e=`${r.jsp}${r.NjX}`;return n.Ay.createElement("p",{className:"section-info",dir:"auto"},W("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map((t=>"PURCHASE_LINK"===t?n.Ay.createElement($l.A,{url:e,text:`@${r.NjX}`}):t)))}(),n.Ay.createElement("p",{className:"section-info",dir:"auto"},W(`${Q}.Username.CreatePublicLinkHelp`))),ae&&n.Ay.createElement(bm,{chatId:t.id,usernames:t.usernames,onEditUsername:K}),n.Ay.createElement("div",{className:"section",dir:W.isRtl?"rtl":void 0},n.Ay.createElement("h3",{className:"section-heading"},W(o?"ChannelVisibility.Forwarding.ChannelTitle":"ChannelVisibility.Forwarding.GroupTitle")),n.Ay.createElement(Z.A,{selected:A?"protected":"allowed",name:"forwarding-type",options:ee,onChange:G}),n.Ay.createElement("p",{className:"section-info section-info_push"},W(o?"ChannelVisibility.Forwarding.ChannelInfo":"ChannelVisibility.Forwarding.GroupInfo")))),n.Ay.createElement(un.A,{isShown:J,disabled:te,ariaLabel:W("Save"),onClick:z},te?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})),n.Ay.createElement(tn.A,{isOpen:V,onClose:U,text:W("ChannelVisibility.Confirm.MakePrivate.Channel",S),confirmHandler:H,confirmIsDestructive:!0}))}))),Np=(0,n.ph)((0,s.EK)(((e,t)=>{let{chat:a}=t;const{currentUserId:n}=e;return{currentUserId:n,chatMembers:(0,c.AWZ)(e,a.id)?.members}}))((e=>{let{chat:t,currentUserId:a,chatMembers:i,isOpen:r,onClose:o}=e;const{loadMoreMembers:l,deleteChatMember:c}=(0,s.ko)(),d=(0,T.A)(),[m,u]=(0,n.J0)(""),A=(0,n.Kr)((()=>{const e=(i||[]).reduce(((e,t)=>(t.isAdmin||t.isOwner||t.userId===a||e.push(t.userId),e)),[]);return(0,rn.PU)({ids:e,query:m,type:"user"})}),[i,a,m]),h=(0,n.hb)((e=>{c({chatId:t.id,userId:e}),o()}),[t.id,c,o]);return n.Ay.createElement(Ps,{isOpen:r,chatOrUserIds:A,searchPlaceholder:d("ChannelBlockUser"),search:m,onSearchChange:u,loadMore:l,onSelectChatOrUser:h,onClose:o})}))),Ip=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a),{byId:s}=e.users;return{chat:n,usersById:s,canDeleteMembers:n&&((0,l.ubU)(n,"banUsers")||n.isCreator),removedMembers:(0,c.AWZ)(e,a)?.kickedMembers||ln.p,isChannel:n&&(0,l.WXB)(n)}}))((e=>{let{chat:t,usersById:a,canDeleteMembers:i,removedMembers:r,isChannel:o,onClose:c,isActive:d}=e;const{updateChatMemberBannedRights:m}=(0,s.ko)(),u=(0,T.A)(),[A,h,y]=(0,I.A)();(0,ve.A)({isActive:d,onBack:c});const p=(0,n.hb)((e=>{if(!e.kickedByUserId)return;const t=a[e.kickedByUserId];return t?u("UserRemovedBy",(0,l.YgS)(t)):void 0}),[u,a]),v=(0,n.hb)((e=>{if(t)return[{title:u("Unblock"),icon:"delete",destructive:!0,handler:()=>m({chatId:t.id,userId:e.userId,bannedRights:{}})}]}),[u,t,m]);return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section",dir:u.isRtl?"rtl":void 0},n.Ay.createElement("p",{className:"section-help"},u(o?"NoBlockedChannel2":"NoBlockedGroup2")),r.map((e=>n.Ay.createElement(Wa.A,{key:e.userId,className:"chat-item-clickable",ripple:!0,contextActions:v(e)},n.Ay.createElement(ds.A,{userId:e.userId,status:p(e),forceShowSelf:!0})))),i&&n.Ay.createElement(un.A,{isShown:!0,onClick:h,ariaLabel:u("Channel.EditAdmin.Permission.BanUsers")},n.Ay.createElement(q.A,{name:"add-user-filled"})),t&&i&&n.Ay.createElement(Np,{chat:t,isOpen:A,onClose:y}))))}))),Pp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a),{linkedChatId:s}=(0,c.AWZ)(e,a)||{},{forDiscussionIds:i,byId:r}=e.chats;return{chat:n,chatsByIds:r,forDiscussionIds:i,linkedChat:s?(0,c.hds)(e,s):void 0,isChannel:n&&(0,l.WXB)(n)}}))((e=>{let{chat:t,onClose:a,isActive:o,chatId:l,chatsByIds:c,linkedChat:d,forDiscussionIds:m,isChannel:u,onScreenSelect:A}=e;const{loadGroupsForDiscussion:h,linkDiscussionGroup:y,unlinkDiscussionGroup:p,toggleJoinRequest:v,toggleJoinToSend:g}=(0,s.ko)(),[E,b]=(0,n.J0)(),[C,f,S]=(0,I.A)(),[k,w,N]=(0,I.A)(),[P,M]=(0,n.J0)(Boolean(d?.isJoinToSend)),[B,L]=(0,n.J0)(Boolean(d?.isJoinRequest)),R=(0,T.A)(),x=d?.id;(0,ve.A)({isActive:o,onBack:a}),(0,n.vJ)((()=>{h()}),[h]),(0,n.vJ)((()=>{o&&(M(d?.isJoinToSend||!1),L(d?.isJoinRequest||!1))}),[d,o]);const F=(0,n.hb)((()=>{S(),p({channelId:u?l:x}),u||A(i.je.Initial)}),[S,p,u,l,x,A]),V=(0,n.hb)((()=>{N(),y({channelId:l,chatId:E})}),[N,y,l,E]),D=(0,n.hb)((e=>{M(e),g({chatId:x,isEnabled:e}),e||L(!1)}),[x,g]),_=(0,n.hb)((e=>{L(e),v({chatId:x,isEnabled:e})}),[x,v]);return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ol.A,{tgsUrl:rl.w.DiscussionGroups,size:r.Uyp,className:"section-icon"}),d&&n.Ay.createElement("div",null,n.Ay.createElement(Wa.A,{className:"chat-item-clickable",inactive:!0},n.Ay.createElement(cs.A,{chatId:d.id})),n.Ay.createElement(Wa.A,{icon:"delete",ripple:!0,destructive:!0,onClick:f},R(u?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel")),n.Ay.createElement(tn.A,{isOpen:C,onClose:S,header:n.Ay.createElement("div",{className:"modal-header"},n.Ay.createElement(wt.A,{size:"tiny",peer:d}),n.Ay.createElement("div",{className:"modal-title"},R(u?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel"))),textParts:(0,kt.A)(R(u?"DiscussionUnlinkChannelAlert":"DiscussionUnlinkGroupAlert",d.title),["br","simple_markdown"]),confirmLabel:R(u?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel"),confirmHandler:F,confirmIsDestructive:!0})),!d&&n.Ay.createElement("div",null,n.Ay.createElement("p",{className:"section-help",dir:"auto"},R("DiscussionChannelHelp")),n.Ay.createElement("div",{teactFastList:!0},n.Ay.createElement(Wa.A,{key:"create-group",icon:"group",ripple:!0,teactOrderKey:0,disabled:!0},R("DiscussionCreateGroup")),m?m.map(((e,t)=>n.Ay.createElement(Wa.A,{key:e,teactOrderKey:t+1,className:"chat-item-clickable scroll-item",onClick:()=>{b(e),w()}},n.Ay.createElement(cs.A,{chatId:e})))):n.Ay.createElement(qc.A,{key:"nothing-found",teactOrderKey:0,text:"No discussion groups found"})),n.Ay.createElement("p",{className:"mt-4 mb-0 section-help",dir:"auto"},R("DiscussionChannelHelp2")),n.Ay.createElement(tn.A,{isOpen:k,onClose:N,header:function(){if(!E)return;const e=c[E];return e?n.Ay.createElement("div",{className:"modal-header"},n.Ay.createElement(wt.A,{size:"tiny",peer:e}),n.Ay.createElement("div",{className:"modal-title"},R("Channel.DiscussionGroup.LinkGroup"))):void 0}(),textParts:function(){if(!E)return;const e=c[E];return e?e.hasPrivateLink?(0,kt.A)(`Do you want to make **${e.title}** the discussion board for **${t.title}**?`,["br","simple_markdown"]):(0,kt.A)(`Do you want to make **${e.title}** the discussion board for **${t.title}**?\n\nAnyone from the channel will be able to see messages in this group.`,["br","simple_markdown"]):void 0}(),confirmLabel:R("DiscussionLinkGroup"),confirmHandler:V}))),d&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("h3",{className:"section-heading"},R("ChannelSettingsJoinTitle")),n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(js.A,{checked:P,onCheck:D,label:R("ChannelSettingsJoinToSend")})),P&&n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(js.A,{checked:B,onCheck:_,label:R("ChannelSettingsJoinRequest")})),n.Ay.createElement("p",{className:"section-info section-info_push"},R(P?"ChannelSettingsJoinRequestInfo":"ChannelSettingsJoinToSendInfo")))))}))),Mp="Group title can't be empty",Tp=["sendMessages","embedLinks","sendPolls","changeInfo","inviteUsers","pinMessages","manageTopics","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs"],Bp=Tp.length+1,Lp=(0,Ae.sg)((e=>e()),500,!1),Rp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a),s=(0,c.AWZ)(e,a),{management:i,limitReachedModal:r}=(0,c.nTw)(e),{progress:o}=i,d=Boolean(s?.linkedChatId),m=(0,l.yn$)(n),{invites:u}=i.byChatId[a]||{},A=!d&&((0,l.ubU)(n,"changeInfo")||n.isCreator);return{chat:n,chatFullInfo:s,progress:o,isBasicGroup:m,hasLinkedChannel:d,canChangeInfo:n.isCreator||(0,l.ubU)(n,"changeInfo"),canBanUsers:n.isCreator||(0,l.ubU)(n,"banUsers"),canInvite:n.isCreator||(0,l.ubU)(n,"inviteUsers"),exportedInvites:u,isChannelsPremiumLimitReached:"channels"===r?.limit,availableReactions:e.reactions.availableReactions,canEditForum:A}}),((e,t)=>{let{chatId:a}=t;return Boolean((0,c.hds)(e,a))}))((e=>{let{chatId:t,chat:a,chatFullInfo:r,progress:o,isBasicGroup:c,hasLinkedChannel:d,canChangeInfo:m,canBanUsers:u,canInvite:A,canEditForum:h,isActive:y,exportedInvites:p,isChannelsPremiumLimitReached:v,availableReactions:g,onScreenSelect:E,onClose:b}=e;const{togglePreHistoryHidden:C,updateChat:f,deleteChat:S,leaveChannel:k,deleteChannel:w,closeManagement:N,openChat:P,loadExportedChatInvites:B,loadChatJoinRequests:L,toggleForum:R}=(0,s.ko)(),[x,F,V]=(0,I.A)(),D=a.title,_=r?.about||"",[O,J]=(0,n.J0)(!1),[K,j]=(0,n.J0)(D),[z,H]=(0,n.J0)(_),[$,W]=(0,n.J0)(),[Q,Z]=(0,n.J0)(),[X,ee]=(0,n.J0)(a.isForum),te=(0,l.cP1)(a),ae=(0,G.A)(te,!1,U.qZ.BlobUrl),ne=(0,n.Kr)((()=>(0,l.gAJ)(a)),[a]),se=(0,T.A)(),ie=(0,n.li)(null);(0,ve.A)({isActive:y,onBack:b}),(0,n.vJ)((()=>{A&&(B({chatId:t}),B({chatId:t,isRevoked:!0}),L({chatId:t}))}),[t,A]),(0,n.vJ)((()=>{ee(Boolean(a.isForum))}),[a.isForum]),(0,n.vJ)((()=>{o===i.TD.Complete&&(J(!1),Z(void 0))}),[o]);const re=(0,M.A)((()=>{E(i.je.ChatPrivacyType)})),oe=(0,M.A)((()=>{E(i.je.Discussion)})),le=(0,M.A)((()=>{E(i.je.Reactions)})),ce=(0,M.A)((()=>{E(i.je.GroupPermissions)})),de=(0,M.A)((()=>{E(i.je.ChatAdministrators)})),me=(0,M.A)((()=>{E(i.je.Invites)})),ue=(0,M.A)((()=>{E(i.je.JoinRequests)})),Ae=(0,M.A)((e=>{W(e),J(!0)})),he=(0,M.A)((e=>{j(e.target.value),J(!0)})),ye=(0,M.A)((e=>{H(e.target.value),J(!0)})),pe=(0,M.A)((()=>{const e=K.trim(),a=z.trim();e.length?f({chatId:t,title:e,about:a,photo:$}):Z(Mp)})),ge=(0,M.A)((()=>{E(i.je.GroupMembers)})),Ee=(0,M.A)((()=>{if(!r)return;const{isPreHistoryHidden:e}=r;C({chatId:a.id,isEnabled:!e})})),be=(0,M.A)((()=>{ee((e=>{const a=!e;return Lp((()=>{R({chatId:t,isEnabled:a})})),a}))}));(0,n.vJ)((()=>{if(!v)return;const e=ie.current?.querySelector("input");e.checked=!r?.isPreHistoryHidden}),[v,r?.isPreHistoryHidden]);const Ce=(0,n.Kr)((()=>{if(!r?.enabledReactions)return se("ReactionsOff");if("all"===r.enabledReactions.type)return se("ReactionsAll");const e=r.enabledReactions.allowed.length,t=g?.filter((e=>!e.isInactive)).length||0;return t?`${e} / ${t}`:`${e}`}),[g,r?.enabledReactions,se]),fe=(0,n.Kr)((()=>{if(!a.defaultBannedRights)return 0;let e=Tp.filter((e=>!("manageTopics"===e&&!X||a.defaultBannedRights[e]))).length;const{sendStickers:t,sendGifs:n}=a.defaultBannedRights;return t||n||(e+=1),e}),[a.defaultBannedRights,X]),Se=(0,n.Kr)((()=>Object.keys(r?.adminMembersById||{}).length),[r?.adminMembersById]),ke=(0,M.A)((()=>{c?S({chatId:a.id}):a.isCreator?w({chatId:a.id}):k({chatId:a.id}),V(),N(),P({id:void 0})}));if(a.isRestricted||a.isForbidden)return;const we=o===i.TD.InProgress;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(wm.A,{isForForum:X,currentAvatarBlobUrl:ae,onChange:Ae,disabled:!m}),n.Ay.createElement("div",{className:"settings-edit"},n.Ay.createElement(Y.A,{id:"group-title",label:se("GroupName"),onChange:he,value:K,error:Q===Mp?Q:void 0,disabled:!m}),n.Ay.createElement(cc.A,{id:"group-about",label:se("DescriptionPlaceholder"),maxLength:255,maxLengthIndicator:(255-z.length).toString(),onChange:ye,value:z,disabled:!m,noReplaceNewlines:!0})),a.isCreator&&n.Ay.createElement(Wa.A,{icon:"lock",multiline:!0,onClick:re},n.Ay.createElement("span",{className:"title"},se("GroupType")),n.Ay.createElement("span",{className:"subtitle"},se(ne?"TypePublic":"TypePrivate"))),d&&n.Ay.createElement(Wa.A,{icon:"message",multiline:!0,onClick:oe},n.Ay.createElement("span",{className:"title"},se("LinkedChannel")),n.Ay.createElement("span",{className:"subtitle"},se("DiscussionUnlink"))),n.Ay.createElement(Wa.A,{icon:"permissions",multiline:!0,onClick:ce,disabled:!u},n.Ay.createElement("span",{className:"title"},se("ChannelPermissions")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},fe,"/",Bp-(X?0:1))),n.Ay.createElement(Wa.A,{icon:"heart-outline",multiline:!0,onClick:le,disabled:!m},n.Ay.createElement("span",{className:"title"},se("Reactions")),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},Ce)),n.Ay.createElement(Wa.A,{icon:"admin",multiline:!0,onClick:de},n.Ay.createElement("span",{className:"title"},se("ChannelAdministrators")),n.Ay.createElement("span",{className:"subtitle"},(0,je.Sm)(Se))),A&&n.Ay.createElement(Wa.A,{icon:"link",onClick:me,multiline:!0,disabled:!p},n.Ay.createElement("span",{className:"title"},se("GroupInfo.InviteLinks")),n.Ay.createElement("span",{className:"subtitle"},p?(0,je.Sm)(p.length):se("Loading"))),Boolean(a.joinRequests?.length)&&n.Ay.createElement(Wa.A,{icon:"add-user-filled",onClick:ue,multiline:!0},n.Ay.createElement("span",{className:"title"},se("MemberRequests")),n.Ay.createElement("span",{className:"subtitle"},(0,je.Sm)(a.joinRequests.length))),h&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Wa.A,{icon:"forums",ripple:!0,onClick:be},n.Ay.createElement("span",null,se("ChannelTopics")),n.Ay.createElement(sn.A,{id:"group-notifications",label:se("ChannelTopics"),checked:X,inactive:!0})),n.Ay.createElement("div",{className:"section-info section-info_push"},se("ForumToggleDescription")))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Wa.A,{icon:"group",multiline:!0,onClick:ge},n.Ay.createElement("span",{className:"title"},se("GroupMembers")),n.Ay.createElement("span",{className:"subtitle"},(0,je.Sm)(a.membersCount??0))),!ne&&!d&&Boolean(r)&&n.Ay.createElement("div",{className:"ListItem narrow",ref:ie},n.Ay.createElement(js.A,{checked:!r.isPreHistoryHidden,label:se("ChatHistory"),onChange:Ee,subLabel:r.isPreHistoryHidden?se("ChatHistoryHiddenInfo2"):se("ChatHistoryVisibleInfo"),disabled:!u}))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Wa.A,{icon:"delete",ripple:!0,destructive:!0,onClick:F},se("DeleteMega")))),n.Ay.createElement(un.A,{isShown:O,onClick:pe,disabled:we,ariaLabel:se("Save")},we?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})),n.Ay.createElement(tn.A,{isOpen:x,onClose:V,textParts:(0,kt.A)(c||!a.isCreator?se("AreYouSureDeleteAndExit"):se("AreYouSureDeleteThisChatWithGroup",a.title),["br","simple_markdown"]),confirmLabel:c||!a.isCreator?se("DeleteMega"):se("DeleteGroupForAll"),confirmHandler:ke,confirmIsDestructive:!0}))}))),xp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a,isPromotedByCurrentUser:n}=t;const s=(0,c.hds)(e,a),i=(0,c.AWZ)(e,a),{byId:r}=e.users,{currentUserId:o}=e,d=(0,l.WXB)(s),m=!(s.isCreator||n);return{chat:s,usersById:r,currentUserId:o,isChannel:d,isForum:s.isForum,isFormFullyDisabled:m,defaultRights:s.adminRights,hasFullInfo:Boolean(i),adminMembersById:i?.adminMembersById}}),((e,t)=>{let{chatId:a}=t;return Boolean((0,c.hds)(e,a))}))((e=>{let{isActive:t,isNewAdmin:a,selectedUserId:r,defaultRights:o,chat:c,usersById:d,currentUserId:m,adminMembersById:u,hasFullInfo:A,isChannel:h,isForum:y,isFormFullyDisabled:p,onClose:v,onScreenSelect:g}=e;const{updateChatAdmin:E}=(0,s.ko)(),[b,C]=(0,n.J0)({}),[f,S]=(0,n.J0)(Boolean(a)),[k,w]=(0,n.J0)(!1),[N,P,M]=(0,I.A)(),[B,L]=(0,n.J0)(""),R=(0,T.A)();(0,ve.A)({isActive:t,onBack:v});const x=(0,n.Kr)((()=>{const e=r?u?.[r]:void 0;if(!a||!e&&r){if(a){const e=(0,s.mS)().users.byId[r];return e?{userId:e.id,adminRights:o,customTitle:R("ChannelAdmin"),isOwner:!1,promotedByUserId:void 0}:void 0}return e}}),[u,o,a,R,r]);(0,n.vJ)((()=>{A&&r&&!x&&g(i.je.ChatAdministrators)}),[c,A,g,x,r]),(0,n.vJ)((()=>{C(x?.adminRights||{}),L((x?.customTitle||"").substr(0,16)),S(Boolean(a)),w(!1)}),[o,a,x]);const F=(0,n.hb)((e=>{const{name:t}=e.target;C((e=>{return{...e,[t]:(a=e[t],!a||void 0)};var a})),S(!0)}),[]),V=(0,n.hb)((()=>{r&&(w(!0),E({chatId:c.id,userId:r,adminRights:b,customTitle:B}))}),[r,E,c.id,b,B]),D=(0,n.hb)((()=>{r&&(E({chatId:c.id,userId:r,adminRights:{}}),M())}),[c.id,M,r,E]),_=(0,n.hb)((e=>!((0,l.yn$)(c)||!p&&c.adminRights&&(c.isCreator||c.adminRights[e]))),[c,p]),U=(0,n.Kr)((()=>{if(a||!x)return;if(x.isOwner)return R("ChannelCreator");const e=x.promotedByUserId?d[x.promotedByUserId]:void 0;return e?R("EditAdminPromotedBy",(0,l.YgS)(e)):R("ChannelAdmin")}),[a,x,d,R]),O=(0,n.hb)((e=>{const{value:t}=e.target;L(t),S(!0)}),[]);if(x)return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Wa.A,{inactive:!0,className:"chat-item-clickable"},n.Ay.createElement(ds.A,{userId:x.userId,status:U,forceShowSelf:!0})),n.Ay.createElement("h3",{className:"section-heading mt-4",dir:"auto"},R("EditAdminWhatCanDo")),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"changeInfo",checked:Boolean(b.changeInfo),label:R(h?"EditAdminChangeChannelInfo":"EditAdminChangeGroupInfo"),blocking:!0,disabled:_("changeInfo"),onChange:F})),h&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"postMessages",checked:Boolean(b.postMessages),label:R("EditAdminPostMessages"),blocking:!0,disabled:_("postMessages"),onChange:F})),h&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"editMessages",checked:Boolean(b.editMessages),label:R("EditAdminEditMessages"),blocking:!0,disabled:_("editMessages"),onChange:F})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"deleteMessages",checked:Boolean(b.deleteMessages),label:R(h?"EditAdminDeleteMessages":"EditAdminGroupDeleteMessages"),blocking:!0,disabled:_("deleteMessages"),onChange:F})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"postStories",checked:Boolean(b.postStories),label:R("EditAdminPostStories"),blocking:!0,disabled:_("postStories"),onChange:F})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"editStories",checked:Boolean(b.editStories),label:R("EditAdminEditStories"),blocking:!0,disabled:_("editStories"),onChange:F})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"deleteStories",checked:Boolean(b.deleteStories),label:R("EditAdminDeleteStories"),blocking:!0,disabled:_("deleteStories"),onChange:F})),!h&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"banUsers",checked:Boolean(b.banUsers),label:R("EditAdminBanUsers"),blocking:!0,disabled:_("banUsers"),onChange:F})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"inviteUsers",checked:Boolean(b.inviteUsers),label:R("EditAdminAddUsers"),blocking:!0,disabled:_("inviteUsers"),onChange:F})),!h&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"pinMessages",checked:Boolean(b.pinMessages),label:R("EditAdminPinMessages"),blocking:!0,disabled:_("pinMessages"),onChange:F})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"addAdmins",checked:Boolean(b.addAdmins),label:R("EditAdminAddAdmins"),blocking:!0,disabled:_("addAdmins"),onChange:F})),n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"manageCall",checked:Boolean(b.manageCall),label:R("StartVoipChatPermission"),blocking:!0,disabled:_("manageCall"),onChange:F})),y&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"manageTopics",checked:Boolean(b.manageTopics),label:R("ManageTopicsPermission"),blocking:!0,disabled:_("manageTopics"),onChange:F})),!h&&n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:"anonymous",checked:Boolean(b.anonymous),label:R("EditAdminSendAnonymously"),blocking:!0,disabled:_("anonymous"),onChange:F})),p&&n.Ay.createElement("p",{className:"section-info mb-4",dir:"auto"},R("Channel.EditAdmin.CannotEdit")),!h&&n.Ay.createElement(Y.A,{id:"admin-title",label:R("EditAdminRank"),onChange:O,value:B,disabled:p,maxLength:16}),m!==r&&!p&&!a&&n.Ay.createElement(Wa.A,{icon:"delete",ripple:!0,destructive:!0,onClick:P},R("EditAdminRemoveAdmin")))),n.Ay.createElement(un.A,{isShown:f,onClick:V,ariaLabel:R("Save"),disabled:k},k?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})),!a&&n.Ay.createElement(tn.A,{isOpen:N,onClose:M,text:"Are you sure you want to dismiss this admin?",confirmLabel:R("Channel.Admin.Dismiss"),confirmHandler:D,confirmIsDestructive:!0}))})));var Fp=a(23459),Vp=a(285);const Dp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a),{statusesById:s}=e.users,{members:i,adminMembersById:r,areParticipantsHidden:o}=(0,c.AWZ)(e,a)||{},d=n&&(0,l.WXB)(n),{userIds:m}=e.contactList||{},u=e.appConfig?.hiddenMembersMinCount,A=n&&(n.isCreator||(0,l.ubU)(n,"banUsers")),h=A&&!(0,l.yn$)(n)&&void 0!==n.membersCount&&void 0!==u&&n.membersCount>=u,y=n&&((0,l.ubU)(n,"inviteUsers")||!d&&!(0,l.SqZ)(n,"inviteUsers")||n.isCreator),{query:p,fetchingStatus:v,globalUserIds:g,localUserIds:E}=(0,c.nTw)(e).userSearch;return{areParticipantsHidden:Boolean(n&&o),members:i,canAddMembers:y,adminMembersById:r,userStatusesById:s,isChannel:d,localContactIds:m,searchQuery:p,isSearching:v,globalUserIds:g,localUserIds:E,canDeleteMembers:A,currentUserId:e.currentUserId,canHideParticipants:h}}))((e=>{let{chatId:t,noAdmins:a,members:r,canAddMembers:o,adminMembersById:c,userStatusesById:d,isChannel:m,isActive:u,globalUserIds:A,localContactIds:h,localUserIds:y,isSearching:p,searchQuery:v,currentUserId:g,canDeleteMembers:E,areParticipantsHidden:b,canHideParticipants:C,onClose:f,onScreenSelect:S,onChatMemberSelect:k}=e;const{openChat:w,setUserSearchQuery:N,closeManagement:I,toggleParticipantsHidden:P,setNewChatMembersDialogState:B,toggleManagement:L}=(0,s.ko)(),R=(0,T.A)(),x=(0,n.li)(null),F=(0,n.li)(null),[V,D]=(0,n.J0)(),_=(0,n.Kr)((()=>a&&c?Object.keys(c):[]),[c,a]),U=(0,n.Kr)((()=>{const e=(0,s.mS)().users.byId;if(!r||!e)return[];const t=(0,l.UBH)(r.map((e=>{let{userId:t}=e;return t})),e,d);return a?t.filter((e=>!_.includes(e))):t}),[r,d,a,_]);(0,Fp.A)(U);const O=(0,n.Kr)((()=>{const e=(0,s.mS)().users.byId,t=Boolean(v),n=t?h?(0,rn.PU)({ids:h,query:v,type:"user"}):[]:U;return(0,vs.A)((0,on.Am)([...n,...t&&y||[],...t&&A||[]]).filter((t=>{const n=e[t];return!n||(m||n.canBeInvitedToGroup||!(0,l.tvf)(n))&&(!a||!_.includes(t))})),!0)}),[U,h,v,y,A,m,a,_]),[J,K]=(0,Es.A)(void 0,O,Boolean(v)),j=(0,M.A)((e=>{a?(k(e,!0),S(i.je.ChatNewAdminRights)):(I(),w({id:e}))})),G=(0,M.A)((e=>{N({query:e.target.value})})),z=(0,Cs.A)(F,u,(e=>{J&&J.length>0&&j(J[-1===e?0:e])}),".ListItem-button",!0),H=(0,M.A)((()=>{D(void 0)})),$=(0,M.A)((()=>{P({chatId:t,isEnabled:!b})})),W=(0,M.A)((()=>{L(),B({newChatMembersProgress:i.D7.InProgress})}));return(0,ve.A)({isActive:u,onBack:f}),n.Ay.createElement("div",{className:"Management"},a&&n.Ay.createElement("div",{className:"Management__filter",dir:R.isRtl?"rtl":void 0},n.Ay.createElement(Y.A,{ref:x,value:v,onChange:G,placeholder:R("Search")})),n.Ay.createElement("div",{className:"custom-scroll"},C&&!m&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Wa.A,{icon:"group",ripple:!0,onClick:$},n.Ay.createElement("span",null,R("ChannelHideMembers")),n.Ay.createElement(sn.A,{label:R("ChannelHideMembers"),checked:b})),n.Ay.createElement("p",{className:"section-info"},R(b?"GroupMembers.MembersHiddenOn":"GroupMembers.MembersHiddenOff"))),n.Ay.createElement("div",{className:"section"},J?.length?n.Ay.createElement(rs.A,{className:"picker-list custom-scroll",items:O,onLoadMore:K,noScrollRestore:Boolean(v),ref:F,onKeyDown:z},J.map((e=>{return n.Ay.createElement(Wa.A,{key:e,className:"chat-item-clickable scroll-item",onClick:()=>j(e),contextActions:(t=e,t!==g&&E?[{title:R("lng_context_remove_from_group"),icon:"stop",handler:()=>{D(t)}}]:void 0)},n.Ay.createElement(ds.A,{userId:e,forceShowSelf:!0,withStory:!0}));var t}))):p||!J||J.length?n.Ay.createElement(fs.A,null):n.Ay.createElement(qc.A,{teactOrderKey:0,key:"nothing-found",text:m?"No subscribers found":"No members found"}))),o&&n.Ay.createElement(un.A,{isShown:!0,onClick:W,ariaLabel:R("lng_channel_add_users")},n.Ay.createElement(q.A,{name:"add-user-filled"})),E&&n.Ay.createElement(Vp.A,{isOpen:Boolean(V),userId:V,onClose:H}))}))),_p=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a),s=(0,c.AWZ)(e,a);return{chat:n,currentUserId:e.currentUserId,removedUsersCount:s?.kickedMembers?.length||0,members:s?.members}}))((e=>{let{onScreenSelect:t,onChatMemberSelect:a,chat:r,currentUserId:o,removedUsersCount:l,members:c,onClose:d,isActive:m}=e;const{updateChatDefaultBannedRights:u}=(0,s.ko)(),{permissions:A,havePermissionChanged:h,isLoading:y,handlePermissionChange:p,setIsLoading:v}=gc(r?.defaultBannedRights),g=(0,T.A)();(0,ve.A)({isActive:m,onBack:d});const E=(0,n.hb)((()=>{t(i.je.GroupRemovedUsers)}),[t]),b=(0,n.hb)((()=>{t(i.je.GroupUserPermissionsCreate)}),[t]),C=(0,n.hb)((e=>{a(e.userId,e.promotedByUserId===o),t(i.je.GroupUserPermissions)}),[o,a,t]),[f,S]=(0,n.J0)(!1),k=(0,n.hb)((()=>{r&&(v(!0),u({chatId:r.id,bannedRights:A}))}),[r,A,v,u]),w=(0,n.Kr)((()=>c?c.filter((e=>{let{bannedRights:t}=e;return Boolean(t)})):[]),[c]),N=(0,n.hb)((e=>{const{bannedRights:t}=e;if(!t||!r)return;const{defaultBannedRights:a}=r;return Object.keys(t).reduce(((e,n)=>{const s=n;if(!t[s]||a?.[s]||"sendInline"===s||"viewMessages"===s||"sendGames"===s)return e;const i=function(e){switch(e){case"sendMessages":return"UserRestrictionsNoSend";case"sendMedia":return"UserRestrictionsNoSendMedia";case"sendStickers":return"UserRestrictionsNoSendStickers";case"embedLinks":return"UserRestrictionsNoEmbedLinks";case"sendPolls":return"UserRestrictionsNoSendPolls";case"changeInfo":return"UserRestrictionsNoChangeInfo";case"inviteUsers":return"UserRestrictionsInviteUsers";case"pinMessages":return"UserRestrictionsPinMessages";case"manageTopics":return"GroupPermission.NoManageTopics";case"sendPlain":return"UserRestrictionsNoSendText";case"sendDocs":return"UserRestrictionsNoSendDocs";case"sendRoundvideos":return"UserRestrictionsNoSendRound";case"sendVoices":return"UserRestrictionsNoSendVoice";case"sendAudios":return"UserRestrictionsNoSendMusic";case"sendVideos":return"UserRestrictionsNoSendVideos";case"sendPhotos":return"UserRestrictionsNoSendPhotos";default:return}}(s);if(!i)return e;const r=g(i);return`${e}${e.length?`, ${r}`:r}`}),"")}),[r,g]);return n.Ay.createElement("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 432px;--before-shift-height: 96px;"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section without-bottom-shadow"},n.Ay.createElement("h3",{className:"section-heading",dir:"auto"},g("ChannelPermissionsHeader")),n.Ay.createElement(bc,{chatId:r?.id,isMediaDropdownOpen:f,setIsMediaDropdownOpen:S,handlePermissionChange:p,permissions:A,dropdownClassName:"DropdownListTrap",className:(0,de.A)("DropdownList",f&&"DropdownList--open"),shiftedClassName:(0,de.A)("part",f&&"shifted")})),n.Ay.createElement("div",{className:(0,de.A)("section",f&&"shifted")},n.Ay.createElement(Wa.A,{icon:"delete-user",multiline:!0,narrow:!0,onClick:E},n.Ay.createElement("span",{className:"title"},g("ChannelBlockedUsers")),n.Ay.createElement("span",{className:"subtitle"},l))),n.Ay.createElement("div",{className:(0,de.A)("section",f&&"shifted")},n.Ay.createElement("h3",{className:"section-heading",dir:"auto"},g("PrivacyExceptions")),n.Ay.createElement(Wa.A,{icon:"add-user",onClick:b},g("ChannelAddException")),w.map((e=>n.Ay.createElement(Wa.A,{key:e.userId,className:"chat-item-clickable exceptions-member",onClick:()=>C(e)},n.Ay.createElement(ds.A,{userId:e.userId,status:N(e),forceShowSelf:!0})))))),n.Ay.createElement(un.A,{isShown:h,onClick:k,ariaLabel:g("Save"),disabled:y},y?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})))}))),Up=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a,isPromotedByCurrentUser:n}=t;const s=(0,c.hds)(e,a),i=(0,c.AWZ)(e,a);return{chat:s,isFormFullyDisabled:!(s.isCreator||n),hasFullInfo:Boolean(i),members:i?.members}}),((e,t)=>{let{chatId:a}=t;return Boolean((0,c.hds)(e,a))}))((e=>{let{chat:t,selectedChatMemberId:a,hasFullInfo:r,members:o,onScreenSelect:l,isFormFullyDisabled:c,onClose:d,isActive:m}=e;const{updateChatMemberBannedRights:u}=(0,s.ko)(),A=(0,n.Kr)((()=>{if(o)return o.find((e=>{let{userId:t}=e;return t===a}))}),[o,a]),{permissions:h,havePermissionChanged:y,isLoading:p,handlePermissionChange:v,setIsLoading:g}=gc(A?.bannedRights||t?.defaultBannedRights),[E,b,C]=(0,I.A)(),f=(0,Us.A)(),S=(0,T.A)();(0,ve.A)({isActive:m,onBack:d}),(0,n.vJ)((()=>{r&&a&&!A&&l(i.je.GroupPermissions)}),[t,r,l,A,a]);const k=(0,n.hb)((()=>{t&&a&&(g(!0),u({chatId:t.id,userId:a,bannedRights:h}))}),[t,a,g,u,h]),w=(0,n.hb)((()=>{t&&a&&u({chatId:t.id,userId:a,bannedRights:{viewMessages:!0}})}),[t,a,u]),N=(0,n.hb)((e=>!!c||!(!t||!t.defaultBannedRights)&&t.defaultBannedRights[e]),[t,c]),[P,M]=(0,n.J0)(!1);if(A)return n.Ay.createElement("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 431px;--before-shift-height: 192px;"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section without-bottom-shadow"},n.Ay.createElement(Wa.A,{inactive:!0,className:"chat-item-clickable"},n.Ay.createElement(ds.A,{userId:A.userId,forceShowSelf:!0})),n.Ay.createElement("h3",{className:"section-heading mt-4",dir:"auto"},S("UserRestrictionsCanDo")),n.Ay.createElement(bc,{chatId:t?.id,isMediaDropdownOpen:P,setIsMediaDropdownOpen:M,handlePermissionChange:v,permissions:h,className:(0,de.A)("DropdownList",P&&"DropdownList--open"),dropdownClassName:"DropdownListTrap",shiftedClassName:(0,de.A)("part",P&&"shifted"),getControlIsDisabled:N})),!c&&n.Ay.createElement("div",{className:(0,de.A)("section",P&&"shifted")},n.Ay.createElement(Wa.A,{icon:"delete-user",ripple:!0,destructive:!0,onClick:b},S("UserRestrictionsBlock")))),n.Ay.createElement(un.A,{isShown:y,onClick:k,ariaLabel:S("Save"),disabled:p},p?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})),n.Ay.createElement(tn.A,{isOpen:E,onClose:C,text:f("GroupManagementBanUserConfirm"),confirmLabel:"Remove",confirmHandler:w,confirmIsDestructive:!0}))}))),Op=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a),{byId:s,statusesById:i}=e.users,r=(0,c.AWZ)(e,a)?.members;return{members:r,usersById:s,userStatusesById:i,isChannel:n&&(0,l.WXB)(n)}}))((e=>{let{usersById:t,userStatusesById:a,members:s,isChannel:r,onScreenSelect:o,onChatMemberSelect:c,onClose:d,isActive:m}=e;(0,ve.A)({isActive:m,onBack:d});const u=(0,n.Kr)((()=>{if(s&&t)return(0,l.UBH)(s.filter((e=>!e.isOwner)).map((e=>{let{userId:t}=e;return t})),t,a)}),[s,t,a]),A=(0,n.hb)((e=>{c(e),o(i.je.GroupUserPermissions)}),[c,o]);return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section",teactFastList:!0},u?u.map(((e,t)=>n.Ay.createElement(Wa.A,{key:e,teactOrderKey:t,className:"chat-item-clickable scroll-item",onClick:()=>A(e)},n.Ay.createElement(ds.A,{userId:e,forceShowSelf:!0})))):n.Ay.createElement(qc.A,{teactOrderKey:0,key:"nothing-found",text:r?"No subscribers found":"No members found"}))))}))),Jp=[1,10,100],Kp={hour:36e5,day:864e5,week:6048e5},jp=Kp.hour,Gp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const{editingInvite:n}=(0,c.nTw)(e).management.byChatId[a]||{};return{editingInvite:n}}))((e=>{let{chatId:t,editingInvite:a,isActive:r,onClose:o,onScreenSelect:l}=e;const{editExportedChatInvite:c,exportChatInvite:d}=(0,s.ko)(),m=(0,T.A)(),[u,A,h]=(0,I.A)(),[y,p]=(0,n.J0)(!1),[v,g]=(0,n.J0)(""),[E,b]=(0,n.J0)(Date.now()+jp),[C,f]=(0,n.J0)("unlimited"),[S,k]=(0,n.J0)(10),[w,N]=(0,n.J0)("0"),[P,M]=(0,n.J0)(!1);(0,ve.A)({isActive:r,onBack:o}),(0,j.A)((e=>{let[t]=e;if(t!==a)if(a){const{title:e,usageLimit:t,expireDate:n,isRequestNeeded:s}=a;if(e&&g(e),t&&(N(Jp.includes(t)?t.toString():"custom"),k(t)),n){const e=(0,qa.Fm)()+jp;f("custom"),b(1e3*Math.max(n,e))}s&&p(!0)}else g(""),f("unlimited"),N("0"),b(1e3*(0,qa.Fm)()+jp),k(10),p(!1)}),[a]);const B=(0,n.hb)((e=>{p(e.target.checked)}),[]),L=(0,n.hb)((e=>{g(e.target.value)}),[]),R=(0,n.hb)((e=>{k(Number.parseInt(e.target.value,10))}),[]),x=(0,n.hb)((e=>{b(e.getTime()),h()}),[h]),F=(0,n.hb)((()=>{M(!0);const e="custom"===w?S:Number(w);let n;switch(C){case"custom":n=(0,qa.Fm)()+(E-Date.now())/1e3;break;case"hour":case"day":case"week":n=(0,qa.Fm)()+Kp[C]/1e3;break;case"unlimited":n=0;break;default:n=void 0}a?c({link:a.link,chatId:t,title:v,isRequestNeeded:y,expireDate:n,usageLimit:e}):d({chatId:t,title:v,isRequestNeeded:y,expireDate:n,usageLimit:e}),l(i.je.Invites)}),[t,E,S,c,a,d,y,C,w,v,l]);return n.Ay.createElement("div",{className:"Management ManageInvite"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(js.A,{label:m("ApproveNewMembers"),subLabel:m("ApproveNewMembersDescription"),checked:y,onChange:B})),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Y.A,{className:"link-name",placeholder:m("LinkNameHint"),value:v,onChange:L}),n.Ay.createElement("p",{className:"section-help hint"},m("LinkNameHelp"))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement("div",{className:"section-header"},m("LimitByPeriod")),n.Ay.createElement(Z.A,{name:"expireOptions",options:[{value:"hour",label:m("Hours",1)},{value:"day",label:m("Days",1)},{value:"week",label:m("Weeks",1)},{value:"unlimited",label:m("NoLimit")},{value:"custom",label:m("lng_group_invite_expire_custom")}],onChange:f,selected:C}),"custom"===C&&n.Ay.createElement(W.A,{className:"expire-limit",isText:!0,onClick:A},(0,Ke.Lu)(m,E)," ",(0,Ke.fU)(m,E)),n.Ay.createElement("p",{className:"section-help hint"},m("TimeLimitHelp"))),!y&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("div",{className:"section-header"},m("LimitNumberOfUses")),n.Ay.createElement(Z.A,{name:"usageOptions",options:[...Jp.map((e=>({value:e.toString(),label:e}))),{value:"0",label:m("NoLimit")},{value:"custom",label:m("lng_group_invite_usage_custom")}],onChange:N,selected:w}),"custom"===w&&n.Ay.createElement("input",{className:"form-control usage-limit",type:"number",min:"1",max:"99999",value:S,onChange:R}),n.Ay.createElement("p",{className:"section-help hint"},m("UsesLimitHelp"))),n.Ay.createElement(un.A,{isShown:!0,onClick:F,disabled:P,ariaLabel:m(a?"SaveLink":"CreateLink")},n.Ay.createElement(q.A,{name:"check"}))),n.Ay.createElement(Ys,{isOpen:u,isFutureMode:!0,withTimePicker:!0,onClose:h,onSubmit:x,selectedAt:E,submitButtonLabel:m("Save")}))}))),zp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const{inviteInfo:n}=(0,c.nTw)(e).management.byChatId[a]||{},{invite:s,importers:i,requesters:r}=n||{},o=(0,c.hds)(e,a);return{invite:s,importers:i,requesters:r,isChannel:o&&(0,l.WXB)(o)}}))((e=>{let{chatId:t,invite:a,importers:i,requesters:r,isChannel:o,isActive:l,onClose:c}=e;const{showNotification:d,loadChatInviteImporters:m,loadChatInviteRequesters:u,openChat:A}=(0,s.ko)(),h=(0,T.A)(),{usage:y=0,usageLimit:p,link:v,adminId:g}=a||{},E=a?.expireDate&&1e3*(a.expireDate-(0,qa.Fm)())+Date.now(),b=(a?.expireDate||0)-(0,qa.Fm)()<0;(0,n.vJ)((()=>{v&&(m({chatId:t,link:v}),u({chatId:t,link:v}))}),[t,v,m,u]);const C=(0,n.hb)((()=>{(0,Uc.eM)(a.link),d({message:h("LinkCopied")})}),[a,h,d]);return(0,ve.A)({isActive:l,onBack:c}),n.Ay.createElement("div",{className:"Management ManageInviteInfo"},n.Ay.createElement("div",{className:"custom-scroll"},!a&&n.Ay.createElement("p",{className:"section-help"},h("Loading")),a&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"section"},n.Ay.createElement("h3",{className:"link-title"},a.title||a.link),n.Ay.createElement("input",{className:"form-control",value:a.link,readOnly:!0,onClick:C}),n.Ay.createElement(W.A,{className:"copy-link",onClick:C},h("CopyLink")),Boolean(E)&&n.Ay.createElement("p",{className:"section-help"},b?h("ExpiredLink"):h("LinkExpiresIn",`${(0,Ke.Lu)(h,E)} ${(0,Ke.fU)(h,E)}`))),g&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("p",null,h("LinkCreatedeBy")),n.Ay.createElement(Wa.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>A({id:g})},n.Ay.createElement(ds.A,{userId:g,status:(0,Ke.fS)(h,1e3*a.date,!0),forceShowSelf:!0}))),(()=>{if(i?.length||!r?.length)return i?n.Ay.createElement("div",{className:"section"},n.Ay.createElement("p",null,i.length?h("PeopleJoined",y):h("NoOneJoined")),n.Ay.createElement("p",{className:"section-help"},!i.length&&(p?h("PeopleCanJoinViaLinkCount",p-y):h("NoOneJoinedYet")),i.map((e=>{const t=(0,Ke.fS)(h,1e3*e.date,!0),a=e.isFromChatList?`${t} • ${h("JoinedViaFolder")}`:t;return n.Ay.createElement(Wa.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>A({id:e.userId})},n.Ay.createElement(ds.A,{userId:e.userId,status:a,forceShowSelf:!0}))})))):n.Ay.createElement(Re.A,null)})(),(()=>{if(!a?.isRevoked){if(!r&&i)return n.Ay.createElement(Re.A,null);if(r?.length)return n.Ay.createElement("div",{className:"section"},n.Ay.createElement("p",null,h(o?"SubscribeRequests":"MemberRequests")),n.Ay.createElement("p",{className:"section-help"},r.map((e=>n.Ay.createElement(Wa.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>A({id:e.userId})},n.Ay.createElement(ds.A,{userId:e.userId,status:(0,Ke.fS)(h,1e3*e.date,!0),forceShowSelf:!0}))))))}})())))}))),Hp="•";function $p(e,t){const{isPermanent:a,usage:n=0,date:s}=e,{isPermanent:i,usage:r=0,date:o}=t;return a||i?Number(a)-Number(i):n||r?r-n:o-s}const qp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const{invites:n,revokedInvites:s}=(0,c.nTw)(e).management.byChatId[a]||{},i=(0,c.hds)(e,a);return{exportedInvites:n,revokedExportedInvites:s,chat:i,isChannel:i&&(0,l.WXB)(i)}}))((e=>{let{chatId:t,chat:a,exportedInvites:o,revokedExportedInvites:c,isActive:d,isChannel:m,onClose:u,onScreenSelect:A}=e;const{setEditingExportedInvite:h,showNotification:y,editExportedChatInvite:p,deleteExportedChatInvite:v,deleteRevokedExportedChatInvites:g,setOpenedInviteInfo:E}=(0,s.ko)(),b=(0,Us.A)(),C=(0,T.A)(),[f,S,k]=(0,I.A)(),[w,N,M]=(0,I.A)(),[B,L]=(0,n.J0)(),[R,x,F]=(0,I.A)(),[V,D]=(0,n.J0)();(0,ve.A)({isActive:d,onBack:u});const _=(0,n.Kr)((()=>{if(o)return o.some((e=>{let{expireDate:t}=e;return t&&t-(0,qa.Fm)()<Ke.il/1e3}))}),[o]),U=(0,P.A)();(0,ni.A)(U,_?1e3:void 0);const O=(0,n.Kr)((()=>a&&(0,l.KlG)(a)),[a]),J=o?.find((e=>{let{isPermanent:t}=e;return t})),K=O?`${r.jsp}${O}`:J?.link,j=(0,n.Kr)((()=>{const e=a?.usernames?o:o?.filter((e=>{let{isPermanent:t}=e;return!t}));return e?.sort($p)}),[a?.usernames,o]),G=(0,n.hb)((e=>{const{link:a,title:n,isRequestNeeded:s,expireDate:i,usageLimit:r}=e;p({chatId:t,link:a,title:n,isRequestNeeded:s,expireDate:i,usageLimit:r,isRevoked:!0})}),[t,p]),z=(0,n.hb)((e=>{L(e),N()}),[N]),H=(0,n.hb)((()=>{B&&(G(B),L(void 0),M())}),[M,G,B]),$=(0,n.hb)((()=>{A(i.je.EditInvite)}),[A]),Y=(0,n.hb)((()=>{J&&z(J)}),[z,J]),Q=(0,n.hb)((()=>{g({chatId:t}),k()}),[t,k,g]),Z=(0,n.hb)((e=>{E({chatId:t,invite:e}),A(i.je.InviteInfo)}),[t,A,E]),X=(0,n.hb)((e=>{v({chatId:t,link:e.link})}),[t,v]),ee=(0,n.hb)((e=>{D(e),x()}),[x]),te=(0,n.hb)((()=>{V&&(X(V),D(void 0),F())}),[F,X,V]),ae=(0,n.hb)((e=>{(0,Uc.eM)(e),y({message:C("LinkCopied")})}),[C,y]),ne=e=>{const{usage:t=0,usageLimit:a,expireDate:n,isPermanent:s,requested:i,isRevoked:r}=e;let o="";if(o=!r&&a&&t<a?C("CanJoin",a-t):t?C("PeopleJoined",t):C("NoOneJoined"),r)return o+=` ${Hp} ${C("Revoked")}`,o;if(i&&(o+=` ${Hp} ${C("JoinRequests",i)}`),void 0!==a&&t===a)o+=` ${Hp} ${C("LinkLimitReached")}`;else if(n){const e=n-(0,qa.Fm)();o+=` ${Hp} `,o+=e>0?C("InviteLink.ExpiresIn",(0,Ke.zt)(b,e)):C("InviteLink.Expired")}else s&&(o+=` ${Hp} ${C("Permanent")}`);return o},se=e=>{const{usage:t=0,usageLimit:a,isRevoked:n,expireDate:s}=e;return n?"link-status-icon-gray":a&&t<a?"link-status-icon-green":s&&1e3*(s-(0,qa.Fm)())<=0?"link-status-icon-red":"link-status-icon-blue"},ie=e=>{const a=[];return a.push({title:C("Copy"),icon:"copy",handler:()=>ae(e.link)}),e.isPermanent||e.isRevoked||a.push({title:C("Edit"),icon:"edit",handler:()=>(e=>{h({chatId:t,invite:e}),A(i.je.EditInvite)})(e)}),e.isRevoked?a.push({title:C("DeleteLink"),icon:"delete",handler:()=>ee(e),destructive:!0}):a.push({title:C("RevokeButton"),icon:"delete",handler:()=>z(e),destructive:!0}),a};return n.Ay.createElement("div",{className:"Management ManageInvites"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ol.A,{tgsUrl:rl.w.Invite,size:r.xMZ,className:"section-icon"}),n.Ay.createElement("p",{className:"section-help"},C(m?"PrimaryLinkHelpChannel":"PrimaryLinkHelp"))),K&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Rl.A,{className:"settings-input",link:K,withShare:!0,onRevoke:a?.usernames?void 0:Y,title:C(a?.usernames?"PublicLink":"lng_create_permanent_link_title")})),n.Ay.createElement("div",{className:"section",teactFastList:!0},n.Ay.createElement(W.A,{isText:!0,key:"create",className:"create-link",onClick:$},C("CreateNewLink")),(!j||!j.length)&&n.Ay.createElement(qc.A,{text:"No links found",key:"nothing"}),j?.map((e=>n.Ay.createElement(Wa.A,{leftElement:n.Ay.createElement(q.A,{name:"link",className:`link-status-icon ${se(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>Z(e),contextActions:ie(e),key:e.link},n.Ay.createElement("span",{className:"title invite-title"},e.title||e.link),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},ne(e))))),n.Ay.createElement("p",{className:"section-help hint",key:"links-hint"},C("ManageLinksInfoHelp"))),c&&Boolean(c.length)&&n.Ay.createElement("div",{className:"section",teactFastList:!0},n.Ay.createElement("p",{className:"section-help",key:"title"},C("RevokedLinks")),n.Ay.createElement(Wa.A,{icon:"delete",destructive:!0,key:"delete",onClick:S},n.Ay.createElement("span",{className:"title"},C("DeleteAllRevokedLinks"))),c?.map((e=>n.Ay.createElement(Wa.A,{leftElement:n.Ay.createElement(q.A,{name:"link",className:`link-status-icon ${se(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>Z(e),contextActions:ie(e),key:e.link},n.Ay.createElement("span",{className:"title"},e.title||e.link),n.Ay.createElement("span",{className:"subtitle",dir:"auto"},ne(e))))))),n.Ay.createElement(tn.A,{isOpen:f,onClose:k,title:C("DeleteAllRevokedLinks"),text:C("DeleteAllRevokedLinkHelp"),confirmIsDestructive:!0,confirmLabel:C("DeleteAll"),confirmHandler:Q}),n.Ay.createElement(tn.A,{isOpen:w,onClose:M,title:C("RevokeLink"),text:C("RevokeAlert"),confirmIsDestructive:!0,confirmLabel:C("RevokeButton"),confirmHandler:H}),n.Ay.createElement(tn.A,{isOpen:R,onClose:F,title:C("DeleteLink"),text:C("DeleteLinkHelp"),confirmIsDestructive:!0,confirmLabel:C("Delete"),confirmHandler:te}))}))),Wp=(0,n.ph)((0,s.EK)(((e,t)=>{let{userId:a}=t;return{user:(0,c.mBe)(e,a)}}))((e=>{let{userId:t,chatId:a,about:i,date:r,isChannel:o,user:c}=e;const{openChat:d,hideChatJoinRequest:m}=(0,s.ko)(),u=(0,de.x)("JoinRequest"),A=(0,T.A)(),h=(0,l.YgS)(c),y=1e3*(r-(0,qa.Fm)())+Date.now(),p=(0,Ke.cK)(new Date(y))?(0,Ke.fU)(A,y):(0,Ke.F5)(A,y,!0,!1,!0),v=(0,n.hb)((()=>{m({chatId:a,userId:t,isApproved:!0})}),[a,m,t]),g=(0,n.hb)((()=>{m({chatId:a,userId:t,isApproved:!1})}),[a,m,t]);return n.Ay.createElement("div",{className:u("&")},n.Ay.createElement("div",{className:u("top")},n.Ay.createElement("div",{className:u("user"),onClick:()=>{d({id:t})}},n.Ay.createElement(wt.A,{key:t,size:"medium",peer:c}),n.Ay.createElement("div",{className:u("user-info")},n.Ay.createElement("div",{className:u("user-name")},h),n.Ay.createElement("div",{className:u("user-subtitle")},i))),n.Ay.createElement("div",{className:u("date")},p)),n.Ay.createElement("div",{className:u("buttons")},n.Ay.createElement(W.A,{className:u("button"),onClick:v},A(o?"ChannelAddToChannel":"ChannelAddToGroup")),n.Ay.createElement(W.A,{className:u("button"),isText:!0,onClick:g},A("DismissRequest"))))}))),Yp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a);return{chat:n,isChannel:n&&(0,l.WXB)(n)}}))((e=>{let{chat:t,chatId:a,isActive:i,isChannel:o,onClose:c}=e;const{hideAllChatJoinRequests:d,loadChatJoinRequests:m}=(0,s.ko)(),[u,A,h]=(0,I.A)(),[y,p,v]=(0,I.A)(),g=(0,T.A)();(0,ve.A)({isActive:i,onBack:c}),(0,n.vJ)((()=>{t?.joinRequests||(0,l.L8L)(a)||m({chatId:a})}),[t,a,m]);const E=(0,n.hb)((()=>{d({chatId:a,isApproved:!0}),h()}),[d,a,h]),b=(0,n.hb)((()=>{d({chatId:a,isApproved:!1}),v()}),[d,a,v]);return n.Ay.createElement("div",{className:"Management ManageJoinRequests"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ol.A,{tgsUrl:rl.w.JoinRequest,size:r.OMf,className:"section-icon"}),Boolean(t?.joinRequests?.length)&&n.Ay.createElement("div",{className:"bulk-actions"},n.Ay.createElement(W.A,{className:"bulk-action-button",onClick:A},"Accept all"),n.Ay.createElement(W.A,{className:"bulk-action-button",onClick:p,isText:!0},"Dismiss all"))),n.Ay.createElement("div",{className:"section",teactFastList:!0},n.Ay.createElement("p",{key:"title"},t?.joinRequests?t.joinRequests.length?g("JoinRequests",t.joinRequests.length):g("NoMemberRequests"):g("Loading")),!t?.joinRequests&&n.Ay.createElement(Re.A,{key:"loading"}),0===t?.joinRequests?.length&&n.Ay.createElement("p",{className:"section-help",key:"empty"},g(o?"NoSubscribeRequestsDescription":"NoMemberRequestsDescription")),t?.joinRequests?.map((e=>{let{userId:t,about:s,date:i}=e;return n.Ay.createElement(Wp,{userId:t,about:s,date:i,isChannel:o,chatId:a,key:t})})))),n.Ay.createElement(tn.A,{isOpen:u,onClose:h,title:"Accept all requests?",text:"Are you sure you want to accept all requests?",confirmHandler:E}),n.Ay.createElement(tn.A,{isOpen:y,onClose:v,title:"Reject all requests?",text:"Are you sure you want to reject all requests?",confirmHandler:b}))}))),Qp=(0,n.ph)((0,s.EK)(((e,t)=>{let{chatId:a}=t;const n=(0,c.hds)(e,a),{maxUniqueReactions:s=r.UAx}=e.appConfig||{},i=(0,c.AWZ)(e,a),o=i?.reactionsLimit||s,d=(0,l.WXB)(n);return{enabledReactions:i?.enabledReactions,availableReactions:e.reactions.availableReactions,chat:n,maxUniqueReactions:s,reactionsLimit:o,isChannel:d}}),((e,t)=>{let{chatId:a}=t;return Boolean((0,c.hds)(e,a))}))((e=>{let{availableReactions:t,enabledReactions:a,chat:i,isActive:r,onClose:o,maxUniqueReactions:c,reactionsLimit:d,isChannel:m}=e;const{setChatEnabledReactions:u}=(0,s.ko)(),A=(0,T.A)(),[h,y]=(0,n.J0)(!1),[p,v]=(0,n.J0)(!1),[g,E]=(0,n.J0)(a),[b,C]=(0,n.J0)(d);(0,ve.A)({isActive:r,onBack:o});const f=(0,n.Kr)((()=>[{value:"all",label:A("AllReactions")},{value:"some",label:A("SomeReactions")},{value:"none",label:A("NoReactions")}]),[A]),S=(0,n.hb)((()=>{i&&(v(!0),u({chatId:i.id,enabledReactions:g,reactionsLimit:b}))}),[i,g,u,b]);(0,n.vJ)((()=>{v(!1),y(!1),E(a),C(d)}),[a,d]);const k=(0,n.Kr)((()=>t?.filter((e=>{let{isInactive:t}=e;return!t}))),[t]);(0,n.vJ)((()=>{if(void 0===b||b===d){if("some"===g?.type&&"all"!==a?.type&&"some"!==a?.type&&0===g.allowed.length)return void y(!1);if(g?.type===a?.type){if("some"===g?.type&&"some"===a?.type){const e=g.allowed,t=a?.allowed;if(e.length!==t.length||e.reverse().some((e=>!t.find((t=>(0,l.a0K)(e,t))))))return void y(!0)}y(!1)}else y(!0)}else y(!0)}),[b,d,g,a]);const w=(0,n.hb)((e=>{"all"===e?(E({type:"all"}),C(d)):"some"===e?(E({type:"some",allowed:"some"===a?.type?a.allowed:[]}),C(d)):(E(void 0),C(void 0))}),[a,d]),N=(0,n.hb)((e=>{if(!i||!k)return;const{name:t,checked:a}=e.currentTarget;if("some"===g?.type){const e={emoticon:t};E(a?{type:"some",allowed:[...g.allowed,e]}:{type:"some",allowed:g.allowed.filter((t=>!(0,l.a0K)(t,e)))})}}),[k,i,g]),I=(0,n.hb)((e=>{C(e)}),[]),P=(0,n.hb)((e=>A("PeerInfo.AllowedReactions.MaxCountValue",e)),[A]),M=m&&("all"===g?.type||"some"===g?.type);return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},b&&M&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement("h3",{className:"section-heading"},A("MaximumReactionsHeader")),n.Ay.createElement(ze.A,{min:1,max:c,value:b,onChange:I,renderValue:P,isCenteredLayout:!0}),n.Ay.createElement("p",{className:"section-info section-info_push"},A("ChannelReactions.MaxCount.Info"))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement("h3",{className:"section-heading"},A("AvailableReactions")),n.Ay.createElement(Z.A,{selected:g?.type||"none",name:"reactions",options:f,onChange:w}),n.Ay.createElement("p",{className:"section-info section-info_push"},"all"===g?.type&&A("EnableAllReactionsInfo"),"some"===g?.type&&A("EnableSomeReactionsInfo"),!g&&A("DisableReactionsInfo"))),"some"===g?.type&&n.Ay.createElement("div",{className:"section section-with-fab"},n.Ay.createElement("h3",{className:"section-heading"},A("OnlyAllowThisReactions")),k?.map((e=>{let{reaction:a,title:s}=e;return n.Ay.createElement("div",{className:"ListItem"},n.Ay.createElement(js.A,{name:a.emoticon,checked:g?.allowed.some((e=>(0,l.a0K)(a,e))),label:n.Ay.createElement("div",{className:"Reaction"},n.Ay.createElement(ms.A,{reaction:a,availableReactions:t}),s),withIcon:!0,onChange:N}))})))),n.Ay.createElement(un.A,{isShown:h,onClick:S,ariaLabel:A("Save"),disabled:p},p?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})))}))),Zp="Please provide first name",Xp=(0,n.ph)((0,s.EK)(((e,t)=>{let{userId:a}=t;const n=(0,c.mBe)(e,a),s=(0,c.hds)(e,a),i=(0,c.vGo)(e,a),{progress:r}=(0,c.nTw)(e).management,o=s&&(0,l.W1R)(s,(0,c.$5S)(e),(0,c.GrP)(e)),d=i?.personalPhoto;return{user:n,progress:r,isMuted:o,personalPhoto:d,notPersonalPhoto:i?.profilePhoto||i?.fallbackPhoto}}))((e=>{let{userId:t,user:a,progress:o,isMuted:c,onClose:d,isActive:m,personalPhoto:u,notPersonalPhoto:A}=e;const{updateContact:h,deleteContact:y,closeManagement:p,uploadContactProfilePhoto:v}=(0,s.ko)(),[g,E,b]=(0,I.A)(),[C,f,S]=(0,I.A)(),[k,w]=(0,n.J0)(!1),[N,P]=(0,n.J0)(),M=(0,T.A)();(0,ve.A)({isActive:m,onBack:d});const B=a&&a.firstName||"",L=a&&a.lastName||"",[R,x]=(0,n.J0)(B),[F,V]=(0,n.J0)(L),[D,_]=(0,n.J0)(!c);(0,n.vJ)((()=>{_(!c)}),[c]),(0,n.vJ)((()=>{w(!1),b()}),[b,t]),(0,n.vJ)((()=>{x(B),V(L)}),[B,L,a]),(0,n.vJ)((()=>{o===i.TD.Complete&&(w(!1),P(void 0),b())}),[b,o]);const U=(0,n.hb)((e=>{x(e.target.value),w(!0),N===Zp&&P(void 0)}),[N]),O=(0,n.hb)((e=>{V(e.target.value),w(!0)}),[]),J=(0,n.hb)((e=>{_(e.target.checked),w(!0)}),[]),K=(0,n.hb)((()=>{const e=R.trim(),a=F.trim();e.length?h({userId:t,isMuted:!D,firstName:e,lastName:a}):P(Zp)}),[R,F,h,t,D]),j=(0,n.hb)((()=>{y({userId:t}),b(),p()}),[b,p,y,t]),G=(0,n.li)(null),z=(0,n.li)(!1),H=(0,n.hb)((()=>{G.current?.click(),z.current=!0}),[]),$=(0,n.hb)((()=>{G.current?.click(),z.current=!1}),[]),W=(0,n.hb)((()=>{S(),w(!0),v({userId:t})}),[S,v,t]),Q=(0,n.hb)((e=>{w(!0),v({userId:t,file:e,isSuggest:z.current})}),[v,t]);if(!a)return;const Z=!(0,l.tvf)(a)&&a.id!==r.zv8,X=o===i.TD.InProgress;return n.Ay.createElement("div",{className:"Management"},n.Ay.createElement("div",{className:"custom-scroll"},n.Ay.createElement("div",{className:"section"},n.Ay.createElement(ds.A,{userId:a.id,avatarSize:"jumbo",noStatusOrTyping:!0,noEmojiStatus:!0,withFullInfo:!0}),n.Ay.createElement("div",{className:"settings-edit"},n.Ay.createElement(Y.A,{id:"user-first-name",label:M("UserInfo.FirstNamePlaceholder"),onChange:U,value:R,error:N===Zp?N:void 0}),n.Ay.createElement(Y.A,{id:"user-last-name",label:M("UserInfo.LastNamePlaceholder"),onChange:O,value:F})),n.Ay.createElement("div",{className:"ListItem narrow"},n.Ay.createElement(js.A,{checked:D,label:M("Notifications"),subLabel:M(D?"UserInfo.NotificationsEnabled":"UserInfo.NotificationsDisabled"),onChange:J}))),Z&&n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Wa.A,{icon:"camera-add",ripple:!0,onClick:H},n.Ay.createElement("span",{className:"list-item-ellipsis"},M("UserInfo.SuggestPhoto",a.firstName))),n.Ay.createElement(Wa.A,{icon:"camera-add",ripple:!0,onClick:$},n.Ay.createElement("span",{className:"list-item-ellipsis"},M("UserInfo.SetCustomPhoto",a.firstName))),u&&n.Ay.createElement(Wa.A,{leftElement:n.Ay.createElement(wt.A,{photo:A,noPersonalPhoto:!0,peer:a,size:"mini",className:"personal-photo"}),ripple:!0,onClick:f},M("UserInfo.ResetCustomPhoto")),n.Ay.createElement("p",{className:"section-help",dir:"auto"},M("UserInfo.CustomPhotoInfo",a.firstName))),n.Ay.createElement("div",{className:"section"},n.Ay.createElement(Wa.A,{icon:"delete",ripple:!0,destructive:!0,onClick:E},M("DeleteContact")))),n.Ay.createElement(un.A,{isShown:k,onClick:K,disabled:X,ariaLabel:M("Save")},X?n.Ay.createElement(Re.A,{color:"white"}):n.Ay.createElement(q.A,{name:"check"})),n.Ay.createElement(tn.A,{isOpen:g,onClose:b,text:M("AreYouSureDeleteContact"),confirmLabel:M("DeleteContact"),confirmHandler:j,confirmIsDestructive:!0}),n.Ay.createElement(tn.A,{isOpen:C,onClose:S,text:M("UserInfo.ResetToOriginalAlertText",a.firstName),confirmLabel:M("Reset"),confirmHandler:W,confirmIsDestructive:!0}),n.Ay.createElement(mu.A,{onChange:Q,inputRef:G}))}))),ev=(0,n.ph)((0,s.EK)((e=>({managementType:(0,c.vn8)(e)})))((e=>{let{chatId:t,currentScreen:a,selectedChatMemberId:s,isPromotedByCurrentUser:r,onScreenSelect:o,onChatMemberSelect:l,onClose:c,isActive:d,managementType:m}=e;switch(a){case i.je.Initial:switch(m){case"bot":return n.Ay.createElement(Cp,{key:t,userId:t,onClose:c,isActive:d});case"user":return n.Ay.createElement(Xp,{key:t,userId:t,onClose:c,isActive:d});case"group":return n.Ay.createElement(Rp,{key:t,chatId:t,onScreenSelect:o,onClose:c,isActive:d||[i.je.ChatPrivacyType,i.je.Discussion,i.je.GroupPermissions,i.je.ChatAdministrators,i.je.GroupRemovedUsers,i.je.GroupUserPermissionsCreate,i.je.GroupUserPermissions,i.je.ChatAdminRights,i.je.ChatNewAdminRights,i.je.GroupRecentActions].includes(a)});case"channel":return n.Ay.createElement(Sp,{key:t,chatId:t,onScreenSelect:o,onClose:c,isActive:d||[i.je.ChannelSubscribers,i.je.ChatAdministrators,i.je.ChannelRemovedUsers,i.je.Discussion,i.je.ChatPrivacyType,i.je.ChatAdminRights,i.je.ChatNewAdminRights,i.je.GroupRecentActions].includes(a)})}break;case i.je.ChatPrivacyType:return n.Ay.createElement(wp,{chatId:t,isActive:d,onClose:c});case i.je.Discussion:return n.Ay.createElement(Pp,{chatId:t,onScreenSelect:o,isActive:d,onClose:c});case i.je.GroupPermissions:return n.Ay.createElement(_p,{chatId:t,onScreenSelect:o,onChatMemberSelect:l,isActive:d||[i.je.GroupRemovedUsers,i.je.GroupUserPermissionsCreate,i.je.GroupUserPermissions].includes(a),onClose:c});case i.je.ChannelRemovedUsers:case i.je.GroupRemovedUsers:return n.Ay.createElement(Ip,{chatId:t,isActive:d,onClose:c});case i.je.GroupUserPermissionsCreate:return n.Ay.createElement(Op,{chatId:t,onChatMemberSelect:l,onScreenSelect:o,isActive:d||[i.je.GroupUserPermissions].includes(a),onClose:c});case i.je.GroupUserPermissions:return n.Ay.createElement(Up,{chatId:t,selectedChatMemberId:s,isPromotedByCurrentUser:r,onScreenSelect:o,isActive:d,onClose:c});case i.je.ChatAdministrators:return n.Ay.createElement(kp,{chatId:t,onScreenSelect:o,onChatMemberSelect:l,isActive:d||[i.je.ChatAdminRights,i.je.ChatNewAdminRights,i.je.GroupRecentActions].includes(a),onClose:c});case i.je.ChatNewAdminRights:case i.je.ChatAdminRights:return n.Ay.createElement(xp,{chatId:t,isNewAdmin:a===i.je.ChatNewAdminRights,selectedUserId:s,isPromotedByCurrentUser:r,onScreenSelect:o,isActive:d,onClose:c});case i.je.ChannelSubscribers:case i.je.GroupMembers:return n.Ay.createElement(Dp,{chatId:t,isActive:d,onClose:c});case i.je.Invites:return n.Ay.createElement(qp,{chatId:t,isActive:d,onClose:c,onScreenSelect:o});case i.je.EditInvite:return n.Ay.createElement(Gp,{chatId:t,isActive:d,onClose:c,onScreenSelect:o});case i.je.GroupAddAdmins:return n.Ay.createElement(Dp,{chatId:t,noAdmins:!0,isActive:d,onClose:c,onScreenSelect:o,onChatMemberSelect:l});case i.je.Reactions:return n.Ay.createElement(Qp,{chatId:t,isActive:d,onClose:c});case i.je.InviteInfo:return n.Ay.createElement(zp,{chatId:t,isActive:d,onClose:c});case i.je.JoinRequests:return n.Ay.createElement(Yp,{chatId:t,isActive:d,onClose:c})}}))),tv=/^4\d/,av=/^5[1-5]/,nv=/^2[2-7]\d{2}/,sv=/^220[0-4]/;let iv=function(e){return e[e.Default=0]="Default",e[e.Visa=1]="Visa",e[e.Mastercard=2]="Mastercard",e[e.Mir=3]="Mir",e}({});const rv={[iv.Default]:"",[iv.Visa]:"visa",[iv.Mastercard]:"mastercard",[iv.Mir]:"mir"};function ov(e){return e=e.replace(/\s/g,""),tv.test(e)?iv.Visa:sv.test(e)?iv.Mir:av.test(e)||nv.test(e)?iv.Mastercard:iv.Default}const lv={streetLine1:"",streetLine2:"",city:"",state:"",countryIso2:"",postCode:"",fullName:"",email:"",phone:"",shipping:"",cardNumber:"",cardholder:"",expiry:"",cvv:"",billingCountry:"",billingZip:"",saveInfo:!0,saveCredentials:!1,formErrors:{},tipAmount:0,savedCredentialId:""},cv=(e,t)=>{switch(t.type){case"changeAddress1":return{...e,streetLine1:t.payload,formErrors:{...e.formErrors,streetLine1:void 0}};case"changeAddress2":return{...e,streetLine2:t.payload,formErrors:{...e.formErrors,streetLine2:void 0}};case"changeCity":return{...e,city:t.payload,formErrors:{...e.formErrors,city:void 0}};case"changeState":return{...e,state:t.payload,formErrors:{...e.formErrors,state:void 0}};case"changeCountry":return{...e,countryIso2:t.payload.iso2,billingCountry:t.payload.defaultName,formErrors:{...e.formErrors,countryIso2:void 0}};case"changePostCode":return{...e,postCode:t.payload,formErrors:{...e.formErrors,postCode:void 0}};case"changeFullName":return{...e,fullName:t.payload,formErrors:{...e.formErrors,fullName:void 0}};case"changeEmail":return{...e,email:t.payload,formErrors:{...e.formErrors,email:void 0}};case"changePhone":return{...e,phone:t.payload,formErrors:{...e.formErrors,phone:void 0}};case"changeShipping":return{...e,shipping:t.payload};case"changeCardNumber":return{...e,cardNumber:t.payload,formErrors:{...e.formErrors,cardNumber:void 0}};case"changeCardholder":return{...e,cardholder:t.payload,formErrors:{...e.formErrors,cardholder:void 0}};case"changeExpiryDate":return{...e,expiry:t.payload,formErrors:{...e.formErrors,expiry:void 0}};case"changeCvvCode":return{...e,cvv:t.payload,formErrors:{...e.formErrors,cvv:void 0}};case"changeBillingCountry":return{...e,billingCountry:t.payload,formErrors:{...e.formErrors,billingCountry:void 0}};case"changeBillingZip":return{...e,billingZip:t.payload,formErrors:{...e.formErrors,billingZip:void 0}};case"changeSaveInfo":return{...e,saveInfo:t.payload};case"changeSaveCredentials":return{...e,saveCredentials:t.payload};case"updateUserInfo":return t.payload.country?{...e,...t.payload,billingCountry:t.payload.country}:{...e,...t.payload};case"setFormErrors":return{...e,formErrors:{...e.formErrors,...t.payload}};case"setTipAmount":return{...e,tipAmount:t.payload};case"changeSavedCredentialId":return{...e,savedCredentialId:t.payload};case"resetState":return{...lv};default:return e}};var dv=a(37960);const mv={root:"maC_9u6e",description:"zQ6lEVJ2","checkout-picture":"JgWvLdK2",checkoutPicture:"JgWvLdK2",text:"T2pYH395","checkout-title":"HadolzeF",checkoutTitle:"HadolzeF","checkout-description":"oZW7mUNP",checkoutDescription:"oZW7mUNP","price-info":"P618Q3yr",priceInfo:"P618Q3yr","price-info-item":"XNNG_ajy",priceInfoItem:"XNNG_ajy","price-info-item-main":"D9gYNLVk",priceInfoItemMain:"D9gYNLVk","price-info-item-title":"NtY5Aah7",priceInfoItemTitle:"NtY5Aah7",tipsList:"WHO341eB",tipsItem:"ksLlzBxw",tipsItem_active:"J4yem62L",tipsItemActive:"J4yem62L","invoice-info":"U2IBOLP1",invoiceInfo:"U2IBOLP1",provider:"kqWcdro1",stripe:"xKztZrna",smartglocal:"X_Ge1o4u","checkout-info-item-info-title":"ysWuPklS",checkoutInfoItemInfoTitle:"ysWuPklS","checkout-info-item-info-data":"MpC_P8_c",checkoutInfoItemInfoData:"MpC_P8_c","tos-checkbox":"OrRb0xG7",tosCheckbox:"OrRb0xG7",list:"l_wfiFG0"},uv=(0,n.ph)((e=>{let{title:t,description:a,photo:r,invoice:o,shippingPrices:c,checkoutInfo:d,totalPrice:m,isTosAccepted:u,dispatch:A,onAcceptTos:h,tipAmount:y,needAddress:p,hasShippingOptions:v,savedCredentials:g,isPaymentFormUrl:E,botName:b}=e;const{setPaymentStep:C}=(0,s.ko)(),f=(0,T.A)(),S=(0,Us.A)(),k=Boolean(A),{termsUrl:w,suggestedTipAmounts:N,maxTipAmount:I}=o||{},{paymentMethod:P,paymentProvider:M,shippingAddress:B,name:L,phone:R,shippingMethod:x}=d||{},F=(0,G.A)((0,l.cy4)(r)),V=(0,dv.A)(F),D=(0,n.hb)((e=>{A({type:"setTipAmount",payload:I?Math.min(e,I):e})}),[A,I]),_=(0,n.hb)((()=>{C({step:g?.length?i.tn.SavedPayments:i.tn.PaymentInfo})}),[g?.length,C]),U=(0,n.hb)((()=>{C({step:i.tn.ShippingInfo})}),[C]),O=(0,n.hb)((()=>{C({step:i.tn.Shipping})}),[C]);return n.Ay.createElement("div",{className:mv.root},n.Ay.createElement("div",{className:mv.description},F&&n.Ay.createElement("img",{ref:V,className:mv.checkoutPicture,src:F,draggable:!1,width:r.dimensions?.width,height:r.dimensions?.height,alt:""}),!F&&r&&n.Ay.createElement(Rn.A,{width:r.dimensions?.width,height:r.dimensions?.height,className:mv.checkoutPicture,forceAspectRatio:!0}),n.Ay.createElement("div",{className:mv.text},n.Ay.createElement("h5",{className:mv.checkoutTitle},t),a&&n.Ay.createElement("div",{className:mv.checkoutDescription},(0,kt.A)(a,["br","links","emoji"])))),n.Ay.createElement("div",{className:mv.priceInfo},o.prices.map((e=>Av(S,e.label,e.amount,o.currency))),c&&c.map((e=>Av(S,e.label,e.amount,o.currency))),N&&N.length>0&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:mv.priceInfoItem},n.Ay.createElement("div",{className:mv.priceInfoItemTitle},t),n.Ay.createElement("div",null,(0,Qi.v)(S,y,o.currency))),n.Ay.createElement("div",{className:mv.tipsList},N.map((e=>n.Ay.createElement("div",{key:e,className:(0,de.A)(mv.tipsItem,e===y&&mv.tipsItem_active),onClick:A?()=>D(e===y?0:e):void 0},(0,Qi.v)(S,e,o.currency,{shouldOmitFractions:!0})))))),void 0!==m&&Av(S,f("Checkout.TotalAmount"),m,o.currency,!0)),n.Ay.createElement("div",{className:mv.invoiceInfo},!E&&hv({title:P||g?.[0].title,label:f("PaymentCheckoutMethod"),icon:"card",onClick:k?_:void 0}),M&&hv({title:M,label:f("PaymentCheckoutProvider"),customIcon:(0,de.A)(mv.provider,mv[M.toLowerCase()])}),(p||!k&&B)&&hv({title:B,label:f("PaymentShippingAddress"),icon:"location",onClick:k?U:void 0}),L&&hv({title:L,label:f("PaymentCheckoutName"),icon:"user"}),R&&hv({title:R,label:f("PaymentCheckoutPhoneNumber"),icon:"phone"}),(v||!k&&x)&&hv({title:x,label:f("PaymentCheckoutShippingMethod"),icon:"truck",onClick:k?O:void 0}),w&&(J=w,n.Ay.createElement(js.A,{label:function(e,t){const a=f("PaymentCheckoutAcceptRecurrent",b).split("*");return n.Ay.createElement(n.Ay.Fragment,null,a[0],n.Ay.createElement($l.A,{url:e,text:a[1],isRtl:t}),a.slice(2))}(J,f.isRtl),name:"checkout_tos",checked:Boolean(u),className:mv.tosCheckbox,tabIndex:0,onCheck:h}))));var J}));function Av(e,t,a,s){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n.Ay.createElement("div",{className:(0,de.A)(mv.priceInfoItem,i&&mv.priceInfoItemMain)},n.Ay.createElement("div",{className:mv.priceInfoItemTitle},t),n.Ay.createElement("div",null,(0,Qi.v)(e,a,s)))}function hv(e){let{title:t,label:a,icon:s,customIcon:i,onClick:r}=e;const o=Boolean(t&&a!==t);return n.Ay.createElement(Wa.A,{className:mv.list,narrow:!0,multiline:o,icon:s,inactive:!r,onClick:r,leftElement:i&&n.Ay.createElement("i",{className:(0,de.A)("icon",i)})},n.Ay.createElement("div",{className:mv.checkoutInfoItemInfoTitle},t||a),t&&a!==t&&n.Ay.createElement("p",{className:mv.checkoutInfoItemInfoData},a))}const yv=(0,n.ph)((e=>{let{url:t,noRedirect:a,onClose:i,onPaymentFormSubmit:o}=e;const{openTelegramLink:l}=(0,s.ko)(),c=(0,T.A)(),d=(0,n.hb)((e=>{try{const t=JSON.parse(e.data),{eventType:n,eventData:s}=t;switch(n){case"web_app_open_tg_link":if(!a){const e=r.jsp+s.path_full;l({url:e})}i();break;case"payment_form_submit":o&&o(s);break;default:i()}}catch(e){}}),[i,a,l,o]);return(0,n.vJ)((()=>(window.addEventListener("message",d),()=>window.removeEventListener("message",d))),[d]),n.Ay.createElement("div",{className:"ConfirmPayment"},n.Ay.createElement("iframe",{src:t,title:c("Checkout.WebConfirmation.Title"),allow:"payment",sandbox:"allow-modals allow-forms allow-scripts allow-same-origin allow-top-navigation",className:"ConfirmPayment__content"}))})),pv=(0,n.ph)((0,s.EK)((e=>{const{payment:t}=(0,c.nTw)(e);return{errorKey:t.error?.messageKey,passwordHint:e.twoFaSettings.hint,savedCredentials:"regular"===t.form?.type?t.form.savedCredentials:void 0}}))((e=>{let{isActive:t,errorKey:a,state:i,savedCredentials:r,passwordHint:o,onPasswordChange:l}=e;const{clearPaymentError:c}=(0,s.ko)(),d=(0,T.A)(),m=(0,Us.A)(),[u,A]=(0,n.J0)(!1),h=(0,n.Kr)((()=>r?.length&&i.savedCredentialId?r.find((e=>{let{id:t}=e;return t===i.savedCredentialId}))?.title:void 0),[r,i.savedCredentialId]);return n.Ay.createElement("div",{className:"PaymentInfo"},n.Ay.createElement($d.A,{isBig:!0,isPasswordVisible:u}),n.Ay.createElement(tc.A,{error:a&&m.withRegular(a),hint:o,description:d("PaymentConfirmationMessage",h),placeholder:d("Password"),clearError:c,shouldShowSubmit:!1,shouldResetValue:t,isPasswordVisible:u,onChangePasswordVisibility:A,onInputChange:l}))})));var vv=a(63173);function gv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;(0,n.vJ)((()=>{b.TF||setTimeout((()=>{(0,o.YS)((()=>{e.current?.focus()}))}),t)}),[e,t])}const Ev=a.p+"telegram-a.mastercard.790db81f7978635f77d8.svg",bv=a.p+"telegram-a.mir.e3a390b90e2e3e292621.svg",Cv=a.p+"telegram-a.visa.fb39984c9532c0336be9.svg",fv=(0,n.ph)((e=>{let{value:t,error:a,onChange:s}=e;const i=(0,T.A)(),r=(0,n.li)(null);gv(r);const[o,l]=(0,n.J0)(iv.Default);(0,n.vJ)((()=>{const e=ov(t);l(e)}),[]);const c=(0,n.hb)((e=>{const t=function(e){const t=(e=e.replace(/[^\d]/g,"")).match(/.{1,4}/g);return t?t.join(" "):""}(e.target.value),a=ov(e.target.value);l(a),s(t)}),[s]),d=function(e){switch(e){case iv.Mastercard:return n.Ay.createElement("img",{src:Ev,draggable:!1,alt:""});case iv.Visa:return n.Ay.createElement("img",{src:Cv,draggable:!1,alt:""});case iv.Mir:return n.Ay.createElement("img",{src:bv,draggable:!1,alt:""});default:return}}(o);return n.Ay.createElement("div",{className:"CardInput"},n.Ay.createElement(Y.A,{ref:r,label:i("PaymentCardNumber"),onChange:c,value:t,inputMode:"numeric",className:o?"has-right-addon":"",error:a,tabIndex:0,maxLength:19,teactExperimentControlled:!0}),n.Ay.createElement("span",{className:"right-addon"},d))})),Sv=(0,n.ph)((e=>{let{value:t,error:a,onChange:s}=e;const i=(0,T.A)(),r=(0,n.hb)((e=>{const a=e.target.value;t.endsWith("/")&&t.length>a.length?s(a):s(function(e){const t=(e=e.replace(/[^\d]/g,"").slice(0,4)).match(/.{1,2}/g);return t?.[0]&&Number(t[0])>12&&(t[0]="12"),t?.[0]&&2===t[0].length&&!t[1]&&(t[1]=""),t?t.join("/"):""}(e.target.value))}),[s,t]);return n.Ay.createElement(Y.A,{label:i("PaymentCardExpireDate"),onChange:r,value:t,error:a,inputMode:"numeric",tabIndex:0,maxLength:5,teactExperimentControlled:!0})})),kv=(0,n.ph)((e=>{let{state:t,canSaveCredentials:a,needCardholderName:s,needCountry:i,needZip:r,countryList:o,dispatch:l}=e;const c=(0,n.li)(null);(0,n.vJ)((()=>{c.current&&c.current.value!==t.billingCountry&&(c.current.value=t.billingCountry)}),[t.billingCountry]);const d=(0,n.hb)((e=>{l({type:"changeCardNumber",payload:e})}),[l]),m=(0,n.hb)((e=>{l({type:"changeCardholder",payload:e.target.value.toUpperCase()})}),[l]),u=(0,n.hb)((e=>{l({type:"changeExpiryDate",payload:e})}),[l]),A=(0,n.hb)((e=>{const t=e.target.value.replace(/[^0-9]/g,"");l({type:"changeCvvCode",payload:t})}),[l]),h=(0,n.hb)((e=>{l({type:"changeBillingCountry",payload:e.target.value})}),[l]),y=(0,n.hb)((e=>{l({type:"changeBillingZip",payload:e.target.value})}),[l]),p=(0,n.hb)((e=>{l({type:"changeSaveCredentials",payload:e.target.value})}),[l]),v=(0,T.A)(),g=(0,Us.A)(),{formErrors:E={}}=t;return n.Ay.createElement("div",{className:"PaymentInfo"},n.Ay.createElement("form",null,n.Ay.createElement("h5",null,v("PaymentCardTitle")),n.Ay.createElement(fv,{onChange:d,value:t.cardNumber,error:E.cardNumber&&g.withRegular(E.cardNumber)}),s&&n.Ay.createElement(Y.A,{label:v("Checkout.NewCard.CardholderNamePlaceholder"),onChange:m,value:t.cardholder,inputMode:"text",tabIndex:0,error:E.cardholder&&g.withRegular(E.cardholder)}),n.Ay.createElement("section",{className:"inline-inputs"},n.Ay.createElement(Sv,{value:t.expiry,onChange:u,error:E.expiry&&g.withRegular(E.expiry)}),n.Ay.createElement(Y.A,{label:v("lng_payments_card_cvc"),onChange:A,value:t.cvv,inputMode:"numeric",maxLength:3,tabIndex:0,error:E.cvv&&g.withRegular(E.cvv),teactExperimentControlled:!0})),i||r?n.Ay.createElement("h5",null,v("PaymentBillingAddress")):void 0,n.Ay.createElement("section",{className:"inline-inputs"},i&&n.Ay.createElement(vv.A,{label:v("PaymentShippingCountry"),onChange:h,value:t.billingCountry,hasArrow:Boolean(!0),id:"billing-country",error:E.billingCountry&&g.withRegular(E.billingCountry),tabIndex:0,ref:c},o.map((e=>{let{defaultName:a,name:s}=e;return n.Ay.createElement("option",{value:a,className:"county-item",selected:a===t.billingCountry},a||s)}))),r&&n.Ay.createElement(Y.A,{label:v("PaymentShippingZipPlaceholder"),onChange:y,value:t.billingZip,inputMode:"text",tabIndex:0,maxLength:12,error:E.billingZip&&g.withRegular(E.billingZip)})),n.Ay.createElement("div",{className:"checkbox"},n.Ay.createElement(js.A,{label:v("PaymentCardSavePaymentInformation"),checked:!!a&&t.saveCredentials,tabIndex:0,subLabel:v(a?"Checkout.NewCard.SaveInfoHelp":"Checkout.2FA.Text"),onChange:p,disabled:!a}))))})),wv=(0,n.ph)((e=>{let{state:t,savedCredentials:a,dispatch:s,onNewCardClick:i}=e;const r=(0,T.A)(),o=(0,n.Kr)((()=>a?.length?a.map((e=>{let{id:t,title:a}=e;return{label:a,value:t}})):ln.p),[a]),l=(0,n.hb)((e=>{s({type:"changeSavedCredentialId",payload:e})}),[s]);return n.Ay.createElement("div",{className:"PaymentInfo"},n.Ay.createElement("form",null,n.Ay.createElement("h5",null,r("PaymentCardTitle")),n.Ay.createElement(Z.A,{name:"saved-credentials",options:o,selected:t.savedCredentialId,onChange:l}),n.Ay.createElement(W.A,{isText:!0,onClick:i},r("PaymentCheckoutMethodNewCard"))))})),Nv=(0,n.ph)((e=>{let{state:t,shippingOptions:a,currency:s,dispatch:i}=e;const r=(0,T.A)(),o=(0,Us.A)();(0,n.vJ)((()=>{a&&a.length&&!t.shipping&&i({type:"changeShipping",payload:a[0].id})}),[a,t.shipping,i]);const l=(0,n.hb)((e=>{i({type:"changeShipping",payload:e})}),[i]),c=(0,n.Kr)((()=>a.map((e=>{let{id:t,title:a,amount:n}=e;return{label:a,subLabel:(0,Qi.v)(o,n,s),value:t}}))),[a,s,o]);return n.Ay.createElement("div",{className:"Shipping"},n.Ay.createElement("form",null,n.Ay.createElement("p",null,r("PaymentShippingMethod")),n.Ay.createElement(Z.A,{name:"shipping-options",options:c,onChange:l,selected:t.shipping})))})),Iv=(0,n.ph)((e=>{let{state:t,needEmail:a,needPhone:s,needName:i,needAddress:r,countryList:o,dispatch:l}=e;const c=(0,n.li)(null),d=(0,n.li)(null),m=(0,n.li)(null);(0,n.vJ)((()=>{m.current&&m.current.value!==t.countryIso2&&(m.current.value=t.countryIso2)}),[t.countryIso2]);const u=(0,T.A)(),A=(0,Us.A)();gv(c);const h=(0,n.hb)((e=>{l({type:"changeAddress1",payload:e.target.value})}),[l]),y=(0,n.hb)((e=>{l({type:"changeAddress2",payload:e.target.value})}),[l]),p=(0,n.hb)((e=>{l({type:"changeCity",payload:e.target.value})}),[l]),v=(0,n.hb)((e=>{l({type:"changeState",payload:e.target.value})}),[l]),g=(0,n.hb)((e=>{l({type:"changeCountry",payload:o.find((t=>t.iso2===e.target.value))})}),[o,l]),E=(0,n.hb)((e=>{l({type:"changePostCode",payload:e.target.value})}),[l]),b=(0,n.hb)((e=>{l({type:"changeFullName",payload:e.target.value})}),[l]),C=(0,n.hb)((e=>{l({type:"changeEmail",payload:e.target.value})}),[l]),f=(0,n.hb)((e=>{let{value:t}=e.target;t=`+${t.replace(/\D/g,"")}`,d.current&&(d.current.value=t),l({type:"changePhone",payload:t})}),[l]),S=(0,n.hb)((e=>{l({type:"changeSaveInfo",payload:e.target.value})}),[l]),{formErrors:k}=t;return n.Ay.createElement("div",{className:"ShippingInfo"},n.Ay.createElement("form",null,r?n.Ay.createElement("div",null,n.Ay.createElement("h5",null,u("PaymentShippingAddress")),n.Ay.createElement(Y.A,{ref:c,label:u("PaymentShippingAddress1Placeholder"),onChange:h,value:t.streetLine1,inputMode:"text",tabIndex:0,error:k.streetLine1&&A.withRegular(k.streetLine1)}),n.Ay.createElement(Y.A,{label:u("PaymentShippingAddress2Placeholder"),onChange:y,value:t.streetLine2,inputMode:"text",tabIndex:0,error:k.streetLine2&&A.withRegular(k.streetLine2)}),n.Ay.createElement(Y.A,{label:u("PaymentShippingCityPlaceholder"),onChange:p,value:t.city,inputMode:"text",tabIndex:0,error:k.city&&A.withRegular(k.city)}),n.Ay.createElement(Y.A,{label:u("PaymentShippingStatePlaceholder"),onChange:v,value:t.state,inputMode:"text",error:k.state&&A.withRegular(k.state)}),n.Ay.createElement(vv.A,{label:u("PaymentShippingCountry"),onChange:g,value:t.countryIso2,hasArrow:Boolean(!0),id:"shipping-country",error:k.countryIso2&&A.withRegular(k.countryIso2),ref:m,tabIndex:0},o.map((e=>{let{defaultName:a,name:s,iso2:i}=e;return n.Ay.createElement("option",{value:i,className:"county-item",selected:i===t.countryIso2},a||s)}))),n.Ay.createElement(Y.A,{label:u("PaymentShippingZipPlaceholder"),onChange:E,value:t.postCode,inputMode:"text",tabIndex:0,error:k.postCode&&A.withRegular(k.postCode)})):void 0,i||a||s?n.Ay.createElement("h5",null,u("PaymentShippingReceiver")):void 0,i&&n.Ay.createElement(Y.A,{label:u("PaymentShippingName"),onChange:b,value:t.fullName,inputMode:"text",tabIndex:0,error:k.fullName&&A.withRegular(k.fullName)}),a&&n.Ay.createElement(Y.A,{label:u("PaymentShippingEmailPlaceholder"),onChange:C,value:t.email,inputMode:"email",tabIndex:0,error:k.email&&A.withRegular(k.email)}),s&&n.Ay.createElement(Y.A,{label:u("PaymentShippingPhoneNumber"),onChange:f,value:t.phone,inputMode:"tel",tabIndex:0,error:k.phone&&A.withRegular(k.phone),ref:d}),n.Ay.createElement(js.A,{label:u("PaymentShippingSave"),subLabel:u("PaymentShippingSaveInfo"),checked:Boolean(t.saveInfo),tabIndex:0,onChange:S})))})),Pv="stripe",Mv="smartglocal",Tv=new Set([Pv,Mv]),Bv=(0,n.ph)((0,s.EK)((e=>{const{form:t,step:a,shippingOptions:n,error:s,confirmPaymentUrl:i,inputInvoice:r,requestId:o,stripeCredentials:d,smartGlocalCredentials:m,temporaryPassword:u,isExtendedMedia:A,url:h}=(0,c.nTw)(e).payment,{invoice:y,nativeParams:p,nativeProvider:v}=t||{},g=e.countryList.general;let E=t?.nativeProvider;!E&&h&&(E=h.startsWith("https://payment.smart-glocal.com")?Mv:void 0);const b=r&&"chatId"in r?(0,c.hds)(e,r.chatId):void 0,C=Boolean(y&&(!E||!Tv.has(E))),{needCardholderName:f,needCountry:S,needZip:k}=p||{},w=t?.botId?(0,c.mBe)(e,t.botId):void 0,N=(0,l.YgS)(w);return{step:a,chat:b,shippingOptions:n,nativeProvider:E,isProviderError:C,form:t,invoice:y,needCardholderName:f,needCountry:S,needZip:k,error:s,confirmPaymentUrl:i??h,isPaymentFormUrl:Boolean(!v&&h),countryList:g,requestId:o,hasShippingOptions:Boolean(n?.length),smartGlocalToken:m?.token,stripeId:d?.id,passwordValidUntil:u?.validUntil,isExtendedMedia:A,botName:N}}))((e=>{let{isOpen:t,onClose:a,step:r,shippingOptions:o,form:l,isProviderError:c,invoice:d,nativeProvider:m,needCardholderName:u,needCountry:A,needZip:h,confirmPaymentUrl:y,error:p,countryList:v,hasShippingOptions:g,requestId:E,smartGlocalToken:b,stripeId:C,savedCredentials:f,passwordValidUntil:S,isExtendedMedia:k,isPaymentFormUrl:w,botName:N}=e;const{loadPasswordInfo:P,validateRequestedInfo:B,sendPaymentForm:L,setPaymentStep:R,sendCredentialsInfo:x,clearPaymentError:F,validatePaymentPassword:V,setSmartGlocalCardInfo:_}=(0,s.ko)(),U=(0,T.A)(),O=(0,Us.A)(),[J,K,j]=(0,I.A)(),[G,z]=(0,Td.A)(cv,lv),[H,$]=(0,n.J0)(!1),[Y,Z]=(0,n.J0)(!1),[X,ee]=(0,n.J0)(""),ae=(0,D.A)(r,!0),ne=(0,D.A)(E),se=r!==i.tn.ConfirmPayment,ie=(0,n.hb)((e=>{R({step:e})}),[R]);(0,n.vJ)((()=>{t&&(ee(""),P(),K())}),[t,P,K]),(0,n.vJ)((()=>{!t&&J&&j()}),[j,J,t]),(0,n.vJ)((()=>{(void 0!==r||p)&&$(!1)}),[r,p,E]),(0,n.vJ)((()=>{r!==i.tn.Checkout||r!==ae||E===ne||G.savedCredentialId||G.cardNumber||ie(i.tn.PaymentInfo)}),[G.cardNumber,G.savedCredentialId,ne,ae,E,ie,r]),(0,n.vJ)((()=>{p?.field&&z({type:"setFormErrors",payload:{[p.field]:p.messageKey}})}),[p,z]),(0,n.vJ)((()=>{if(l?.savedInfo){const{name:e,phone:t,email:a,shippingAddress:n}=l.savedInfo,{countryIso2:s,...i}=n||{},r=s&&v.find((e=>{let{iso2:t}=e;return t===s})).defaultName;z({type:"updateUserInfo",payload:{fullName:e,phone:t&&"+"!==t.charAt(0)?`+${t}`:t,email:a,...r&&{country:r,countryIso2:s,...i}}})}}),[l,z,v]),(0,n.vJ)((()=>{f?.length&&z({type:"changeSavedCredentialId",payload:f[0].id})}),[z,f]);const re=(0,n.hb)((()=>{F()}),[F]),oe=(0,n.Kr)((()=>r!==i.tn.Checkout?0:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>3?arguments[3]:void 0;const n=t?Rv(t,arguments.length>2?arguments[2]:void 0):[];let s=a;return s=e.concat(n||[]).reduce(((e,t)=>e+t.amount),s),s}(d?.prices,o,G.shipping,G.tipAmount)),[r,d?.prices,o,G.shipping,G.tipAmount]),le=(0,n.Kr)((()=>{if(r===i.tn.Checkout)return function(e,t,a){const n=function(e){const t=ov(e);return rv[t]||""}(e.cardNumber),s=n&&e.cardNumber?`${n} *${e.cardNumber.slice(-4)}`:void 0,i=e.streetLine1?`${e.streetLine1}, ${e.city}, ${e.countryIso2}`:void 0,{phone:r,fullName:o}=e,l=t?Lv(t,e.shipping):void 0,c=l?.title;return{paymentMethod:s,paymentProvider:a,shippingAddress:i,name:o,phone:r,shippingMethod:c}}(G,o,m||"")}),[r,G,o,m]),ce=(0,n.hb)((()=>{ie(i.tn.PaymentInfo)}),[ie]),me=(0,n.hb)((()=>{F()}),[F]),ue=(0,n.hb)((()=>{L({shippingOptionId:G.shipping,saveCredentials:G.saveCredentials,savedCredentialId:G.savedCredentialId,tipAmount:G.tipAmount})}),[L,G]),Ae=(0,n.hb)((e=>{const{credentials:t}=e;_(t),ue()}),[ue]),he=(0,n.hb)((()=>{const{saveInfo:e}=G,t=function(e){const{streetLine1:t,streetLine2:a,city:n,state:s,countryIso2:i,postCode:r,fullName:o,phone:l,email:c}=e;return{name:o,phone:l,email:c,shippingAddress:{streetLine1:t,streetLine2:a,city:n,state:s,countryIso2:i,postCode:r}}}(G);B({requestInfo:t,saveInfo:e})}),[B,G]),ye=(0,n.hb)((()=>{const e=function(e){const{cardNumber:t,cardholder:a,expiry:n,cvv:s,billingCountry:i,billingZip:r}=e,[o,l]=n.split("/");return{data:{cardNumber:t,cardholder:a,expiryMonth:o,expiryYear:l,cvv:s,country:i,zip:r}}}(G);x({credentials:e})}),[x,G]),pe=(0,M.A)((()=>{switch(r){case i.tn.ShippingInfo:$(!0),he();break;case i.tn.Shipping:ie(i.tn.Checkout);break;case i.tn.SavedPayments:ie(i.tn.ConfirmPassword);break;case i.tn.ConfirmPassword:if(""===X)return;$(!0),V({password:X});break;case i.tn.PaymentInfo:$(!0),ye(),z({type:"changeSavedCredentialId",payload:""});break;case i.tn.Checkout:{if(w)return $(!0),void ie(i.tn.ConfirmPayment);if(l?.savedInfo&&!E&&!G.shipping)return $(!0),void he();if(G.savedCredentialId&&(!S||S<=Date.now()/1e3-3))return void ie(i.tn.ConfirmPassword);if(!G.savedCredentialId&&(m===Pv&&!C||m===Mv&&!b))return void ie(i.tn.PaymentInfo);const{phone:e,email:t,fullName:a}=G,n=d?.isEmailRequested&&!t||d?.isPhoneRequested&&!e||d?.isNameRequested&&!a;if(d?.isShippingAddressRequested&&!E||n)return void ie(i.tn.ShippingInfo);if(d?.isShippingAddressRequested&&!G.shipping&&o?.length)return void ie(i.tn.Shipping);$(!0),ue();break}}}));(0,n.vJ)((()=>r===i.tn.ConfirmPassword?(0,fn.A)({onEnter:pe}):void 0),[pe,r]);const ve=(0,n.hb)((()=>{z({type:"resetState"}),Z(!1),a()}),[a,z]),ge=(0,n.hb)((()=>{ie(r===i.tn.ConfirmPassword?i.tn.SavedPayments:i.tn.Checkout)}),[ie,r]),Ee=(0,n.Kr)((()=>{switch(r){case i.tn.Checkout:return U("PaymentCheckout");case i.tn.ShippingInfo:return U("PaymentShippingInfo");case i.tn.Shipping:return U("PaymentShippingMethod");case i.tn.SavedPayments:return U("PaymentCheckoutMethod");case i.tn.ConfirmPassword:return U("Checkout.PasswordEntry.Title");case i.tn.PaymentInfo:return U("PaymentCardInfo");case i.tn.ConfirmPayment:return U("Checkout.WebConfirmation.Title");default:return""}}),[r,U]),be=r===i.tn.Checkout?U("Checkout.PayPrice",(0,Qi.A)(oe,d.currency,U.code)):O("PaymentInfoDone");if(c)return n.Ay.createElement(Q.A,{className:"error",isOpen:J,onClose:j,onCloseAnimationEnd:ve},n.Ay.createElement("p",null,"Sorry, Telegram Web A doesn't support payments with this provider yet. ",n.Ay.createElement("br",null),"Please use one of our mobile apps to do this."),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(W.A,{isText:!0,onClick:j},U("OK"))));const Ce=function(){if(H)return!0;switch(r){case i.tn.Checkout:return Boolean(d?.termsUrl)&&!Y;case i.tn.PaymentInfo:return Boolean(""===G.cardNumber||u&&""===G.cardholder||""===G.cvv||""===G.expiry);default:return!1}}();return n.Ay.createElement(Q.A,{className:(0,de.A)("PaymentModal",d?.isRecurring&&"recurring"),isOpen:J,onClose:j,onCloseAnimationEnd:ve},n.Ay.createElement("div",{className:"header",dir:U.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",onClick:r===i.tn.Checkout?j:ge,ariaLabel:"Close"},n.Ay.createElement(q.A,{name:r===i.tn.Checkout?"close":"arrow-left"})),n.Ay.createElement("h3",null,Ee)),void 0!==r?n.Ay.createElement(te.Ay,{name:"slide",activeKey:r,shouldCleanup:!0,cleanupOnlyKey:i.tn.ConfirmPayment},n.Ay.createElement("div",{className:"content custom-scroll"},function(e){switch(e){case i.tn.Checkout:return n.Ay.createElement(uv,{title:l.title,description:l.description,photo:l.photo,dispatch:z,shippingPrices:G.shipping&&o?Rv(o,G.shipping):void 0,totalPrice:oe,invoice:d,checkoutInfo:le,isPaymentFormUrl:w,hasShippingOptions:g,tipAmount:G.tipAmount,needAddress:Boolean(d?.isShippingAddressRequested),savedCredentials:f,isTosAccepted:Y,onAcceptTos:Z,botName:N});case i.tn.SavedPayments:return n.Ay.createElement(wv,{state:G,savedCredentials:f,dispatch:z,onNewCardClick:ce});case i.tn.ConfirmPassword:return n.Ay.createElement(pv,{state:G,savedCredentials:f,onPasswordChange:ee,isActive:e===r});case i.tn.PaymentInfo:return n.Ay.createElement(kv,{state:G,dispatch:z,canSaveCredentials:Boolean(!l.isPasswordMissing&&l.canSaveCredentials),needCardholderName:u,needCountry:A,needZip:h,countryList:v});case i.tn.ShippingInfo:return n.Ay.createElement(Iv,{state:G,dispatch:z,needAddress:Boolean(d?.isShippingAddressRequested),needEmail:Boolean(d?.isEmailRequested||d?.isEmailSentToProvider),needPhone:Boolean(d?.isPhoneRequested||d?.isPhoneSentToProvider),needName:Boolean(d?.isNameRequested),countryList:v});case i.tn.Shipping:return n.Ay.createElement(Nv,{state:G,dispatch:z,shippingOptions:o||[],currency:d.currency});case i.tn.ConfirmPayment:return n.Ay.createElement(yv,{url:y,noRedirect:k,onPaymentFormSubmit:Ae,onClose:j});default:return}}(r))):n.Ay.createElement("div",{className:"empty-content"},n.Ay.createElement(Re.A,{color:"gray"})),se&&n.Ay.createElement("div",{className:"footer"},n.Ay.createElement(W.A,{className:"button-text",type:"submit",onClick:pe,disabled:Ce,isLoading:H},be)),p&&!p.field&&function(){if(p)return n.Ay.createElement(Q.A,{className:"error",isOpen:Boolean(p),onClose:re},n.Ay.createElement("h4",null,p.descriptionKey?O.withRegular(p.descriptionKey):O("ErrorUnspecified")),n.Ay.createElement("div",{className:"dialog-buttons mt-2"},n.Ay.createElement(W.A,{isText:!0,onClick:me},U("OK"))))}())})));function Lv(e,t){return e.find((e=>{let{id:a}=e;return a===t}))}function Rv(e,t){const a=Lv(e,t);return a?.prices}const xv=(0,n.ph)((0,s.EK)((e=>{const{receipt:t}=(0,c.nTw)(e).payment;return{receipt:t}}))((e=>{let{isOpen:t,onClose:a,receipt:s}=e;const i=(0,Us.A)(),[r,o,l]=(0,I.A)();(0,n.vJ)((()=>{t&&o()}),[t,o]);const c=(0,Gl.A)(s),d=s||c,m=(0,n.Kr)((()=>{if(d)return function(e,t,a){if(!t)return{paymentMethod:e};const{shippingAddress:n}=t,s=n?.streetLine1?`${n.streetLine1}, ${n.city}, ${n.countryIso2}`:void 0,{phone:i,name:r}=t;return{paymentMethod:e,shippingAddress:s,name:r,phone:i,shippingMethod:a}}(d.credentialsTitle,d.info,d.shippingMethod)}),[d]);return n.Ay.createElement(Q.A,{className:"PaymentModal PaymentModal-receipt",isOpen:r,onClose:l,onCloseAnimationEnd:a},d&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("div",{className:"header",dir:i.isRtl?"rtl":void 0},n.Ay.createElement(W.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",onClick:l,ariaLabel:"Close"},n.Ay.createElement(q.A,{name:"close"})),n.Ay.createElement("h3",null," ",i("PaymentReceipt")," ")),n.Ay.createElement("div",{className:"receipt-content custom-scroll"},n.Ay.createElement(uv,{shippingPrices:d.shippingPrices,totalPrice:d.totalAmount,tipAmount:d.tipAmount,invoice:d.invoice,checkoutInfo:m,title:d.title,description:d.description,photo:d.photo}))))}))),Fv="Qo4PtFZI",Vv="wtfpombl",Dv=(0,n.ph)((0,s.EK)(((e,t)=>{let{modal:a}=t;return{chat:a?.chatId?(0,c.hds)(e,a.chatId):void 0}}))((e=>{let{modal:t,chat:a}=e;const{sendInviteMessages:i,closeInviteViaLinkModal:r,openPremiumModal:o}=(0,s.ko)(),{missingUsers:c}=t||{},d=(0,T.A)(),[m,u]=(0,n.J0)([]),A=(0,n.Kr)((()=>c?.map((e=>e.id))||ln.p),[c]),[h,y]=(0,n.Kr)((()=>{if(!c?.length)return[[],[]];const[e,t]=(0,on.jB)(c,(e=>e.isRequiringPremiumToMessage));return[e.map((e=>e.id)),t.map((e=>e.id))]}),[c]),p=(0,n.Kr)((()=>c?.filter((e=>e.isRequiringPremiumToInvite||e.isRequiringPremiumToMessage)).map((e=>e.id))),[c]),v=(0,n.Kr)((()=>{if(c)return!c.some((e=>e.isRequiringPremiumToInvite&&!e.isRequiringPremiumToMessage))}),[c]),g=(0,n.Kr)((()=>{const e=(0,s.mS)().users.byId;return p?.map((t=>e[t]))}),[p]);(0,n.vJ)((()=>{u(y)}),[y]);const E=(0,M.A)((()=>r())),b=(0,n.hb)((()=>{i({chatId:a.id,userIds:m}),r()}),[m,a]),C=(0,n.hb)((()=>{o()}),[]),f=(0,n.Kr)((()=>{if(a)return Boolean(a?.isCreator||a?.adminRights?.inviteUsers)}),[a]),S=(0,n.Kr)((()=>f?d(1===c?.length?"InviteBlockedOneMessage":"InviteBlockedManyMessage"):d("InviteRestrictedUsers2",c?.length)),[f,d,c?.length]),k=(0,n.Kr)((()=>{if(!p?.length||!g?.length)return;const e=v?"InviteMessagePremiumBlocked":"InvitePremiumBlocked";let t=`${e}One`,a=[(0,l.YgS)(g[0])];return 2===p.length?(t=`${e}Two`,a=[(0,l.YgS)(g[0]),(0,l.YgS)(g[1])]):3===p.length?(t=`${e}Three`,a=[(0,l.YgS)(g[0]),(0,l.YgS)(g[1]),(0,l.YgS)(g[2])]):p.length>3&&(t=`${e}Many`,a=[(0,l.YgS)(g[0]),(0,l.YgS)(g[1]),(p.length-2).toString()]),d(t,a,void 0,g.length)}),[p,v,d,g]),w=Boolean(g?.length),N=Boolean(y?.length);return n.Ay.createElement(Q.A,{isOpen:Boolean(A&&a),contentClassName:"n8eENbaR",onClose:E,isSlim:!0},n.Ay.createElement(W.A,{round:!0,color:"translucent",size:"smaller",className:"smosGkw9",ariaLabel:d("Close"),onClick:E},n.Ay.createElement(q.A,{name:"close"})),k&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement(Hn.A,{className:"Nc3SOtKd",peers:g,size:"large"}),n.Ay.createElement("h3",{className:Vv},d(f?"InvitePremiumBlockedTitle":"ChannelInviteViaLinkRestricted")),n.Ay.createElement("p",{className:Fv},(0,kt.A)(k,["simple_markdown"])),n.Ay.createElement(W.A,{withPremiumGradient:!0,isShiny:!0,size:"smaller",onClick:C},d("InvitePremiumBlockedSubscribe"))),w&&N&&n.Ay.createElement(Tc.A,{className:"UoMeVIyC"},d("InvitePremiumBlockedOr")),N&&n.Ay.createElement(n.Ay.Fragment,null,n.Ay.createElement("h3",{className:Vv},d("InviteBlockedTitle")),n.Ay.createElement("p",{className:Fv},S),n.Ay.createElement(cn.A,{className:"nEYyTS_m",itemIds:A,selectedIds:m,lockedUnselectedIds:h,lockedUnselectedSubtitle:d("InvitePremiumBlockedUser"),onSelectedIdsChange:u,isViewOnly:!f,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),f&&n.Ay.createElement(W.A,{className:"Ttkq3nqt",size:"smaller",onClick:b,disabled:!m.length},d("SendInviteLink.ActionInvite"))))})));var _v=a(84555);const Uv=(0,n.ph)((e=>{let{modal:t}=e;const{closeOneTimeMediaModal:a}=(0,s.ko)(),r=(0,T.A)(),o=(0,Cn.A)(t?.message,!0),{shouldRender:d,transitionClassNames:m}=(0,De.A)(Boolean(t)),u=(0,M.A)((()=>{})),A=(0,M.A)((()=>{a()}));if(!d||!o)return;const h=(0,l.Ie9)(o),y=(0,c.SJA)((0,s.mS)()),p=r(h?"Chat.Voice.Single.Close":"Chat.Voice.Single.DeleteAndClose");return n.Ay.createElement("div",{className:(0,de.A)("c3xMWwzW",m)},function(){if(!o?.content)return;const{voice:e,video:t}=o.content;return e?n.Ay.createElement($c.Ay,{className:"VLiJWMs0",theme:y,message:o,origin:i.d9.OneTimeModal,autoPlay:!0,onPlay:u,onPause:A}):t?.isRound?n.Ay.createElement(_v.A,{className:"ML2YEpGq",message:o,origin:"oneTimeModal",onStop:A}):void 0}(),n.Ay.createElement("div",{className:"VWy1qXJL"},n.Ay.createElement(W.A,{faded:!0,onClick:A,pill:!0,size:"smaller",color:"dark"===y?"dark":"secondary",className:"FfMrCmD9"},p)))})),Ov=(0,n.ph)((e=>{let{isOpen:t}=e;const a=(0,T.A)(),i=(0,Us.A)(),{closeWebAppsCloseConfirmationModal:r,closeWebAppModal:o}=(0,s.ko)(),[l,c]=(0,n.J0)(!1),d=(0,n.li)(null),m=(0,n.hb)((()=>{r({shouldSkipInFuture:l})}),[l]),u=(0,n.hb)((()=>{o({shouldSkipConfirmation:!0}),r({shouldSkipInFuture:l})}),[l]),A=(0,n.hb)((e=>{-1===e&&u()}),[u]),h=(0,Cs.A)(d,t,A,".Button");return n.Ay.createElement(Q.A,{className:(0,de.A)("confirm"),title:i("CloseMiniApps"),isOpen:t,onClose:m},n.Ay.createElement("p",null,i("AreYouSureCloseMiniApps")),n.Ay.createElement(js.A,{className:"dialog-checkbox",label:i("DoNotAskAgain"),checked:l,onCheck:c}),n.Ay.createElement("div",{className:"dialog-buttons mt-2",ref:d,onKeyDown:h},n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:u,color:"danger"},a("Confirm")),n.Ay.createElement(W.A,{className:"confirm-dialog-button",isText:!0,onClick:m},a("Cancel"))))}))},3178:(e,t,a)=>{a.d(t,{A:()=>A});var n=a(84051),s=a(31481),i=a(58784),r=a(14737),o=a(43874),l=a(37661),c=a(18104);const d=[0,50],m=[0,20],u=[20,0],A=(0,n.ph)((e=>{let{isPasswordVisible:t,isBig:a}=e;const[A,h]=(0,l.A)(!1),[y,p]=(0,l.A)(!1),{isMobile:v}=(0,o.Ay)(),g=v?s.UyP:s.H6l;(0,r.A)(p,2e3);const E=(0,n.hb)(h,[h]);return n.Ay.createElement("div",{id:"monkey",className:a?"big":""},!A&&n.Ay.createElement("div",{className:"monkey-preview"}),n.Ay.createElement(c.A,{size:a?s.r2x:g,className:y?"hidden":"shown",tgsUrl:i.w.MonkeyClose,playSegment:d,noLoop:!0,onLoad:E}),n.Ay.createElement(c.A,{size:a?s.r2x:g,className:y?"shown":"hidden",tgsUrl:i.w.MonkeyPeek,playSegment:t?m:u,noLoop:!0}))}))},84991:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(84051),s=a(87357),i=a(21849),r=a(18276);const o={root:"hyRfEyRz",top:"p_Ny8jqJ",badge:"QRrryqp4",text:"I5jdPgFL"},l=(0,n.ph)((e=>{let{peer:t,avatarWebPhoto:a,avatarSize:l,text:c,badgeText:d,badgeIcon:m,className:u,badgeClassName:A,badgeIconClassName:h,textClassName:y,onClick:p}=e;return n.Ay.createElement("div",{className:(0,s.A)(o.root,p&&o.clickable,u),onClick:p},n.Ay.createElement("div",{className:o.top},n.Ay.createElement(i.A,{size:l,peer:t,webPhoto:a}),d&&n.Ay.createElement("div",{className:(0,s.A)(o.badge,A)},m&&n.Ay.createElement(r.A,{name:m,className:h}),d)),c&&n.Ay.createElement("p",{className:(0,s.A)(o.text,y)},c))}))},34642:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(84051),s=a(87357),i=a(59030),r=a(64493),o=a(8410);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l.apply(this,arguments)}const c=(0,n.ph)((e=>{let{confirmButtonText:t,isConfirmDisabled:a,shouldAdaptToSearch:c,withFixedHeight:d,onConfirm:m,withPremiumGradient:u,...A}=e;const h=(0,i.A)(),y=Boolean(t||m);return n.Ay.createElement(o.A,l({},A,{isSlim:!0,className:(0,s.A)(c&&"WGSZ8u75",d&&"CrEsDylb",A.className),contentClassName:(0,s.A)("FuFYE0AA",A.contentClassName),headerClassName:(0,s.A)("iEptOmIp",A.headerClassName)}),A.children,y&&n.Ay.createElement("div",{className:"HqeDTaSr"},n.Ay.createElement(r.A,{withPremiumGradient:u,onClick:m||A.onClose,color:"primary",size:"smaller",disabled:a},t||h("Confirm"))))}))},5463:(e,t,a)=>{a.d(t,{A:()=>d});var n=a(84051),s=a(87357),i=a(18276),r=a(64493),o=a(22720),l=a(8410),c=a(32581);const d=(0,n.ph)((e=>{let{isOpen:t,listItemData:a,headerIconName:d,header:m,footer:u,buttonText:A,hasBackdrop:h,withSeparator:y,onClose:p,onButtonClick:v,contentClassName:g}=e;return n.Ay.createElement(l.A,{isOpen:t,className:(0,s.A)("LAh8evux",g),contentClassName:"hrizpMDe",hasAbsoluteCloseButton:!0,absoluteCloseButtonColor:h?"translucent-white":void 0,onClose:p},d&&n.Ay.createElement("div",{className:"jySLtQNG"},n.Ay.createElement(i.A,{name:d})),m,n.Ay.createElement("div",null,a?.map((e=>{let[t,a,s]=e;return n.Ay.createElement(o.A,{isStatic:!0,multiline:!0,icon:t,iconClassName:"hQbEPsTU"},n.Ay.createElement("span",{className:"title"},a),n.Ay.createElement("span",{className:"subtitle"},s))}))),y&&n.Ay.createElement(c.A,{className:"En1zD2cT"}),u,A&&n.Ay.createElement(r.A,{size:"smaller",onClick:v||p},A))}))},70046:(e,t,a)=>{a.d(t,{A:()=>u});var n=a(84051),s=a(13439),i=a(87357),r=a(17712),o=a(21849),l=a(10187),c=a(64493),d=a(8410);const m="Cnh5ENvm",u=(0,n.ph)((e=>{let{isOpen:t,title:a,tableData:u,headerAvatarPeer:A,header:h,modalHeader:y,footer:p,buttonText:v,className:g,hasBackdrop:E,onClose:b,onButtonClick:C}=e;const{openChat:f}=(0,s.ko)(),S=(0,r.A)((e=>{f({id:e}),b()}));return n.Ay.createElement(d.A,{isOpen:t,hasCloseButton:Boolean(a),hasAbsoluteCloseButton:!a,absoluteCloseButtonColor:E?"translucent-white":void 0,isSlim:!0,header:y,title:a,className:g,contentClassName:"KYHkJ9Qf",onClose:b},A&&n.Ay.createElement(o.A,{peer:A,size:"jumbo",className:"SHQbPR5Y"}),h,n.Ay.createElement("div",{className:"DFRB0Ad4"},u?.map((e=>{let[t,a]=e;return n.Ay.createElement(n.Ay.Fragment,null,t&&n.Ay.createElement("div",{className:(0,i.A)(m,"AwnUe4Qk")},t),n.Ay.createElement("div",{className:(0,i.A)(m,"JGH6P9Az",!t&&"UssCZwgy")},"object"==typeof a&&"chatId"in a?n.Ay.createElement(l.A,{peerId:a.chatId,className:"aS9U4hiQ",forceShowSelf:!0,withEmojiStatus:a.withEmojiStatus,clickArg:a.chatId,onClick:S}):a))}))),p,v&&n.Ay.createElement(c.A,{className:p?void 0:"cSamlkt9",size:"smaller",onClick:C||b},v))}))},1526:(e,t,a)=>{a.d(t,{A:()=>y});var n=a(84051),s=a(87357),i=a(17142),r=a(14242),o=a(4961),l=a(37661),c=a(39351),d=a(59030),m=a(18276),u=a(9267),A=a(64493);const h={options:"OnCj9kef",option:"tpTHQAUF",active:"U_9MXPG5",wideOption:"dJcJl33b",optionTop:"x9G4lqMf",stackedStars:"etXLebjM",stackedStar:"swttXv9P",optionBottom:"tK7La7L2",moreOptions:"AWXBaWLW",iconDown:"zWYHZJmd"},y=(0,n.ph)((e=>{let{isActive:t,className:a,options:y,selectedStarOption:p,selectedStarCount:v,starsNeeded:g,onClick:E}=e;const b=(0,d.A)(),C=(0,c.A)(),[f,S,k]=(0,l.A)();(0,n.vJ)((()=>{t||k()}),[t]);const[w,N]=(0,n.Kr)((()=>{if(!y)return[void 0,!1];const e=y.reduce(((e,t)=>e.stars>t.stars?e:t)),t=g&&e.stars<g,a=[];let n=0,s=!1;return y.forEach(((e,i)=>{e.isExtended||n++,g&&!t&&e.stars<g||(f||!e.isExtended?a.push({option:e,starsCount:Math.min(n,6),isWide:i===y.length-1}):s=!0)})),[a,s]}),[f,y,g]);return n.Ay.createElement("div",{className:(0,s.A)(h.options,a)},w?.map((e=>{let{option:t,starsCount:a,isWide:l}=e;const c=w?.length,d=c%2==0,m=t===p;let A;if(t&&"winners"in t){const e=t.winners.find((e=>e.users===v))||t.winners.reduce(((e,t)=>t.users>e.users?t:e),t.winners[0]);A=e?.perUserStars}return n.Ay.createElement("div",{className:(0,s.A)(h.option,!d&&l&&h.wideOption,m&&h.active),key:t.stars,onClick:()=>E?.(t)},n.Ay.createElement("div",{className:h.optionTop},"+",(0,r.Sm)(t.stars),n.Ay.createElement("div",{className:h.stackedStars,dir:C.isRtl?"ltr":"rtl"},Array.from({length:a}).map((()=>n.Ay.createElement(u.A,{className:h.stackedStar,type:"gold",size:"big"}))))),n.Ay.createElement("div",{className:h.optionBottom},(0,i.v)(C,t.amount,t.currency)),(m||p&&"winners"in p)&&A&&n.Ay.createElement("div",{className:h.optionBottom},n.Ay.createElement("div",{className:h.perUserStars},(0,o.A)(b("BoostGift.Stars.PerUser",(0,r.Sm)(A))))))})),!f&&N&&n.Ay.createElement(A.A,{className:h.moreOptions,isText:!0,noForcedUpperCase:!0,onClick:S},b("Stars.Purchase.ShowMore"),n.Ay.createElement(m.A,{className:h.iconDown,name:"down"})))}))}}]);
//# sourceMappingURL=telegram-a.9451.19a3b09af534b22d3528.js.map